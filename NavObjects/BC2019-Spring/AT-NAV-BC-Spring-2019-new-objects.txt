OBJECT Table 18 Customer
{
  OBJECT-PROPERTIES
  {
    Date=17.06.19;
    Time=20:37:33;
    Modified=Yes;
    Version List=NAVW114.01,AT2017.01;
  }
  PROPERTIES
  {
    Permissions=TableData 21=r,
                TableData 167=r,
                TableData 249=rd,
                TableData 5900=r,
                TableData 5907=r,
                TableData 5940=rm,
                TableData 5965=rm,
                TableData 7002=rd,
                TableData 7004=rd;
    DataCaptionFields=No.,Name;
    OnInsert=BEGIN
               IF "No." = '' THEN BEGIN
                 SalesSetup.GET;
                 SalesSetup.TESTFIELD("Customer Nos.");
                 NoSeriesMgt.InitSeries(SalesSetup."Customer Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;

               IF "Invoice Disc. Code" = '' THEN
                 "Invoice Disc. Code" := "No.";

               IF (NOT (InsertFromContact OR (InsertFromTemplate AND (Contact <> '')) OR ISTEMPORARY)) OR ForceUpdateContact THEN
                 UpdateContFromCust.OnInsert(Rec);

               IF "Salesperson Code" = '' THEN
                 SetDefaultSalesperson;

               DimMgt.UpdateDefaultDim(
                 DATABASE::Customer,"No.",
                 "Global Dimension 1 Code","Global Dimension 2 Code");

               UpdateReferencedIds;
               SetLastModifiedDateTime;
             END;

    OnModify=BEGIN
               UpdateReferencedIds;
               SetLastModifiedDateTime;
               IF IsContactUpdateNeeded THEN BEGIN
                 MODIFY;
                 UpdateContFromCust.OnModify(Rec);
                 IF NOT FIND THEN BEGIN
                   RESET;
                   IF FIND THEN;
                 END;
               END;
             END;

    OnDelete=VAR
               CampaignTargetGr@1000 : Record 7030;
               ContactBusRel@1001 : Record 5054;
               Job@1004 : Record 167;
               SocialListeningSearchTopic@1007 : Record 871;
               StdCustSalesCode@1003 : Record 172;
               CustomReportSelection@1008 : Record 9657;
               MyCustomer@1005 : Record 9150;
               ServHeader@1009 : Record 5900;
               CampaignTargetGrMgmt@1002 : Codeunit 7030;
               VATRegistrationLogMgt@1006 : Codeunit 249;
               ConfirmManagement@1010 : Codeunit 27;
             BEGIN
               ApprovalsMgmt.OnCancelCustomerApprovalRequest(Rec);

               ServiceItem.SETRANGE("Customer No.","No.");
               IF ServiceItem.FINDFIRST THEN
                 IF ConfirmManagement.ConfirmProcess(
                      STRSUBSTNO(Text008,TABLECAPTION,"No.",ServiceItem.FIELDCAPTION("Customer No.")),TRUE)
                 THEN
                   ServiceItem.MODIFYALL("Customer No.",'')
                 ELSE
                   ERROR(Text009);

               Job.SETRANGE("Bill-to Customer No.","No.");
               IF NOT Job.ISEMPTY THEN
                 ERROR(Text015,TABLECAPTION,"No.",Job.TABLECAPTION);

               MoveEntries.MoveCustEntries(Rec);

               CommentLine.SETRANGE("Table Name",CommentLine."Table Name"::Customer);
               CommentLine.SETRANGE("No.","No.");
               CommentLine.DELETEALL;

               CustBankAcc.SETRANGE("Customer No.","No.");
               CustBankAcc.DELETEALL;

               ShipToAddr.SETRANGE("Customer No.","No.");
               ShipToAddr.DELETEALL;

               SalesPrice.SETRANGE("Sales Type",SalesPrice."Sales Type"::Customer);
               SalesPrice.SETRANGE("Sales Code","No.");
               SalesPrice.DELETEALL;

               SalesLineDisc.SETRANGE("Sales Type",SalesLineDisc."Sales Type"::Customer);
               SalesLineDisc.SETRANGE("Sales Code","No.");
               SalesLineDisc.DELETEALL;

               SalesPrepmtPct.SETCURRENTKEY("Sales Type","Sales Code");
               SalesPrepmtPct.SETRANGE("Sales Type",SalesPrepmtPct."Sales Type"::Customer);
               SalesPrepmtPct.SETRANGE("Sales Code","No.");
               SalesPrepmtPct.DELETEALL;

               StdCustSalesCode.SETRANGE("Customer No.","No.");
               StdCustSalesCode.DELETEALL(TRUE);

               ItemCrossReference.SETCURRENTKEY("Cross-Reference Type","Cross-Reference Type No.");
               ItemCrossReference.SETRANGE("Cross-Reference Type",ItemCrossReference."Cross-Reference Type"::Customer);
               ItemCrossReference.SETRANGE("Cross-Reference Type No.","No.");
               ItemCrossReference.DELETEALL;

               IF NOT SocialListeningSearchTopic.ISEMPTY THEN BEGIN
                 SocialListeningSearchTopic.FindSearchTopic(SocialListeningSearchTopic."Source Type"::Customer,"No.");
                 SocialListeningSearchTopic.DELETEALL;
               END;

               SalesOrderLine.SETCURRENTKEY("Document Type","Bill-to Customer No.");
               SalesOrderLine.SETRANGE("Bill-to Customer No.","No.");
               IF SalesOrderLine.FINDFIRST THEN
                 ERROR(
                   Text000,
                   TABLECAPTION,"No.",SalesOrderLine."Document Type");

               SalesOrderLine.SETRANGE("Bill-to Customer No.");
               SalesOrderLine.SETRANGE("Sell-to Customer No.","No.");
               IF SalesOrderLine.FINDFIRST THEN
                 ERROR(
                   Text000,
                   TABLECAPTION,"No.",SalesOrderLine."Document Type");

               CampaignTargetGr.SETRANGE("No.","No.");
               CampaignTargetGr.SETRANGE(Type,CampaignTargetGr.Type::Customer);
               IF CampaignTargetGr.FIND('-') THEN BEGIN
                 ContactBusRel.SETRANGE("Link to Table",ContactBusRel."Link to Table"::Customer);
                 ContactBusRel.SETRANGE("No.","No.");
                 ContactBusRel.FINDFIRST;
                 REPEAT
                   CampaignTargetGrMgmt.ConverttoContact(Rec,ContactBusRel."Contact No.");
                 UNTIL CampaignTargetGr.NEXT = 0;
               END;

               ServContract.SETFILTER(Status,'<>%1',ServContract.Status::Canceled);
               ServContract.SETRANGE("Customer No.","No.");
               IF NOT ServContract.ISEMPTY THEN
                 ERROR(
                   Text007,
                   TABLECAPTION,"No.");

               ServContract.SETRANGE(Status);
               ServContract.MODIFYALL("Customer No.",'');

               ServContract.SETFILTER(Status,'<>%1',ServContract.Status::Canceled);
               ServContract.SETRANGE("Bill-to Customer No.","No.");
               IF NOT ServContract.ISEMPTY THEN
                 ERROR(
                   Text007,
                   TABLECAPTION,"No.");

               ServContract.SETRANGE(Status);
               ServContract.MODIFYALL("Bill-to Customer No.",'');

               ServHeader.SETCURRENTKEY("Customer No.","Order Date");
               ServHeader.SETRANGE("Customer No.","No.");
               IF ServHeader.FINDFIRST THEN
                 ERROR(
                   Text013,
                   TABLECAPTION,"No.",ServHeader."Document Type");

               ServHeader.SETRANGE("Bill-to Customer No.");
               IF ServHeader.FINDFIRST THEN
                 ERROR(
                   Text013,
                   TABLECAPTION,"No.",ServHeader."Document Type");

               UpdateContFromCust.OnDelete(Rec);

               CustomReportSelection.SETRANGE("Source Type",DATABASE::Customer);
               CustomReportSelection.SETRANGE("Source No.","No.");
               CustomReportSelection.DELETEALL;

               MyCustomer.SETRANGE("Customer No.","No.");
               MyCustomer.DELETEALL;
               VATRegistrationLogMgt.DeleteCustomerLog(Rec);

               DimMgt.DeleteDefaultDim(DATABASE::Customer,"No.");

               CalendarManagement.DeleteCustomizedBaseCalendarData(CustomizedCalendarChange."Source Type"::Customer,"No.");
             END;

    OnRename=VAR
               CustomerTemplate@1000 : Record 5105;
             BEGIN
               ApprovalsMgmt.OnRenameRecordInApprovalRequest(xRec.RECORDID,RECORDID);
               DimMgt.RenameDefaultDim(DATABASE::Customer,xRec."No.","No.");

               SetLastModifiedDateTime;
               IF xRec."Invoice Disc. Code" = xRec."No." THEN
                 "Invoice Disc. Code" := "No.";
               CustomerTemplate.SETRANGE("Invoice Disc. Code",xRec."No.");
               CustomerTemplate.MODIFYALL("Invoice Disc. Code","No.");

               CalendarManagement.RenameCustomizedBaseCalendarData(CustomizedCalendarChange."Source Type"::Customer,"No.",xRec."No.");
             END;

    CaptionML=[DEU=Debitor;
               ENU=Customer];
    LookupPageID=Page33;
    DrillDownPageID=Page22;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  NoSeriesMgt.TestManual(SalesSetup."Customer Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                                IF "Invoice Disc. Code" = '' THEN
                                                                  "Invoice Disc. Code" := "No.";
                                                              END;

                                                   AltSearchField=Search Name;
                                                   CaptionML=[DEU=Nr.;
                                                              ENU=No.] }
    { 2   ;   ;Name                ;Text100       ;OnValidate=BEGIN
                                                                IF ("Search Name" = UPPERCASE(xRec.Name)) OR ("Search Name" = '') THEN
                                                                  "Search Name" := Name;

                                                                // AT2017 BEGIN
                                                                IF Name <> xRec.Name THEN
                                                                  ATEvPub.OnCustomerNameChanged(Rec);
                                                                // AT2017 END
                                                              END;

                                                   CaptionML=[DEU=Name;
                                                              ENU=Name] }
    { 3   ;   ;Search Name         ;Code100       ;CaptionML=[DEU=Suchbegriff;
                                                              ENU=Search Name] }
    { 4   ;   ;Name 2              ;Text50        ;CaptionML=[DEU=Name 2;
                                                              ENU=Name 2] }
    { 5   ;   ;Address             ;Text100       ;CaptionML=[DEU=Adresse;
                                                              ENU=Address] }
    { 6   ;   ;Address 2           ;Text50        ;CaptionML=[DEU=Adresse 2;
                                                              ENU=Address 2] }
    { 7   ;   ;City                ;Text30        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookupPostCode(City,"Post Code",County,"Country/Region Code");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DEU=Ort;
                                                              ENU=City] }
    { 8   ;   ;Contact             ;Text100       ;OnValidate=BEGIN
                                                                IF RMSetup.GET THEN
                                                                  IF RMSetup."Bus. Rel. Code for Customers" <> '' THEN
                                                                    IF (xRec.Contact = '') AND (xRec."Primary Contact No." = '') AND (Contact <> '') THEN BEGIN
                                                                      MODIFY;
                                                                      UpdateContFromCust.OnModify(Rec);
                                                                      UpdateContFromCust.InsertNewContactPerson(Rec,FALSE);
                                                                      MODIFY(TRUE);
                                                                    END
                                                              END;

                                                   OnLookup=VAR
                                                              ContactBusinessRelation@1001 : Record 5054;
                                                              Cont@1000 : Record 5050;
                                                              TempCust@1002 : TEMPORARY Record 18;
                                                            BEGIN
                                                              IF ContactBusinessRelation.FindByRelation(ContactBusinessRelation."Link to Table"::Customer,"No.") THEN
                                                                Cont.SETRANGE("Company No.",ContactBusinessRelation."Contact No.")
                                                              ELSE
                                                                Cont.SETRANGE("Company No.",'');

                                                              IF "Primary Contact No." <> '' THEN
                                                                IF Cont.GET("Primary Contact No.") THEN ;
                                                              IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                TempCust.COPY(Rec);
                                                                FIND;
                                                                TRANSFERFIELDS(TempCust,FALSE);
                                                                VALIDATE("Primary Contact No.",Cont."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[DEU=Kontakt;
                                                              ENU=Contact] }
    { 9   ;   ;Phone No.           ;Text30        ;OnValidate=VAR
                                                                Char@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Char";
                                                                i@1001 : Integer;
                                                              BEGIN
                                                                FOR i := 1 TO STRLEN("Phone No.") DO
                                                                  IF Char.IsLetter("Phone No."[i]) THEN
                                                                    ERROR(PhoneNoCannotContainLettersErr);

                                                                // AT2017 BEGIN
                                                                ATEvPub.OnCustomerPhoneNoChanged(Rec);
                                                                // AT2017.01 CHANGED
                                                                // AT2017 END
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[DEU=Telefonnr.;
                                                              ENU=Phone No.] }
    { 10  ;   ;Telex No.           ;Text20        ;CaptionML=[DEU=Telexnr.;
                                                              ENU=Telex No.] }
    { 11  ;   ;Document Sending Profile;Code20    ;TableRelation="Document Sending Profile".Code;
                                                   CaptionML=[DEU=Belegsendeprofil;
                                                              ENU=Document Sending Profile] }
    { 12  ;   ;Ship-to Code        ;Code10        ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(No.));
                                                   CaptionML=[DEU=Lief. an Code;
                                                              ENU=Ship-to Code] }
    { 14  ;   ;Our Account No.     ;Text20        ;CaptionML=[DEU=Unsere Kontonr.;
                                                              ENU=Our Account No.] }
    { 15  ;   ;Territory Code      ;Code10        ;TableRelation=Territory;
                                                   CaptionML=[DEU=Gebietscode;
                                                              ENU=Territory Code] }
    { 16  ;   ;Global Dimension 1 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Global Dimension 1 Code");
                                                              END;

                                                   CaptionML=[DEU=Globaler Dimensionscode 1;
                                                              ENU=Global Dimension 1 Code];
                                                   CaptionClass='1,1,1' }
    { 17  ;   ;Global Dimension 2 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Global Dimension 2 Code");
                                                              END;

                                                   CaptionML=[DEU=Globaler Dimensionscode 2;
                                                              ENU=Global Dimension 2 Code];
                                                   CaptionClass='1,1,2' }
    { 18  ;   ;Chain Name          ;Code10        ;CaptionML=[DEU=Unternehmenskette;
                                                              ENU=Chain Name] }
    { 19  ;   ;Budgeted Amount     ;Decimal       ;CaptionML=[DEU=Budgetierter Betrag;
                                                              ENU=Budgeted Amount];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 20  ;   ;Credit Limit (LCY)  ;Decimal       ;CaptionML=[DEU=Kreditlimit (MW);
                                                              ENU=Credit Limit (LCY)];
                                                   AutoFormatType=1 }
    { 21  ;   ;Customer Posting Group;Code20      ;TableRelation="Customer Posting Group";
                                                   CaptionML=[DEU=Debitorenbuchungsgruppe;
                                                              ENU=Customer Posting Group] }
    { 22  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   OnValidate=BEGIN
                                                                UpdateCurrencyId;
                                                              END;

                                                   CaptionML=[DEU=WÑhrungscode;
                                                              ENU=Currency Code] }
    { 23  ;   ;Customer Price Group;Code10        ;TableRelation="Customer Price Group";
                                                   CaptionML=[DEU=Debitorenpreisgruppe;
                                                              ENU=Customer Price Group] }
    { 24  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   CaptionML=[DEU=Sprachcode;
                                                              ENU=Language Code] }
    { 26  ;   ;Statistics Group    ;Integer       ;CaptionML=[DEU=Statistikgruppe;
                                                              ENU=Statistics Group] }
    { 27  ;   ;Payment Terms Code  ;Code10        ;TableRelation="Payment Terms";
                                                   OnValidate=BEGIN
                                                                UpdatePaymentTermsId;
                                                              END;

                                                   CaptionML=[DEU=Zlg.-Bedingungscode;
                                                              ENU=Payment Terms Code] }
    { 28  ;   ;Fin. Charge Terms Code;Code10      ;TableRelation="Finance Charge Terms";
                                                   CaptionML=[DEU=Zinskonditionencode;
                                                              ENU=Fin. Charge Terms Code] }
    { 29  ;   ;Salesperson Code    ;Code20        ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=BEGIN
                                                                ValidateSalesPersonCode;
                                                              END;

                                                   CaptionML=[DEU=VerkÑufercode;
                                                              ENU=Salesperson Code] }
    { 30  ;   ;Shipment Method Code;Code10        ;TableRelation="Shipment Method";
                                                   OnValidate=BEGIN
                                                                UpdateShipmentMethodId;
                                                              END;

                                                   CaptionML=[DEU=Lieferbedingungscode;
                                                              ENU=Shipment Method Code] }
    { 31  ;   ;Shipping Agent Code ;Code10        ;TableRelation="Shipping Agent";
                                                   OnValidate=BEGIN
                                                                IF "Shipping Agent Code" <> xRec."Shipping Agent Code" THEN
                                                                  VALIDATE("Shipping Agent Service Code",'');
                                                              END;

                                                   AccessByPermission=TableData 5790=R;
                                                   CaptionML=[DEU=Zustellercode;
                                                              ENU=Shipping Agent Code] }
    { 32  ;   ;Place of Export     ;Code20        ;CaptionML=[DEU=Transitstelle;
                                                              ENU=Place of Export] }
    { 33  ;   ;Invoice Disc. Code  ;Code20        ;TableRelation=Customer;
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DEU=Rechnungsrabattcode;
                                                              ENU=Invoice Disc. Code] }
    { 34  ;   ;Customer Disc. Group;Code20        ;TableRelation="Customer Discount Group";
                                                   CaptionML=[DEU=Debitorenrabattgruppe;
                                                              ENU=Customer Disc. Group] }
    { 35  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   OnValidate=BEGIN
                                                                PostCode.CheckClearPostCodeCityCounty(City,"Post Code",County,"Country/Region Code",xRec."Country/Region Code");

                                                                IF "Country/Region Code" <> xRec."Country/Region Code" THEN
                                                                  VATRegistrationValidation;
                                                              END;

                                                   CaptionML=[DEU=LÑnder-/Regionscode;
                                                              ENU=Country/Region Code] }
    { 36  ;   ;Collection Method   ;Code20        ;CaptionML=[DEU=Einzugsverfahren;
                                                              ENU=Collection Method] }
    { 37  ;   ;Amount              ;Decimal       ;CaptionML=[DEU=Betrag;
                                                              ENU=Amount];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 38  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Comment Line" WHERE (Table Name=CONST(Customer),
                                                                                           No.=FIELD(No.)));
                                                   CaptionML=[DEU=Bemerkung;
                                                              ENU=Comment];
                                                   Editable=No }
    { 39  ;   ;Blocked             ;Option        ;OnValidate=BEGIN
                                                                IF (Blocked <> Blocked::All) AND "Privacy Blocked" THEN
                                                                  IF GUIALLOWED THEN
                                                                    IF CONFIRM(ConfirmBlockedPrivacyBlockedQst) THEN
                                                                      "Privacy Blocked" := FALSE
                                                                    ELSE
                                                                      ERROR('')
                                                                  ELSE
                                                                    ERROR(CanNotChangeBlockedDueToPrivacyBlockedErr);

                                                                // AT2017 BEGIN
                                                                IF Blocked <> xRec.Blocked THEN
                                                                  ATEvPub.OnCustomerBlockedChanged(Rec);
                                                                // AT2017 END
                                                              END;

                                                   CaptionML=[DEU=Gesperrt;
                                                              ENU=Blocked];
                                                   OptionCaptionML=[DEU=" ,Liefern,Fakturieren,Alle";
                                                                    ENU=" ,Ship,Invoice,All"];
                                                   OptionString=[ ,Ship,Invoice,All] }
    { 40  ;   ;Invoice Copies      ;Integer       ;CaptionML=[DEU=Anzahl Rechnungskopien;
                                                              ENU=Invoice Copies] }
    { 41  ;   ;Last Statement No.  ;Integer       ;CaptionML=[DEU=Letzte Kontoauszugsnr.;
                                                              ENU=Last Statement No.] }
    { 42  ;   ;Print Statements    ;Boolean       ;CaptionML=[DEU=KontoauszÅge drucken;
                                                              ENU=Print Statements] }
    { 45  ;   ;Bill-to Customer No.;Code20        ;TableRelation=Customer;
                                                   CaptionML=[DEU=Rech. an Deb.-Nr.;
                                                              ENU=Bill-to Customer No.] }
    { 46  ;   ;Priority            ;Integer       ;CaptionML=[DEU=PrioritÑt;
                                                              ENU=Priority] }
    { 47  ;   ;Payment Method Code ;Code10        ;TableRelation="Payment Method";
                                                   OnValidate=VAR
                                                                PaymentMethod@1000 : Record 289;
                                                              BEGIN
                                                                UpdatePaymentMethodId;

                                                                IF "Payment Method Code" = '' THEN
                                                                  EXIT;

                                                                PaymentMethod.GET("Payment Method Code");
                                                                IF PaymentMethod."Direct Debit" AND ("Payment Terms Code" = '') THEN
                                                                  VALIDATE("Payment Terms Code",PaymentMethod."Direct Debit Pmt. Terms Code");
                                                              END;

                                                   CaptionML=[DEU=Zahlungsformcode;
                                                              ENU=Payment Method Code] }
    { 53  ;   ;Last Modified Date Time;DateTime   ;CaptionML=[DEU=Datum/Uhrzeit der letzten énderung;
                                                              ENU=Last Modified Date Time];
                                                   Editable=No }
    { 54  ;   ;Last Date Modified  ;Date          ;CaptionML=[DEU=Korrigiert am;
                                                              ENU=Last Date Modified];
                                                   Editable=No }
    { 55  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=Datumsfilter;
                                                              ENU=Date Filter] }
    { 56  ;   ;Global Dimension 1 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   CaptionML=[DEU=Globaler Dimensionsfilter 1;
                                                              ENU=Global Dimension 1 Filter];
                                                   CaptionClass='1,3,1' }
    { 57  ;   ;Global Dimension 2 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   CaptionML=[DEU=Globaler Dimensionsfilter 2;
                                                              ENU=Global Dimension 2 Filter];
                                                   CaptionClass='1,3,2' }
    { 58  ;   ;Balance             ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Customer No.=FIELD(No.),
                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                              Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Saldo;
                                                              ENU=Balance];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 59  ;   ;Balance (LCY)       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Customer No.=FIELD(No.),
                                                                                                                      Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                      Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                      Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Saldo (MW);
                                                              ENU=Balance (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 60  ;   ;Net Change          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Customer No.=FIELD(No.),
                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                              Posting Date=FIELD(Date Filter),
                                                                                                              Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Bewegung;
                                                              ENU=Net Change];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 61  ;   ;Net Change (LCY)    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Customer No.=FIELD(No.),
                                                                                                                      Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                      Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                      Posting Date=FIELD(Date Filter),
                                                                                                                      Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Bewegung (MW);
                                                              ENU=Net Change (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 62  ;   ;Sales (LCY)         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Cust. Ledger Entry"."Sales (LCY)" WHERE (Customer No.=FIELD(No.),
                                                                                                             Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                             Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                             Posting Date=FIELD(Date Filter),
                                                                                                             Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Verkauf (MW);
                                                              ENU=Sales (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 63  ;   ;Profit (LCY)        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Cust. Ledger Entry"."Profit (LCY)" WHERE (Customer No.=FIELD(No.),
                                                                                                              Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                              Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                              Posting Date=FIELD(Date Filter),
                                                                                                              Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=DB (MW);
                                                              ENU=Profit (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 64  ;   ;Inv. Discounts (LCY);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Cust. Ledger Entry"."Inv. Discount (LCY)" WHERE (Customer No.=FIELD(No.),
                                                                                                                     Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                     Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                     Posting Date=FIELD(Date Filter),
                                                                                                                     Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Rechnungsrabatte (MW);
                                                              ENU=Inv. Discounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 65  ;   ;Pmt. Discounts (LCY);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Customer No.=FIELD(No.),
                                                                                                                       Entry Type=FILTER(Payment Discount..'Payment Discount (VAT Adjustment)'),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Skonto (MW);
                                                              ENU=Pmt. Discounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 66  ;   ;Balance Due         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Customer No.=FIELD(No.),
                                                                                                              Initial Entry Due Date=FIELD(UPPERLIMIT(Date Filter)),
                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                              Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=FÑlliger Saldo;
                                                              ENU=Balance Due];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 67  ;   ;Balance Due (LCY)   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Customer No.=FIELD(No.),
                                                                                                                      Initial Entry Due Date=FIELD(UPPERLIMIT(Date Filter)),
                                                                                                                      Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                      Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                      Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=FÑlliger Saldo (MW);
                                                              ENU=Balance Due (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 69  ;   ;Payments            ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Payment),
                                                                                                               Entry Type=CONST(Initial Entry),
                                                                                                               Customer No.=FIELD(No.),
                                                                                                               Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                               Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                               Posting Date=FIELD(Date Filter),
                                                                                                               Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Zahlungen;
                                                              ENU=Payments];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 70  ;   ;Invoice Amounts     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Invoice),
                                                                                                              Entry Type=CONST(Initial Entry),
                                                                                                              Customer No.=FIELD(No.),
                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                              Posting Date=FIELD(Date Filter),
                                                                                                              Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Fakturierter Betrag;
                                                              ENU=Invoice Amounts];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 71  ;   ;Cr. Memo Amounts    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Credit Memo),
                                                                                                               Entry Type=CONST(Initial Entry),
                                                                                                               Customer No.=FIELD(No.),
                                                                                                               Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                               Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                               Posting Date=FIELD(Date Filter),
                                                                                                               Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Gutgeschriebener Betrag;
                                                              ENU=Cr. Memo Amounts];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 72  ;   ;Finance Charge Memo Amounts;Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Finance Charge Memo),
                                                                                                              Entry Type=CONST(Initial Entry),
                                                                                                              Customer No.=FIELD(No.),
                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                              Posting Date=FIELD(Date Filter),
                                                                                                              Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Zinsrechnungsbetrag;
                                                              ENU=Finance Charge Memo Amounts];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 74  ;   ;Payments (LCY)      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Payment),
                                                                                                                       Entry Type=CONST(Initial Entry),
                                                                                                                       Customer No.=FIELD(No.),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Bezahlt (MW);
                                                              ENU=Payments (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 75  ;   ;Inv. Amounts (LCY)  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Invoice),
                                                                                                                      Entry Type=CONST(Initial Entry),
                                                                                                                      Customer No.=FIELD(No.),
                                                                                                                      Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                      Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                      Posting Date=FIELD(Date Filter),
                                                                                                                      Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Fakturierter Betrag (MW);
                                                              ENU=Inv. Amounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 76  ;   ;Cr. Memo Amounts (LCY);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Credit Memo),
                                                                                                                       Entry Type=CONST(Initial Entry),
                                                                                                                       Customer No.=FIELD(No.),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Gutgeschriebener Betrag (MW);
                                                              ENU=Cr. Memo Amounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 77  ;   ;Fin. Charge Memo Amounts (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Finance Charge Memo),
                                                                                                                      Entry Type=CONST(Initial Entry),
                                                                                                                      Customer No.=FIELD(No.),
                                                                                                                      Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                      Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                      Posting Date=FIELD(Date Filter),
                                                                                                                      Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Zinsrechnungsbetrag (MW);
                                                              ENU=Fin. Charge Memo Amounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 78  ;   ;Outstanding Orders  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Outstanding Amount" WHERE (Document Type=CONST(Order),
                                                                                                            Bill-to Customer No.=FIELD(No.),
                                                                                                            Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                            Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                            Currency Code=FIELD(Currency Filter)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[DEU=Auftragsbestand;
                                                              ENU=Outstanding Orders];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 79  ;   ;Shipped Not Invoiced;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Shipped Not Invoiced" WHERE (Document Type=CONST(Order),
                                                                                                              Bill-to Customer No.=FIELD(No.),
                                                                                                              Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                              Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                              Currency Code=FIELD(Currency Filter)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[DEU=Nicht fakt. Lieferungen;
                                                              ENU=Shipped Not Invoiced];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 80  ;   ;Application Method  ;Option        ;CaptionML=[DEU=Ausgleichsmethode;
                                                              ENU=Application Method];
                                                   OptionCaptionML=[DEU=Offener Posten,Saldomethode;
                                                                    ENU=Manual,Apply to Oldest];
                                                   OptionString=Manual,Apply to Oldest }
    { 82  ;   ;Prices Including VAT;Boolean       ;CaptionML=[DEU=Preise inkl. MwSt.;
                                                              ENU=Prices Including VAT] }
    { 83  ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   CaptionML=[DEU=Lagerortcode;
                                                              ENU=Location Code] }
    { 84  ;   ;Fax No.             ;Text30        ;OnValidate=BEGIN
                                                                // AT2017 BEGIN
                                                                ATEvPub.OnCustomerFaxNoChanged(Rec);
                                                                // AT2017.01 CHANGED
                                                                // AT2017 END
                                                              END;

                                                   CaptionML=[DEU=Faxnr.;
                                                              ENU=Fax No.] }
    { 85  ;   ;Telex Answer Back   ;Text20        ;CaptionML=[DEU=Telex Namengeber;
                                                              ENU=Telex Answer Back] }
    { 86  ;   ;VAT Registration No.;Text20        ;OnValidate=BEGIN
                                                                "VAT Registration No." := UPPERCASE("VAT Registration No.");
                                                                IF "VAT Registration No." <> xRec."VAT Registration No." THEN
                                                                  VATRegistrationValidation;
                                                              END;

                                                   CaptionML=[DEU=USt-IdNr.;
                                                              ENU=VAT Registration No.] }
    { 87  ;   ;Combine Shipments   ;Boolean       ;AccessByPermission=TableData 110=R;
                                                   CaptionML=[DEU=Sammelrechnung;
                                                              ENU=Combine Shipments] }
    { 88  ;   ;Gen. Bus. Posting Group;Code20     ;TableRelation="Gen. Business Posting Group";
                                                   OnValidate=BEGIN
                                                                IF xRec."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group" THEN
                                                                  IF GenBusPostingGrp.ValidateVatBusPostingGroup(GenBusPostingGrp,"Gen. Bus. Posting Group") THEN
                                                                    VALIDATE("VAT Bus. Posting Group",GenBusPostingGrp."Def. VAT Bus. Posting Group");
                                                              END;

                                                   CaptionML=[DEU=GeschÑftsbuchungsgruppe;
                                                              ENU=Gen. Bus. Posting Group] }
    { 89  ;   ;Picture             ;BLOB          ;ObsoleteState=Pending;
                                                   ObsoleteReason=Replaced by Image field;
                                                   CaptionML=[DEU=Bild;
                                                              ENU=Picture];
                                                   SubType=Bitmap }
    { 90  ;   ;GLN                 ;Code13        ;OnValidate=VAR
                                                                GLNCalculator@1000 : Codeunit 1607;
                                                              BEGIN
                                                                IF GLN <> '' THEN
                                                                  GLNCalculator.AssertValidCheckDigit13(GLN);
                                                              END;

                                                   CaptionML=[DEU=GLN;
                                                              ENU=GLN];
                                                   Numeric=Yes }
    { 91  ;   ;Post Code           ;Code20        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookupPostCode(City,"Post Code",County,"Country/Region Code");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DEU=PLZ-Code;
                                                              ENU=Post Code] }
    { 92  ;   ;County              ;Text30        ;CaptionML=[DEU=Bundesregion;
                                                              ENU=County];
                                                   CaptionClass='5,1,' + "Country/Region Code" }
    { 97  ;   ;Debit Amount        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Debit Amount" WHERE (Customer No.=FIELD(No.),
                                                                                                                      Entry Type=FILTER(<>Application),
                                                                                                                      Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                      Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                      Posting Date=FIELD(Date Filter),
                                                                                                                      Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Sollbetrag;
                                                              ENU=Debit Amount];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 98  ;   ;Credit Amount       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Credit Amount" WHERE (Customer No.=FIELD(No.),
                                                                                                                       Entry Type=FILTER(<>Application),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Habenbetrag;
                                                              ENU=Credit Amount];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 99  ;   ;Debit Amount (LCY)  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Debit Amount (LCY)" WHERE (Customer No.=FIELD(No.),
                                                                                                                            Entry Type=FILTER(<>Application),
                                                                                                                            Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                            Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                            Posting Date=FIELD(Date Filter),
                                                                                                                            Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Sollbetrag (MW);
                                                              ENU=Debit Amount (LCY)];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 100 ;   ;Credit Amount (LCY) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Credit Amount (LCY)" WHERE (Customer No.=FIELD(No.),
                                                                                                                             Entry Type=FILTER(<>Application),
                                                                                                                             Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                             Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                             Posting Date=FIELD(Date Filter),
                                                                                                                             Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Habenbetrag (MW);
                                                              ENU=Credit Amount (LCY)];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 102 ;   ;E-Mail              ;Text80        ;OnValidate=VAR
                                                                MailManagement@1000 : Codeunit 9520;
                                                              BEGIN
                                                                MailManagement.ValidateEmailAddressField("E-Mail");
                                                              END;

                                                   ExtendedDatatype=E-Mail;
                                                   CaptionML=[DEU=E-Mail;
                                                              ENU=Email] }
    { 103 ;   ;Home Page           ;Text80        ;ExtendedDatatype=URL;
                                                   CaptionML=[DEU=Homepage;
                                                              ENU=Home Page] }
    { 104 ;   ;Reminder Terms Code ;Code10        ;TableRelation="Reminder Terms";
                                                   CaptionML=[DEU=Mahnmethodencode;
                                                              ENU=Reminder Terms Code] }
    { 105 ;   ;Reminder Amounts    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Reminder),
                                                                                                              Entry Type=CONST(Initial Entry),
                                                                                                              Customer No.=FIELD(No.),
                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                              Posting Date=FIELD(Date Filter),
                                                                                                              Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Mahnbetrag;
                                                              ENU=Reminder Amounts];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 106 ;   ;Reminder Amounts (LCY);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Reminder),
                                                                                                                      Entry Type=CONST(Initial Entry),
                                                                                                                      Customer No.=FIELD(No.),
                                                                                                                      Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                      Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                      Posting Date=FIELD(Date Filter),
                                                                                                                      Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Mahnbetrag (MW);
                                                              ENU=Reminder Amounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 107 ;   ;No. Series          ;Code20        ;TableRelation="No. Series";
                                                   CaptionML=[DEU=Nummernserie;
                                                              ENU=No. Series];
                                                   Editable=No }
    { 108 ;   ;Tax Area Code       ;Code20        ;TableRelation="Tax Area";
                                                   OnValidate=BEGIN
                                                                UpdateTaxAreaId;
                                                              END;

                                                   CaptionML=[DEU=Steuergebietscode;
                                                              ENU=Tax Area Code] }
    { 109 ;   ;Tax Liable          ;Boolean       ;CaptionML=[DEU=Steuerpflichtig;
                                                              ENU=Tax Liable] }
    { 110 ;   ;VAT Bus. Posting Group;Code20      ;TableRelation="VAT Business Posting Group";
                                                   OnValidate=BEGIN
                                                                UpdateTaxAreaId;
                                                              END;

                                                   CaptionML=[DEU=MwSt.-GeschÑftsbuchungsgruppe;
                                                              ENU=VAT Bus. Posting Group] }
    { 111 ;   ;Currency Filter     ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Currency;
                                                   CaptionML=[DEU=WÑhrungsfilter;
                                                              ENU=Currency Filter] }
    { 113 ;   ;Outstanding Orders (LCY);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Outstanding Amount (LCY)" WHERE (Document Type=CONST(Order),
                                                                                                                  Bill-to Customer No.=FIELD(No.),
                                                                                                                  Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                  Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                  Currency Code=FIELD(Currency Filter)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[DEU=Auftragsbestand (MW);
                                                              ENU=Outstanding Orders (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 114 ;   ;Shipped Not Invoiced (LCY);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Shipped Not Invoiced (LCY)" WHERE (Document Type=CONST(Order),
                                                                                                                    Bill-to Customer No.=FIELD(No.),
                                                                                                                    Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                    Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                    Currency Code=FIELD(Currency Filter)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[DEU=Nicht fakt. Lieferungen (MW);
                                                              ENU=Shipped Not Invoiced (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 115 ;   ;Reserve             ;Option        ;InitValue=Optional;
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[DEU=Reservieren;
                                                              ENU=Reserve];
                                                   OptionCaptionML=[DEU=Nie,Optional,Immer;
                                                                    ENU=Never,Optional,Always];
                                                   OptionString=Never,Optional,Always }
    { 116 ;   ;Block Payment Tolerance;Boolean    ;OnValidate=BEGIN
                                                                UpdatePaymentTolerance((CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   CaptionML=[DEU=Zahlungstoleranz sperren;
                                                              ENU=Block Payment Tolerance] }
    { 117 ;   ;Pmt. Disc. Tolerance (LCY);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Customer No.=FIELD(No.),
                                                                                                                       Entry Type=FILTER(Payment Discount Tolerance|'Payment Discount Tolerance (VAT Adjustment)'|'Payment Discount Tolerance (VAT Excl.)'),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Skontotoleranz (MW);
                                                              ENU=Pmt. Disc. Tolerance (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 118 ;   ;Pmt. Tolerance (LCY);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Customer No.=FIELD(No.),
                                                                                                                       Entry Type=FILTER(Payment Tolerance|'Payment Tolerance (VAT Adjustment)'|'Payment Tolerance (VAT Excl.)'),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Zahlungstoleranz (MW);
                                                              ENU=Pmt. Tolerance (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 119 ;   ;IC Partner Code     ;Code20        ;TableRelation="IC Partner";
                                                   OnValidate=VAR
                                                                CustLedgEntry@1001 : Record 21;
                                                                AccountingPeriod@1000 : Record 50;
                                                                ICPartner@1002 : Record 413;
                                                                ConfirmManagement@1003 : Codeunit 27;
                                                              BEGIN
                                                                IF xRec."IC Partner Code" <> "IC Partner Code" THEN BEGIN
                                                                  IF NOT CustLedgEntry.SETCURRENTKEY("Customer No.",Open) THEN
                                                                    CustLedgEntry.SETCURRENTKEY("Customer No.");
                                                                  CustLedgEntry.SETRANGE("Customer No.","No.");
                                                                  CustLedgEntry.SETRANGE(Open,TRUE);
                                                                  IF CustLedgEntry.FINDLAST THEN
                                                                    ERROR(Text012,FIELDCAPTION("IC Partner Code"),TABLECAPTION);

                                                                  CustLedgEntry.RESET;
                                                                  CustLedgEntry.SETCURRENTKEY("Customer No.","Posting Date");
                                                                  CustLedgEntry.SETRANGE("Customer No.","No.");
                                                                  AccountingPeriod.SETRANGE(Closed,FALSE);
                                                                  IF AccountingPeriod.FINDFIRST THEN BEGIN
                                                                    CustLedgEntry.SETFILTER("Posting Date",'>=%1',AccountingPeriod."Starting Date");
                                                                    IF CustLedgEntry.FINDFIRST THEN
                                                                      IF NOT ConfirmManagement.ConfirmProcess(STRSUBSTNO(Text011,TABLECAPTION),TRUE) THEN
                                                                        "IC Partner Code" := xRec."IC Partner Code";
                                                                  END;
                                                                END;

                                                                IF "IC Partner Code" <> '' THEN BEGIN
                                                                  ICPartner.GET("IC Partner Code");
                                                                  IF (ICPartner."Customer No." <> '') AND (ICPartner."Customer No." <> "No.") THEN
                                                                    ERROR(Text010,FIELDCAPTION("IC Partner Code"),"IC Partner Code",TABLECAPTION,ICPartner."Customer No.");
                                                                  ICPartner."Customer No." := "No.";
                                                                  ICPartner.MODIFY;
                                                                END;

                                                                IF (xRec."IC Partner Code" <> "IC Partner Code") AND ICPartner.GET(xRec."IC Partner Code") THEN BEGIN
                                                                  ICPartner."Customer No." := '';
                                                                  ICPartner.MODIFY;
                                                                END;
                                                              END;

                                                   CaptionML=[DEU=IC-Partnercode;
                                                              ENU=IC Partner Code] }
    { 120 ;   ;Refunds             ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Refund),
                                                                                                              Entry Type=CONST(Initial Entry),
                                                                                                              Customer No.=FIELD(No.),
                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                              Posting Date=FIELD(Date Filter),
                                                                                                              Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Erstattungen;
                                                              ENU=Refunds] }
    { 121 ;   ;Refunds (LCY)       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Refund),
                                                                                                                      Entry Type=CONST(Initial Entry),
                                                                                                                      Customer No.=FIELD(No.),
                                                                                                                      Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                      Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                      Posting Date=FIELD(Date Filter),
                                                                                                                      Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Erstattungen (MW);
                                                              ENU=Refunds (LCY)] }
    { 122 ;   ;Other Amounts       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Initial Document Type=CONST(" "),
                                                                                                              Entry Type=CONST(Initial Entry),
                                                                                                              Customer No.=FIELD(No.),
                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                              Posting Date=FIELD(Date Filter),
                                                                                                              Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Weitere BetrÑge;
                                                              ENU=Other Amounts] }
    { 123 ;   ;Other Amounts (LCY) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(" "),
                                                                                                                      Entry Type=CONST(Initial Entry),
                                                                                                                      Customer No.=FIELD(No.),
                                                                                                                      Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                      Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                      Posting Date=FIELD(Date Filter),
                                                                                                                      Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Weitere BetrÑge (MW);
                                                              ENU=Other Amounts (LCY)] }
    { 124 ;   ;Prepayment %        ;Decimal       ;CaptionML=[DEU=Vorauszahlung %;
                                                              ENU=Prepayment %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 125 ;   ;Outstanding Invoices (LCY);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Outstanding Amount (LCY)" WHERE (Document Type=CONST(Invoice),
                                                                                                                  Bill-to Customer No.=FIELD(No.),
                                                                                                                  Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                  Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                  Currency Code=FIELD(Currency Filter)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[DEU=Ausstehende Rechnungen (MW);
                                                              ENU=Outstanding Invoices (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 126 ;   ;Outstanding Invoices;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Outstanding Amount" WHERE (Document Type=CONST(Invoice),
                                                                                                            Bill-to Customer No.=FIELD(No.),
                                                                                                            Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                            Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                            Currency Code=FIELD(Currency Filter)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[DEU=Ausstehende Rechnungen;
                                                              ENU=Outstanding Invoices];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 130 ;   ;Bill-to No. Of Archived Doc.;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header Archive" WHERE (Document Type=CONST(Order),
                                                                                                   Bill-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl archivierter Belege fÅr Rech. an;
                                                              ENU=Bill-to No. Of Archived Doc.] }
    { 131 ;   ;Sell-to No. Of Archived Doc.;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header Archive" WHERE (Document Type=CONST(Order),
                                                                                                   Sell-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl archivierter Belege fÅr Verk. an;
                                                              ENU=Sell-to No. Of Archived Doc.] }
    { 132 ;   ;Partner Type        ;Option        ;CaptionML=[DEU=Partnerart;
                                                              ENU=Partner Type];
                                                   OptionCaptionML=[DEU=" ,Unternehmen,Person";
                                                                    ENU=" ,Company,Person"];
                                                   OptionString=[ ,Company,Person] }
    { 140 ;   ;Image               ;Media         ;ExtendedDatatype=Person;
                                                   CaptionML=[DEU=Abbildung;
                                                              ENU=Image] }
    { 150 ;   ;Privacy Blocked     ;Boolean       ;OnValidate=BEGIN
                                                                IF "Privacy Blocked" THEN
                                                                  Blocked := Blocked::All
                                                                ELSE
                                                                  Blocked := Blocked::" ";
                                                              END;

                                                   CaptionML=[DEU=Datenschutzsperre;
                                                              ENU=Privacy Blocked] }
    { 160 ;   ;Disable Search by Name;Boolean     ;DataClassification=SystemMetadata;
                                                   CaptionML=[DEU=Suche nach Namen deaktivieren;
                                                              ENU=Disable Search by Name] }
    { 288 ;   ;Preferred Bank Account Code;Code20 ;TableRelation="Customer Bank Account".Code WHERE (Customer No.=FIELD(No.));
                                                   CaptionML=[DEU=Bevorzugter Bankkontocode;
                                                              ENU=Preferred Bank Account Code] }
    { 840 ;   ;Cash Flow Payment Terms Code;Code10;TableRelation="Payment Terms";
                                                   CaptionML=[DEU=Cashflow - Zlg.-Bedingungscode;
                                                              ENU=Cash Flow Payment Terms Code] }
    { 5049;   ;Primary Contact No. ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                Cont@1000 : Record 5050;
                                                                ContBusRel@1001 : Record 5054;
                                                              BEGIN
                                                                Contact := '';
                                                                IF "Primary Contact No." <> '' THEN BEGIN
                                                                  Cont.GET("Primary Contact No.");

                                                                  ContBusRel.FindOrRestoreContactBusinessRelation(Cont,Rec,ContBusRel."Link to Table"::Customer);

                                                                  IF Cont."Company No." <> ContBusRel."Contact No." THEN
                                                                    ERROR(Text003,Cont."No.",Cont.Name,"No.",Name);

                                                                  IF Cont.Type = Cont.Type::Person THEN
                                                                    Contact := Cont.Name;

                                                                  IF Cont.Image.HASVALUE THEN
                                                                    CopyContactPicture(Cont);

                                                                  IF Cont."Phone No." <> '' THEN
                                                                    "Phone No." := Cont."Phone No.";
                                                                  IF Cont."E-Mail" <> '' THEN
                                                                    "E-Mail" := Cont."E-Mail";
                                                                END ELSE
                                                                  IF Image.HASVALUE THEN
                                                                    CLEAR(Image);
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1000 : Record 5050;
                                                              ContBusRel@1001 : Record 5054;
                                                              TempCust@1002 : TEMPORARY Record 18;
                                                            BEGIN
                                                              ContBusRel.SETCURRENTKEY("Link to Table","No.");
                                                              ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
                                                              ContBusRel.SETRANGE("No.","No.");
                                                              IF ContBusRel.FINDFIRST THEN
                                                                Cont.SETRANGE("Company No.",ContBusRel."Contact No.")
                                                              ELSE
                                                                Cont.SETRANGE("No.",'');

                                                              IF "Primary Contact No." <> '' THEN
                                                                IF Cont.GET("Primary Contact No.") THEN ;
                                                              IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                TempCust.COPY(Rec);
                                                                FIND;
                                                                TRANSFERFIELDS(TempCust,FALSE);
                                                                VALIDATE("Primary Contact No.",Cont."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[DEU=PrimÑre Kontaktnr.;
                                                              ENU=Primary Contact No.] }
    { 5050;   ;Contact Type        ;Option        ;OnValidate=VAR
                                                                SalesHeader@1000 : Record 36;
                                                              BEGIN
                                                                IF IdentityManagement.IsInvAppId THEN BEGIN
                                                                  VALIDATE("Prices Including VAT","Contact Type" = "Contact Type"::Person);
                                                                  SalesHeader.SETRANGE("Sell-to Customer No.","No.");
                                                                  IF SalesHeader.FINDSET THEN
                                                                    REPEAT
                                                                      SalesHeader.VALIDATE("Prices Including VAT","Prices Including VAT");
                                                                      SalesHeader.MODIFY(TRUE);
                                                                    UNTIL SalesHeader.NEXT = 0;
                                                                END;
                                                              END;

                                                   CaptionML=[DEU=Kontaktart;
                                                              ENU=Contact Type];
                                                   OptionCaptionML=[DEU=Unternehmen,Person;
                                                                    ENU=Company,Person];
                                                   OptionString=Company,Person }
    { 5700;   ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   CaptionML=[DEU=ZustÑndigkeitseinheitencode;
                                                              ENU=Responsibility Center] }
    { 5750;   ;Shipping Advice     ;Option        ;AccessByPermission=TableData 110=R;
                                                   CaptionML=[DEU=Versandanweisung;
                                                              ENU=Shipping Advice];
                                                   OptionCaptionML=[DEU=Teillieferung,Komplettlieferung;
                                                                    ENU=Partial,Complete];
                                                   OptionString=Partial,Complete }
    { 5790;   ;Shipping Time       ;DateFormula   ;AccessByPermission=TableData 5790=R;
                                                   CaptionML=[DEU=Transportzeit;
                                                              ENU=Shipping Time] }
    { 5792;   ;Shipping Agent Service Code;Code10 ;TableRelation="Shipping Agent Services".Code WHERE (Shipping Agent Code=FIELD(Shipping Agent Code));
                                                   OnValidate=BEGIN
                                                                IF ("Shipping Agent Code" <> '') AND
                                                                   ("Shipping Agent Service Code" <> '')
                                                                THEN
                                                                  IF ShippingAgentService.GET("Shipping Agent Code","Shipping Agent Service Code") THEN
                                                                    "Shipping Time" := ShippingAgentService."Shipping Time"
                                                                  ELSE
                                                                    EVALUATE("Shipping Time",'<>');
                                                              END;

                                                   CaptionML=[DEU=Zustellertransportartencode;
                                                              ENU=Shipping Agent Service Code] }
    { 5900;   ;Service Zone Code   ;Code10        ;TableRelation="Service Zone";
                                                   CaptionML=[DEU=Servicegebietscode;
                                                              ENU=Service Zone Code] }
    { 5902;   ;Contract Gain/Loss Amount;Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Contract Gain/Loss Entry".Amount WHERE (Customer No.=FIELD(No.),
                                                                                                            Ship-to Code=FIELD(Ship-to Filter),
                                                                                                            Change Date=FIELD(Date Filter)));
                                                   CaptionML=[DEU=Gewinn-/Verlustbetrag (Vertr.);
                                                              ENU=Contract Gain/Loss Amount];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5903;   ;Ship-to Filter      ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(No.));
                                                   CaptionML=[DEU=Lief. an Filter;
                                                              ENU=Ship-to Filter] }
    { 5910;   ;Outstanding Serv. Orders (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Line"."Outstanding Amount (LCY)" WHERE (Document Type=CONST(Order),
                                                                                                                    Bill-to Customer No.=FIELD(No.),
                                                                                                                    Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                    Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                    Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Serviceauftragsbestand (MW);
                                                              ENU=Outstanding Serv. Orders (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5911;   ;Serv Shipped Not Invoiced(LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Line"."Shipped Not Invoiced (LCY)" WHERE (Document Type=CONST(Order),
                                                                                                                      Bill-to Customer No.=FIELD(No.),
                                                                                                                      Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                      Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                      Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Service Lief. nicht fakt. Betrag (MW);
                                                              ENU=Serv Shipped Not Invoiced(LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5912;   ;Outstanding Serv.Invoices(LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Line"."Outstanding Amount (LCY)" WHERE (Document Type=CONST(Invoice),
                                                                                                                    Bill-to Customer No.=FIELD(No.),
                                                                                                                    Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                    Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                    Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Ausstehende Servicerechnungen (MW);
                                                              ENU=Outstanding Serv.Invoices(LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 7001;   ;Allow Line Disc.    ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[DEU=Zeilenrabatt zulassen;
                                                              ENU=Allow Line Disc.] }
    { 7171;   ;No. of Quotes       ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Quote),
                                                                                           Sell-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Angebote;
                                                              ENU=No. of Quotes];
                                                   Editable=No }
    { 7172;   ;No. of Blanket Orders;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Blanket Order),
                                                                                           Sell-to Customer No.=FIELD(No.)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[DEU=Anzahl RahmenauftrÑge;
                                                              ENU=No. of Blanket Orders];
                                                   Editable=No }
    { 7173;   ;No. of Orders       ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Order),
                                                                                           Sell-to Customer No.=FIELD(No.)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[DEU=Anzahl AuftrÑge;
                                                              ENU=No. of Orders];
                                                   Editable=No }
    { 7174;   ;No. of Invoices     ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Invoice),
                                                                                           Sell-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Rechnungen;
                                                              ENU=No. of Invoices];
                                                   Editable=No }
    { 7175;   ;No. of Return Orders;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Return Order),
                                                                                           Sell-to Customer No.=FIELD(No.)));
                                                   AccessByPermission=TableData 6660=R;
                                                   CaptionML=[DEU=Anzahl Reklamationen;
                                                              ENU=No. of Return Orders];
                                                   Editable=No }
    { 7176;   ;No. of Credit Memos ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Credit Memo),
                                                                                           Sell-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Gutschriften;
                                                              ENU=No. of Credit Memos];
                                                   Editable=No }
    { 7177;   ;No. of Pstd. Shipments;Integer     ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Shipment Header" WHERE (Sell-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl gebuchter Lieferungen;
                                                              ENU=No. of Pstd. Shipments];
                                                   Editable=No }
    { 7178;   ;No. of Pstd. Invoices;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Invoice Header" WHERE (Sell-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl gebuchter Rechnungen;
                                                              ENU=No. of Pstd. Invoices];
                                                   Editable=No }
    { 7179;   ;No. of Pstd. Return Receipts;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Return Receipt Header" WHERE (Sell-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anz. gebuchter RÅcksendungen;
                                                              ENU=No. of Pstd. Return Receipts];
                                                   Editable=No }
    { 7180;   ;No. of Pstd. Credit Memos;Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Cr.Memo Header" WHERE (Sell-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl gebuchter Gutschriften;
                                                              ENU=No. of Pstd. Credit Memos];
                                                   Editable=No }
    { 7181;   ;No. of Ship-to Addresses;Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Count("Ship-to Address" WHERE (Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Lieferadressen;
                                                              ENU=No. of Ship-to Addresses];
                                                   Editable=No }
    { 7182;   ;Bill-To No. of Quotes;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Quote),
                                                                                           Bill-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Angebote fÅr Rechnungsadresse;
                                                              ENU=Bill-To No. of Quotes];
                                                   Editable=No }
    { 7183;   ;Bill-To No. of Blanket Orders;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Blanket Order),
                                                                                           Bill-to Customer No.=FIELD(No.)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[DEU=Anzahl RahmenauftrÑge fÅr Rechnungsadresse;
                                                              ENU=Bill-To No. of Blanket Orders];
                                                   Editable=No }
    { 7184;   ;Bill-To No. of Orders;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Order),
                                                                                           Bill-to Customer No.=FIELD(No.)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[DEU=Anzahl AuftrÑge fÅr Rechnungsadresse;
                                                              ENU=Bill-To No. of Orders];
                                                   Editable=No }
    { 7185;   ;Bill-To No. of Invoices;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Invoice),
                                                                                           Bill-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Rechungen fÅr Rechnungsadresse;
                                                              ENU=Bill-To No. of Invoices];
                                                   Editable=No }
    { 7186;   ;Bill-To No. of Return Orders;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Return Order),
                                                                                           Bill-to Customer No.=FIELD(No.)));
                                                   AccessByPermission=TableData 6660=R;
                                                   CaptionML=[DEU=Anzahl Reklamationen fÅr Rechnungsadresse;
                                                              ENU=Bill-To No. of Return Orders];
                                                   Editable=No }
    { 7187;   ;Bill-To No. of Credit Memos;Integer;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Credit Memo),
                                                                                           Bill-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Gutschriften fÅr Rechnungsadresse;
                                                              ENU=Bill-To No. of Credit Memos];
                                                   Editable=No }
    { 7188;   ;Bill-To No. of Pstd. Shipments;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Shipment Header" WHERE (Bill-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl gebuchter Lieferungen fÅr Rechnungsadresse;
                                                              ENU=Bill-To No. of Pstd. Shipments];
                                                   Editable=No }
    { 7189;   ;Bill-To No. of Pstd. Invoices;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Invoice Header" WHERE (Bill-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl gebuchter Rechnungen fÅr Rechnungsadresse;
                                                              ENU=Bill-To No. of Pstd. Invoices];
                                                   Editable=No }
    { 7190;   ;Bill-To No. of Pstd. Return R.;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Return Receipt Header" WHERE (Bill-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl geb. Retourenbel. fÅr Rechnungsadresse;
                                                              ENU=Bill-To No. of Pstd. Return R.];
                                                   Editable=No }
    { 7191;   ;Bill-To No. of Pstd. Cr. Memos;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Cr.Memo Header" WHERE (Bill-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anz. geb. Gutschr. fÅr Rechnungsadresse;
                                                              ENU=Bill-To No. of Pstd. Cr. Memos];
                                                   Editable=No }
    { 7600;   ;Base Calendar Code  ;Code10        ;TableRelation="Base Calendar";
                                                   CaptionML=[DEU=Basiskalendercode;
                                                              ENU=Base Calendar Code] }
    { 7601;   ;Copy Sell-to Addr. to Qte From;Option;
                                                   AccessByPermission=TableData 5050=R;
                                                   CaptionML=[DEU=Verk. an Adr. in Ang. v. kop.;
                                                              ENU=Copy Sell-to Addr. to Qte From];
                                                   OptionCaptionML=[DEU=Unternehmen,Person;
                                                                    ENU=Company,Person];
                                                   OptionString=Company,Person }
    { 7602;   ;Validate EU Vat Reg. No.;Boolean   ;CaptionML=[DEU=USt-IdNr. validieren;
                                                              ENU=Validate EU Vat Reg. No.] }
    { 8000;   ;Id                  ;GUID          ;CaptionML=[DEU=ID;
                                                              ENU=Id] }
    { 8001;   ;Currency Id         ;GUID          ;TableRelation=Currency.Id;
                                                   OnValidate=BEGIN
                                                                UpdateCurrencyCode;
                                                              END;

                                                   CaptionML=[DEU=WÑhrungskennung;
                                                              ENU=Currency Id] }
    { 8002;   ;Payment Terms Id    ;GUID          ;TableRelation="Payment Terms".Id;
                                                   OnValidate=BEGIN
                                                                UpdatePaymentTermsCode;
                                                              END;

                                                   CaptionML=[DEU=Zahlungsbedingungskennung;
                                                              ENU=Payment Terms Id] }
    { 8003;   ;Shipment Method Id  ;GUID          ;TableRelation="Shipment Method".Id;
                                                   OnValidate=BEGIN
                                                                UpdateShipmentMethodCode;
                                                              END;

                                                   CaptionML=[DEU=Lieferbedingungskennung;
                                                              ENU=Shipment Method Id] }
    { 8004;   ;Payment Method Id   ;GUID          ;TableRelation="Payment Method".Id;
                                                   OnValidate=BEGIN
                                                                UpdatePaymentMethodCode;
                                                              END;

                                                   CaptionML=[DEU=Zahlungsformkennung;
                                                              ENU=Payment Method Id] }
    { 9003;   ;Tax Area ID         ;GUID          ;OnValidate=BEGIN
                                                                UpdateTaxAreaCode;
                                                              END;

                                                   CaptionML=[DEU=Steuergebiet-ID;
                                                              ENU=Tax Area ID] }
    { 9004;   ;Tax Area Display Name;Text100      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Tax Area".Description WHERE (Code=FIELD(Tax Area Code)));
                                                   ObsoleteState=Removed;
                                                   ObsoleteReason=This field is not needed and it should not be used.;
                                                   CaptionML=[DEU=Steuergebiet-Anzeigename;
                                                              ENU=Tax Area Display Name] }
    { 9005;   ;Contact ID          ;GUID          ;CaptionML=[DEU=Kontakt-ID;
                                                              ENU=Contact ID] }
    { 9006;   ;Contact Graph Id    ;Text250       ;CaptionML=[DEU=Kontakt-Graph-ID;
                                                              ENU=Contact Graph Id] }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Search Name                              }
    {    ;Customer Posting Group                   }
    {    ;Currency Code                            }
    {    ;Country/Region Code                      }
    {    ;Gen. Bus. Posting Group                  }
    {    ;Name,Address,City                        }
    {    ;VAT Registration No.                     }
    {    ;Name                                     }
    {    ;City                                     }
    {    ;Post Code                                }
    {    ;Phone No.                                }
    {    ;Contact                                  }
    {    ;Blocked                                  }
    {    ;Primary Contact No.                      }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Name,City,Post Code,Phone No.,Contact }
    { 2   ;Brick               ;No.,Name,Balance (LCY),Contact,Balance Due (LCY),Image }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'DEU=Sie kînnen %1 %2 nicht lîschen, da noch ein(e) %3 (oder mehrere) fÅr diesen Debitor vorhanden ist.;ENU=You cannot delete %1 %2 because there is at least one outstanding Sales %3 for this customer.';
      Text002@1001 : TextConst 'DEU=Mîchten Sie einen Kontakt fÅr %1 %2 erstellen?;ENU=Do you wish to create a contact for %1 %2?';
      SalesSetup@1002 : Record 311;
      CommentLine@1004 : Record 97;
      SalesOrderLine@1005 : Record 37;
      CustBankAcc@1006 : Record 287;
      ShipToAddr@1007 : Record 222;
      PostCode@1008 : Record 225;
      GenBusPostingGrp@1009 : Record 250;
      ShippingAgentService@1010 : Record 5790;
      ItemCrossReference@1016 : Record 5717;
      RMSetup@1018 : Record 5079;
      SalesPrice@1021 : Record 7002;
      SalesLineDisc@1022 : Record 7004;
      SalesPrepmtPct@1003 : Record 459;
      ServContract@1026 : Record 5965;
      ServiceItem@1027 : Record 5940;
      SalespersonPurchaser@1060 : Record 13;
      CustomizedCalendarChange@1048 : Record 7602;
      PaymentToleranceMgt@1038 : Codeunit 426;
      IdentityManagement@1047 : Codeunit 9801;
      NoSeriesMgt@1011 : Codeunit 396;
      MoveEntries@1012 : Codeunit 361;
      UpdateContFromCust@1013 : Codeunit 5056;
      DimMgt@1014 : Codeunit 408;
      ApprovalsMgmt@1039 : Codeunit 1535;
      CalendarManagement@1049 : Codeunit 7600;
      InsertFromContact@1015 : Boolean;
      Text003@1020 : TextConst 'DEU=Kontakt %1 %2 ist nicht mit Debitor %3 %4 verknÅpft.;ENU=Contact %1 %2 is not related to customer %3 %4.';
      Text004@1023 : TextConst 'DEU=buchen;ENU=post';
      Text005@1024 : TextConst 'DEU=erstellen;ENU=create';
      Text006@1025 : TextConst 'DEU=Sie kînnen diese Belegart nicht %1, wenn der Debitor %2 fÅr die Art %3 gesperrt ist.;ENU=You cannot %1 this type of document when Customer %2 is blocked with type %3';
      Text007@1028 : TextConst 'DEU=Sie kînnen %1 %2 nicht lîschen, da fÅr diesen Debitor mindestens ein nicht stornierter Servicevertrag vorhanden ist.;ENU=You cannot delete %1 %2 because there is at least one not cancelled Service Contract for this customer.';
      Text008@1029 : TextConst 'DEU=Wenn Sie %1 %2 lîschen, wird die %3 fÅr die verknÅpften Serviceartikel ebenfalls gelîscht. Mîchten Sie fortfahren?;ENU=Deleting the %1 %2 will cause the %3 to be deleted for the associated Service Items. Do you want to continue?';
      Text009@1030 : TextConst 'DEU=Debitor kann nicht gelîscht werden.;ENU=Cannot delete customer.';
      Text010@1031 : TextConst 'DEU=%1 %2 wurde %3 %4 zugewiesen.\Derselbe %1 kann nicht auf mehr als einen %3 eingegeben werden. Geben Sie einen anderen Code ein.;ENU=The %1 %2 has been assigned to %3 %4.\The same %1 cannot be entered on more than one %3. Enter another code.';
      Text011@1033 : TextConst 'DEU=Das Abstimmen von IC-Buchungen kann schwierig sein, wenn Sie den IC-Partnercode Ñndern, weil %1 Posten in einem noch nicht geschlossenen GeschÑftsjahr aufweist.\ Mîchten Sie den IC-Partnercode trotzdem Ñndern?;ENU=Reconciling IC transactions may be difficult if you change IC Partner Code because this %1 has ledger entries in a fiscal year that has not yet been closed.\ Do you still want to change the IC Partner Code?';
      Text012@1032 : TextConst 'DEU=Sie kînnen den Inhalt des Feldes %1 nicht Ñndern, weil fÅr dieses %2 ein oder mehrere offene Posten vorliegen.;ENU=You cannot change the contents of the %1 field because this %2 has one or more open ledger entries.';
      Text013@1035 : TextConst 'DEU=Sie kînnen %1 %2 nicht lîschen, da noch mindestens ein ausstehender Service-%3 fÅr diesen Debitor vorhanden ist.;ENU=You cannot delete %1 %2 because there is at least one outstanding Service %3 for this customer.';
      Text014@1017 : TextConst 'DEU=Bevor Sie Online Map verwenden kînnen, mÅssen Sie die Felder des Fensters ''Online Map-Einrichtung'' ausfÅllen.\Informationen hierzu finden Sie in der Hilfe zum Einrichten von Online Map.;ENU=Before you can use Online Map, you must fill in the Online Map Setup window.\See Setting Up Online Map in Help.';
      Text015@1036 : TextConst 'DEU=%1 ''%2'' kann nicht gelîscht werden, da dem Debitor mindestens ein Objekt vom Typ %3 zugeordnet ist.;ENU=You cannot delete %1 %2 because there is at least one %3 associated to this customer.';
      AllowPaymentToleranceQst@1037 : TextConst 'DEU=Mîchten Sie Zahlungstoleranzen fÅr momentan offene Posten zulassen?;ENU=Do you want to allow payment tolerance for entries that are currently open?';
      RemovePaymentRoleranceQst@1019 : TextConst 'DEU=Mîchten Sie Zahlungstoleranzen fÅr momentan offene Posten lîschen?;ENU=Do you want to remove payment tolerance from entries that are currently open?';
      CreateNewCustTxt@1041 : TextConst '@@@="%1 is the name to be used to create the customer. ";DEU=Erstellt eine neue Debitorenkarte fÅr %1;ENU=Create a new customer card for %1';
      SelectCustErr@1040 : TextConst 'DEU=Sie mÅssen einen vorhandenen Debitor auswÑhlen.;ENU=You must select an existing customer.';
      CustNotRegisteredTxt@1042 : TextConst 'DEU=Dieser Debitor ist nicht registriert. Zum Fortfahren wÑhlen Sie eine der folgenden Optionen:;ENU=This customer is not registered. To continue, choose one of the following options:';
      SelectCustTxt@1043 : TextConst 'DEU=WÑhlt einen vorhandenen Debitor aus;ENU=Select an existing customer';
      InsertFromTemplate@1044 : Boolean;
      LookupRequested@1034 : Boolean;
      OverrideImageQst@1045 : TextConst 'DEU=Bild Åberschreiben?;ENU=Override Image?';
      PrivacyBlockedActionErr@1061 : TextConst '@@@="%1 = action (create or post), %2 = customer code.";DEU=Sie kînnen diese Belegart nicht %1, wenn der Debitor %2 aus DatenschutzgrÅnden gesperrt ist.;ENU=You cannot %1 this type of document when Customer %2 is blocked for privacy.';
      PrivacyBlockedGenericTxt@1062 : TextConst '@@@="%1 = customer code";DEU="""Datenschutzsperre"" darf fÅr den Debitor %1 nicht ""true"" sein.";ENU=Privacy Blocked must not be true for customer %1.';
      ConfirmBlockedPrivacyBlockedQst@1071 : TextConst 'DEU=Wenn Sie das Feld "Gesperrt" Ñndern, wird das Feld "Datenschutzsperre" in "Nein" geÑndert. Mîchten Sie fortfahren?;ENU=If you change the Blocked field, the Privacy Blocked field is changed to No. Do you want to continue?';
      CanNotChangeBlockedDueToPrivacyBlockedErr@1072 : TextConst 'DEU=Das Feld "Gesperrt" kann nicht geÑndert werden, weil der Benutzer aus DatenschutzgrÅnden gesperrt ist.;ENU=The Blocked field cannot be changed because the user is blocked for privacy reasons.';
      PhoneNoCannotContainLettersErr@1046 : TextConst 'DEU=Sie kînnen keine Buchstaben in dieses Feld eingeben.;ENU=You cannot enter letters in this field.';
      ForceUpdateContact@1050 : Boolean;
      "*** AT ***"@1000056780 : Integer;
      ATEvPub@1000056781 : Codeunit 56781;

    [External]
    PROCEDURE AssistEdit@2(OldCust@1000 : Record 18) : Boolean;
    VAR
      Cust@1001 : Record 18;
    BEGIN
      WITH Cust DO BEGIN
        Cust := Rec;
        SalesSetup.GET;
        SalesSetup.TESTFIELD("Customer Nos.");
        IF NoSeriesMgt.SelectSeries(SalesSetup."Customer Nos.",OldCust."No. Series","No. Series") THEN BEGIN
          NoSeriesMgt.SetSeries("No.");
          Rec := Cust;
          EXIT(TRUE);
        END;
      END;
    END;

    [External]
    PROCEDURE ValidateShortcutDimCode@29(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.SaveDefaultDim(DATABASE::Customer,"No.",FieldNumber,ShortcutDimCode);
      MODIFY;
    END;

    [External]
    PROCEDURE ShowContact@1();
    VAR
      ContBusRel@1000 : Record 5054;
      Cont@1001 : Record 5050;
      OfficeContact@1002 : Record 5050;
      OfficeMgt@1003 : Codeunit 1630;
      ConfirmManagement@1004 : Codeunit 27;
    BEGIN
      IF OfficeMgt.GetContact(OfficeContact,"No.") AND (OfficeContact.COUNT = 1) THEN
        PAGE.RUN(PAGE::"Contact Card",OfficeContact)
      ELSE BEGIN
        IF "No." = '' THEN
          EXIT;

        ContBusRel.SETCURRENTKEY("Link to Table","No.");
        ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
        ContBusRel.SETRANGE("No.","No.");
        IF NOT ContBusRel.FINDFIRST THEN BEGIN
          IF NOT ConfirmManagement.ConfirmProcess(STRSUBSTNO(Text002,TABLECAPTION,"No."),TRUE) THEN
            EXIT;
          UpdateContFromCust.InsertNewContact(Rec,FALSE);
          ContBusRel.FINDFIRST;
        END;
        COMMIT;

        Cont.FILTERGROUP(2);
        Cont.SETRANGE("Company No.",ContBusRel."Contact No.");
        IF Cont.ISEMPTY THEN BEGIN
          Cont.SETRANGE("Company No.");
          Cont.SETRANGE("No.",ContBusRel."Contact No.");
        END;
        PAGE.RUN(PAGE::"Contact List",Cont);
      END;
    END;

    [External]
    PROCEDURE SetInsertFromContact@3(FromContact@1000 : Boolean);
    BEGIN
      InsertFromContact := FromContact;
    END;

    [External]
    PROCEDURE CheckBlockedCustOnDocs@5(Cust2@1000 : Record 18;DocType@1001 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order';Shipment@1005 : Boolean;Transaction@1003 : Boolean);
    VAR
      Source@1002 : 'Journal,Document';
    BEGIN
      IF IsOnBeforeCheckBlockedCustHandled(Cust2,Source::Document,DocType,Shipment,Transaction) THEN
        EXIT;

      WITH Cust2 DO BEGIN
        IF "Privacy Blocked" THEN
          CustPrivacyBlockedErrorMessage(Cust2,Transaction);

        IF ((Blocked = Blocked::All) OR
            ((Blocked = Blocked::Invoice) AND
             (DocType IN [DocType::Quote,DocType::Order,DocType::Invoice,DocType::"Blanket Order"])) OR
            ((Blocked = Blocked::Ship) AND (DocType IN [DocType::Quote,DocType::Order,DocType::"Blanket Order"]) AND
             (NOT Transaction)) OR
            ((Blocked = Blocked::Ship) AND (DocType IN [DocType::Quote,DocType::Order,DocType::Invoice,DocType::"Blanket Order"]) AND
             Shipment AND Transaction))
        THEN
          CustBlockedErrorMessage(Cust2,Transaction);
      END;
    END;

    [External]
    PROCEDURE CheckBlockedCustOnJnls@7(Cust2@1003 : Record 18;DocType@1002 : ' ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund';Transaction@1000 : Boolean);
    VAR
      Source@1001 : 'Journal,Document';
    BEGIN
      IF IsOnBeforeCheckBlockedCustHandled(Cust2,Source::Journal,DocType,FALSE,Transaction) THEN
        EXIT;

      WITH Cust2 DO BEGIN
        IF "Privacy Blocked" THEN
          CustPrivacyBlockedErrorMessage(Cust2,Transaction);

        IF (Blocked = Blocked::All) OR
           ((Blocked = Blocked::Invoice) AND (DocType IN [DocType::Invoice,DocType::" "]))
        THEN
          CustBlockedErrorMessage(Cust2,Transaction)
      END;
    END;

    [External]
    PROCEDURE CustBlockedErrorMessage@4(Cust2@1001 : Record 18;Transaction@1000 : Boolean);
    VAR
      Action@1002 : Text[30];
    BEGIN
      IF Transaction THEN
        Action := Text004
      ELSE
        Action := Text005;
      ERROR(Text006,Action,Cust2."No.",Cust2.Blocked);
    END;

    [External]
    PROCEDURE CustPrivacyBlockedErrorMessage@72(Cust2@1001 : Record 18;Transaction@1000 : Boolean);
    VAR
      Action@1002 : Text[30];
    BEGIN
      IF Transaction THEN
        Action := Text004
      ELSE
        Action := Text005;

      ERROR(PrivacyBlockedActionErr,Action,Cust2."No.");
    END;

    [External]
    PROCEDURE GetPrivacyBlockedGenericErrorText@73(Cust2@1001 : Record 18) : Text[250];
    BEGIN
      EXIT(STRSUBSTNO(PrivacyBlockedGenericTxt,Cust2."No."));
    END;

    [External]
    PROCEDURE DisplayMap@8();
    VAR
      MapPoint@1001 : Record 800;
      MapMgt@1000 : Codeunit 802;
    BEGIN
      IF MapPoint.FINDFIRST THEN
        MapMgt.MakeSelection(DATABASE::Customer,GETPOSITION)
      ELSE
        MESSAGE(Text014);
    END;

    [External]
    PROCEDURE GetTotalAmountLCY@10() : Decimal;
    BEGIN
      CALCFIELDS("Balance (LCY)","Outstanding Orders (LCY)","Shipped Not Invoiced (LCY)","Outstanding Invoices (LCY)",
        "Outstanding Serv. Orders (LCY)","Serv Shipped Not Invoiced(LCY)","Outstanding Serv.Invoices(LCY)");

      EXIT(GetTotalAmountLCYCommon);
    END;

    [External]
    PROCEDURE GetTotalAmountLCYUI@16() : Decimal;
    BEGIN
      SETAUTOCALCFIELDS("Balance (LCY)","Outstanding Orders (LCY)","Shipped Not Invoiced (LCY)","Outstanding Invoices (LCY)",
        "Outstanding Serv. Orders (LCY)","Serv Shipped Not Invoiced(LCY)","Outstanding Serv.Invoices(LCY)");

      EXIT(GetTotalAmountLCYCommon);
    END;

    LOCAL PROCEDURE GetTotalAmountLCYCommon@17() : Decimal;
    VAR
      SalesLine@1000 : Record 37;
      ServiceLine@1002 : Record 5902;
      SalesOutstandingAmountFromShipment@1001 : Decimal;
      ServOutstandingAmountFromShipment@1003 : Decimal;
      InvoicedPrepmtAmountLCY@1004 : Decimal;
      RetRcdNotInvAmountLCY@1006 : Decimal;
    BEGIN
      SalesOutstandingAmountFromShipment := SalesLine.OutstandingInvoiceAmountFromShipment("No.");
      ServOutstandingAmountFromShipment := ServiceLine.OutstandingInvoiceAmountFromShipment("No.");
      InvoicedPrepmtAmountLCY := GetInvoicedPrepmtAmountLCY;
      RetRcdNotInvAmountLCY := GetReturnRcdNotInvAmountLCY;

      EXIT("Balance (LCY)" + "Outstanding Orders (LCY)" + "Shipped Not Invoiced (LCY)" + "Outstanding Invoices (LCY)" +
        "Outstanding Serv. Orders (LCY)" + "Serv Shipped Not Invoiced(LCY)" + "Outstanding Serv.Invoices(LCY)" -
        SalesOutstandingAmountFromShipment - ServOutstandingAmountFromShipment - InvoicedPrepmtAmountLCY - RetRcdNotInvAmountLCY);
    END;

    [External]
    PROCEDURE GetSalesLCY@13() : Decimal;
    VAR
      CustomerSalesYTD@1005 : Record 18;
      AccountingPeriod@1004 : Record 50;
      StartDate@1001 : Date;
      EndDate@1000 : Date;
    BEGIN
      StartDate := AccountingPeriod.GetFiscalYearStartDate(WORKDATE);
      EndDate := AccountingPeriod.GetFiscalYearEndDate(WORKDATE);
      CustomerSalesYTD := Rec;
      CustomerSalesYTD."SECURITYFILTERING"("SECURITYFILTERING");
      CustomerSalesYTD.SETRANGE("Date Filter",StartDate,EndDate);
      CustomerSalesYTD.CALCFIELDS("Sales (LCY)");
      EXIT(CustomerSalesYTD."Sales (LCY)");
    END;

    [External]
    PROCEDURE CalcAvailableCredit@9() : Decimal;
    BEGIN
      EXIT(CalcAvailableCreditCommon(FALSE));
    END;

    [External]
    PROCEDURE CalcAvailableCreditUI@15() : Decimal;
    BEGIN
      EXIT(CalcAvailableCreditCommon(TRUE));
    END;

    LOCAL PROCEDURE CalcAvailableCreditCommon@14(CalledFromUI@1000 : Boolean) : Decimal;
    BEGIN
      IF "Credit Limit (LCY)" = 0 THEN
        EXIT(0);
      IF CalledFromUI THEN
        EXIT("Credit Limit (LCY)" - GetTotalAmountLCYUI);
      EXIT("Credit Limit (LCY)" - GetTotalAmountLCY);
    END;

    [External]
    PROCEDURE CalcOverdueBalance@11() OverDueBalance : Decimal;
    VAR
      CustLedgEntryRemainAmtQuery@1000 : Query 21 SECURITYFILTERING(Filtered);
    BEGIN
      CustLedgEntryRemainAmtQuery.SETRANGE(Customer_No,"No.");
      CustLedgEntryRemainAmtQuery.SETRANGE(IsOpen,TRUE);
      CustLedgEntryRemainAmtQuery.SETFILTER(Due_Date,'<%1',WORKDATE);
      CustLedgEntryRemainAmtQuery.OPEN;

      IF CustLedgEntryRemainAmtQuery.READ THEN
        OverDueBalance := CustLedgEntryRemainAmtQuery.Sum_Remaining_Amt_LCY;
    END;

    [External]
    PROCEDURE GetLegalEntityType@6() : Text;
    BEGIN
      EXIT(FORMAT("Partner Type"));
    END;

    [External]
    PROCEDURE GetLegalEntityTypeLbl@26() : Text;
    BEGIN
      EXIT(FIELDCAPTION("Partner Type"));
    END;

    [External]
    PROCEDURE SetStyle@12() : Text;
    BEGIN
      IF CalcAvailableCredit < 0 THEN
        EXIT('Unfavorable');
      EXIT('');
    END;

    [External]
    PROCEDURE HasValidDDMandate@23(Date@1000 : Date) : Boolean;
    VAR
      SEPADirectDebitMandate@1001 : Record 1230;
    BEGIN
      EXIT(SEPADirectDebitMandate.GetDefaultMandate("No.",Date) <> '');
    END;

    [External]
    PROCEDURE GetReturnRcdNotInvAmountLCY@53() : Decimal;
    VAR
      SalesLine@1000 : Record 37;
    BEGIN
      SalesLine.SETCURRENTKEY("Document Type","Bill-to Customer No.");
      SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::"Return Order");
      SalesLine.SETRANGE("Bill-to Customer No.","No.");
      SalesLine.CALCSUMS("Return Rcd. Not Invd. (LCY)");
      EXIT(SalesLine."Return Rcd. Not Invd. (LCY)");
    END;

    [External]
    PROCEDURE GetInvoicedPrepmtAmountLCY@18() : Decimal;
    VAR
      SalesLine@1000 : Record 37;
    BEGIN
      SalesLine.SETCURRENTKEY("Document Type","Bill-to Customer No.");
      SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::Order);
      SalesLine.SETRANGE("Bill-to Customer No.","No.");
      SalesLine.CALCSUMS("Prepmt. Amount Inv. (LCY)","Prepmt. VAT Amount Inv. (LCY)");
      EXIT(SalesLine."Prepmt. Amount Inv. (LCY)" + SalesLine."Prepmt. VAT Amount Inv. (LCY)");
    END;

    [External]
    PROCEDURE CalcCreditLimitLCYExpendedPct@19() : Decimal;
    BEGIN
      IF "Credit Limit (LCY)" = 0 THEN
        EXIT(0);

      IF "Balance (LCY)" / "Credit Limit (LCY)" < 0 THEN
        EXIT(0);

      IF "Balance (LCY)" / "Credit Limit (LCY)" > 1 THEN
        EXIT(10000);

      EXIT(ROUND("Balance (LCY)" / "Credit Limit (LCY)" * 10000,1));
    END;

    [External]
    PROCEDURE CreateAndShowNewInvoice@21();
    VAR
      SalesHeader@1000 : Record 36;
    BEGIN
      SalesHeader."Document Type" := SalesHeader."Document Type"::Invoice;
      SalesHeader.SETRANGE("Sell-to Customer No.","No.");
      SalesHeader.SetDefaultPaymentServices;
      SalesHeader.INSERT(TRUE);
      COMMIT;
      PAGE.RUN(PAGE::"Sales Invoice",SalesHeader)
    END;

    [External]
    PROCEDURE CreateAndShowNewOrder@30();
    VAR
      SalesHeader@1000 : Record 36;
    BEGIN
      SalesHeader."Document Type" := SalesHeader."Document Type"::Order;
      SalesHeader.SETRANGE("Sell-to Customer No.","No.");
      SalesHeader.SetDefaultPaymentServices;
      SalesHeader.INSERT(TRUE);
      COMMIT;
      PAGE.RUN(PAGE::"Sales Order",SalesHeader)
    END;

    [External]
    PROCEDURE CreateAndShowNewCreditMemo@22();
    VAR
      SalesHeader@1000 : Record 36;
    BEGIN
      SalesHeader."Document Type" := SalesHeader."Document Type"::"Credit Memo";
      SalesHeader.SETRANGE("Sell-to Customer No.","No.");
      SalesHeader.INSERT(TRUE);
      COMMIT;
      PAGE.RUN(PAGE::"Sales Credit Memo",SalesHeader)
    END;

    [External]
    PROCEDURE CreateAndShowNewQuote@24();
    VAR
      SalesHeader@1000 : Record 36;
    BEGIN
      SalesHeader."Document Type" := SalesHeader."Document Type"::Quote;
      SalesHeader.SETRANGE("Sell-to Customer No.","No.");
      SalesHeader.INSERT(TRUE);
      COMMIT;
      PAGE.RUN(PAGE::"Sales Quote",SalesHeader)
    END;

    LOCAL PROCEDURE UpdatePaymentTolerance@20(UseDialog@1000 : Boolean);
    BEGIN
      IF "Block Payment Tolerance" THEN BEGIN
        IF UseDialog THEN
          IF NOT CONFIRM(RemovePaymentRoleranceQst,FALSE) THEN
            EXIT;
        PaymentToleranceMgt.DelTolCustLedgEntry(Rec);
      END ELSE BEGIN
        IF UseDialog THEN
          IF NOT CONFIRM(AllowPaymentToleranceQst,FALSE) THEN
            EXIT;
        PaymentToleranceMgt.CalcTolCustLedgEntry(Rec);
      END;
    END;

    [External]
    PROCEDURE GetBillToCustomerNo@27() : Code[20];
    BEGIN
      IF "Bill-to Customer No." <> '' THEN
        EXIT("Bill-to Customer No.");
      EXIT("No.");
    END;

    [External]
    PROCEDURE HasAddressIgnoreCountryCode@37() : Boolean;
    BEGIN
      CASE TRUE OF
        Address <> '':
          EXIT(TRUE);
        "Address 2" <> '':
          EXIT(TRUE);
        City <> '':
          EXIT(TRUE);
        County <> '':
          EXIT(TRUE);
        "Post Code" <> '':
          EXIT(TRUE);
        Contact <> '':
          EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    [External]
    PROCEDURE HasAddress@25() : Boolean;
    BEGIN
      EXIT(HasAddressIgnoreCountryCode OR ("Country/Region Code" <> ''));
    END;

    [External]
    PROCEDURE HasDifferentAddress@49(OtherCustomer@1000 : Record 18) : Boolean;
    BEGIN
      CASE TRUE OF
        Address <> OtherCustomer.Address:
          EXIT(TRUE);
        "Address 2" <> OtherCustomer."Address 2":
          EXIT(TRUE);
        City <> OtherCustomer.City:
          EXIT(TRUE);
        County <> OtherCustomer.County:
          EXIT(TRUE);
        "Post Code" <> OtherCustomer."Post Code":
          EXIT(TRUE);
        "Country/Region Code" <> OtherCustomer."Country/Region Code":
          EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    [External]
    PROCEDURE GetCustNo@44(CustomerText@1000 : Text) : Text;
    BEGIN
      EXIT(GetCustNoOpenCard(CustomerText,TRUE,TRUE));
    END;

    [External]
    PROCEDURE GetCustNoOpenCard@36(CustomerText@1000 : Text;ShowCustomerCard@1006 : Boolean;ShowCreateCustomerOption@1007 : Boolean) : Code[20];
    VAR
      Customer@1001 : Record 18;
      CustomerNo@1002 : Code[20];
      NoFiltersApplied@1008 : Boolean;
      CustomerWithoutQuote@1005 : Text;
      CustomerFilterFromStart@1004 : Text;
      CustomerFilterContains@1003 : Text;
    BEGIN
      IF CustomerText = '' THEN
        EXIT('');

      IF STRLEN(CustomerText) <= MAXSTRLEN(Customer."No.") THEN
        IF Customer.GET(COPYSTR(CustomerText,1,MAXSTRLEN(Customer."No."))) THEN
          EXIT(Customer."No.");

      Customer.SETRANGE(Blocked,Customer.Blocked::" ");
      Customer.SETRANGE(Name,CustomerText);
      IF Customer.FINDFIRST THEN
        EXIT(Customer."No.");

      Customer.SETCURRENTKEY(Name);

      CustomerWithoutQuote := CONVERTSTR(CustomerText,'''','?');
      Customer.SETFILTER(Name,'''@' + CustomerWithoutQuote + '''');
      IF Customer.FINDFIRST THEN
        EXIT(Customer."No.");
      Customer.SETRANGE(Name);

      CustomerFilterFromStart := '''@' + CustomerWithoutQuote + '*''';

      Customer.FILTERGROUP := -1;
      Customer.SETFILTER("No.",CustomerFilterFromStart);

      Customer.SETFILTER(Name,CustomerFilterFromStart);

      IF Customer.FINDFIRST THEN
        EXIT(Customer."No.");

      CustomerFilterContains := '''@*' + CustomerWithoutQuote + '*''';

      Customer.SETFILTER("No.",CustomerFilterContains);
      Customer.SETFILTER(Name,CustomerFilterContains);
      Customer.SETFILTER(City,CustomerFilterContains);
      Customer.SETFILTER(Contact,CustomerFilterContains);
      Customer.SETFILTER("Phone No.",CustomerFilterContains);
      Customer.SETFILTER("Post Code",CustomerFilterContains);

      IF Customer.COUNT = 0 THEN
        MarkCustomersWithSimilarName(Customer,CustomerText);

      IF Customer.COUNT = 1 THEN BEGIN
        Customer.FINDFIRST;
        EXIT(Customer."No.");
      END;

      IF NOT GUIALLOWED THEN
        ERROR(SelectCustErr);

      IF Customer.COUNT = 0 THEN BEGIN
        IF Customer.WRITEPERMISSION THEN
          IF ShowCreateCustomerOption THEN
            CASE STRMENU(
                   STRSUBSTNO(
                     '%1,%2',STRSUBSTNO(CreateNewCustTxt,CONVERTSTR(CustomerText,',','.')),SelectCustTxt),1,CustNotRegisteredTxt) OF
              0:
                ERROR(SelectCustErr);
              1:
                EXIT(CreateNewCustomer(COPYSTR(CustomerText,1,MAXSTRLEN(Customer.Name)),ShowCustomerCard));
            END
          ELSE
            EXIT('');
        Customer.RESET;
        NoFiltersApplied := TRUE;
      END;

      IF ShowCustomerCard THEN
        CustomerNo := PickCustomer(Customer,NoFiltersApplied)
      ELSE BEGIN
        LookupRequested := TRUE;
        EXIT('');
      END;

      IF CustomerNo <> '' THEN
        EXIT(CustomerNo);

      ERROR(SelectCustErr);
    END;

    LOCAL PROCEDURE MarkCustomersWithSimilarName@33(VAR Customer@1001 : Record 18;CustomerText@1000 : Text);
    VAR
      TypeHelper@1002 : Codeunit 10;
      CustomerCount@1003 : Integer;
      CustomerTextLength@1004 : Integer;
      Treshold@1005 : Integer;
    BEGIN
      IF CustomerText = '' THEN
        EXIT;
      IF STRLEN(CustomerText) > MAXSTRLEN(Customer.Name) THEN
        EXIT;
      CustomerTextLength := STRLEN(CustomerText);
      Treshold := CustomerTextLength DIV 5;
      IF Treshold = 0 THEN
        EXIT;

      Customer.RESET;
      Customer.ASCENDING(FALSE); // most likely to search for newest customers
      Customer.SETRANGE(Blocked,Customer.Blocked::" ");
      IF Customer.FINDSET THEN
        REPEAT
          CustomerCount += 1;
          IF ABS(CustomerTextLength - STRLEN(Customer.Name)) <= Treshold THEN
            IF TypeHelper.TextDistance(UPPERCASE(CustomerText),UPPERCASE(Customer.Name)) <= Treshold THEN
              Customer.MARK(TRUE);
        UNTIL Customer.MARK OR (Customer.NEXT = 0) OR (CustomerCount > 1000);
      Customer.MARKEDONLY(TRUE);
    END;

    [External]
    PROCEDURE CreateNewCustomer@28(CustomerName@1000 : Text[100];ShowCustomerCard@1001 : Boolean) : Code[20];
    VAR
      Customer@1005 : Record 18;
      MiniCustomerTemplate@1006 : Record 1300;
      CustomerCard@1002 : Page 21;
    BEGIN
      Customer.Name := CustomerName;
      IF NOT MiniCustomerTemplate.NewCustomerFromTemplate(Customer) THEN
        Customer.INSERT(TRUE)
      ELSE
        IF CustomerName <> Customer.Name THEN BEGIN
          Customer.Name := CustomerName;
          Customer.MODIFY(TRUE);
        END;

      COMMIT;
      IF NOT ShowCustomerCard THEN
        EXIT(Customer."No.");
      Customer.SETRANGE("No.",Customer."No.");
      CustomerCard.SETTABLEVIEW(Customer);
      IF NOT (CustomerCard.RUNMODAL = ACTION::OK) THEN
        ERROR(SelectCustErr);

      EXIT(Customer."No.");
    END;

    LOCAL PROCEDURE PickCustomer@51(VAR Customer@1000 : Record 18;NoFiltersApplied@1002 : Boolean) : Code[20];
    VAR
      CustomerList@1001 : Page 22;
    BEGIN
      IF NOT NoFiltersApplied THEN
        MarkCustomersByFilters(Customer);

      CustomerList.SETTABLEVIEW(Customer);
      CustomerList.SETRECORD(Customer);
      CustomerList.LOOKUPMODE := TRUE;
      IF CustomerList.RUNMODAL = ACTION::LookupOK THEN
        CustomerList.GETRECORD(Customer)
      ELSE
        CLEAR(Customer);

      EXIT(Customer."No.");
    END;

    LOCAL PROCEDURE MarkCustomersByFilters@42(VAR Customer@1000 : Record 18);
    BEGIN
      IF Customer.FINDSET THEN
        REPEAT
          Customer.MARK(TRUE);
        UNTIL Customer.NEXT = 0;
      IF Customer.FINDFIRST THEN;
      Customer.MARKEDONLY := TRUE;
    END;

    [External]
    PROCEDURE OpenCustomerLedgerEntries@31(FilterOnDueEntries@1002 : Boolean);
    VAR
      DetailedCustLedgEntry@1001 : Record 379;
      CustLedgerEntry@1000 : Record 21;
    BEGIN
      DetailedCustLedgEntry.SETRANGE("Customer No.","No.");
      COPYFILTER("Global Dimension 1 Filter",DetailedCustLedgEntry."Initial Entry Global Dim. 1");
      COPYFILTER("Global Dimension 2 Filter",DetailedCustLedgEntry."Initial Entry Global Dim. 2");
      IF FilterOnDueEntries AND (GETFILTER("Date Filter") <> '') THEN BEGIN
        COPYFILTER("Date Filter",DetailedCustLedgEntry."Initial Entry Due Date");
        DetailedCustLedgEntry.SETFILTER("Posting Date",'<=%1',GETRANGEMAX("Date Filter"));
      END;
      COPYFILTER("Currency Filter",DetailedCustLedgEntry."Currency Code");
      CustLedgerEntry.DrillDownOnEntries(DetailedCustLedgEntry);
    END;

    [External]
    PROCEDURE SetInsertFromTemplate@32(FromTemplate@1000 : Boolean);
    BEGIN
      InsertFromTemplate := FromTemplate;
    END;

    [External]
    PROCEDURE IsLookupRequested@34() Result : Boolean;
    BEGIN
      Result := LookupRequested;
      LookupRequested := FALSE;
    END;

    LOCAL PROCEDURE IsContactUpdateNeeded@48() : Boolean;
    VAR
      CustContUpdate@1001 : Codeunit 5056;
      UpdateNeeded@1000 : Boolean;
    BEGIN
      UpdateNeeded :=
        (Name <> xRec.Name) OR
        ("Search Name" <> xRec."Search Name") OR
        ("Name 2" <> xRec."Name 2") OR
        (Address <> xRec.Address) OR
        ("Address 2" <> xRec."Address 2") OR
        (City <> xRec.City) OR
        ("Phone No." <> xRec."Phone No.") OR
        ("Telex No." <> xRec."Telex No.") OR
        ("Territory Code" <> xRec."Territory Code") OR
        ("Currency Code" <> xRec."Currency Code") OR
        ("Language Code" <> xRec."Language Code") OR
        ("Salesperson Code" <> xRec."Salesperson Code") OR
        ("Country/Region Code" <> xRec."Country/Region Code") OR
        ("Fax No." <> xRec."Fax No.") OR
        ("Telex Answer Back" <> xRec."Telex Answer Back") OR
        ("VAT Registration No." <> xRec."VAT Registration No.") OR
        ("Post Code" <> xRec."Post Code") OR
        (County <> xRec.County) OR
        ("E-Mail" <> xRec."E-Mail") OR
        ("Home Page" <> xRec."Home Page") OR
        (Contact <> xRec.Contact);

      IF NOT UpdateNeeded AND NOT ISTEMPORARY THEN
        UpdateNeeded := CustContUpdate.ContactNameIsBlank("No.");

      IF ForceUpdateContact THEN
        UpdateNeeded := TRUE;

      OnBeforeIsContactUpdateNeeded(Rec,xRec,UpdateNeeded);
      EXIT(UpdateNeeded);
    END;

    [External]
    PROCEDURE IsBlocked@52() : Boolean;
    BEGIN
      IF Blocked <> Blocked::" " THEN
        EXIT(TRUE);

      IF "Privacy Blocked" THEN
        EXIT(TRUE);

      EXIT(FALSE);
    END;

    [External]
    PROCEDURE HasAnyOpenOrPostedDocuments@60() : Boolean;
    VAR
      SalesHeader@1001 : Record 36;
      SalesLine@1000 : Record 37;
      CustLedgerEntry@1002 : Record 21;
      HasAnyDocs@1003 : Boolean;
    BEGIN
      SalesHeader.SETRANGE("Sell-to Customer No.","No.");
      IF SalesHeader.FINDFIRST THEN
        EXIT(TRUE);

      SalesLine.SETCURRENTKEY("Document Type","Bill-to Customer No.");
      SalesLine.SETRANGE("Bill-to Customer No.","No.");
      IF SalesLine.FINDFIRST THEN
        EXIT(TRUE);

      SalesLine.SETRANGE("Bill-to Customer No.");
      SalesLine.SETRANGE("Sell-to Customer No.","No.");
      IF SalesLine.FINDFIRST THEN
        EXIT(TRUE);

      CustLedgerEntry.SETRANGE("Customer No.","No.");
      IF NOT CustLedgerEntry.ISEMPTY THEN
        EXIT(TRUE);

      HasAnyDocs := FALSE;
      OnAfterHasAnyOpenOrPostedDocuments(Rec,HasAnyDocs);
      EXIT(HasAnyDocs);
    END;

    [External]
    PROCEDURE CopyFromCustomerTemplate@63(CustomerTemplate@1000 : Record 5105);
    BEGIN
      "Territory Code" := CustomerTemplate."Territory Code";
      "Global Dimension 1 Code" := CustomerTemplate."Global Dimension 1 Code";
      "Global Dimension 2 Code" := CustomerTemplate."Global Dimension 2 Code";
      "Customer Posting Group" := CustomerTemplate."Customer Posting Group";
      "Currency Code" := CustomerTemplate."Currency Code";
      "Invoice Disc. Code" := CustomerTemplate."Invoice Disc. Code";
      "Customer Price Group" := CustomerTemplate."Customer Price Group";
      "Customer Disc. Group" := CustomerTemplate."Customer Disc. Group";
      "Country/Region Code" := CustomerTemplate."Country/Region Code";
      "Allow Line Disc." := CustomerTemplate."Allow Line Disc.";
      "Gen. Bus. Posting Group" := CustomerTemplate."Gen. Bus. Posting Group";
      "VAT Bus. Posting Group" := CustomerTemplate."VAT Bus. Posting Group";
      VALIDATE("Payment Terms Code",CustomerTemplate."Payment Terms Code");
      VALIDATE("Payment Method Code",CustomerTemplate."Payment Method Code");
      "Prices Including VAT" := CustomerTemplate."Prices Including VAT";
      "Shipment Method Code" := CustomerTemplate."Shipment Method Code";

      OnAfterCopyFromCustomerTemplate(Rec,CustomerTemplate);
    END;

    LOCAL PROCEDURE CopyContactPicture@38(VAR Cont@1000 : Record 5050);
    VAR
      TempNameValueBuffer@1005 : TEMPORARY Record 823;
      FileManagement@1001 : Codeunit 419;
      ConfirmManagement@1002 : Codeunit 27;
      ExportPath@1006 : Text;
    BEGIN
      IF Image.HASVALUE THEN
        IF NOT ConfirmManagement.ConfirmProcess(OverrideImageQst,TRUE) THEN
          EXIT;

      ExportPath := TEMPORARYPATH + Cont."No." + FORMAT(Cont.Image.MEDIAID);
      Cont.Image.EXPORTFILE(ExportPath);
      FileManagement.GetServerDirectoryFilesList(TempNameValueBuffer,TEMPORARYPATH);
      TempNameValueBuffer.SETFILTER(Name,STRSUBSTNO('%1*',ExportPath));
      TempNameValueBuffer.FINDFIRST;

      CLEAR(Image);
      Image.IMPORTFILE(TempNameValueBuffer.Name,'');
      MODIFY;
      IF FileManagement.DeleteServerFile(TempNameValueBuffer.Name) THEN;
    END;

    LOCAL PROCEDURE SetDefaultSalesperson@35();
    VAR
      UserSetup@1000 : Record 91;
    BEGIN
      IF NOT UserSetup.GET(USERID) THEN
        EXIT;

      IF UserSetup."Salespers./Purch. Code" <> '' THEN
        VALIDATE("Salesperson Code",UserSetup."Salespers./Purch. Code");
    END;

    LOCAL PROCEDURE SetLastModifiedDateTime@39();
    BEGIN
      "Last Modified Date Time" := CURRENTDATETIME;
      "Last Date Modified" := TODAY;
    END;

    LOCAL PROCEDURE VATRegistrationValidation@47();
    VAR
      VATRegistrationNoFormat@1005 : Record 381;
      VATRegistrationLog@1004 : Record 249;
      VATRegNoSrvConfig@1003 : Record 248;
      VATRegistrationLogMgt@1002 : Codeunit 249;
      ResultRecordRef@1001 : RecordRef;
      ApplicableCountryCode@1000 : Code[10];
    BEGIN
      IF NOT VATRegistrationNoFormat.Test("VAT Registration No.","Country/Region Code","No.",DATABASE::Customer) THEN
        EXIT;
      VATRegistrationLogMgt.LogCustomer(Rec);
      IF ("Country/Region Code" = '') AND (VATRegistrationNoFormat."Country/Region Code" = '') THEN
        EXIT;
      ApplicableCountryCode := "Country/Region Code";
      IF ApplicableCountryCode = '' THEN
        ApplicableCountryCode := VATRegistrationNoFormat."Country/Region Code";
      IF VATRegNoSrvConfig.VATRegNoSrvIsEnabled THEN BEGIN
        VATRegistrationLogMgt.ValidateVATRegNoWithVIES(ResultRecordRef,Rec,"No.",
          VATRegistrationLog."Account Type"::Customer,ApplicableCountryCode);
        ResultRecordRef.SETTABLE(Rec);
      END;
    END;

    [External]
    PROCEDURE SetAddress@40(CustomerAddress@1001 : Text[100];CustomerAddress2@1002 : Text[50];CustomerPostCode@1003 : Code[20];CustomerCity@1000 : Text[30];CustomerCounty@1004 : Text[30];CustomerCountryCode@1005 : Code[10];CustomerContact@1006 : Text[100]);
    BEGIN
      Address := CustomerAddress;
      "Address 2" := CustomerAddress2;
      "Post Code" := CustomerPostCode;
      City := CustomerCity;
      County := CustomerCounty;
      "Country/Region Code" := CustomerCountryCode;
      UpdateContFromCust.OnModify(Rec);
      Contact := CustomerContact;
    END;

    [External]
    PROCEDURE FindByEmail@41(VAR Customer@1001 : Record 18;Email@1000 : Text) : Boolean;
    VAR
      LocalContact@1002 : Record 5050;
      ContactBusinessRelation@1003 : Record 5054;
      MarketingSetup@1004 : Record 5079;
    BEGIN
      Customer.SETRANGE("E-Mail",Email);
      IF Customer.FINDFIRST THEN
        EXIT(TRUE);

      Customer.SETRANGE("E-Mail");
      LocalContact.SETRANGE("E-Mail",Email);
      IF LocalContact.FINDSET THEN BEGIN
        MarketingSetup.GET;
        REPEAT
          IF ContactBusinessRelation.GET(LocalContact."No.",MarketingSetup."Bus. Rel. Code for Customers") THEN BEGIN
            Customer.GET(ContactBusinessRelation."No.");
            EXIT(TRUE);
          END;
        UNTIL LocalContact.NEXT = 0
      END;
    END;

    [External]
    PROCEDURE UpdateReferencedIds@61();
    VAR
      GraphMgtGeneralTools@1000 : Codeunit 5465;
    BEGIN
      IF ISTEMPORARY THEN
        EXIT;

      IF NOT GraphMgtGeneralTools.IsApiEnabled THEN
        EXIT;

      UpdateCurrencyId;
      UpdatePaymentTermsId;
      UpdateShipmentMethodId;
      UpdatePaymentMethodId;
      UpdateTaxAreaId;
    END;

    [External]
    PROCEDURE GetReferencedIds@46(VAR TempField@1000 : TEMPORARY Record 2000000041);
    VAR
      DataTypeManagement@1001 : Codeunit 701;
    BEGIN
      DataTypeManagement.InsertFieldToBuffer(TempField,DATABASE::Customer,FIELDNO("Currency Id"));
      DataTypeManagement.InsertFieldToBuffer(TempField,DATABASE::Customer,FIELDNO("Payment Terms Id"));
      DataTypeManagement.InsertFieldToBuffer(TempField,DATABASE::Customer,FIELDNO("Payment Method Id"));
      DataTypeManagement.InsertFieldToBuffer(TempField,DATABASE::Customer,FIELDNO("Shipment Method Id"));
      DataTypeManagement.InsertFieldToBuffer(TempField,DATABASE::Customer,FIELDNO("Tax Area ID"));
    END;

    [External]
    PROCEDURE SetForceUpdateContact@65(NewForceUpdateContact@1000 : Boolean);
    BEGIN
      ForceUpdateContact := NewForceUpdateContact;
    END;

    LOCAL PROCEDURE UpdateCurrencyCode@54();
    VAR
      Currency@1001 : Record 4;
    BEGIN
      IF NOT ISNULLGUID("Currency Id") THEN BEGIN
        Currency.SETRANGE(Id,"Currency Id");
        Currency.FINDFIRST;
      END;

      VALIDATE("Currency Code",Currency.Code);
    END;

    LOCAL PROCEDURE UpdatePaymentTermsCode@56();
    VAR
      PaymentTerms@1001 : Record 3;
    BEGIN
      IF NOT ISNULLGUID("Payment Terms Id") THEN BEGIN
        PaymentTerms.SETRANGE(Id,"Payment Terms Id");
        PaymentTerms.FINDFIRST;
      END;

      VALIDATE("Payment Terms Code",PaymentTerms.Code);
    END;

    LOCAL PROCEDURE UpdateShipmentMethodCode@58();
    VAR
      ShipmentMethod@1001 : Record 10;
    BEGIN
      IF NOT ISNULLGUID("Shipment Method Id") THEN BEGIN
        ShipmentMethod.SETRANGE(Id,"Shipment Method Id");
        ShipmentMethod.FINDFIRST;
      END;

      VALIDATE("Shipment Method Code",ShipmentMethod.Code);
    END;

    LOCAL PROCEDURE UpdatePaymentMethodCode@43();
    VAR
      PaymentMethod@1001 : Record 289;
    BEGIN
      IF NOT ISNULLGUID("Payment Method Id") THEN BEGIN
        PaymentMethod.SETRANGE(Id,"Payment Method Id");
        PaymentMethod.FINDFIRST;
      END;

      VALIDATE("Payment Method Code",PaymentMethod.Code);
    END;

    [External]
    PROCEDURE UpdateCurrencyId@55();
    VAR
      Currency@1000 : Record 4;
    BEGIN
      IF "Currency Code" = '' THEN BEGIN
        CLEAR("Currency Id");
        EXIT;
      END;

      IF NOT Currency.GET("Currency Code") THEN
        EXIT;

      "Currency Id" := Currency.Id;
    END;

    [External]
    PROCEDURE UpdatePaymentTermsId@57();
    VAR
      PaymentTerms@1000 : Record 3;
    BEGIN
      IF "Payment Terms Code" = '' THEN BEGIN
        CLEAR("Payment Terms Id");
        EXIT;
      END;

      IF NOT PaymentTerms.GET("Payment Terms Code") THEN
        EXIT;

      "Payment Terms Id" := PaymentTerms.Id;
    END;

    [External]
    PROCEDURE UpdateShipmentMethodId@59();
    VAR
      ShipmentMethod@1000 : Record 10;
    BEGIN
      IF "Shipment Method Code" = '' THEN BEGIN
        CLEAR("Shipment Method Id");
        EXIT;
      END;

      IF NOT ShipmentMethod.GET("Shipment Method Code") THEN
        EXIT;

      "Shipment Method Id" := ShipmentMethod.Id;
    END;

    [External]
    PROCEDURE UpdatePaymentMethodId@45();
    VAR
      PaymentMethod@1000 : Record 289;
    BEGIN
      IF "Payment Method Code" = '' THEN BEGIN
        CLEAR("Payment Method Id");
        EXIT;
      END;

      IF NOT PaymentMethod.GET("Payment Method Code") THEN
        EXIT;

      "Payment Method Id" := PaymentMethod.Id;
    END;

    [External]
    PROCEDURE UpdateTaxAreaId@1166();
    VAR
      VATBusinessPostingGroup@1002 : Record 323;
      TaxArea@1000 : Record 318;
      GeneralLedgerSetup@1001 : Record 98;
    BEGIN
      IF GeneralLedgerSetup.UseVat THEN BEGIN
        IF "VAT Bus. Posting Group" = '' THEN BEGIN
          CLEAR("Tax Area ID");
          EXIT;
        END;

        IF NOT VATBusinessPostingGroup.GET("VAT Bus. Posting Group") THEN
          EXIT;

        "Tax Area ID" := VATBusinessPostingGroup.Id;
      END ELSE BEGIN
        IF "Tax Area Code" = '' THEN BEGIN
          CLEAR("Tax Area ID");
          EXIT;
        END;

        IF NOT TaxArea.GET("Tax Area Code") THEN
          EXIT;

        "Tax Area ID" := TaxArea.Id;
      END;
    END;

    LOCAL PROCEDURE UpdateTaxAreaCode@1164();
    VAR
      TaxArea@1001 : Record 318;
      VATBusinessPostingGroup@1000 : Record 323;
      GeneralLedgerSetup@1002 : Record 98;
    BEGIN
      IF ISNULLGUID("Tax Area ID") THEN
        EXIT;

      IF GeneralLedgerSetup.UseVat THEN BEGIN
        VATBusinessPostingGroup.SETRANGE(Id,"Tax Area ID");
        VATBusinessPostingGroup.FINDFIRST;
        "VAT Bus. Posting Group" := VATBusinessPostingGroup.Code;
      END ELSE BEGIN
        TaxArea.SETRANGE(Id,"Tax Area ID");
        TaxArea.FINDFIRST;
        "Tax Area Code" := TaxArea.Code;
      END;
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeIsContactUpdateNeeded@50(Customer@1000 : Record 18;xCustomer@1001 : Record 18;VAR UpdateNeeded@1002 : Boolean);
    BEGIN
    END;

    LOCAL PROCEDURE ValidateSalesPersonCode@1900();
    BEGIN
      IF "Salesperson Code" <> '' THEN
        IF SalespersonPurchaser.GET("Salesperson Code") THEN
          IF SalespersonPurchaser.VerifySalesPersonPurchaserPrivacyBlocked(SalespersonPurchaser) THEN
            ERROR(SalespersonPurchaser.GetPrivacyBlockedGenericText(SalespersonPurchaser,TRUE))
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyFromCustomerTemplate@64(VAR Customer@1000 : Record 18;CustomerTemplate@1001 : Record 5105);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterHasAnyOpenOrPostedDocuments@62(VAR Customer@1000 : Record 18;VAR HasAnyDocs@1001 : Boolean);
    BEGIN
    END;

    LOCAL PROCEDURE IsOnBeforeCheckBlockedCustHandled@67(Customer@1003 : Record 18;Source@1004 : 'Journal,Document';DocType@1002 : Option;Shipment@1001 : Boolean;Transaction@1000 : Boolean) IsHandled : Boolean;
    BEGIN
      OnBeforeCheckBlockedCust(Customer,Source,DocType,Shipment,Transaction,IsHandled)
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeCheckBlockedCust@66(Customer@1003 : Record 18;Source@1005 : 'Journal,Document';DocType@1002 : Option;Shipment@1001 : Boolean;Transaction@1000 : Boolean;VAR IsHandled@1004 : Boolean);
    BEGIN
    END;

    BEGIN
    {
      AT2017  02.12.2016Global Var ATEvPub Codeunit 56781 TAPI Event Publishers
                            4 Events implemented
      AT2017.0120.01.2018GET deleted (2x)
    }
    END.
  }
}

OBJECT Table 56780 Tapi Logfile
{
  OBJECT-PROPERTIES
  {
    Date=15.01.17;
    Time=12:00:00;
    Modified=Yes;
    Version List=AT2016;
  }
  PROPERTIES
  {
    CaptionML=[DEU=TAPI Logbuch;
               ENU=TAPI Logfile];
    LookupPageID=Page56784;
    DrillDownPageID=Page56784;
  }
  FIELDS
  {
    { 1   ;   ;Key local           ;Text40        ;CaptionML=[DEU=SchlÅssel lokal;
                                                              ENU=Key local];
                                                   Description=GUID }
    { 2   ;   ;Date                ;Date          ;CaptionML=[DEU=Datum;
                                                              ENU=Date];
                                                   Description=Date }
    { 3   ;   ;Time                ;Time          ;CaptionML=[DEU=Zeit;
                                                              ENU=Time];
                                                   Description=Time }
    { 4   ;   ;User                ;Code50        ;CaptionML=[DEU=Benutzer;
                                                              ENU=User];
                                                   Description=USERID }
    { 5   ;   ;UserInfo            ;Text120       ;CaptionML=[DEU=UserInfo;
                                                              ENU=UserInfo] }
    { 6   ;   ;UserInfo1           ;Text120       ;CaptionML=[DEU=UserInfo1;
                                                              ENU=UserInfo1] }
    { 7   ;   ;UserInfo2           ;Text120       ;CaptionML=[DEU=UserInfo2;
                                                              ENU=UserInfo2] }
    { 8   ;   ;Direction           ;Option        ;CaptionML=[DEU=Richtung;
                                                              ENU=Direction];
                                                   OptionCaptionML=[DEU=ausgehend,eingehend;
                                                                    ENU=out,in];
                                                   OptionString=out,in }
    { 10  ;   ;Entry No.           ;Integer       ;CaptionML=[DEU=Lfd. Nr.;
                                                              ENU=Entry No.] }
    { 12  ;   ;Duration (Sec.)     ;Decimal       ;CaptionML=[DEU=Dauer (Sec.);
                                                              ENU=Duration (Sec.)] }
    { 13  ;   ;State (rough)       ;Text10        ;CaptionML=[DEU=Status (roh);
                                                              ENU=State (rough)] }
    { 14  ;   ;State               ;Option        ;CaptionML=[DEU=Status;
                                                              ENU=State];
                                                   OptionCaptionML=[DEU=" ,verbunden,nicht verbunden";
                                                                    ENU=" ,connected,not connected"];
                                                   OptionString=[ ,connected,not connected] }
    { 15  ;   ;External            ;Boolean       ;CaptionML=[DEU=Extern;
                                                              ENU=External] }
    { 20  ;   ;Caller ID           ;Text30        ;CaptionML=[DEU=Anrufer ID;
                                                              ENU=Caller ID];
                                                   Description=Caller ID }
    { 21  ;   ;Called ID           ;Text30        ;CaptionML=[DEU=Angerufener ID;
                                                              ENU=Called ID];
                                                   Description=Called ID }
    { 22  ;   ;Connected ID        ;Text30        ;CaptionML=[DEU=Verbunden ID;
                                                              ENU=Connected ID];
                                                   Description=Connected ID }
    { 23  ;   ;Redirection ID      ;Text30        ;CaptionML=[DEU=Weiterleitungsziel ID;
                                                              ENU=Redirection ID];
                                                   Description=Redirection ID }
    { 24  ;   ;Redirecting ID      ;Text30        ;CaptionML=[DEU=Weiterleiter ID;
                                                              ENU=Redirecting ID];
                                                   Description=Redirecting ID }
    { 25  ;   ;Key global          ;Text40        ;CaptionML=[DEU=SchlÅssel zentral;
                                                              ENU=Key global];
                                                   Description=CallData }
    { 30  ;   ;Caller ID Name      ;Text50        ;CaptionML=[DEU=Anrufer ID Name;
                                                              ENU=Caller ID Name] }
    { 31  ;   ;Called ID Name      ;Text50        ;CaptionML=[DEU=Angerufener ID Name;
                                                              ENU=Called ID Name] }
    { 32  ;   ;Connected ID Name   ;Text50        ;CaptionML=[DEU=Verbunden ID Name;
                                                              ENU=Connected ID Name] }
    { 33  ;   ;Redirection ID Name ;Text50        ;CaptionML=[DEU=Weiterleitungsziel ID Name;
                                                              ENU=Redirection ID Name] }
    { 34  ;   ;Redirecting ID Name ;Text50        ;CaptionML=[DEU=Weiterleiter ID Name;
                                                              ENU=Redirecting ID Name] }
    { 35  ;   ;Origin              ;Integer       ;CaptionML=[DEU=Herkunft;
                                                              ENU=Origin] }
    { 40  ;   ;Table of origin     ;Integer       ;CaptionML=[DEU=Herkunfts-Tabelle;
                                                              ENU=Table of origin] }
    { 41  ;   ;No. of origin       ;Code20        ;CaptionML=[DEU=Herkunfts-Nr.;
                                                              ENU=No. of origin] }
    { 42  ;   ;No. 2 of origin     ;Code20        ;CaptionML=[DEU=Herkunfts-Nr. 2;
                                                              ENU=No. 2 of origin] }
    { 43  ;   ;Name of origin      ;Text50        ;CaptionML=[DEU=Herkunfts-Name;
                                                              ENU=Name of origin] }
    { 50  ;   ;Closed              ;Boolean       ;CaptionML=[DEU=Erledigt;
                                                              ENU=Closed] }
    { 60  ;   ;Reference           ;Text30        ;CaptionML=[DEU=Bezug;
                                                              ENU=Reference] }
    { 61  ;   ;Note                ;Text80        ;CaptionML=[DEU=Bemerkung;
                                                              ENU=Note] }
    { 70  ;   ;Remote ID           ;Text30        ;CaptionML=[DEU=Partner ID;
                                                              ENU=Remote ID];
                                                   Description=Remote ID }
    { 71  ;   ;Remote ID Name      ;Text50        ;CaptionML=[DEU=Partner ID Name;
                                                              ENU=Remote ID Name];
                                                   Description=Remote ID Name }
    { 80  ;   ;Local ID            ;Text30        ;CaptionML=[DEU=Lokale ID;
                                                              ENU=Local ID];
                                                   Description=Local ID }
    { 81  ;   ;Local ID Name       ;Text50        ;CaptionML=[DEU=Lokale ID Name;
                                                              ENU=Local ID Name];
                                                   Description=Local ID Name }
  }
  KEYS
  {
    {    ;Key local                               ;Clustered=Yes }
    {    ;Key global                               }
    {    ;Entry No.                                }
    {    ;User,State,Closed,Date,Time              }
    {    ;Date,Time                                }
    {    ;User,Entry No.                           }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      AT01.20       08.09.2003  New Fields: 70 Remote ID        Text 30
                                            71 Remote ID Name   Text 30
                                            80 Local ID         Text 30
                                            81 Local ID Name    Text 30

      AT05.00       16.06.2007  Length of all name-fields changed form 30 to 50
      AT2009        06.11.2009  New Index User,Entry No. for List per User
      AT2016        30.06.2016  Field User from len 20 to len 50 (thanks to Werner)
    }
    END.
  }
}

OBJECT Table 56781 Phone Index
{
  OBJECT-PROPERTIES
  {
    Date=15.01.17;
    Time=12:00:00;
    Modified=Yes;
    Version List=AT2009;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Telefon-Index;
               ENU=Phone Index];
  }
  FIELDS
  {
    { 1   ;   ;Table of origin     ;Integer       ;CaptionML=[DEU=Herkunfts-Tabelle;
                                                              ENU=Table of origin] }
    { 2   ;   ;No. of origin       ;Code20        ;CaptionML=[DEU=Herkunfts-Nr.;
                                                              ENU=No. of origin] }
    { 3   ;   ;No. 2 of origin     ;Code20        ;CaptionML=[DEU=Herkunfts-Nr 2;
                                                              ENU=No. 2 of origin] }
    { 4   ;   ;Type of origin      ;Option        ;CaptionML=[DEU=Herkunftsart;
                                                              ENU=Type of origin];
                                                   OptionCaptionML=[DEU=dienstlich,privat,mobil,zweite,Durchwahl;
                                                                    ENU=business,private,mobile,second,extension];
                                                   OptionString=business,private,mobile,second,extension }
    { 5   ;   ;Name of origin      ;Text50        ;CaptionML=[DEU=Herkunfts-Name;
                                                              ENU=Name of origin] }
    { 6   ;   ;Phone No.           ;Text30        ;CaptionML=[DEU=Telefon-Nr.;
                                                              ENU=Phone No.] }
    { 7   ;   ;Blocked             ;Boolean       ;CaptionML=[DEU=Gesperrt;
                                                              ENU=Blocked] }
  }
  KEYS
  {
    {    ;Table of origin,No. of origin,No. 2 of origin,Type of origin,Blocked;
                                                   Clustered=Yes }
    {    ;Phone No.,Blocked                        }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      AT05.00       16.06.2007  Length of name-field changed form 30 to 50
      AT2009        06.11.2009  New Field "Blocked"; Field "Blocked" added to all Index-Keys
    }
    END.
  }
}

OBJECT Table 56782 TAPI Setup
{
  OBJECT-PROPERTIES
  {
    Date=15.01.17;
    Time=12:00:00;
    Modified=Yes;
    Version List=AT2015;
  }
  PROPERTIES
  {
    CaptionML=[DEU=TAPI Einrichtung;
               ENU=TAPI Setup];
  }
  FIELDS
  {
    { 1   ;   ;Primary key         ;Code10        ;CaptionML=[DEU=PrimÑrschlÅssel;
                                                              ENU=Primary key] }
    { 10  ;   ;Length of internal phone No.;Integer;
                                                   CaptionML=[DEU=LÑnge interne Rufnummer;
                                                              ENU=Length of internal phone No.] }
    { 20  ;   ;Action for incoming call;Option    ;CaptionML=[DEU=Aktion eingehende Anrufe;
                                                              ENU=Action for incoming call];
                                                   OptionCaptionML=[DEU=" ,Anrufer kurz anzeigen,Karte anzeigen,Auswahl anzeigen";
                                                                    ENU=" ,Show caller for short time,Show card,Show menu"];
                                                   OptionString=[ ,Show caller for short time,Show card,Show menu] }
    { 30  ;   ;Create call data    ;Boolean       ;CaptionML=[DEU=Anrufdaten erstellen;
                                                              ENU=Create call data];
                                                   Description=fÅr Weiterleitung / for Redirection }
    { 40  ;   ;TAPI line name      ;Text50        ;TableRelation="TAPI Line";
                                                   CaptionML=[DEU=Name TAPI Leitung;
                                                              ENU=TAPI line name] }
    { 50  ;   ;Trace level         ;Integer       ;InitValue=4;
                                                   CaptionML=[DEU=Verfolgung Stufe;
                                                              ENU=Trace level] }
    { 60  ;   ;Min. length fÅr Phoneindex;Integer ;CaptionML=[DEU=MindestlÑnge fÅr Telefonindex;
                                                              ENU=Min. length fÅr Phoneindex] }
    { 70  ;   ;Format Phone Numbers;Boolean       ;CaptionML=[DEU=Telefon-Nummern formatieren;
                                                              ENU=Format Phone Numbers] }
    { 80  ;   ;Format Fax Numbers  ;Boolean       ;CaptionML=[DEU=Fax-Nummern formatieren;
                                                              ENU=Format Fax Numbers] }
    { 90  ;   ;Check of double numbers;Option     ;CaptionML=DEU=PrÅfung doppelte Nummern;
                                                   OptionCaptionML=[DEU=immer,nur ungesperrte Nummern,nie;
                                                                    ENU=allways,only unblocked numbers,never];
                                                   OptionString=allways,only unblocked numbers,never }
    { 100 ;   ;Create Interaction Log Entry;Boolean;
                                                   CaptionML=[DEU=AktivitÑts-Protokollposten erstellen;
                                                              ENU=Create Interaction Log Entry] }
    { 110 ;   ;Log internal calls  ;Boolean       ;CaptionML=[DEU=Interne Anrufe in Logbuch;
                                                              ENU=Log internal calls] }
    { 120 ;   ;Runs in Developer Mode;Boolean     ;CaptionML=[DEU=LÑuft im Entwickler Modus;
                                                              ENU=Runs in Developer Mode] }
  }
  KEYS
  {
    {    ;Primary key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      AT01.20     08.09.2003  New fields: 60 Min. length fÅr Phoneindex Integer
                                          70 Format Phone Numbers
      AT04.00     04.11.2005  New field:  80 Format Fax Numbers
      AT2009      06.11.2009  New field:  90 Check of double numbers (in Phone Index)
                                          100 Create Interaction Log Entry
      AT2011      05.04.2011  New field:  110 Log internal calls
      AT2015      02.12.2014  New field:  120 Runs in Developer Mode
    }
    END.
  }
}

OBJECT Table 56783 TAPI User
{
  OBJECT-PROPERTIES
  {
    Date=15.01.17;
    Time=12:00:00;
    Modified=Yes;
    Version List=AT2016;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               VALIDATE(User);
             END;

    CaptionML=[DEU=TAPI Benutzer;
               ENU=TAPI User];
    LookupPageID=Page56783;
    DrillDownPageID=Page56783;
  }
  FIELDS
  {
    { 1   ;   ;User                ;Code50        ;TableRelation="User Setup";
                                                   OnValidate=BEGIN
                                                                IF User = '' THEN BEGIN
                                                                  ERROR(Text100);
                                                                END ELSE BEGIN
                                                                  IF UserSetup.GET(User) THEN BEGIN
                                                                    IF NOT UserSetup."Use activeTAPI" THEN
                                                                      ERROR(Text102,User);
                                                                  END ELSE BEGIN
                                                                    ERROR(Text101,User);
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[DEU=Benutzer;
                                                              ENU=User] }
    { 10  ;   ;Action for incoming call;Option    ;CaptionML=[DEU=Aktion bei eingehendem Anruf;
                                                              ENU=Action for incoming call];
                                                   OptionCaptionML=[DEU=" ,Anrufer kurz anzeigen,Karte anzeigen,Auswahl anzeigen";
                                                                    ENU=" ,Show caller for short time,Show card,Show menu"];
                                                   OptionString=[ ,Show caller for short time,Show card,Show menu] }
    { 11  ;   ;Action for new ext. Phone No.;Option;
                                                   CaptionML=[DEU=Aktion bei neuer ext. Telefon-Nr.;
                                                              ENU=Action for new ext. Phone No.];
                                                   OptionCaptionML=[DEU=" ,Kontakt-Karte îffnen,Auswahl anzeigen";
                                                                    ENU=" ,Open Contact Card,Show menu"];
                                                   OptionString=[ ,Open Contact Card,Show menu] }
    { 20  ;   ;Start activeTAPI Dialer;Boolean    ;CaptionML=[DEU=activeTAPI Dialer starten;
                                                              ENU=Start activeTAPI Dialer] }
    { 21  ;   ;Directory of dialer ;Text150       ;CaptionML=[DEU=Verzeichnis des Dialers;
                                                              ENU=Directory of dialer] }
    { 30  ;   ;TAPI line name      ;Text50        ;TableRelation="TAPI Line";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DEU=Name TAPI Leitung;
                                                              ENU=TAPI line name] }
    { 90  ;   ;Blocked             ;Boolean       ;CaptionML=[DEU=Gesperrt;
                                                              ENU=Blocked];
                                                   Editable=No }
    { 100 ;   ;Action for end of incom. call;Option;
                                                   CaptionML=DEU=Aktion Ende eingeh. Anruf;
                                                   OptionCaptionML=[DEU=Bezug/Bemerkung,keine;
                                                                    ENU=Reference/Note,none];
                                                   OptionString=Reference/Note,none }
    { 110 ;   ;Action for end of outgo. call;Option;
                                                   CaptionML=DEU=Aktion Ende ausgeh. Anruf;
                                                   OptionCaptionML=[DEU=Bezug/Bemerkung,keine;
                                                                    ENU=Reference/Note,none];
                                                   OptionString=Reference/Note,none }
    { 200 ;   ;HelpField           ;Text30        ;CaptionML=[DEU=Hilfsfeld;
                                                              ENU=HelpField] }
    { 201 ;   ;GUIDTemp            ;Text40        ;CaptionML=[DEU=Lokaler SchlÅssel temp;
                                                              ENU=GUIDTemp] }
    { 202 ;   ;BLOBTemp            ;BLOB          ;CaptionML=[DEU=BLOBTemp;
                                                              ENU=BLOBTemp] }
  }
  KEYS
  {
    {    ;User                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      UserSetup@1000 : Record 91;
      Text100@1001 : TextConst 'DEU=Benutzer darf nicht leer sein.;ENU=User may not be empty.';
      Text101@1002 : TextConst 'DEU=Benutzer %1 ist nicht in Benutzer Einrichtung angelegt.;ENU=User %1 is not definded in User Setup.';
      Text102@1003 : TextConst 'DEU=Benutzer %1 ist nicht fÅr activeTAPI freigegeben.;ENU=User %1 is not allowed to use activeTAPI.';
      TAPIEinr@1004 : Record 56782;
      Text103@1005 : TextConst 'DEU=Sie kînnen TAPI Leitungsname nur eingeben, wenn in der TAPI Einrichtung Leitungszuordnung per Benutzer eingegeben wurde.;ENU=You can input TAPI Line name only, if in the TAPI Setup TAPI Line selection is per User.';

    BEGIN
    {
      AT2009        06.11.2009 New field: Action for end of incom. call     Reference/Note,none
                                          Action for end of outgo. call     Reference/Note,none
      AT2016        30.06.2016  Field User from len 20 to len 50 (thanks to Werner)
    }
    END.
  }
}

OBJECT Table 56784 TAPI Line
{
  OBJECT-PROPERTIES
  {
    Date=15.01.17;
    Time=12:00:00;
    Modified=Yes;
    Version List=AT01;
  }
  PROPERTIES
  {
    CaptionML=[DEU=TAPI Leitung;
               ENU=TAPI Line];
    LookupPageID=Page56787;
    DrillDownPageID=Page56787;
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=[DEU=Lfd. Nr.;
                                                              ENU=Entry No.] }
    { 2   ;   ;TAPI Line name      ;Text50        ;CaptionML=[DEU=TAPI Leitung;
                                                              ENU=TAPI Line name] }
  }
  KEYS
  {
    {    ;TAPI Line name,Entry No.                ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 56785 Note for Phone-Index
{
  OBJECT-PROPERTIES
  {
    Date=15.01.17;
    Time=12:00:00;
    Modified=Yes;
    Version List=AT01;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Hinweis Telefon-Index;
               ENU=Note for Phone-Index];
  }
  FIELDS
  {
    { 1   ;   ;Lfd.Nr.             ;Integer       ;CaptionML=[DEU=Lfd.Nr.;
                                                              ENU=Entry No.] }
    { 2   ;   ;Text                ;Text150       ;CaptionML=[DEU=Text;
                                                              ENU=Text] }
  }
  KEYS
  {
    {    ;Lfd.Nr.                                 ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 56786 Phone Index Temp
{
  OBJECT-PROPERTIES
  {
    Date=15.01.17;
    Time=12:00:00;
    Modified=Yes;
    Version List=AT05.00;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Telefon-Index temp;
               ENU=Phone Index temp];
  }
  FIELDS
  {
    { 1   ;   ;Table of origin     ;Integer       ;CaptionML=[DEU=Herkunfts-Tabelle;
                                                              ENU=Table of origin] }
    { 2   ;   ;No. of origin       ;Code20        ;CaptionML=[DEU=Herkunfts-Nr.;
                                                              ENU=No. of origin] }
    { 3   ;   ;No. 2 of origin     ;Code20        ;CaptionML=[DEU=Herkunfts-Nr 2;
                                                              ENU=No. 2 of origin] }
    { 4   ;   ;Type of origin      ;Option        ;CaptionML=[DEU=Herkunftsart;
                                                              ENU=Type of origin];
                                                   OptionCaptionML=[DEU=dienstlich,privat,mobil,zweite,Durchwahl;
                                                                    ENU=business,private,mobile,second,extension];
                                                   OptionString=business,private,mobile,second,extension }
    { 5   ;   ;Name of origin      ;Text50        ;CaptionML=[DEU=Herkunfts-Name;
                                                              ENU=Name of origin] }
    { 6   ;   ;Phone No.           ;Text30        ;CaptionML=[DEU=Telefon-Nr.;
                                                              ENU=Phone No.] }
    { 8   ;   ;Table Name          ;Text50        ;CaptionML=[DEU=Tabellen-Name;
                                                              ENU=Table Name] }
  }
  KEYS
  {
    {    ;Table of origin,No. of origin,No. 2 of origin,Type of origin;
                                                   Clustered=Yes }
    {    ;Phone No.                                }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      AT05.00       16.06.2007  Length of name-field changed form 30 to 50
      AT2009        26.08.2010  Field No. of Table Name changed from 7 to 8 (error in searching Phone No.)
    }
    END.
  }
}

OBJECT Report 56780 Fill Phone Index
{
  OBJECT-PROPERTIES
  {
    Date=15.01.17;
    Time=12:00:00;
    Modified=Yes;
    Version List=AO,AT2015;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Telefon-Index fÅllen;
               ENU=Fill Phone Index];
    ProcessingOnly=Yes;
    OnInitReport=BEGIN
                   IF TAPIFu.TAPIRights < 2 THEN
                     ERROR(Text1010,USERID);
                 END;

    OnPreReport=BEGIN
                  Window.OPEN('Telefon-Index wird vorbereitet ... ');

                  TelInd.DELETEALL;
                  Hinw.DELETEALL;
                  COMMIT;

                  LfdNr := 0;
                  Window.CLOSE;

                  // AT2009 INSERTED
                  TAPIEinr.GET;
                  // AT2009 END

                  CREATE(ATPhoneNumber,TRUE,TRUE);

                  Window.OPEN(Text001 + ' #1######## #2############################');
                END;

    OnPostReport=BEGIN
                   Window.CLOSE;

                   CLEAR(ATPhoneNumber);
                 END;

  }
  DATASET
  {
    { 6836;    ;DataItem;                    ;
               DataItemTable=Table18;
               DataItemTableView=SORTING(No.);
               OnPreDataItem=BEGIN
                               Window.UPDATE(1, Text002);
                             END;

               OnAfterGetRecord=BEGIN
                                  IF ("Phone No." <> '') THEN BEGIN
                                    Window.UPDATE(2, "No.");

                                  // AT2009 BEGIN
                                    IF TAPIEinr."Check of double numbers" = TAPIEinr."Check of double numbers"::never THEN BEGIN
                                    END ELSE BEGIN
                                  // AT2009 END

                                  // Check for Double for Phone No. in the same table
                                  // Dubletten-PrÅfung fÅr Telefonnr. in gleicher Tabelle
                                      IF "Phone No." <> '' THEN BEGIN
                                        PhoneNo := TAPIFu.ConvToPlain("Phone No.",FALSE);
                                        TelIndex.RESET;
                                        TelIndex.SETCURRENTKEY("Phone No.");
                                        TelIndex.SETRANGE("Phone No.",PhoneNo);
                                        TelIndex.SETRANGE("Table of origin", 18);
                                        TelIndex.SETFILTER("No. of origin", '<>%1',"No.");
                                  // AT2009 BEGIN
                                        IF TAPIEinr."Check of double numbers" = TAPIEinr."Check of double numbers"::"only unblocked numbers" THEN
                                          TelIndex.SETRANGE(Blocked, FALSE);
                                  // AT2009 END
                                        IF TelIndex.FIND('-') THEN BEGIN
                                          Hinw.INIT;
                                          LfdNr := LfdNr + 1;
                                          Hinw."Lfd.Nr." := LfdNr;
                                          Hinw.Text := STRSUBSTNO(Text1008, TABLECAPTION, "No.", FIELDCAPTION("Phone No."),
                                            "Phone No.", TABLECAPTION, TelIndex."No. of origin");
                                          Hinw.INSERT;
                                        END;
                                      END;

                                  // AT2009 BEGIN
                                    END;
                                  // AT2009 END

                                    TelIndex.RESET;
                                    TelIndex.SETRANGE("Table of origin", 18);
                                    TelIndex.SETRANGE("No. of origin", "No.");
                                    IF TelIndex.FIND('-') THEN
                                      TelIndex.DELETEALL;
                                    TelIndex.RESET;

                                  // AT2011 CHANGE
                                    IF ("Phone No." <> '') AND (STRLEN("Phone No.") > TAPIEinr."Min. length fÅr Phoneindex") THEN BEGIN
                                  // AT2011 END:
                                      TelIndex.INIT;
                                      TelIndex."Table of origin"   := 18;
                                      TelIndex."No. of origin"     := "No.";
                                      TelIndex."No. 2 of origin"   := '';
                                      TelIndex."Type of origin"    := TelIndex."Type of origin"::business;
                                      TelIndex."Name of origin"    := Name;
                                      TelIndex."Phone No."         := TAPIFu.ConvToPlain("Phone No.",FALSE);
                                  // AT2009 BEGIN
                                      IF Blocked = Blocked::All THEN
                                        TelIndex.Blocked           := TRUE
                                      ELSE
                                        TelIndex.Blocked           := FALSE;
                                  // AT 2009 END
                                      TelIndex.INSERT;
                                    END;

                                  // AT2011 START
                                    IF FormatExistPhonoNo THEN BEGIN
                                      "Phone No." := TAPIFuSi.ConvToCanonic("Phone No.");
                                      MODIFY;
                                    END;
                                    IF FormatExistFaxNo THEN BEGIN
                                      "Fax No." := TAPIFuSi.ConvToCanonic("Fax No.");
                                      MODIFY;
                                    END;
                                  // AT2011 END

                                  END;
                                END;
                                 }

    { 3182;    ;DataItem;                    ;
               DataItemTable=Table23;
               DataItemTableView=SORTING(No.);
               OnPreDataItem=BEGIN
                               Window.UPDATE(1, Text003);
                             END;

               OnAfterGetRecord=BEGIN
                                  IF "Phone No." <> '' THEN BEGIN
                                    Window.UPDATE(2, "No.");

                                  // AT2009 BEGIN
                                    IF TAPIEinr."Check of double numbers" = TAPIEinr."Check of double numbers"::never THEN BEGIN
                                    END ELSE BEGIN
                                  // AT2009 END

                                  // Check for Double for Phone No. in the same table
                                  // Dubletten-PrÅfung fÅr Telefonnr. in gleicher Tabelle
                                      IF "Phone No." <> '' THEN BEGIN
                                        PhoneNo := TAPIFu.ConvToPlain("Phone No.",FALSE);
                                        TelIndex.RESET;
                                        TelIndex.SETCURRENTKEY("Phone No.");
                                        TelIndex.SETRANGE("Phone No.",PhoneNo);
                                        TelIndex.SETRANGE("Table of origin", 23);
                                        TelIndex.SETFILTER("No. of origin", '<>%1',"No.");
                                  // AT2009 BEGIN
                                        IF TAPIEinr."Check of double numbers" = TAPIEinr."Check of double numbers"::"only unblocked numbers" THEN
                                          TelIndex.SETRANGE(Blocked, FALSE);
                                  // AT2009 END
                                        IF TelIndex.FIND('-') THEN BEGIN
                                          Hinw.INIT;
                                          LfdNr := LfdNr + 1;
                                          Hinw."Lfd.Nr." := LfdNr;
                                          Hinw.Text := STRSUBSTNO(Text1008, TABLECAPTION, "No.", FIELDCAPTION("Phone No."),
                                            "Phone No.", TABLECAPTION, TelIndex."No. of origin");
                                          Hinw.INSERT;
                                        END;
                                      END;
                                  // AT2009 BEGIN
                                    END;
                                  // AT2009 END

                                    TelIndex.RESET;
                                    TelIndex.SETRANGE("Table of origin", 23);
                                    TelIndex.SETRANGE("No. of origin", "No.");
                                    IF TelIndex.FIND('-') THEN
                                      TelIndex.DELETEALL;
                                    TelIndex.RESET;

                                  // AT2011 CHANGE
                                    IF ("Phone No." <> '') AND (STRLEN("Phone No.") > TAPIEinr."Min. length fÅr Phoneindex") THEN BEGIN
                                  // AT2011 END
                                      TelIndex.INIT;
                                      TelIndex."Table of origin"   := 23;
                                      TelIndex."No. of origin"     := "No.";
                                      TelIndex."No. 2 of origin"   := '';
                                      TelIndex."Type of origin"    := TelIndex."Type of origin"::business;
                                      TelIndex."Name of origin"    := Name;
                                      TelIndex."Phone No."         := TAPIFu.ConvToPlain("Phone No.",FALSE);
                                  // AT2009 BEGIN
                                      IF Blocked = Blocked::All THEN
                                        TelIndex.Blocked           := TRUE
                                      ELSE
                                        TelIndex.Blocked           := FALSE;
                                  // AT 2009 END
                                      TelIndex.INSERT;
                                    END;

                                  // AT2011 START
                                    IF FormatExistPhonoNo THEN BEGIN
                                      "Phone No." := TAPIFuSi.ConvToCanonic("Phone No.");
                                      MODIFY;
                                    END;
                                    IF FormatExistFaxNo THEN BEGIN
                                      "Fax No." := TAPIFuSi.ConvToCanonic("Fax No.");
                                      MODIFY;
                                    END;
                                  // AT2011 END

                                  END;
                                END;
                                 }

    { 6698;    ;DataItem;                    ;
               DataItemTable=Table5050;
               DataItemTableView=SORTING(No.);
               OnPreDataItem=BEGIN
                               Window.UPDATE(1, Text005);
                             END;

               OnAfterGetRecord=BEGIN
                                  IF ("Phone No." <> '') OR ("Mobile Phone No." <> '') THEN BEGIN
                                    Window.UPDATE(2, "No.");

                                  // AT2009 BEGIN
                                    IF TAPIEinr."Check of double numbers" = TAPIEinr."Check of double numbers"::never THEN BEGIN
                                    END ELSE BEGIN
                                  // AT2009 END

                                  // Check for Double for Phone No. in the same table
                                  // Dubletten-PrÅfung fÅr Telefonnr. in der gleichen Tabelle
                                      IF "Phone No." <> '' THEN BEGIN
                                        IF ("Phone No." = "Mobile Phone No.") THEN BEGIN
                                          Hinw.INIT;
                                          LfdNr := LfdNr + 1;
                                          Hinw."Lfd.Nr." := LfdNr;
                                          Hinw.Text := STRSUBSTNO(Text1011, "No.");
                                          Hinw.INSERT;
                                        END;
                                        PhoneNo := TAPIFu.ConvToPlain("Phone No.",FALSE);
                                        TelIndex.RESET;
                                        TelIndex.SETCURRENTKEY("Phone No.");
                                        TelIndex.SETRANGE("Phone No.",PhoneNo);
                                        TelIndex.SETRANGE("Table of origin", 5050);
                                        TelIndex.SETFILTER("No. of origin", '<>%1',"No.");
                                  // AT2009 BEGIN
                                        IF TAPIEinr."Check of double numbers" = TAPIEinr."Check of double numbers"::"only unblocked numbers" THEN
                                          TelIndex.SETRANGE(Blocked, FALSE);
                                  // AT2009 END
                                        IF TelIndex.FIND('-') THEN BEGIN
                                          Hinw.INIT;
                                          LfdNr := LfdNr + 1;
                                          Hinw."Lfd.Nr." := LfdNr;
                                          Hinw.Text := STRSUBSTNO(Text1012, "No.", "Phone No.",
                                            TABLECAPTION, TelIndex."No. of origin");
                                          Hinw.INSERT;
                                        END;
                                      END;

                                  // Check for Double for Mobile Phone No. in the same table
                                  // Dubletten-PrÅfung fÅr Mobiltelefonnr. in der gleichen Tabelle
                                      IF "Mobile Phone No." <> '' THEN BEGIN
                                        IF ("Mobile Phone No." = "Phone No.") THEN BEGIN
                                          Hinw.INIT;
                                          LfdNr := LfdNr + 1;
                                          Hinw."Lfd.Nr." := LfdNr;
                                          Hinw.Text := STRSUBSTNO(Text1011, "No.");
                                          Hinw.INSERT;
                                        END;
                                        PhoneNo := TAPIFu.ConvToPlain("Mobile Phone No.",FALSE);
                                        TelIndex.RESET;
                                        TelIndex.SETCURRENTKEY("Phone No.");
                                        TelIndex.SETRANGE("Phone No.",PhoneNo);
                                        TelIndex.SETRANGE("Table of origin", 5050);
                                        TelIndex.SETFILTER("No. of origin", '<>%1',"No.");
                                  // AT2009 BEGIN
                                        IF TAPIEinr."Check of double numbers" = TAPIEinr."Check of double numbers"::"only unblocked numbers" THEN
                                          TelIndex.SETRANGE(Blocked, FALSE);
                                  // AT2009 END
                                        IF TelIndex.FIND('-') THEN BEGIN
                                          Hinw.INIT;
                                          LfdNr := LfdNr + 1;
                                          Hinw."Lfd.Nr." := LfdNr;
                                          Hinw.Text := STRSUBSTNO(Text1012, "No.", "Mobile Phone No.",
                                            TABLECAPTION, TelIndex."No. of origin");
                                          Hinw.INSERT;
                                        END;
                                      END;

                                  // AT2009 BEGIN
                                    END;
                                  // AT2009 END

                                    TelIndex.RESET;
                                    TelIndex.SETRANGE("Table of origin", 5050);
                                    TelIndex.SETRANGE("No. of origin", "No.");
                                    IF TelIndex.FIND('-') THEN
                                      TelIndex.DELETEALL;
                                    TelIndex.RESET;

                                  // AT2011 START
                                    IF ("Phone No." <> '') AND (STRLEN("Phone No.") > TAPIEinr."Min. length fÅr Phoneindex") THEN BEGIN
                                  // AT2011 END
                                      TelIndex.INIT;
                                      TelIndex."Table of origin"   := 5050;
                                      TelIndex."No. of origin"     := "No.";
                                      TelIndex."No. 2 of origin"   := '';
                                      TelIndex."Type of origin"    := TelIndex."Type of origin"::business;
                                      TelIndex."Name of origin"    := Name;
                                      TelIndex."Phone No."         := TAPIFu.ConvToPlain("Phone No.",FALSE);
                                      TelIndex.INSERT;
                                    END;

                                  // AT2011 START
                                    IF ("Mobile Phone No." <> '') AND (STRLEN("Mobile Phone No.") > TAPIEinr."Min. length fÅr Phoneindex") THEN BEGIN
                                  // AT2011 END
                                      TelIndex.INIT;
                                      TelIndex."Table of origin"   := 5050;
                                      TelIndex."No. of origin"     := "No.";
                                      TelIndex."No. 2 of origin"   := '';
                                      TelIndex."Type of origin"    := TelIndex."Type of origin"::mobile;
                                      TelIndex."Name of origin"    := Name;
                                      TelIndex."Phone No."         := TAPIFu.ConvToPlain("Mobile Phone No.",FALSE);
                                      TelIndex.INSERT;
                                    END;

                                  // AT2011 START
                                    IF FormatExistPhonoNo THEN BEGIN
                                      "Phone No." := TAPIFuSi.ConvToCanonic("Phone No.");
                                      "Mobile Phone No." := TAPIFuSi.ConvToCanonic("Mobile Phone No.");
                                      MODIFY;
                                    END;
                                    IF FormatExistFaxNo THEN BEGIN
                                      "Fax No." := TAPIFuSi.ConvToCanonic("Fax No.");
                                      MODIFY;
                                    END;
                                  // AT2011 END

                                  END;
                                END;
                                 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      OnOpenPage=BEGIN
                   HintText := Text1013;
                 END;

    }
    CONTROLS
    {
      { 1000000000;;Container;
                  ContainerType=ContentArea }

      { 1000000001;1;Group  ;
                  GroupType=Group }

      { 1000000004;2;Field  ;
                  CaptionML=[DEU=Mit diesem Report (nur Verarbeitung) wird einmalig zu Beginn der Arbeit mit activeTAPI-Navi der Telefon-Index fÅr die Telefonnummern-Schnellsuche gefÅllt. Optional kînnen die vorhandenen Telefon- und Fax-Nummern formatiert werden.;
                             ENU=When starting to work with activeTAPI-Navi you use this report once (processing only) to fill the Phone Index (fÅr Phone No. Quick Search). Existing Phone / Fax Nos can be formatted.] }

      { 1000000002;2;Field  ;
                  CaptionML=[DEU=Vorhandene Telefonnr. formatieren ?;
                             ENU=Format existing Phone No.?];
                  SourceExpr=FormatExistPhonoNo }

      { 1000000003;2;Field  ;
                  CaptionML=[DEU=Vorhandene Fax Nr. formatieren ?;
                             ENU=Format existing Fax No.?];
                  SourceExpr=FormatExistFaxNo }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Text001@1001 : TextConst 'DEU=Bearbeitet wird;ENU=Working on';
      Text002@1002 : TextConst 'DEU=Debitor;ENU=Customer';
      Text003@1003 : TextConst 'DEU=Kreditor;ENU=Vendor';
      Text004@1004 : TextConst 'DEU=Kontaktperson;ENU=Contact';
      Text005@1006 : TextConst 'DEU=Interessent;ENU=Company';
      Text006@1016 : TextConst 'DEU=Kontakt;ENU=Contact';
      Text1001@1000000007 : TextConst 'DEU=Telefonnummer %1 existiert schon bei %2 %3.;ENU=Phone No. %1 does already exist in %2 %3.';
      Text1002@1000000006 : TextConst 'DEU=Bei Kontaktperson %1, %2 sind Durchwahl-Nr., Mobil-Telefon-Nummer und/oder private Telefonnr. gleich.;ENU=For Contactperson %1, %2 Direct Phone, Mobile Phone No. and /or Private Phone No. are equal.';
      Text1003@1000000005 : TextConst 'DEU=Bei Interessent %1 sind Telefonnr. und Telefon 2 gleich.;ENU=For prospect %1 Phone No. and Phone 2 are equal.';
      Text1004@1000000004 : TextConst 'DEU=Bei Kontaktperson %1, %2 sind Durchwahl-Nr., Mobil-Telefon-Nummer und/oder private Telefonnr. gleich.;ENU=For Contact %1, %2 Direct Phone, Mobile Phone No. and /or Private Phone No. are equal.';
      Text1005@1000000003 : TextConst 'DEU=Telefonnummer %1 existiert schon bei %2 %3 %4.;ENU=Phone No. %1 does already exist in %2 %3 %4.';
      Text1006@1007 : TextConst 'DEU=Kontaktperson %1, %2: Telefon-Nummer %3 existiert schon bei %4 %5, %6.;ENU=Contactperson %1, %2: Phone No. %3 does already exist for %4 %5, %6.';
      Text1007@1008 : TextConst 'DEU=Interessent %1: Telefon-Nummer %2 existiert schon bei %3 %4.;ENU=Prospect %1: Phone No. %2 does already exist for %3 %4.';
      Text1008@1009 : TextConst 'DEU="%1 %2: %3 %4 existiert schon bei %5 %6. ";ENU=%1 %2: %3 %4 does already exist for %5 %6.';
      Text1009@1010 : TextConst 'DEU=Bei Debitor %1 sind Telefonnr., Telefonnr. 2 und/oder Mobiltelefonnr. gleich.';
      ATPhoneNumber@1113900000 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{8760C1F1-E05B-4764-9D01-6E192C0F3BC1}:'activeTAPI-Telephony'.PhoneNumber";
      Hinw@1014 : Record 56785;
      TelInd@1013 : Record 56781;
      TelIndex@1012 : Record 56781;
      TAPIFu@1005 : Codeunit 56780;
      TAPIFuSi@1108800002 : Codeunit 56782;
      Window@1015 : Dialog;
      PhoneNo@1011 : Text[30];
      LfdNr@1000 : Integer;
      Text1010@1000000000 : TextConst 'DEU=FÅr Benutzer %1 ist keine Telefonie eingerichtet.;ENU=For User %1 there exists no Phone Setup.';
      Text1011@1017 : TextConst 'DEU=Bei Kontakt %1 sind Telefonnr. und Mobil-Telefon-Nummer gleich.;ENU=For Contact %1 Phone No. and Mobile Phone No. are equal.';
      Text1012@1018 : TextConst 'DEU=Kontakt %1: Telefon-Nummer %2 existiert schon bei %3 %4.;ENU=Contact %1: Phone No. %2 does already exist for %3 %4.';
      TAPIEinr@1000000001 : Record 56782;
      FormatExistPhonoNo@1108800000 : Boolean;
      FormatExistFaxNo@1108800001 : Boolean;
      Text1013@1000000008 : TextConst 'DEU=Mit diesem Report (nur Verarbeitung) wird einmalig zu Beginn der Arbeit mit activeTAPI-Navi der Telefon-Index fÅr die Telefonnummern-Schnellsuche gefÅllt. Optional kînnen die vorhandenen Telefon- und Fax-Nummern formatiert werden.;ENU=When starting to work with activeTAPI-Navi you use this report once (processing only) to fill the Phone Index (fÅr Phone No. Quick Search). Existing Phone / Fax Nos can be formatted.';
      HintText@1000000009 : Text[300];

    BEGIN
    {
      AT01.20     25.09.2003  New (second) parameter for Function ConvToPlain
      AT01.20a    13.03.2008  New Connection with Automation objects
      AT2009      06.11.2009  Check double Numbers options; Fill new field "Blocked"
      AT2011      05.04.2011  Option Format existing numbers Phone / Fax
                              Check Min. length fÅr Phoneindex
      AT2013      11.05.2013  Adapted to 2013
      AT2015      02.12.2014  Adapted to 2015, Request Page added
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 56781 Update TAPI Lines
{
  OBJECT-PROPERTIES
  {
    Date=15.01.17;
    Time=12:00:00;
    Modified=Yes;
    Version List=AT2013;
  }
  PROPERTIES
  {
    CaptionML=[DEU=TAPI Leitungen aktualisieren;
               ENU=Update TAPI Lines];
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  TapiFu.UpdateLines;
                END;

    UseRequestPage=No;
  }
  DATASET
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      TapiFu@1000000000 : Codeunit 56780;

    BEGIN
    {
      AT04.00             New report
                          to be used in the MenuSuite
      AT2013  11.05.2013  To be used in Departments
                          Caption added
                          Adapted to 2013
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 56782 Delete TAPI Logfile
{
  OBJECT-PROPERTIES
  {
    Date=15.01.17;
    Time=12:00:00;
    Modified=Yes;
    Version List=AT2013;
  }
  PROPERTIES
  {
    Permissions=TableData 56780=rd;
    CaptionML=[DEU=TAPI Logbuch lîschen;
               ENU=Delete TAPI Logfile];
    ProcessingOnly=Yes;
    OnPostReport=BEGIN
                   COMMIT;
                 END;

  }
  DATASET
  {
    { 5477;    ;DataItem;                    ;
               DataItemTable=Table56780;
               OnAfterGetRecord=BEGIN
                                  DELETE;
                                END;

               ReqFilterFields=Date,User,Direction,External }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {

    BEGIN
    {
      AT2011  05.04.2011  Created
      AT2013  11.05.2013  Adapted to 2013
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Codeunit 56780 TAPI Functions
{
  OBJECT-PROPERTIES
  {
    Date=17.08.19;
    Time=19:00:00;
    Modified=Yes;
    Version List=AO,AT2018;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Text001@1003 : TextConst 'DEU=%1 %2: Telefonnummer %3 existiert schon bei %4 %5.;ENU=Phone No. %1 does already exist in %2 %3.';
      Text002@1004 : TextConst 'DEU=Bei Kontakt %1 sind Durchwahl-Nr., Mobil-Telefon-Nummer und/oder private Telefonnr. gleich.;ENU=For Contact %1 Direct Phone, Mobile Phone No. and /or Private Phone No. are equal.';
      Text003@1011 : TextConst 'DEU=Bei Interessent %1 sind Telefonnr. und Telefon 2 gleich.;ENU=For prospect %1 Phone No. and Phone 2 are equal.';
      Text004@1012 : TextConst 'DEU=Bei Kontakt %1, %2 sind Durchwahl-Nr., Mobil-Telefon-Nummer und/oder private Telefonnr. gleich.;ENU=For Contact %1, %2 Direct Phone, Mobile Phone No. and /or Private Phone No. are equal.';
      Text005@1013 : TextConst 'DEU=%1 %2, %3: Telefonnummer %4 existiert schon bei %5 %6, %7.;ENU=Phone No. %1 does already exist in %2 %3 %4.';
      ATTelephony@1033 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{7D58078D-E0FB-4D64-9829-B909B8F6D8F6}:'activeTAPI-Telephony'.Telephony";
      ATEventSource@1113900014 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{206D2787-8575-4750-A727-38FC5DBFA1A3}:'activeTAPI-Telephony'.EventSource";
      ATPhoneNumber@1005 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{8760C1F1-E05B-4764-9D01-6E192C0F3BC1}:'activeTAPI-Telephony'.PhoneNumber";
      ATDevices@1000000008 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{58F30A7B-2AAB-46EC-86C1-D8EF887CD1CB}:'activeTAPI-Telephony'.Devices";
      AppTrace@1113900001 : Automation "{600E23A8-24BF-43EE-BA93-691E0DFFAD1A} 2.0:{1B61767C-91A3-4632-9E92-A8C29C7DA936}:'activeTAPI_NET_Services'.AppTrace";
      ATConfiguration@1113900007 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{1000FBBF-6480-40B4-B257-F077F04F59CF}:'activeTAPI-Telephony'.Configuration";
      ActiveCalls@1113900006 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{233EE8A5-8A5D-40B2-BF4B-8EE5E9A793F7}:'activeTAPI-Telephony'.ActiveCalls";
      WSHShell@1113900011 : Automation "{F935DC20-1CF0-11D0-ADB9-00C04FD58A0B} 1.0:{72C24DD5-D70A-438B-8A42-98424B88AFB8}:'Windows Script Host Object Model'.WshShell";
      TAPILog@1028 : Record 56780;
      TelIndex@1000 : Record 56781;
      Cust@1015 : Record 18;
      Vend@1014 : Record 23;
      ContAtt@1009 : Record 5050;
      Cont@1113900002 : Record 5050;
      UserSetup@1008 : Record 91;
      TAPIUser@1007 : Record 56783;
      TAPIEinr@1029 : Record 56782;
      TAPILine@1000000014 : Record 56784;
      ContBusRel@1000000017 : Record 5054;
      TempSegmentLine@1000000015 : TEMPORARY Record 5077;
      InteractionTmplSetup@1000000018 : Record 5122;
      ShortShowPage@1113900018 : Page 56781;
      PhoneNoFoundPage@1113900039 : Page 56780;
      PhoneNoNotFoundPage@1113900037 : Page 56786;
      EndOfCallInPage@1113900035 : Page 56788;
      EndOfCallOutPage@1113900033 : Page 56789;
      TAPIFu@1000000004 : Codeunit 56780;
      TAPIFuSI@1000000019 : Codeunit 56782;
      PhoneNo@1002 : Text[30];
      GUIDTemp@1016 : Text[40];
      InID@1018 : Text[30];
      CallerIDName@1023 : Text[50];
      TempText@1027 : Text[30];
      UserInfo1Alt@1000000003 : Text[120];
      PlainNo@1006 : Text[30];
      InputNo@1001 : Text[30];
      LineName@1000000013 : Text[1000];
      RemoteID@1113900000 : Text[30];
      RemoteIDPlain@1113900017 : Text[30];
      StateRoughHex@1113900010 : Text[8];
      p@1022 : Integer;
      ActionIncom@1026 : Integer;
      NoOfCalls@1031 : Integer;
      EntryNo@1034 : Integer;
      TestNo@1000000005 : Integer;
      Text006@1000000006 : TextConst 'DEU=Der Benutzer %1 ist nicht fÅr Telefonie eingerichtet.;ENU=User %1 has no Setup for TAPI Phoning.';
      Text007@1000000007 : TextConst 'DEU=Der Benutzer %1 ist nur fÅr Pflege Telefon-Index eingerichtet, nicht fÅr Telefonie generell.;ENU=User %1 is only allowed to update the Phone Index, not to use TAPI Phoning in general.';
      Text008@1010 : TextConst 'DEU=Bei Kontakt %1 sind Telefonnr. und Mobil-Telefon-Nummer gleich.;ENU=For Contact %1 Phone No. and Mobile Phone No. are equal.';
      Text009@1021 : TextConst 'DEU=%1 %2: Telefonnummer %3 existiert schon bei %4 %5.;ENU=%1 %2: Phone No. %3 does already exist in %4 %5.';
      LineEntryNo@1000000011 : Integer;
      i@1000000010 : Integer;
      MaxAnz@1000000009 : Integer;
      StatRough@1113900003 : Integer;
      StateRoughInt@1113900008 : Integer;
      Outgoing@1113900004 : Boolean;
      TAPILogFound@1000000012 : Boolean;
      Found@1113900005 : Boolean;
      TimeTemp@1113900009 : Time;
      ProgrRun@1113900012 : Text[180];
      Opt@1113900013 : Text[30];

    PROCEDURE PhoneIndexCust@3(Cust@1000 : Record 18);
    BEGIN
      // AT01.20 BEGIN
      TAPIEinr.GET;
      TAPIEinr.TESTFIELD("Min. length fÅr Phoneindex");
      // AT01.20 END

      // AT2009 INSERTED
      IF TAPIEinr."Check of double numbers" = TAPIEinr."Check of double numbers"::never THEN BEGIN
      END ELSE BEGIN
      // AT2009 END

      // Check for Double for Phone No. in the same table
      // Dubletten-PrÅfung fÅr Telefonnr. in gleicher Tabelle
        IF Cust."Phone No." <> '' THEN BEGIN
          PhoneNo := ConvToPlain(Cust."Phone No.",FALSE);
          TelIndex.RESET;
          TelIndex.SETCURRENTKEY("Phone No.");
          TelIndex.SETRANGE("Phone No.",PhoneNo);
          TelIndex.SETRANGE("Table of origin", 18);
          TelIndex.SETFILTER("No. of origin", '<>%1',Cust."No.");
      // AT2009 INSERTED
          IF TAPIEinr."Check of double numbers" = TAPIEinr."Check of double numbers"::"only unblocked numbers" THEN
            TelIndex.SETRANGE(Blocked, FALSE);
      // AT2009 END
          IF TelIndex.FIND('-') THEN
            MESSAGE(Text001, Cust.TABLECAPTION, Cust."No.", Cust."Phone No.",
              Cust.TABLECAPTION, TelIndex."No. of origin");
        END;

      // AT2009 INSERTED
      END;
      // AT2009 END

      TelIndex.RESET;
      TelIndex.SETRANGE("Table of origin", 18);
      TelIndex.SETRANGE("No. of origin", Cust."No.");
      IF TelIndex.FIND('-') THEN
        TelIndex.DELETEALL;
      TelIndex.RESET;

      // AT01.20 CHANGED
      IF (Cust."Phone No." <> '') AND
         (STRLEN(ConvToNumber(Cust."Phone No.")) >= TAPIEinr."Min. length fÅr Phoneindex") THEN BEGIN
      // AT2018
        TelIndex.LOCKTABLE;
        TelIndex.INIT;
        TelIndex."Table of origin"   := 18;
        TelIndex."No. of origin"     := Cust."No.";
        TelIndex."No. 2 of origin"   := '';
        TelIndex."Type of origin"    := TelIndex."Type of origin"::business;
        TelIndex."Name of origin"    := Cust.Name;
        TelIndex."Phone No."         := ConvToPlain(Cust."Phone No.",FALSE);
      // AT2009 INSERTED
        IF Cust.Blocked = Cust.Blocked::All THEN
          TelIndex.Blocked           := TRUE
        ELSE
          TelIndex.Blocked           := FALSE;
      // AT 2009 END
        TelIndex.INSERT;
      END;
    END;

    PROCEDURE PhoneIndexVend@4(Vend@1000 : Record 23);
    BEGIN
      // AT01.20 BEGIN
      TAPIEinr.GET;
      TAPIEinr.TESTFIELD("Min. length fÅr Phoneindex");
      // AT01.20 END

      // AT2009 INSERTED
      IF TAPIEinr."Check of double numbers" = TAPIEinr."Check of double numbers"::never THEN BEGIN
      END ELSE BEGIN
      // AT2009 END

      // Check for Double for Phone No. in the same table
      // Dubletten-PrÅfung fÅr Telefonnr. in gleicher Tabelle
        IF Vend."Phone No." <> '' THEN BEGIN
          PhoneNo := ConvToPlain(Vend."Phone No.",FALSE);
          TelIndex.RESET;
          TelIndex.SETCURRENTKEY("Phone No.");
          TelIndex.SETRANGE("Phone No.",PhoneNo);
          TelIndex.SETRANGE("Table of origin", 23);
          TelIndex.SETFILTER("No. of origin", '<>%1',Vend."No.");
      // AT2009 INSERTED
          IF TAPIEinr."Check of double numbers" = TAPIEinr."Check of double numbers"::"only unblocked numbers" THEN
            TelIndex.SETRANGE(Blocked, FALSE);
      // AT2009 END
          IF TelIndex.FIND('-') THEN
            MESSAGE(Text001, Vend.TABLECAPTION, Vend."No.", Vend."Phone No.",
              Vend.TABLECAPTION, TelIndex."No. of origin");
        END;

      // AT2009 INSERTED
      END;
      // AT2009 END

      TelIndex.RESET;
      TelIndex.SETRANGE("Table of origin", 23);
      TelIndex.SETRANGE("No. of origin", Vend."No.");
      IF TelIndex.FIND('-') THEN
        TelIndex.DELETEALL;
      TelIndex.RESET;

      // AT01.20 CHANGED
      IF (Vend."Phone No." <> '') AND
         (STRLEN(ConvToNumber(Vend."Phone No.")) >= TAPIEinr."Min. length fÅr Phoneindex") THEN BEGIN
      // AT2018
        TelIndex.LOCKTABLE;
        TelIndex.INIT;
        TelIndex."Table of origin"    := 23;
        TelIndex."No. of origin"     := Vend."No.";
        TelIndex."No. 2 of origin"   := '';
        TelIndex."Type of origin"    := TelIndex."Type of origin"::business;
        TelIndex."Name of origin"    := Vend.Name;
        TelIndex."Phone No."         := ConvToPlain(Vend."Phone No.",FALSE);
      // AT2009 INSERTED
        IF Vend.Blocked = Vend.Blocked::All THEN
          TelIndex.Blocked           := TRUE
        ELSE
          TelIndex.Blocked           := FALSE;
      // AT 2009 END
        TelIndex.INSERT;
      END;
    END;

    PROCEDURE PhoneIndexCont@11(Cont@1000 : Record 5050);
    BEGIN
      // AT01.20 BEGIN
      TAPIEinr.GET;
      TAPIEinr.TESTFIELD("Min. length fÅr Phoneindex");
      // AT01.20 END

      // AT2009 INSERTED
      IF TAPIEinr."Check of double numbers" = TAPIEinr."Check of double numbers"::never THEN BEGIN
      END ELSE BEGIN
      // AT2009 END

      // Check for Double for Phone No. in the same table
      // Dubletten-PrÅfung fÅr Telefonnr. in gleicher Tabelle
        IF Cont."Phone No." <> '' THEN BEGIN
          IF (Cont."Phone No." = Cont."Mobile Phone No.") THEN
            MESSAGE(Text008, Cont."No.");
          PhoneNo := ConvToPlain(Cont."Phone No.",FALSE);
          TelIndex.RESET;
          TelIndex.SETCURRENTKEY("Phone No.");
          TelIndex.SETRANGE("Phone No.",PhoneNo);
          TelIndex.SETRANGE("Table of origin", 5050);
          TelIndex.SETFILTER("No. of origin", '<>%1',Cont."No.");
      // AT2009 INSERTED
          IF TAPIEinr."Check of double numbers" = TAPIEinr."Check of double numbers"::"only unblocked numbers" THEN
            TelIndex.SETRANGE(Blocked, FALSE);
      // AT2009 END
          IF TelIndex.FIND('-') THEN
            MESSAGE(Text009, Cont.TABLECAPTION, ContAtt."No.",
              Cont."Phone No.", Cont.TABLECAPTION, TelIndex."No. of origin");
        END;

      // Check for Double for Mobile Phone No. in the same table
      // Dubletten-PrÅfung fÅr Mobiltelefonnr. in der gleichen Tabelle
        IF Cont."Mobile Phone No." <> '' THEN BEGIN
          IF (Cont."Mobile Phone No." = Cont."Phone No.") THEN
            MESSAGE(Text008, Cont."No.");
          PhoneNo := ConvToPlain(Cont."Mobile Phone No.",FALSE);
          TelIndex.RESET;
          TelIndex.SETCURRENTKEY("Phone No.");
          TelIndex.SETRANGE("Phone No.",PhoneNo);
          TelIndex.SETRANGE("Table of origin", 5050);
          TelIndex.SETFILTER("No. of origin", '<>%1',Cont."No.");
      // AT2009 INSERTED
          IF TAPIEinr."Check of double numbers" = TAPIEinr."Check of double numbers"::"only unblocked numbers" THEN
            TelIndex.SETRANGE(Blocked, FALSE);
      // AT2009 END
          IF TelIndex.FIND('-') THEN
            MESSAGE(Text009, Cont.TABLECAPTION, ContAtt."No.",
              ContAtt."Mobile Phone No.", Cont.TABLECAPTION, TelIndex."No. of origin");
        END;

      // AT2009 INSERTED
      END;
      // AT2009 END

      TelIndex.RESET;
      TelIndex.SETRANGE("Table of origin", 5050);
      TelIndex.SETRANGE("No. of origin", ContAtt."No.");
      IF TelIndex.FIND('-') THEN
        TelIndex.DELETEALL;
      TelIndex.RESET;

      // AT01.20 CHANGED
      IF (ContAtt."Phone No." <> '') AND
         (STRLEN(ConvToNumber(Cont."Phone No.")) >= TAPIEinr."Min. length fÅr Phoneindex") THEN BEGIN
      // AT2018
        TelIndex.LOCKTABLE;
        TelIndex.INIT;
        TelIndex."Table of origin"   := 5050;
        TelIndex."No. of origin"     := Cont."No.";
        TelIndex."No. 2 of origin"   := '';
        TelIndex."Type of origin"    := TelIndex."Type of origin"::business;
        TelIndex."Name of origin"    := Cont.Name;
        TelIndex."Phone No."         := ConvToPlain(Cont."Phone No.",FALSE);
        TelIndex.INSERT;
      END;

      // AT01.20 CHANGED
      IF (Cont."Mobile Phone No." <> '') AND
         (STRLEN(ConvToNumber(Cont."Mobile Phone No.")) >= TAPIEinr."Min. length fÅr Phoneindex") THEN BEGIN
      // AT2018
        TelIndex.LOCKTABLE;  TelIndex.INIT;
        TelIndex."Table of origin"   := 5050;
        TelIndex."No. of origin"     := Cont."No.";
        TelIndex."No. 2 of origin"   := '';
        TelIndex."Type of origin"    := TelIndex."Type of origin"::mobile;
        TelIndex."Name of origin"    := Cont.Name;
        TelIndex."Phone No."         := ConvToPlain(Cont."Mobile Phone No.",FALSE);
        TelIndex.INSERT;
      END;
    END;

    PROCEDURE ConvToPlain@2(PhoneNo@1000 : Text[30];LeadAccCode@1001 : Boolean) : Text[30];
    BEGIN
      IF PhoneNo = '' THEN
        EXIT('')
      ELSE BEGIN

      IF ISCLEAR(ATPhoneNumber) THEN
        CREATE(ATPhoneNumber,TRUE,TRUE);

      { Leading Access Code:
        FALSE: The Phone Number does not start with a leading access code (outbound or User input)
        TRUE: The Phone Number can start with a leading access code, depending on telephone device.
        Refer to activeTAPI.cfg, leading access code value: It depends on the behavior of your telephone (system)
      }
        IF NOT LeadAccCode THEN
          ATPhoneNumber.Initialize(PhoneNo,FALSE)
        ELSE
          ATPhoneNumber.Initialize(PhoneNo);
        PlainNo := ATPhoneNumber.PlainNumber;

        CLEAR(ATPhoneNumber);
        EXIT(PlainNo);
      END;
    END;

    PROCEDURE Dial@5(VerwTab@1000 : Integer;VerwKey1@1001 : Code[20];VerwKey2@1002 : Code[20];VerwArt@1003 : Integer);
    VAR
      LfdNr@1004 : Integer;
    BEGIN
      // Function for create outgoing call: Called from Customer-, Vendor-, Prospect- and Contactperson-Card
      // Funktion zum WÑhlen (ausgehend): Aufgerufen von Debitor-, Kreditor-, Interessenten- und Kontakt-Karte

      TestNo := TAPIFu.TAPIRights;
      IF TestNo < 2 THEN BEGIN
        TAPIFu.TAPINotReadyMessage(TestNo);
        EXIT;
      END;

      // AT2011 CHANGED
      IF ISCLEAR(ATTelephony) THEN
        CREATE(ATTelephony,TRUE,TRUE);
      // AT2011 END

      CASE VerwTab OF
      // Customer / Debitor
        18:
          BEGIN
            IF Cust.GET(VerwKey1) THEN
              IF Cust."Phone No." <> '' THEN
                ATTelephony.MakeCall(Cust."Phone No.");
          END;
      // Vendor / Kreditor
        23:
          BEGIN
            IF Vend.GET(VerwKey1) THEN
              IF Vend."Phone No." <> '' THEN
                ATTelephony.MakeCall(Vend."Phone No.");
          END;
      // Kontakt / Contact
        5050:
          BEGIN
            IF ContAtt.GET(VerwKey1) THEN BEGIN
              CASE VerwArt OF
                // Phone No. / Telefonnr.
                0: BEGIN
                     IF ContAtt."Phone No." <> '' THEN
                       ATTelephony.MakeCall(ContAtt."Phone No.");
                   END;
                // Mobile Phone No. / Mobile Telefonnr.
                2: BEGIN
                     IF ContAtt."Mobile Phone No." <> '' THEN
                       ATTelephony.MakeCall(ContAtt."Mobile Phone No.");
                   END;
              END;
            END;
          END;
      END;

      CLEAR(ATTelephony);
    END;

    PROCEDURE PhoneNoFindAgain@7(PhoneNo@1000 : Text[30]);
    BEGIN
      IF TAPIFu.TAPIRights < 2 THEN
        EXIT;

      GUIDTemp := '';
      IF TAPIUser.GET(USERID) THEN
        GUIDTemp := TAPIUser.GUIDTemp;

      TAPILogFound := FALSE;
      IF GUIDTemp <> '' THEN
        IF TAPILog.GET(GUIDTemp) THEN
          TAPILogFound := TRUE;

      InID := ConvToPlain(PhoneNo,FALSE);

      TelIndex.SETRANGE("Phone No.",InID);

      IF TelIndex.FIND('-') THEN BEGIN
        // If necessary update TAPILog / Wenn erforderlich TAPILog aktualisieren
        IF TAPILogFound THEN BEGIN
          // Update UserInfo / UserInfo aktualisieren
          UserInfo1Alt := TAPILog.UserInfo1;
          CallerIDName := TelIndex."Name of origin" ;
          p := STRPOS(UserInfo1Alt,'|');
            UserInfo1Alt := DELCHR(CallerIDName,'<>') +
              COPYSTR(UserInfo1Alt,p,MAXSTRLEN(UserInfo1Alt)- p + 1);
          TAPILog.UserInfo1 := UserInfo1Alt;
          TAPILog."Table of origin" := TelIndex."Table of origin";
          TAPILog."No. of origin" := TelIndex."No. of origin";
          TAPILog."No. 2 of origin" := TelIndex."No. 2 of origin";
          TAPILog."Name of origin" := TelIndex."Name of origin";
          IF TAPILog.Direction = TAPILog.Direction::"in" THEN BEGIN
            TAPILog."Caller ID" := PhoneNo;
            TAPILog."Caller ID Name" := TelIndex."Name of origin";
          END ELSE BEGIN
            TAPILog."Called ID" := PhoneNo;
            TAPILog."Called ID Name" := TelIndex."Name of origin";
          END;
          TAPILog.MODIFY;
        END;

        // Incoming call, Phone No. found in Phone-Index -> Action for incoming call
        // Eingehender Anruf, Telefonnr. gefunden in Telefon-Index -> Aktion bei eingehendem Anruf
        ActionIncom := 0;
        IF TAPIUser."Action for incoming call" > 0 THEN
          ActionIncom := TAPIUser."Action for incoming call"
        ELSE
          ActionIncom := TAPIEinr."Action for incoming call";
        CASE ActionIncom OF
          // Short Show / Kurzanzeige
          1:
            BEGIN
              CLEAR(ShortShowPage);
              ShortShowPage.DefVar(TelIndex."Name of origin",
                               PhoneNo,
                               TelIndex."Table of origin",
                               TelIndex."No. of origin",
                               TelIndex."No. 2 of origin");
              ShortShowPage.RUN;
            END;
          // Show Origin / Herkunft anzeigen
          2:
            BEGIN
              CASE TelIndex."Table of origin" OF
                // Customer / Debitor
                18:
                  BEGIN
                    IF Cust.GET(TelIndex."No. of origin") THEN
      // AT2013 CHANGED
                      PAGE.RUN(21,Cust,Cust.Name);
                  END;
                // Vendor / Kreditor
                23:
                  BEGIN
                    IF Vend.GET(TelIndex."No. of origin") THEN
      // AT2013 CHANGED
                      PAGE.RUN(26,Vend,Vend.Name);
                  END;
                // Contact / Kontakt)
                5050:
                  BEGIN
                    IF ContAtt.GET(TelIndex."No. of origin") THEN
      // AT2013 CHANGED
                      PAGE.RUN(5050,ContAtt,ContAtt.Name);
                  END;
              END;
            END;
          // Show Menu Phone No. found / Auswahl Telefonnr. gefunden anzeigen
          3:
            BEGIN
              CLEAR(PhoneNoFoundPage);
              PhoneNoFoundPage.DefVar(TelIndex."Name of origin",
                                  PhoneNo,
                                  TelIndex."Table of origin",
                                  TelIndex."No. of origin",
                                  TelIndex."No. 2 of origin");
              PhoneNoFoundPage.RUN;
            END;
        END;
      END ELSE BEGIN
        // Incoming call, Phone No. not found in Phone-Index -> alternatively open Contact-Card
        //   (only if not internal)
        // Eingehender Anruf, Telefonnr. nicht gefunden in Telefon-Index -> wahlweise Kontakt-Karte îffnen
        //   (nur wenn kein interner Anruf)
        IF STRLEN(InID) > TAPIEinr."Length of internal phone No." THEN BEGIN
          CASE TAPIUser."Action for new ext. Phone No." OF
            // Show Contact Card / Interessenten-Karte anzeigen
            1:
              BEGIN
      // AT2013 CHANGED
                PAGE.RUN(5001);
              END;
            // Show Menu Phone No. not found / Auswahl Telefonnr. nicht gefunden anzeigen
            2: BEGIN
                 CLEAR(PhoneNoNotFoundPage);
                 PhoneNoNotFoundPage.DefVar(PhoneNo);
                 PhoneNoNotFoundPage.RUN;
               END;
          END;
        END;
      END;
    END;

    PROCEDURE TAPIRights@1000000002() : Integer;
    BEGIN
      // On every Navision PC activeTAPI-Navi must be installed
      // Auf jedem Navision PC mu· activeTAPI-Navi installiert sein

      // Test User Setup for TAPI-Phoning / Test Benutzer Einrichtung fÅr Telephonie
      // 0: No valid PC Setup and no valid User Setup -> No Phone Functions
      //    keine gÅltige PC und Benutzer-Einrichtung -> Keine Telefonie-Funktionen
      // 2: Only valid User Setup -> Line from User
      //    Nur gÅltige Benutzer Einrichtung -> Leitung vom Benutzer

      TAPIEinr.GET;
      TestNo := 0;

      // Test for User / Test fÅr Benutzer
      IF UserSetup.GET(USERID) THEN BEGIN
        IF UserSetup."Use activeTAPI" THEN BEGIN
          IF TAPIUser.GET(USERID) THEN BEGIN
            IF (NOT TAPIUser.Blocked) THEN BEGIN
              IF TAPIUser."TAPI line name" <> '' THEN
                TestNo := TestNo + 2
              ELSE
                IF TAPIEinr."TAPI line name" <> '' THEN
                  TestNo := TestNo + 2;
            END;
          END;
        END;
      END;

      EXIT(TestNo);
    END;

    PROCEDURE TAPILineReady@1000000000(No@1000000000 : Integer) : Text[50];
    BEGIN
      // No = 2: Take line from User
      // No = 2: Leitung des Benutzers zurÅckgeben

      TAPIEinr.GET;
      CASE No OF
        // Line of the user / Leitung des Benutzers
        2: BEGIN
             TAPIUser.INIT;
             IF TAPIUser.GET(USERID) THEN ;
             IF TAPIUser."TAPI line name" = '' THEN
               EXIT('__' + TAPIEinr."TAPI line name")
             ELSE
               EXIT('__' + TAPIUser."TAPI line name");
           END;
      END;
    END;

    PROCEDURE TAPINotReadyMessage@1000000001(No@1000000000 : Integer);
    BEGIN
      CASE No OF
        0: MESSAGE(Text006,USERID);
      END;
    END;

    PROCEDURE DeletePhoneIndex@12(VerwTab@1003 : Integer;VerwKey1@1002 : Code[20];VerwKey2@1001 : Code[20];VerwArt@1000 : Integer);
    VAR
      PhoneIndex@1004 : Record 56781;
    BEGIN
      // Function for deleting phone index: Called from Customer-, Vendor-, Prospect- and Contactperson-Table (OnDelete)
      // Funktion zum lîschen des Tel.-Index: Aufgerufen von Debitor-, Kreditor-, Interessenten- und Kontakt-Tabelle (OnDelete)

      IF (VerwTab <> 0) AND (VerwKey1 <> '') THEN BEGIN
        PhoneIndex.SETRANGE("Table of origin",VerwTab);
        PhoneIndex.SETRANGE("No. of origin",VerwKey1);
        PhoneIndex.DELETEALL;
      //  AT04.00 ERROR CORRECTION: Deleted
      //  PhoneIndex.MODIFY;
      END;
    END;

    PROCEDURE ConvToNumber@9(PhoneNo@1000 : Text[30]) : Text[30];
    BEGIN
      // AT01.20 NEW
      IF PhoneNo = '' THEN
        EXIT('')
      ELSE BEGIN
        CREATE(ATPhoneNumber,TRUE,TRUE);
        ATPhoneNumber.Initialize(PhoneNo);
        InputNo := ATPhoneNumber.SubscriberNumber;
        CLEAR(ATPhoneNumber);
      // AT04.00.02 NEW
        CLEAR(ATPhoneNumber);
      // AT04.00.02 END
        EXIT(InputNo);
      END;
    END;

    PROCEDURE UpdateLines@1000000003();
    VAR
      Text001@1000000008 : TextConst 'DEU=Es wurde(n) %1 Leitung(en) aktualisiert.;ENU=%1 line(s) were updated.';
    BEGIN
      TAPILine.RESET;
      TAPILine.DELETEALL;
      LineEntryNo := 0;

      // AT2015 CHANGED
      IF ISCLEAR(ATTelephony) THEN BEGIN
        CREATE(ATTelephony,TRUE,TRUE);
        ATTelephony.Initialize('NAV Client');
      END;
      // AT2015 END

      ATDevices := ATTelephony.Devices;
      MaxAnz := ATDevices.Count;
      FOR i := 1 TO MaxAnz DO BEGIN
        LineEntryNo := LineEntryNo + 1;
      // AT2018
        TAPILine.LOCKTABLE;
        TAPILine.INIT;
        TAPILine."Entry No." := LineEntryNo;
        LineName := ATDevices.ItemByIndex(i).Name;
        TAPILine."TAPI Line name" := COPYSTR(DELCHR(LineName,'<'),1,50);
        TAPILine.INSERT;
      END;

      // AT2015 INSERTED
      IF NOT ISCLEAR(ATTelephony) THEN BEGIN
        ATTelephony.Terminate;
        CLEAR(ATTelephony);
      END;
      // AT2105 ENDE

      MESSAGE(Text001,MaxAnz);
    END;

    PROCEDURE DialNo@1000000004(PhoneNo@1000000000 : Text[30]);
    BEGIN
      // Function for create outgoing call by Number: Called from Page 56789 End of Call out
      //                                              and Page 56784 TAPI Logs
      // Funktion zum WÑhlen (ausgehend) einer Nummer: Aufgerufen von Page 56789 Abschlu· Telefonat ausgehend
      //                                              und Page 56784 TAPI Protokolle

      IF PhoneNo = '' THEN
        EXIT;

      TestNo := TAPIFu.TAPIRights;
      IF TestNo < 2 THEN BEGIN
        TAPIFu.TAPINotReadyMessage(TestNo);
        EXIT;
      END;

      // AT2011 CHANGED
      IF ISCLEAR(ATTelephony) THEN
        CREATE(ATTelephony,TRUE,TRUE);
      // AT2011 END

      ATTelephony.MakeCall(PhoneNo);

      CLEAR(ATTelephony);
    END;

    PROCEDURE CreateInteractLogEntry@1000000005(NewGUID@1000000006 : Text[40];NewFound@1000000005 : Boolean;NewName@1000000004 : Text[50];NewPhoneNo@1000000003 : Text[30];NewOriginTab@1000000002 : Integer;NewOriginKey1@1000000001 : Code[20];NewOriginKey2@1000000000 : Code[20];Conn@1000000007 : Boolean);
    BEGIN
      // AT2009 INSERTED
      CASE NewOriginTab OF
        // 18
        DATABASE::Customer:
          BEGIN
            ContBusRel.RESET;
            ContBusRel.SETCURRENTKEY("Link to Table","No.");
            ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
            ContBusRel.SETRANGE("No.",NewOriginKey1);
            IF ContBusRel.FIND('-') THEN
              Cont.GET(ContBusRel."Contact No.")
            ELSE
              EXIT;
          END;
        // 23
        DATABASE::Vendor:
          BEGIN
            ContBusRel.RESET;
            ContBusRel.SETCURRENTKEY("Link to Table","No.");
            ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Vendor);
            ContBusRel.SETRANGE("No.",NewOriginKey1);
            IF ContBusRel.FIND('-') THEN
              Cont.GET(ContBusRel."Contact No.")
            ELSE
              EXIT;
          END;
        // 5050
        DATABASE::Contact:
          Cont.GET(NewOriginKey1);
      END;

      IF Cont."No." = '' THEN
        EXIT;

      COMMIT;

      InteractionTmplSetup.GET;
      InteractionTmplSetup.TESTFIELD(InteractionTmplSetup."Outg. Calls");

      CLEAR(TempSegmentLine);

      // AT2018
      TempSegmentLine.LOCKTABLE;
      TempSegmentLine.INIT;

      IF Cont.Type = Cont.Type::Person THEN
        TempSegmentLine.SETRANGE("Contact No.",Cont."No.")
      ELSE
        TempSegmentLine.SETRANGE("Contact Company No.",Cont."Company No.");

      NewPhoneNo := TAPIFuSI.ConvToCanonic(NewPhoneNo);
      IF NewPhoneNo <> '' THEN
        TempSegmentLine."Contact Via" := NewPhoneNo;
      TempSegmentLine.VALIDATE("Contact No.",Cont."No.");
      TempSegmentLine."Contact Name" := Cont.Name;
      IF TempSegmentLine."Contact Name" = '' THEN
        TempSegmentLine."Contact Name" := NewName;
      TempSegmentLine.VALIDATE(Date,TODAY);
      // TempSegmentLine."Mail GUID" := NewGUID;

      TempSegmentLine."Wizard Step" := TempSegmentLine."Wizard Step"::"2";
      TempSegmentLine."Time of Interaction" := TIME;
      IF Conn THEN BEGIN
        TempSegmentLine."Interaction Successful" := TRUE;
        TempSegmentLine."Attempt Failed" := FALSE;
      END ELSE BEGIN
        TempSegmentLine."Interaction Successful" := FALSE;
        TempSegmentLine."Attempt Failed" := TRUE;
      END;
      TempSegmentLine."Dial Contact" := FALSE;
      TempSegmentLine.Description := 'Telefonat activeTAPI';
      TempSegmentLine.INSERT;

      TempSegmentLine.VALIDATE("Interaction Template Code",InteractionTmplSetup."Outg. Calls");

      // AT2013 CHANGED
      PAGE.RUNMODAL(PAGE::"Make Phone Call",TempSegmentLine,TempSegmentLine."Contact Via");

      CLEAR(TempSegmentLine);
      // AT2009 END
    END;

    PROCEDURE HandleCallNew@1113900003(CurrentCall@1113900000 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{88C48794-8E10-434C-8617-60D0817AB5D9}:'activeTAPI-Telephony'.ActiveCall");
    BEGIN
      // AT2011 START
      {
      IF ISCLEAR(AppTrace) THEN
        CREATE(AppTrace,TRUE,TRUE);
      }

      IF ISCLEAR(ATTelephony) THEN
        CREATE(ATTelephony, TRUE, TRUE);
      // AT2011 END

      // No action for function falls (First character = *)
      // Anlagen-Steuerbefehle keine Aktion (1. Stelle = *)
      // AT01.20 CHANGED: ForeignID -> RemoteID

      RemoteID := DELCHR(CurrentCall.RemoteID,'<>');
      IF STRLEN(RemoteID) > 0 THEN
        IF COPYSTR(RemoteID,1,1) = '*' THEN
          EXIT;

      ActiveCalls := ATTelephony.ActiveCalls;
      NoOfCalls := ActiveCalls.Count;
      IF NoOfCalls > 0 THEN
        CurrentCall.UserInfo2 := FORMAT(NoOfCalls);

      // AT2011 BEGIN
      // AppTrace.InfoMessage('Call New: Local ID : ' + DELCHR(CurrentCall.LocalID),'<>'));
      // AppTrace.InfoMessage('Call New: Remote ID: ' + DELCHR(CurrentCall.RemoteID),'<>'));
      // AppTrace.InfoMessage('Call New: Called ID: ' + DELCHR(CurrentCall.CalledID),'<>'));
      // AppTrace.InfoMessage('Call New: Caller ID: ' + DELCHR(CurrentCall.CallerID),'<>'));
      // AT2011 END

      // AT2011 START
      CLEAR(ATTelephony);
      // AT2011 END
    END;

    PROCEDURE HandleCallFinished@1113900001(CurrentCall@1113900000 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{88C48794-8E10-434C-8617-60D0817AB5D9}:'activeTAPI-Telephony'.ActiveCall");
    BEGIN
      // AT01.20 CHANGED: Introduction of RemoteID instead of CallerID/CalledID

      // When call is finished: Log of call / Bei Anrufende in Log schreiben

      Found := FALSE;

      // AT 2011 BEGIN
      // AppTrace.WriteLine('Call Finished: Local ID : ' + DELCHR(CurrentCall.LocalID,'<>'));
      // AppTrace.WriteLine('Call Finished: Remote ID: ' + DELCHR(CurrentCall.RemoteID,'<>'));
      // AppTrace.WriteLine('Call Finished: Called ID: ' + DELCHR(CurrentCall.CalledID,'<>'));
      // AppTrace.WriteLine('Call Finished: Caller ID: ' + DELCHR(CurrentCall.CallerID,'<>'));
      // AT 2011 END

      // No logging for Function Calls (First character = *) / Anlagen-Steuerbefehle nicht loggen (1. Stelle = *)
      RemoteID := DELCHR(CurrentCall.RemoteID,'<>');

      IF STRLEN(RemoteID) > 0 THEN
        IF COPYSTR(RemoteID,1,1) = '*' THEN
          EXIT;

      // No logging for only status Idle (State rough = 1)
      StatRough := CurrentCall.States;
      IF StatRough = 1 THEN
        EXIT;

      // AT2011 INSERT BEGIN
      TAPIEinr.GET;
      IF (STRLEN(RemoteID) <= TAPIEinr."Length of internal phone No.") AND
         (NOT TAPIEinr."Log internal calls") THEN BEGIN
      END ELSE BEGIN
      // AT2011 INSERT END

        TAPILog.RESET;
        TAPILog.SETCURRENTKEY("Entry No.");
        IF TAPILog.FIND('+') THEN
          EntryNo := TAPILog."Entry No."
        ELSE
          EntryNo := 0;

      // AT2018
        TAPILog.RESET;
        TAPILog.LOCKTABLE;
        TAPILog.INIT;
        TAPILog."Key local" := CurrentCall.GUID;
        EntryNo := EntryNo + 1;
        TAPILog."Entry No." := EntryNo;
        TAPILog.INSERT;

        TAPILog.Date := CurrentCall.CallDate;

        // Time als String
        TempText := FORMAT(CurrentCall.CallTimeS);
        IF EVALUATE(TimeTemp,TempText) THEN ;
        TAPILog.Time := TimeTemp;

        TAPILog.User := USERID;
        TAPILog."Duration (Sec.)" := CurrentCall.TimerB;
        StateRoughInt := CurrentCall.States;
      //  StateRoughHex := ATProxyServiceFunctions.DezHex(StateRoughInt);
      //  TAPILog."State (rough)" := StateRoughHex;
        IF CurrentCall.WasConnected THEN
          TAPILog.State := TAPILog.State::connected
        ELSE
          TAPILog.State := TAPILog.State::"not connected";
        TAPILog."Caller ID" := CurrentCall.CallerID;
        TAPILog."Caller ID Name" := CurrentCall.CallerIDName;
        TAPILog."Called ID" := CurrentCall.CalledID;
        TAPILog."Called ID Name" := CurrentCall.CalledIDName;
        IF STRLEN(RemoteID) > TAPIEinr."Length of internal phone No." THEN
          TAPILog.External := TRUE
        ELSE
          TAPILog.External := FALSE;
        TAPILog."Connected ID" := CurrentCall.ConnectedID;
        TAPILog."Connected ID Name" := CurrentCall.ConnectedIDName;
        TAPILog."Redirection ID" := CurrentCall.RedirectionID;
        TAPILog."Redirection ID Name" := CurrentCall.RedirectionIDName;
        TAPILog."Redirecting ID" := CurrentCall.RedirectingID;
        TAPILog."Redirecting ID Name" := CurrentCall.RedirectingIDName;
        TAPILog."Key global" := CurrentCall.CallData;
        TelIndex.RESET;
        TelIndex.SETCURRENTKEY("Phone No.");
        IF CurrentCall.IsInbound THEN
          TAPILog.Direction := TAPILog.Direction::"in"
        ELSE
          TAPILog.Direction := TAPILog.Direction::out;

        TAPILog."Remote ID" := RemoteID;
        TAPILog."Local ID" := CurrentCall.LocalID;
        TAPILog."Local ID Name" := CurrentCall.LocalIDName;

        IF RemoteID <> '' THEN BEGIN
          RemoteIDPlain := TAPIFu.ConvToPlain(RemoteID,TRUE);
          TelIndex.SETRANGE("Phone No.",RemoteIDPlain);
          IF TelIndex.FIND('-') THEN BEGIN
            TAPILog."Remote ID Name" := TelIndex."Name of origin";
            TAPILog."Table of origin" := TelIndex."Table of origin";
            TAPILog."No. of origin" := TelIndex."No. of origin";
            TAPILog."No. 2 of origin" := TelIndex."No. 2 of origin";
            TAPILog."Name of origin" := TelIndex."Name of origin";
            Found := TRUE;
          END;
        END;

        TAPILog.Origin := CurrentCall.Origin;

        TAPILog.MODIFY;

      // AppTrace.InfoMessage('TAPI Log geschrieben');

      // AT2011 INSERT BEGIN
      END;
      // AT2011 INSERT END

      // AT2009 INSERTED
      TAPIUser.INIT;
      IF TAPIUser.GET(USERID) THEN ;
      // AT2009 END

      // Page for End of Call
      // Page fÅr Ende des Telefonats

      // Incoming
      IF CurrentCall.IsInbound THEN BEGIN
      // AT2009 INSERTED
        IF TAPIUser."Action for end of incom. call" = TAPIUser."Action for end of incom. call"::none THEN BEGIN
        END ELSE BEGIN
      // AT2009 END
      // AT2013 CHANGED
          CLEAR(EndOfCallInPage);
          IF Found THEN BEGIN
            EndOfCallInPage.DefVar(TAPILog."Key local", TRUE, TAPILog."Remote ID Name",RemoteID,
              TAPILog."Table of origin", TAPILog."No. of origin", TAPILog."No. 2 of origin");
            EndOfCallInPage.RUN;
          END ELSE BEGIN
            EndOfCallInPage.DefVar(TAPILog."Key local", FALSE, '',RemoteID, 0, '', '');
            EndOfCallInPage.RUN;
          END;
      // AT2012 END
        END;

      // Outgoing
      END ELSE BEGIN
      // AT2009 INSERTED
        IF TAPIUser."Action for end of outgo. call" = TAPIUser."Action for end of outgo. call"::none THEN BEGIN
        END ELSE BEGIN
      // AT2009 END
      // AT2013 CHANGED
          CLEAR(EndOfCallOutPage);
          IF Found THEN BEGIN

      // AppTrace.InfoMessage('Outgoing, Nummer gefunden, Page');

            EndOfCallOutPage.DefVar(TAPILog."Key local", TRUE, TAPILog."Remote ID Name",RemoteID,
              TAPILog."Table of origin", TAPILog."No. of origin", TAPILog."No. 2 of origin");
            EndOfCallOutPage.RUN;

      // AppTrace.InfoMessage('Outgoing, Nummer gefunden, nach Page End of Call');

          END ELSE BEGIN

      // AppTrace.InfoMessage('Outgoing, Nummer nicht gefunden, Page');

            EndOfCallOutPage.DefVar(TAPILog."Key local", FALSE, '',RemoteID, 0, '', '');
            EndOfCallOutPage.RUN;

      // AppTrace.InfoMessage('Outgoing, Nummer nicht gefunden, nach Page End of Call');

          END;
      // AT2013 ENDE
        END;
      END;
    END;

    PROCEDURE HandleLineMessage@1113900002(CurrentCall@1113900000 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{88C48794-8E10-434C-8617-60D0817AB5D9}:'activeTAPI-Telephony'.ActiveCall");
    BEGIN
    END;

    PROCEDURE HandleCallUserInfo@1113900000(CurrentCall@1113900000 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{88C48794-8E10-434C-8617-60D0817AB5D9}:'activeTAPI-Telephony'.ActiveCall";UserInfoBits@1113900001 : Integer);
    BEGIN
      // AT01.20 NEW
      // Change of Remote ID (external Partner ID: In = Caller or Connected ID, Out = Called ID)

      IF UserInfoBits = 8192 THEN BEGIN
      // AT2009 BEGIN
        // AppTrace.InfoMessage('Call User Info: Local ID : ' + DELCHR(CurrentCall.LocalID,'<>'));
        // AppTrace.InfoMessage('Call User Info: Remote ID: ' + DELCHR(CurrentCall.RemoteID,'<>'));
        // AppTrace.InfoMessage('Call User Info: Called ID: ' + DELCHR(CurrentCall.CalledID,'<>'));
        // AppTrace.InfoMessage('Call User Info: Caller ID: ' + DELCHR(CurrentCall.CallerID,'<>'));
      // AT2009 END

        RemoteID := DELCHR(CurrentCall.RemoteID,'<>');
        RemoteIDPlain := TAPIFu.ConvToPlain(RemoteID,TRUE);

        // Search for Remote ID in Phone Index; if found write Name into Remote Name
        Found := FALSE;
        IF STRLEN(RemoteID) > 0 THEN BEGIN
          TelIndex.SETRANGE("Phone No.",RemoteIDPlain);
          IF TelIndex.FIND('-') THEN BEGIN
            CurrentCall.RemoteIDName := TelIndex."Name of origin";
            Found := TRUE;
          END;
        END;

        // Actions

        // No action for function falls (First character = *)
        // Anlagen-Steuerbefehle keine Aktion (1. Stelle = *)

        IF STRLEN(RemoteID) > 0 THEN
          IF COPYSTR(RemoteID,1,1) = '*' THEN
            EXIT;

      // AT2018
        TAPIUser.RESET;
        TAPIUser.LOCKTABLE;
        TAPIUser.SETRANGE(User, USERID);
        IF TAPIUser.FINDSET THEN BEGIN
          TAPIUser.GUIDTemp := CurrentCall.GUID;
          TAPIUser.MODIFY;
        END;
        TAPIUser.RESET;

        IF CurrentCall.Origin = 1 THEN BEGIN
          Outgoing := TRUE;
        END ELSE BEGIN
          Outgoing := FALSE;
        END;

        // In
        IF (NOT Outgoing) THEN BEGIN
          IF Found THEN BEGIN
            // Incoming call, Phone No. found in Phone-Index -> Action for incoming call
            // Eingehender Anruf, Telefonnr. gefunden in Telefon-Index -> Aktion bei eingehendem Anruf

            ActionIncom := 0;
            IF TAPIUser."Action for incoming call" > 0 THEN
              ActionIncom := TAPIUser."Action for incoming call"
            ELSE
              ActionIncom := TAPIEinr."Action for incoming call";
            CASE ActionIncom OF
              // Short Show / Kurzanzeige
              1:
                BEGIN
      // AT2013 CHANGED
                  CLEAR(ShortShowPage);
                  ShortShowPage.DefVar(TelIndex."Name of origin",
                                         RemoteID,
                                         TelIndex."Table of origin",
                                         TelIndex."No. of origin",
                                         TelIndex."No. 2 of origin");
                  ShortShowPage.RUN;
      // AT2013 END
                END;
              // Show Origin / Herkunft anzeigen
              2:
                BEGIN
                  CASE TelIndex."Table of origin" OF
                    // Customer / Debitor
                    18:
                      BEGIN
      // AT2013 CHANGED
                        IF Cust.GET(TelIndex."No. of origin") THEN
                          PAGE.RUN(21,Cust,Cust.Name);
      // AT 2013 ENDE
                      END;
                    // Vendor / Kreditor
                    23:
                      BEGIN
      // AT2013 CHANGED
                        IF Vend.GET(TelIndex."No. of origin") THEN
                          PAGE.RUN(26,Vend,Vend.Name);
      // AT 2013 ENDE
                      END;
                    // Contact / Kontaktperson
                    5050:
                      BEGIN
      // AT2013 CHANGED
                        IF ContAtt.GET(TelIndex."No. of origin") THEN
                          PAGE.RUN(5050,ContAtt,ContAtt.Name);
      // AT2013 ENDE
                      END;
                  END;
                END;
              // Show Menu Phone No. found / Auswahl Telefonnr. gefunden anzeigen
              3:
                BEGIN
      // AT2013 CHANGED
                  CLEAR(PhoneNoFoundPage);
                  PhoneNoFoundPage.DefVar(TelIndex."Name of origin",
                                          RemoteID,
                                          TelIndex."Table of origin",
                                          TelIndex."No. of origin",
                                          TelIndex."No. 2 of origin");
                  PhoneNoFoundPage.RUN;
      // AT2013 ENDE
                END;
            END;
          END ELSE BEGIN
            // Incoming call, Phone No. not found in Phone-Index -> alternatively open Contact-Card
            //   (only if not internal)
            // Eingehender Anruf, Telefonnr. nicht gefunden in Telefon-Index -> wahlweise Kontakt-Karte îffnen
            //   (nur wenn kein interner Anruf)
            IF STRLEN(RemoteID) > TAPIEinr."Length of internal phone No." THEN BEGIN
              CASE TAPIUser."Action for new ext. Phone No." OF
                // Show Contact Card / Interessenten-Karte anzeigen
      // AT2013 CHANGED
                1: PAGE.RUN(5050);
                // Show Menu Phone No. not found / Auswahl Telefonnr. nicht gefunden anzeigen
                2: BEGIN
      // AT2013 BEGIN
                     CLEAR(PhoneNoNotFoundPage);
                     PhoneNoNotFoundPage.DefVar(RemoteID);
                     PhoneNoNotFoundPage.RUN;
                   END;
      // AT2013 END
              END;
            END;
          END;
        END;
      END;
    END;

    PROCEDURE BeginOfTAPI@1113900004();
    BEGIN
      // AT2011 START
      // Start Dialer / Start WÑhlhilfe
      TAPIUser.INIT;
      IF TAPIUser.GET(USERID) THEN BEGIN
        IF (NOT TAPIUser.Blocked) THEN BEGIN
          IF TAPIUser."Start activeTAPI Dialer" THEN BEGIN
            IF TAPIUser."Directory of dialer" <> '' THEN BEGIN
              IF ISCLEAR(WSHShell) THEN
                CREATE(WSHShell, TRUE, TRUE);
              ProgrRun := '"' + TAPIUser."Directory of dialer" + '" /MINIMIZED=1';
              WSHShell.Run(ProgrRun);
      // AT 2015 BEGIN
              IF NOT ISCLEAR(WSHShell) THEN
                CLEAR(WSHShell);
      // AT 2015 END
            END;
          END;
        END;
      END;
      // AT2011 END
    END;

    PROCEDURE EndOfTAPI@1113900005();
    BEGIN
      // AT2011 CHANGED
      // AT01.20 NEW
      // End Dialer / Beenden WÑhlhilfe
      TAPIUser.INIT;
      IF TAPIUser.GET(USERID) THEN BEGIN
        IF TAPIUser."Start activeTAPI Dialer" THEN BEGIN
          IF TAPIUser."Directory of dialer" <> '' THEN BEGIN
            IF ISCLEAR(WSHShell) THEN
              CREATE(WSHShell, TRUE, TRUE);
            ProgrRun := '"' + TAPIUser."Directory of dialer" + '" /EXIT';
            WSHShell.Run(ProgrRun);
      // AT 2015 BEGIN
            IF NOT ISCLEAR(WSHShell) THEN
              CLEAR(WSHShell);
      // AT 2015 END
          END;
        END;
      END;
      // AT2011 CHANGED END

      // AT 2015 BEGIN
      IF NOT ISCLEAR(ATPhoneNumber) THEN
        CLEAR(ATPhoneNumber);
      // AT 2015 ENDE
    END;

    EVENT ATEventSource@1113900014::CallNew@1(CurrentCall@1113900000 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{BA7151F3-8ECC-4507-9F7C-1C38E76F0054}:'activeTAPI-Telephony'._ActiveCall");
    BEGIN
    END;

    EVENT ATEventSource@1113900014::CallFinished@2(CurrentCall@1113900000 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{BA7151F3-8ECC-4507-9F7C-1C38E76F0054}:'activeTAPI-Telephony'._ActiveCall");
    BEGIN
    END;

    EVENT ATEventSource@1113900014::lineMessage@3(CurrentCall@1113900005 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{BA7151F3-8ECC-4507-9F7C-1C38E76F0054}:'activeTAPI-Telephony'._ActiveCall";CallHandleOrLineHandle@1113900004 : Integer;message@1113900003 : Integer;param1@1113900002 : Integer;param2@1113900001 : Integer;param3@1113900000 : Integer);
    BEGIN
    END;

    EVENT ATEventSource@1113900014::CallUserInfo@4(CurrentCall@1113900003 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{BA7151F3-8ECC-4507-9F7C-1C38E76F0054}:'activeTAPI-Telephony'._ActiveCall";UserInfoBits@1113900002 : Integer;OldValue@1113900001 : Text[1024];NewValue@1113900000 : Text[1024]);
    BEGIN
    END;

    EVENT ATEventSource@1113900014::WatchDog@5();
    BEGIN
    END;

    BEGIN
    {
      AT01.20       08.09.2003  BugFix: Return Value of Function "TAPILineReady" changed from Text 30
                                        to Text 50 (possibility of Field overflow)
                                Integration of new field in TAPI Setup: "Min. length fÅr Phoneindex"
                                New Function ConvertToNumber: Gives back Input-Number without any
                                  special signs like ./- etc.
                                New Function ConvertToCanonic: Gives back canonic formatted Input-Number;
                                  can be used for Customer/Vendor/Contact-Phone-Numbers, if
                                  "TAPI Setup"."Format Phone Number" ist set to Yes
                                New Function EndOfTAPI for closing actions like closing Dialer
      AT04.00       04.11.2005  New Function Update Lines
                                Error Correction in DeletePhoneIndex: MODIFY after DELETEALL deleted
                                Correction in EndOfTAPI: Error in changing Company (Mandantenwechsel)
                                  was fixed

      AT04.00.02    15.09.2006  Error correction:
                                1) In Functions ConvToCanonic, ConvToPlain, ConvToNumber:
                                   Add ATTelephony Object and Initialize it
                                2) In Functions for PhoneIndex: Even if a user is not a TAPI-User,
                                   the input/changes in Phone-No-Fields should be stored in the
                                   Phone Index

      AT05.00       16.06.2007  Length of all name-fields changed from 30 to 50
      AT05.00.01    13.03.2008  New Connection with Automation objects
      AT2009        06.11.2009  ConvToCanonic transfered to SI-CU 56782
                                New Global Var TAPIFuSI Codeunit 56782
                                Field "Blocked" in Phone Index (Customer / Vendor)
                                Check for double numbers defined in Setup
                                Option: Create Interaction Log Entry
      AT2011        05.04.2011  Changes for RTC: CREATE, ISSERVICETIER (Dialer)
                                Old Code deleted, AppTrace
                                Transfer from TAPI Main: Handling of Events
                                BeginOfTAPI - called from CU 1
                    08.04.2011  Automation new defined for Handle functions
      AT2011.3      11.10.2011  In TAPILineReady added __ to the TAPI-Drivername
                                Function EndOfTAPI transfered to the end of the function list
      AT2013        11.05.2013  Changes for NAV 2013 (Page)
                                Text "Page" added to all Page-Names
                                ISSERVICETIER deleted
      AT2015        02.12.2014  EndOfTAPI: CLEAR(ATTelephony) transferred to Page 56780
                                CLEAR(WSHShell) (2x)
                    06.02.2015  UpdateLines changed
      AT2018        17.08.2017  Table locking
    }
    END.
  }
}

OBJECT Codeunit 56781 TAPI Event Publishers
{
  OBJECT-PROPERTIES
  {
    Date=20.01.18;
    Time=17:18:26;
    Modified=Yes;
    Version List=AT2017.01;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [Integration]
    PROCEDURE OnCustomerNameChanged@1000056780(VAR Var@1000000000 : Record 18);
    BEGIN
    END;

    [Integration]
    PROCEDURE OnCustomerPhoneNoChanged@1000056781(VAR Rec@1000000000 : Record 18);
    BEGIN
    END;

    [Integration]
    PROCEDURE OnCustomerBlockedChanged@1000056782(VAR Rec@1000000000 : Record 18);
    BEGIN
    END;

    [Integration]
    PROCEDURE OnCustomerFaxNoChanged@1000056783(VAR Rec@1000000000 : Record 18);
    BEGIN
    END;

    [Integration]
    PROCEDURE OnVendorNameChanged@1000056784(VAR Rec@1000000000 : Record 23);
    BEGIN
    END;

    [Integration]
    PROCEDURE OnVendorPhoneNoChanged@1000056785(VAR Rec@1000000000 : Record 23);
    BEGIN
    END;

    [Integration]
    PROCEDURE OnVendorBlockedChanged@1000056786(VAR Rec@1000000000 : Record 23);
    BEGIN
    END;

    [Integration]
    PROCEDURE OnVendorFaxNoChanged@1000056787(VAR Rec@1000000000 : Record 23);
    BEGIN
    END;

    [Integration]
    PROCEDURE OnContactNameChanged@1000056788(VAR Rec@1000056788 : Record 5050);
    BEGIN
    END;

    [Integration]
    PROCEDURE OnContactPhoneNoChanged@1000056789(VAR Rec@1000056789 : Record 5050);
    BEGIN
    END;

    [Integration]
    PROCEDURE OnContactFaxNoChanged@1000056791(VAR Rec@1000056791 : Record 5050);
    BEGIN
    END;

    [Integration]
    PROCEDURE OnContactMobilePhoneNoChanged@1000056792(VAR Rec@1000056792 : Record 5050);
    BEGIN
    END;

    [Integration]
    PROCEDURE OnCustomerPagesDialPhoneNo@1000056793(VAR Rec@1000056793 : Record 18);
    BEGIN
    END;

    [Integration]
    PROCEDURE OnVendorPagesDialPhoneNo@1000056794(VAR Rec@1000000000 : Record 23);
    BEGIN
    END;

    [Integration]
    PROCEDURE OnContactPagesDialPhoneNo@1000056795(VAR Rec@1000000000 : Record 5050);
    BEGIN
    END;

    [Integration]
    PROCEDURE OnContactPagesDialMobilePhoneNo@1000056796(VAR Rec@1000000000 : Record 5050);
    BEGIN
    END;

    [Integration]
    PROCEDURE OnUpdateCustomerFromContact@1000056797(VAR Cust@1000056780 : Record 18;VAR Cont@1000056781 : Record 5050);
    BEGIN
    END;

    [Integration]
    PROCEDURE OnUpdateVendorFromContact@1000056798(VAR Vend@1000056780 : Record 23;VAR Cont@1000056781 : Record 5050);
    BEGIN
    END;

    [Integration]
    PROCEDURE OnUpdateContactFromCustomer@1000056799(VAR Cont@1000056780 : Record 5050;VAR Cust@1000056781 : Record 18);
    BEGIN
    END;

    [Integration]
    PROCEDURE OnUpdateContactFromVendor@1000056800(VAR Cont@1000056780 : Record 5050;VAR Vend@1000056781 : Record 23);
    BEGIN
    END;

    [Integration]
    PROCEDURE OnUpdateContact@1000056801(VAR Rec@1000056780 : Record 5050);
    BEGIN
    END;

    BEGIN
    {
      AT2017      02.11.2016  Event Publishers for activeTAPI
      AT2017.01   16.01.2018  All globals with VAR, nearly all globals named Rec
    }
    END.
  }
}

OBJECT Codeunit 56782 TAPI Functions SI
{
  OBJECT-PROPERTIES
  {
    Date=15.01.17;
    Time=12:00:00;
    Modified=Yes;
    Version List=AO,AT2015;
  }
  PROPERTIES
  {
    SingleInstance=Yes;
    OnRun=BEGIN
            // AT2015 INSERTED
            ATPhoneRunning := FALSE;
            // AT2015 END

            // AT 2015 CHANGED
            IF ISCLEAR(ATTelephony) THEN BEGIN
              IF CREATE(ATTelephony,TRUE,TRUE) THEN BEGIN
                ATTelephony.Initialize('NAV Client');
                IF ISCLEAR(ATPhoneNumber) THEN BEGIN
                  IF CREATE(ATPhoneNumber,TRUE,TRUE) THEN
                    ATPhoneRunning := TRUE;
                END;
              END;
            // AT2015 END
            END;
          END;

  }
  CODE
  {
    VAR
      ATTelephony@1000000001 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{7D58078D-E0FB-4D64-9829-B909B8F6D8F6}:'activeTAPI-Telephony'.Telephony";
      ATPhoneNumber@1000000000 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{8760C1F1-E05B-4764-9D01-6E192C0F3BC1}:'activeTAPI-Telephony'.PhoneNumber";
      ATCountry@1000000003 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{04D52579-095E-4DBC-9444-B87AA4AB73CB}:'activeTAPI-Telephony'.Country";
      CanonicNo@1000000002 : Text[30];
      Text001@1000000004 : TextConst 'DEU=Die Telefonnummer bezieht sich auf Land %1, Region %2.;ENU=The Phone No. belongs to Country %1, Area %2.';
      ATPhoneRunning@1000000005 : Boolean;

    PROCEDURE ConvToCanonic@14(PhoneNo@1000 : Text[30]) : Text[30];
    BEGIN
      // AT2009 BEGIN
      IF PhoneNo = '' THEN
        EXIT('')
      ELSE BEGIN
      // AT2015 INSERTED
        IF ATPhoneRunning THEN BEGIN
      // AT2015 END
          ATPhoneNumber.Initialize(PhoneNo,FALSE);
          CanonicNo := ATPhoneNumber.CanonicNumber;

        { Option START
          If after the input of a Phone Number you want to show to the user the
          country and area of the Phone number you must activate this option;
          Attention: If you have activated Integration of Relationship Management, the message may appear two times:
          f.e.: 1st time from the customer Phone No., 2nd time from the Contact Phone No.
          IF ATPhoneNumber.IsCanonical THEN BEGIN
            ATCountry := ATPhoneNumber.Country;
            MESSAGE(Text001, ATCountry.Name, ATPhoneNumber.AreaName);
          END ELSE BEGIN
            CanonicNo := DELCHR(PhoneNo, '<>') + '|?';
          END;
        Option END}

          EXIT(CanonicNo);
      // AT 2015 INSERTED
        END ELSE
          EXIT(PhoneNo);
      // AT 2015 ENDE
      END;
      // AT2009 END
    END;

    BEGIN
    {
      AT2009      06.11.2009  ConvToCanonic transferred from CU 56780
      AT2011      05.04.2011  Changes for RTC: CREATE
      AT2015      11.02.2015  New Var ATPhoneRunning to avoid RT-Client-Crash, if activeTAPI is not installed (thanks to Heiko)
    }
    END.
  }
}

OBJECT Codeunit 56783 TAPI Event Handler
{
  OBJECT-PROPERTIES
  {
    Date=20.01.18;
    Time=17:37:14;
    Modified=Yes;
    Version List=AT2017.01;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      TAPIFu@1000000000 : Codeunit 56780;
      TAPISetUp@1000000001 : Record 56782;
      TAPIFuSi@1000000002 : Codeunit 56782;
      FileMgmt@1000000003 : Codeunit 419;
      UserSetUp@1000000004 : Record 91;
      Ok@1000000005 : Boolean;
      AppTrace@1000000006 : Automation "{600E23A8-24BF-43EE-BA93-691E0DFFAD1A} 2.0:{1B61767C-91A3-4632-9E92-A8C29C7DA936}:'activeTAPI_NET_Services'.AppTrace";

    [EventSubscriber(Table,18,OnAfterDeleteEvent,"",Skip,Skip)]
    LOCAL PROCEDURE DeletePhoneIndexOnCustomerDelete@1000056780(VAR Rec@1000000000 : Record 18;RunTrigger@1000000001 : Boolean);
    BEGIN
      TAPIFu.DeletePhoneIndex(18, Rec."No.", '', 0);
    END;

    [EventSubscriber(Codeunit,56781,OnCustomerNameChanged,"",Skip,Skip)]
    LOCAL PROCEDURE PhoneIndexCustOnCustomerValidateName@1000056781(VAR Rec@1000000000 : Record 18);
    BEGIN
      // AT2017.01 CHANGED
      TAPIFu.PhoneIndexCust(Rec);
    END;

    [EventSubscriber(Codeunit,56781,OnCustomerPhoneNoChanged,"",Skip,Skip)]
    LOCAL PROCEDURE FormatPhoneNoOnCustomerValidatePhoneNo@1000056782(VAR Rec@1000000001 : Record 18);
    BEGIN
      // AT2017.01 CHANGED
      TAPIFu.PhoneIndexCust(Rec);
      TAPISetUp.GET;
      IF TAPISetUp."Format Phone Numbers" THEN
        Rec."Phone No." := TAPIFuSi.ConvToCanonic(Rec."Phone No.");
    END;

    [EventSubscriber(Codeunit,56781,OnCustomerBlockedChanged,"",Skip,Skip)]
    LOCAL PROCEDURE PhoneIndexCustOnCustomerValidateBlocked@1000056783(VAR Rec@1000000000 : Record 18);
    BEGIN
      // AT2017.01 CHANGED
      TAPIFu.PhoneIndexCust(Rec);
    END;

    [EventSubscriber(Codeunit,56781,OnCustomerFaxNoChanged,"",Skip,Skip)]
    LOCAL PROCEDURE FormatFaxNoOnCustomerValidateFaxNo@1000056784(VAR Rec@1000000000 : Record 18);
    BEGIN
      TAPISetUp.GET;
      IF TAPISetUp."Format Fax Numbers" THEN
        Rec."Fax No." := TAPIFuSi.ConvToCanonic(Rec."Fax No.");
    END;

    [EventSubscriber(Codeunit,40,OnAfterLogInStart,"",Skip,Skip)]
    LOCAL PROCEDURE SetUpTAPIOnLogInStart@1000056785();
    BEGIN
      IF FileMgmt.CanRunDotNetOnClient THEN BEGIN
        // IF ISCLEAR(AppTrace) THEN
        //   CREATE(AppTrace,TRUE,TRUE);
        // AppTrace.InfoMessage('Start AppTrace in CU 40');
        Ok := TRUE;
        IF NOT TAPISetUp.GET THEN
          Ok := FALSE
        ELSE BEGIN
          IF TAPISetUp."Runs in Developer Mode" THEN
            Ok := FALSE;
          IF TAPISetUp."TAPI line name" = '' THEN
            Ok := FALSE;
        END;

        IF NOT UserSetUp.GET(USERID) THEN
          Ok := FALSE
        ELSE
          IF NOT (UserSetUp."Use activeTAPI") THEN
            Ok := FALSE;

        IF Ok THEN
          PAGE.RUN(56785);

        IF (NOT TAPISetUp."Runs in Developer Mode") THEN
          CODEUNIT.RUN(CODEUNIT::"TAPI Functions SI");
      END;
    END;

    [EventSubscriber(Table,23,OnAfterDeleteEvent,"",Skip,Skip)]
    LOCAL PROCEDURE DeletePhoneIndexOnVendorDelete@1000056786(VAR Rec@1000000000 : Record 23;RunTrigger@1000000001 : Boolean);
    BEGIN
      TAPIFu.DeletePhoneIndex(23, Rec."No.", '', 0);
    END;

    [EventSubscriber(Codeunit,56781,OnVendorNameChanged,"",Skip,Skip)]
    LOCAL PROCEDURE PhoneIndexCustOnVendorValidateName@1000056787(VAR Rec@1000000000 : Record 23);
    BEGIN
      TAPIFu.PhoneIndexVend(Rec);
    END;

    [EventSubscriber(Codeunit,56781,OnVendorPhoneNoChanged,"",Skip,Skip)]
    LOCAL PROCEDURE FormatPhoneNoOnVendorValidatePhoneNo@1000056788(VAR Rec@1000000000 : Record 23);
    BEGIN
      TAPIFu.PhoneIndexVend(Rec);
      TAPISetUp.GET;
      IF TAPISetUp."Format Phone Numbers" THEN
        Rec."Phone No." := TAPIFuSi.ConvToCanonic(Rec."Phone No.");
      // AT2017.01 CHANGED
    END;

    [EventSubscriber(Codeunit,56781,OnVendorBlockedChanged,"",Skip,Skip)]
    LOCAL PROCEDURE PhoneIndexCustOnVendorValidateBlocked@1000056789(VAR Rec@1000000000 : Record 23);
    BEGIN
      TAPIFu.PhoneIndexVend(Rec);
    END;

    [EventSubscriber(Codeunit,56781,OnVendorFaxNoChanged,"",Skip,Skip)]
    LOCAL PROCEDURE FormatFaxNoOnVendorValidateFaxNo@1000056790(VAR Rec@1000000000 : Record 23);
    BEGIN
      TAPISetUp.GET;
      IF TAPISetUp."Format Fax Numbers" THEN
        Rec."Fax No." := TAPIFuSi.ConvToCanonic(Rec."Fax No.");
    END;

    [EventSubscriber(Table,5050,OnAfterDeleteEvent,"",Skip,Skip)]
    LOCAL PROCEDURE DeletePhoneIndexOnContactDelete@1000056791(VAR Rec@1000000000 : Record 5050;RunTrigger@1000000001 : Boolean);
    BEGIN
      TAPIFu.DeletePhoneIndex(5050, Rec."No.", '', 0);
    END;

    [EventSubscriber(Codeunit,56781,OnContactNameChanged,"",Skip,Skip)]
    LOCAL PROCEDURE PhoneIndexContOnContactValidateName@1000056792(VAR Rec@1000000000 : Record 5050);
    BEGIN
      TAPIFu.PhoneIndexCont(Rec);
    END;

    [EventSubscriber(Codeunit,56781,OnContactPhoneNoChanged,"",Skip,Skip)]
    LOCAL PROCEDURE FormatPhoneNoOnContactValidatePhoneNo@1000056793(VAR Rec@1000000000 : Record 5050);
    BEGIN
      TAPIFu.PhoneIndexCont(Rec);
      TAPISetUp.GET;
      IF TAPISetUp."Format Phone Numbers" THEN
        Rec."Phone No." := TAPIFuSi.ConvToCanonic(Rec."Phone No.");
      // AT2017.01 CHANGED
    END;

    [EventSubscriber(Codeunit,56781,OnContactFaxNoChanged,"",Skip,Skip)]
    LOCAL PROCEDURE FormatFaxNoOnContactValidateFaxNo@1000056795(VAR Rec@1000000000 : Record 5050);
    BEGIN
      TAPISetUp.GET;
      IF TAPISetUp."Format Fax Numbers" THEN
        Rec."Fax No." := TAPIFuSi.ConvToCanonic(Rec."Fax No.");
    END;

    [EventSubscriber(Codeunit,56781,OnContactMobilePhoneNoChanged,"",Skip,Skip)]
    LOCAL PROCEDURE FormatPhoneNoOnContactValidateMobilePhoneNo@1000056796(VAR Rec@1000000000 : Record 5050);
    BEGIN
      TAPIFu.PhoneIndexCont(Rec);
      TAPISetUp.GET;
      IF TAPISetUp."Format Phone Numbers" THEN
        Rec."Mobile Phone No." := TAPIFuSi.ConvToCanonic(Rec."Mobile Phone No.");
      // AT2017.01 CHANGED
    END;

    [EventSubscriber(Codeunit,56781,OnCustomerPagesDialPhoneNo,"",Skip,Skip)]
    LOCAL PROCEDURE DialCustomerPhoneNoOnCustomerPages@1000056797(VAR Rec@1000000000 : Record 18);
    BEGIN
      TAPIFu.Dial(18, Rec."No.", '', 0);
    END;

    [EventSubscriber(Codeunit,56781,OnVendorPagesDialPhoneNo,"",Skip,Skip)]
    LOCAL PROCEDURE DialVendorPhoneNoOnVendorPages@1000056798(VAR Rec@1000000000 : Record 23);
    BEGIN
      TAPIFu.Dial(23, Rec."No.", '', 0);
    END;

    [EventSubscriber(Codeunit,56781,OnContactPagesDialPhoneNo,"",Skip,Skip)]
    LOCAL PROCEDURE DialContactPhoneNoOnContactPages@1000056799(VAR Rec@1000000000 : Record 5050);
    BEGIN
      TAPIFu.Dial(5050, Rec."No.", '', 0);
    END;

    [EventSubscriber(Codeunit,56781,OnContactPagesDialMobilePhoneNo,"",Skip,Skip)]
    LOCAL PROCEDURE DialContactMobilePhoneNoOnContactPages@1000056800(VAR Rec@1000000000 : Record 5050);
    BEGIN
      TAPIFu.Dial(5050, Rec."No.", '', 2);
    END;

    [EventSubscriber(Codeunit,56781,OnUpdateCustomerFromContact,"",Skip,Skip)]
    LOCAL PROCEDURE UpdateCustomerFromContact@1000056801(VAR Cust@1000000000 : Record 18;VAR Cont@1000000001 : Record 5050);
    BEGIN
      IF Cust."Phone No." <> Cont."Phone No." THEN BEGIN
        Cust.VALIDATE("Phone No.");
        Cust.MODIFY;
      END;
    END;

    [EventSubscriber(Codeunit,56781,OnUpdateVendorFromContact,"",Skip,Skip)]
    LOCAL PROCEDURE UpdateVendorFromContact@1000056802(VAR Vend@1000000000 : Record 23;VAR Cont@1000000001 : Record 5050);
    BEGIN
      IF Vend."Phone No." <> Cont."Phone No." THEN BEGIN
        Vend.VALIDATE("Phone No.");
        Vend.MODIFY;
      END;
    END;

    [EventSubscriber(Codeunit,56781,OnUpdateContactFromCustomer,"",Skip,Skip)]
    LOCAL PROCEDURE UpdateContactFromCustomer@1000056803(VAR Cont@1000000000 : Record 5050;VAR Cust@1000000001 : Record 18);
    BEGIN
      IF Cont."Phone No." <> Cust."Phone No." THEN BEGIN
        Cont.VALIDATE("Phone No.");
        Cont.MODIFY;
      END;
    END;

    [EventSubscriber(Codeunit,56781,OnUpdateContactFromVendor,"",Skip,Skip)]
    LOCAL PROCEDURE UpdateContactFromVendor@1000056804(VAR Cont@1000000000 : Record 5050;VAR Vend@1000000001 : Record 23);
    BEGIN
      IF Cont."Phone No." <> Vend."Phone No." THEN BEGIN
        Cont.VALIDATE("Phone No.");
        Cont.MODIFY;
      END;
    END;

    [EventSubscriber(Codeunit,56781,OnUpdateContact,"",Skip,Skip)]
    LOCAL PROCEDURE UpdateContact@1000056805(VAR Rec@1000000000 : Record 5050);
    BEGIN
      Rec.VALIDATE("Phone No.");
      Rec.MODIFY;
    END;

    BEGIN
    {
      AT2017      02.12.2016  Codeunit for TAPI Event Handler
      AT2017.01   nearly all globals as Var, named Rec
                  Event Publisher Object must be  Codeunit 56781 TAPI Event Publishers
    }
    END.
  }
}

OBJECT MenuSuite 1054 Dept - Add-on 4
{
  OBJECT-PROPERTIES
  {
    Date=15.01.17;
    Time=12:00:00;
    Modified=Yes;
    Version List=AT2017;
  }
  PROPERTIES
  {
  }
  MENUNODES
  {
    {                ;[{19A352FE-D90D-424E-B85F-CF3B8E98CF0E}] ;NextNodeID=[{C5D52441-34B2-4F6B-BFA1-033C708A958F}] }
    { Menu           ;[{C5D52441-34B2-4F6B-BFA1-033C708A958F}] ;Name=&Telefonie;
                                                                CaptionML=[DEU=Telefonie;
                                                                           ENU=Telephony (CTI)];
                                                                MemberOfMenu=[{C5D52441-34B2-4F6B-BFA1-033C708A958F}];
                                                                ParentNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                Image=0;
                                                                IsShortcut=No;
                                                                Visible=Yes;
                                                                Enabled=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{B59D4AE7-378E-41BC-A813-B1FB5ABC4D20}] }
    { MenuGroup      ;[{43954EB0-EC5C-487A-82ED-8851BDD53BFA}] ;Name=Neue Gruppe;
                                                                CaptionML=[DEU=Einrichtung;
                                                                           ENU=Setup];
                                                                MemberOfMenu=[{C5D52441-34B2-4F6B-BFA1-033C708A958F}];
                                                                ParentNodeID=[{C5D52441-34B2-4F6B-BFA1-033C708A958F}];
                                                                Visible=Yes;
                                                                NextNodeID=[{3B897170-A738-47AA-B516-F7F5976D8325}];
                                                                FirstChild=[{365868BA-9B7B-4D0E-88C4-4A721704FBB3}] }
    { MenuGroup      ;[{3B897170-A738-47AA-B516-F7F5976D8325}] ;Name=Neue Gruppe;
                                                                CaptionML=[DEU=Periodische AktivitÑten;
                                                                           ENU=Periodic Activities];
                                                                MemberOfMenu=[{C5D52441-34B2-4F6B-BFA1-033C708A958F}];
                                                                ParentNodeID=[{C5D52441-34B2-4F6B-BFA1-033C708A958F}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{64383F72-3B58-40F9-AA02-1EDEE62CB9F0}] }
    { MenuItem       ;[{365868BA-9B7B-4D0E-88C4-4A721704FBB3}] ;Name=TAPI Functions;
                                                                CaptionML=[DEU=TAPI Leitungen aktualisieren;
                                                                           ENU=Update TAPI Lines];
                                                                MemberOfMenu=[{C5D52441-34B2-4F6B-BFA1-033C708A958F}];
                                                                RunObjectType=Report;
                                                                RunObjectID=56781;
                                                                ParentNodeID=[{43954EB0-EC5C-487A-82ED-8851BDD53BFA}];
                                                                Visible=Yes;
                                                                NextNodeID=[{C1346C1B-D5FB-4AFC-A534-9BF3A921BC14}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{C1346C1B-D5FB-4AFC-A534-9BF3A921BC14}] ;Name=TAPI Einrichtung;
                                                                CaptionML=[DEU=TAPI Einrichtung;
                                                                           ENU=TAPI Setup Card];
                                                                MemberOfMenu=[{C5D52441-34B2-4F6B-BFA1-033C708A958F}];
                                                                RunObjectType=Page;
                                                                RunObjectID=56782;
                                                                ParentNodeID=[{43954EB0-EC5C-487A-82ED-8851BDD53BFA}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{64383F72-3B58-40F9-AA02-1EDEE62CB9F0}] ;Name=Telefon-Index fÅllen;
                                                                CaptionML=[DEU=Telefon-Index fÅllen;
                                                                           ENU=Fill Phone Index];
                                                                MemberOfMenu=[{C5D52441-34B2-4F6B-BFA1-033C708A958F}];
                                                                RunObjectType=Report;
                                                                RunObjectID=56780;
                                                                ParentNodeID=[{3B897170-A738-47AA-B516-F7F5976D8325}];
                                                                Visible=Yes;
                                                                NextNodeID=[{DFB5F22F-5022-454B-A166-3E8CC0864B9E}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{DFB5F22F-5022-454B-A166-3E8CC0864B9E}] ;Name=Hinweise fÅr Telefon-Index;
                                                                CaptionML=[DEU=Hinweise fÅr Telefon-Index;
                                                                           ENU=Notes for Phone-Index];
                                                                MemberOfMenu=[{C5D52441-34B2-4F6B-BFA1-033C708A958F}];
                                                                RunObjectType=Page;
                                                                RunObjectID=56791;
                                                                ParentNodeID=[{3B897170-A738-47AA-B516-F7F5976D8325}];
                                                                Visible=Yes;
                                                                NextNodeID=[{85D6C74E-61F7-4683-802A-B11F05889881}];
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{85D6C74E-61F7-4683-802A-B11F05889881}] ;Name=Telefon-Index bearbeiten;
                                                                CaptionML=[DEU=Telefon-Index bearbeiten;
                                                                           ENU=Change Phone Index];
                                                                MemberOfMenu=[{C5D52441-34B2-4F6B-BFA1-033C708A958F}];
                                                                RunObjectType=Page;
                                                                RunObjectID=56790;
                                                                ParentNodeID=[{3B897170-A738-47AA-B516-F7F5976D8325}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{FCFE2485-2318-4034-86F4-4D5D2AD834E3}] ;Name=Delete Orphaned Record Links;
                                                                CaptionML=[DEU=Nicht verbundene DatensatzverknÅpfungen lîschen;
                                                                           ENU=Delete Orphaned Record Links];
                                                                RunObjectType=Codeunit;
                                                                RunObjectID=447;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    {                ;[{65E2DFB3-0C1B-4357-AF34-9D8C2F8695BF}] ;NextNodeID=[{404E62A3-BD1E-4CEA-A90D-D9D6A91F2229}] }
    { MenuItem       ;[{404E62A3-BD1E-4CEA-A90D-D9D6A91F2229}] ;Name=Item Tracking Appendix;
                                                                CaptionML=[DEU=Anhang Artikelverfolgung;
                                                                           ENU=Item Tracking Appendix];
                                                                RunObjectType=Report;
                                                                RunObjectID=6521;
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuGroup      ;[{637F7895-E36D-4539-B9C5-5D5630AC0926}] ;Name=Sales Documents;
                                                                CaptionML=[DEU=Verkaufsbelege;
                                                                           ENU=Sales Documents];
                                                                Visible=Yes }
    { MenuItem       ;[{A8CF00DC-84CF-46D2-893C-BD13C05D34D9}] ;Name=Delete Invoiced Sales Orders..;
                                                                CaptionML=[DEU=Erledigte AuftrÑge lîschen...;
                                                                           ENU=Delete Invoiced Sales Orders...];
                                                                RunObjectType=Report;
                                                                RunObjectID=299;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{C1900F88-45F1-43C5-BD95-EAA296160054}] ;Name=[Delete Invoiced Blanket Sales ];
                                                                CaptionML=[DEU=Erledigte RahmenauftrÑge lîschen...;
                                                                           ENU=Delete Invoiced Blanket Sales Orders...];
                                                                RunObjectType=Report;
                                                                RunObjectID=291;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{BB909E91-17F7-463F-B941-81B4E2D1EA5E}] ;Name=Delete Invoiced Sales Return O;
                                                                CaptionML=[DEU=Erledigte Verkaufsreklamationen lîschen...;
                                                                           ENU=Delete Invoiced Sales Return Orders...];
                                                                RunObjectType=Report;
                                                                RunObjectID=6651;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{6FC70FA7-46E0-4F20-9785-01E18322E83A}] ;Name=Delete Archived Sales Quote Ve;
                                                                CaptionML=[DEU=Archivierte Angebotsversionen lîschen...;
                                                                           ENU=Delete Archived Sales Quote Versions...];
                                                                RunObjectType=Report;
                                                                RunObjectID=5179;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{12BC41EE-5F10-4B3D-8808-919A6E294520}] ;Name=Delete Archived Sales Order Ve;
                                                                CaptionML=[DEU=Archivierte Auftragsversionen lîschen...;
                                                                           ENU=Delete Archived Sales Order Versions...];
                                                                RunObjectType=Report;
                                                                RunObjectID=5180;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{E2DCD87D-3909-4B41-9FAB-65CDCC9BAE4D}] ;Name=Report5005130;
                                                                CaptionML=[DEU=Archivierte Rahmenauftragsversionen lîschen...;
                                                                           ENU=Delete Archived Blanket Sales Order Versions...];
                                                                RunObjectType=Report;
                                                                RunObjectID=5005130;
                                                                Visible=Yes;
                                                                NextNodeID=[{A8CF00DC-84CF-46D2-893C-BD13C05D34D9}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuGroup      ;[{1AE7ACCC-E9A2-4BE6-AA07-78AC5AC1811D}] ;Name=Purchase Documents;
                                                                CaptionML=[DEU=Einkaufsbelege;
                                                                           ENU=Purchase Documents];
                                                                Visible=Yes }
    { MenuItem       ;[{5B47520A-746D-43CF-B4E9-DA7CFBC52464}] ;Name=Delete Invoiced Purchase Order;
                                                                CaptionML=[DEU=Erledigte Bestellungen lîschen...;
                                                                           ENU=Delete Invoiced Purchase Orders...];
                                                                RunObjectType=Report;
                                                                RunObjectID=499;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{30AEF09C-E8EC-4893-9088-CDE9079958D0}] ;Name=Delete Invoiced Blanket Purcha;
                                                                CaptionML=[DEU=Erledigte Rahmenbestellungen lîschen...;
                                                                           ENU=Delete Invoiced Blanket Purchase Orders...];
                                                                RunObjectType=Report;
                                                                RunObjectID=491;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{7E6A50F8-ECD3-4729-820B-53F0A0C117B8}] ;Name=Delete Invoiced Purchase Retur;
                                                                CaptionML=[DEU=Erledigte Einkaufsreklamationen lîschen...;
                                                                           ENU=Delete Invoiced Purchase Return Orders...];
                                                                RunObjectType=Report;
                                                                RunObjectID=6661;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{20FFB6ED-B7BF-4F84-A19F-90E3FA9F3E0F}] ;Name=Delete Archived Purchase Quote;
                                                                CaptionML=[DEU=Archivierte Anfragenversionen lîschen...;
                                                                           ENU=Delete Archived Purchase Quote Versions...];
                                                                RunObjectType=Report;
                                                                RunObjectID=5177;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{3EB49C8F-D3ED-4773-A59A-95396FB176C9}] ;Name=Delete Archived Purchase Order;
                                                                CaptionML=[DEU=Archivierte Bestellungsversionen lîschen...;
                                                                           ENU=Delete Archived Purchase Order Versions...];
                                                                RunObjectType=Report;
                                                                RunObjectID=5178;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{9428E54D-913A-4DC0-B9A7-C2FE9E4A3BD7}] ;Name=Delete Archived Blanket Purcha;
                                                                CaptionML=[DEU=Archivierte Rahmenbestellungsversionen lîschen...;
                                                                           ENU=Delete Archived Blanket Purchase Order Versions...];
                                                                RunObjectType=Report;
                                                                RunObjectID=5005230;
                                                                Visible=Yes;
                                                                NextNodeID=[{5B47520A-746D-43CF-B4E9-DA7CFBC52464}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuGroup      ;[{6F0215A8-7693-4EFA-828C-7B42D0E7E34F}] ;Name=New Group;
                                                                CaptionML=[DEU=Logistikbelege;
                                                                           ENU=Warehouse Documents];
                                                                Visible=Yes }
    { MenuItem       ;[{4B1110CF-F1EF-4164-95C8-A4A03F9809A1}] ;Name=Delete Registered Whse. Docs.;
                                                                CaptionML=[DEU=Registrierte Logistikbelege lîschen...;
                                                                           ENU=Delete Registered Whse. Docs.];
                                                                RunObjectType=Report;
                                                                RunObjectID=5755;
                                                                Visible=Yes;
                                                                NextNodeID=[{4B1110CF-F1EF-4164-95C8-A4A03F9809A1}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuGroup      ;[{E73A0F07-17E7-4051-94AB-16FE1C34E8F6}] ;Name=Date Compression;
                                                                CaptionML=[DEU=Datumskomprimierung;
                                                                           ENU=Date Compression];
                                                                Visible=Yes }
    { MenuItem       ;[{E22EE535-AB97-444F-B411-23F7347D50C0}] ;Name=General Ledger...;
                                                                CaptionML=[DEU=Sachposten...;
                                                                           ENU=G/L Entries...];
                                                                RunObjectType=Report;
                                                                RunObjectID=98;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{016E6289-F48C-4FC3-A111-26DCD3AEC86D}] ;Name=VAT Entries...;
                                                                CaptionML=[DEU=MwSt.-Posten...;
                                                                           ENU=VAT Entries...];
                                                                RunObjectType=Report;
                                                                RunObjectID=95;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{F79DC932-95BB-43AD-9E32-B9E3AD29C139}] ;Name=Bank Account Ledger..;
                                                                CaptionML=[DEU=Bankposten...;
                                                                           ENU=Bank Account Ledger Entries...];
                                                                RunObjectType=Report;
                                                                RunObjectID=1498;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{6E234D06-0F99-4BC1-A2EA-55BB5AA54C3F}] ;Name=G/L Budget Entries;
                                                                CaptionML=[DEU=Finanzbudgetposten...;
                                                                           ENU=G/L Budget Entries...];
                                                                RunObjectType=Report;
                                                                RunObjectID=97;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{CBCA95D5-0BA8-44CD-A900-06FC6B601A83}] ;Name=Customer Ledger Entries...;
                                                                CaptionML=[DEU=Debitorenposten...;
                                                                           ENU=Customer Ledger Entries...];
                                                                RunObjectType=Report;
                                                                RunObjectID=198;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{E9F413C8-17F2-4A38-8865-9B2A687C36DC}] ;Name=Vendor Ledger Entries...;
                                                                CaptionML=[DEU=Kreditorenposten...;
                                                                           ENU=Vendor Ledger Entries...];
                                                                RunObjectType=Report;
                                                                RunObjectID=398;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{6EAF75CF-DC0C-42E3-8E58-C10E1154E1BE}] ;Name=BOM Ledger Entries...;
                                                                CaptionML=[DEU=StÅcklistenposten...;
                                                                           ENU=BOM Ledger Entries...];
                                                                RunObjectType=Report;
                                                                RunObjectID=898;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{592E1717-C332-4C73-A7CF-A5346D5E3283}] ;Name=Resource Ledger Entries...;
                                                                CaptionML=[DEU=Ressourcenposten...;
                                                                           ENU=Resource Ledger Entries...];
                                                                RunObjectType=Report;
                                                                RunObjectID=1198;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{0909EADB-EBAC-45CD-94CF-74283E7DBB1E}] ;Name=FA Ledger Entries...;
                                                                CaptionML=[DEU=Anlagenposten...;
                                                                           ENU=FA Ledger Entries...];
                                                                RunObjectType=Report;
                                                                RunObjectID=5696;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{37DDD71C-F088-4362-A627-E172391FE11B}] ;Name=Maintenance Ledger Entries...;
                                                                CaptionML=[DEU=Wartungsposten...;
                                                                           ENU=Maintenance Ledger Entries...];
                                                                RunObjectType=Report;
                                                                RunObjectID=5698;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{98C8E24B-E34C-41F4-A66A-CCB9986AEF56}] ;Name=Insurance Ledger Entries...;
                                                                CaptionML=[DEU=Versicherungsposten...;
                                                                           ENU=Insurance Ledger Entries...];
                                                                RunObjectType=Report;
                                                                RunObjectID=5697;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{34F1BB2D-D51E-4B5B-A6E2-5D2F7C4531D1}] ;Name=Warehouse Entries...;
                                                                CaptionML=[DEU=Lagerplatzposten...;
                                                                           ENU=Warehouse Entries...];
                                                                RunObjectType=Report;
                                                                RunObjectID=7398;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{5C8BAFCC-1876-4A24-804E-8C12E1D1DBFB}] ;Name=Registers;
                                                                CaptionML=[DEU=Journale;
                                                                           ENU=Registers];
                                                                RunObjectType=Page;
                                                                RunObjectID=107;
                                                                Visible=Yes;
                                                                NextNodeID=[{E22EE535-AB97-444F-B411-23F7347D50C0}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{0AC86023-FC93-4C23-8F15-278D2FFF272E}] ;Name=Delete Invoiced Service Orders;
                                                                CaptionML=[DEU=Fakturierte ServiceauftrÑge lîschen;
                                                                           ENU=Delete Invoiced Service Orders];
                                                                RunObjectType=Report;
                                                                RunObjectID=5914;
                                                                Visible=Yes;
                                                                NextNodeID=[{0AC86023-FC93-4C23-8F15-278D2FFF272E}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuGroup      ;[{B59D4AE7-378E-41BC-A813-B1FB5ABC4D20}] ;Name=Telefonie;
                                                                CaptionML=[DEU=Telefonie;
                                                                           ENU=Telephonie];
                                                                MemberOfMenu=[{C5D52441-34B2-4F6B-BFA1-033C708A958F}];
                                                                ParentNodeID=[{C5D52441-34B2-4F6B-BFA1-033C708A958F}];
                                                                Visible=Yes;
                                                                NextNodeID=[{43954EB0-EC5C-487A-82ED-8851BDD53BFA}];
                                                                FirstChild=[{27EFE9AA-2448-46BA-8D7B-2FDAD910C9E3}] }
    { MenuItem       ;[{27EFE9AA-2448-46BA-8D7B-2FDAD910C9E3}] ;Name=TAPI Benutzer;
                                                                CaptionML=[DEU=TAPI Benutzer;
                                                                           ENU=TAPI User];
                                                                MemberOfMenu=[{C5D52441-34B2-4F6B-BFA1-033C708A958F}];
                                                                RunObjectType=Page;
                                                                RunObjectID=56783;
                                                                ParentNodeID=[{B59D4AE7-378E-41BC-A813-B1FB5ABC4D20}];
                                                                Visible=Yes;
                                                                NextNodeID=[{9D92AB1F-AD75-4CC8-9FCD-A4FFBFCDCF71}];
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{9D92AB1F-AD75-4CC8-9FCD-A4FFBFCDCF71}] ;Name=Telefonnr. suchen;
                                                                CaptionML=[DEU=Telefonnr. suchen;
                                                                           ENU=Find Phone No.];
                                                                MemberOfMenu=[{C5D52441-34B2-4F6B-BFA1-033C708A958F}];
                                                                RunObjectType=Page;
                                                                RunObjectID=56792;
                                                                ParentNodeID=[{B59D4AE7-378E-41BC-A813-B1FB5ABC4D20}];
                                                                Visible=Yes;
                                                                NextNodeID=[{427394AE-7B73-4336-B123-B551F7F79991}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{427394AE-7B73-4336-B123-B551F7F79991}] ;Name=Journal TAPI;
                                                                CaptionML=[DEU=Journal TAPI;
                                                                           ENU=TAPI Logs];
                                                                MemberOfMenu=[{C5D52441-34B2-4F6B-BFA1-033C708A958F}];
                                                                RunObjectType=Page;
                                                                RunObjectID=56784;
                                                                ParentNodeID=[{B59D4AE7-378E-41BC-A813-B1FB5ABC4D20}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Lists }
    {                ;[{DB59B1C0-087E-442B-A5E6-D30FD8F7860C}] ;NextNodeID=[{CA532485-499D-473B-B91B-CD29CC066FCF}] }
    { MenuItem       ;[{CA532485-499D-473B-B91B-CD29CC066FCF}] ;Name=Item Register - Quantity;
                                                                CaptionML=[DEU=Artikeljournal - Menge;
                                                                           ENU=Item Register - Quantity];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Report;
                                                                RunObjectID=703;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
  }
}
OBJECT Page 56780 Menu Phone No. found
{
  OBJECT-PROPERTIES
  {
    Date=15.01.17;
    Time=12:00:00;
    Modified=Yes;
    Version List=AO,AT2013;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[DEU=Eingehend: Auswahl Telefonnr. gefunden;
               ENU=Inbound: Menu Phone No. found];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    PageType=Card;
    OnOpenPage=BEGIN
                 TestNo := TAPIFu.TAPIRights;

                 LineEntryNo := 0;

                 TAPIEinr.GET;

                 TAPIUser.INIT;
                 IF TAPIUser.GET(USERID) THEN ;

                 // Standard Setup for Phoning / Standard-Einstellung fÅr Telefonie
                 LineMediaMode_InteractiveVoice := 4;

                 // Standard Setup for Modem Phoning / Standard-Einstellung fÅr Modem-Telefonie
                 LineMediaMode_DataModem := 16;

                 // Length of internal Phone No. / LÑnge der internen Rufnummern
                 LenOfInternal := TAPIEinr."Length of internal phone No.";

                 // Create Global key for (redirected) calls /
                 // Zentralen SchlÅssel fÅr (weitergeleitete) Telefonate erstellen
                 CallDataErstellen := TAPIEinr."Create call data";

                 TAPIDriverName := TAPIFu.TAPILineReady(TestNo);

                 // AT 2011 CHANGED
                 IF ISCLEAR(ATEventSource) THEN
                   CREATE(ATEventSource,TRUE,TRUE);

                 IF ISCLEAR(ATTelephony) THEN
                   CREATE(ATTelephony,TRUE,TRUE);
                 // AT2011 END
               END;

    OnClosePage=BEGIN
                  // AT2011 CHANGED
                  CLEAR(ATTelephony);
                  CLEAR(ATEventSource);
                  // AT2011 END
                END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000010;1 ;Action    ;
                      Name=CustCard;
                      CaptionML=[DEU=Debitor anzeigen (Karte);
                                 ENU=Show Customer (Card)];
                      Promoted=Yes;
                      Image=Customer;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Cust.RESET;
                                 IF OriginTab = 18 THEN
                                   IF Cust.GET(OriginKey1) THEN ;

                                 // AT2013 CHANGED
                                 PAGE.RUN(21, Cust, Cust.Name);
                               END;
                                }
      { 1000000011;1 ;Action    ;
                      Name=ContCard;
                      CaptionML=[DEU=Kontakt anzeigen (Karte);
                                 ENU=Show Contact (Card)];
                      Promoted=Yes;
                      Image=Company;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ContAtt.RESET;
                                 IF OriginTab = 5050 THEN
                                   IF ContAtt.GET(OriginKey1) THEN ;

                                 // AT2013 CHANGED
                                 PAGE.RUN(5050, ContAtt, ContAtt.Name);
                               END;
                                }
      { 3       ;1   ;Action    ;
                      Name=VendKart;
                      CaptionML=[DEU=Kreditor anzeigen (Karte);
                                 ENU=Show Vendor (Card)];
                      Promoted=Yes;
                      Image=Vendor;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Vend.RESET;
                                 IF OriginTab = 23 THEN
                                   IF Vend.GET(OriginKey1) THEN ;

                                 // AT2013 CHANGED
                                 PAGE.RUN(26, Vend, Vend.Name);
                               END;
                                }
      { 1000000005;1 ;Action    ;
                      Name=ItemList;
                      CaptionML=[DEU=Lager (Artikel-öbersicht);
                                 ENU=Inventory (Item List)];
                      Promoted=Yes;
                      Image=Item;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 // AT2013 CHANGED
                                 PAGE.RUN(31);
                               END;
                                }
      { 1000000009;1 ;Action    ;
                      Name=SalesOrder;
                      CaptionML=[DEU=Verkauf (Auftrags-Karte);
                                 ENU=Sales (Order Card)];
                      Promoted=Yes;
                      Image=Order;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SalesHeader.RESET;
                                 SalesHeader.SETRANGE("Document Type", SalesHeader."Document Type"::Order);
                                 IF OriginTab = 18 THEN BEGIN
                                   SalesHeader.SETRANGE("Sell-to Customer No.", OriginKey1);
                                   IF SalesHeader.FIND('+') THEN BEGIN
                                 // AT2013 CHANGED
                                     PAGE.RUN(42, SalesHeader, SalesHeader."Sell-to Customer No.");
                                   END ELSE BEGIN
                                     SalesHeader.SETRANGE("Sell-to Customer No.");
                                     IF SalesHeader.FIND('+') THEN;
                                 // AT2013 CHANGED
                                     PAGE.RUN(42, SalesHeader, SalesHeader."No.");
                                   END;
                                 END ELSE
                                 // AT2013 CHANGED
                                   PAGE.RUN(42);
                                 SalesHeader.RESET;
                               END;
                                }
      { 1000000008;1 ;Action    ;
                      Name=SalesQuote;
                      CaptionML=[DEU=Angebote;
                                 ENU=Quotes];
                      Promoted=Yes;
                      Image=Quote;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SalesHeader.RESET;
                                 SalesHeader.SETRANGE("Document Type", SalesHeader."Document Type"::Quote);
                                 IF OriginTab = 18 THEN BEGIN
                                   SalesHeader.SETRANGE("Sell-to Customer No.", OriginKey1);
                                   IF SalesHeader.FIND('+') THEN BEGIN
                                 // AT2013 CHANGED
                                     PAGE.RUN(41, SalesHeader, SalesHeader."Sell-to Customer No.");
                                   END ELSE BEGIN
                                     SalesHeader.SETRANGE("Sell-to Customer No.");
                                     IF SalesHeader.FIND('+') THEN;
                                 // AT2013 CHANGED
                                     PAGE.RUN(41, SalesHeader, SalesHeader."No.");
                                   END;
                                 END ELSE
                                 // AT2013 CHANGED
                                   PAGE.RUN(41);
                                 SalesHeader.RESET;
                               END;
                                }
      { 1000000007;1 ;Action    ;
                      Name=SalesInv;
                      CaptionML=[DEU=Rechnungen;
                                 ENU=Invoices];
                      Promoted=Yes;
                      Image=SalesInvoice;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SalesHeader.RESET;
                                 SalesHeader.SETRANGE("Document Type", SalesHeader."Document Type"::Invoice);
                                 IF OriginTab = 18 THEN BEGIN
                                   SalesHeader.SETRANGE("Sell-to Customer No.", OriginKey1);
                                   IF SalesHeader.FIND('+') THEN BEGIN
                                 // AT2013 CHANGED
                                     PAGE.RUN(43, SalesHeader, SalesHeader."Sell-to Customer No.");
                                   END ELSE BEGIN
                                     SalesHeader.SETRANGE("Sell-to Customer No.");
                                     IF SalesHeader.FIND('+') THEN;
                                 // AT2013 CHANGED
                                     PAGE.RUN(43, SalesHeader, SalesHeader."No.");
                                   END;
                                 END ELSE
                                 // AT2013 CHANGED
                                   PAGE.RUN(43);
                               END;
                                }
      { 6       ;1   ;Action    ;
                      Name=PostedSalesInv;
                      CaptionML=[DEU=Gebuchte Rechnungen;
                                 ENU=Posted Invoices];
                      Promoted=Yes;
                      Image=SalesInvoice;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 PInvHeader.RESET;
                                 IF OriginTab = 18 THEN BEGIN
                                   PInvHeader.SETRANGE("Sell-to Customer No.", OriginKey1);
                                   IF PInvHeader.FIND('+') THEN BEGIN
                                 // AT2013 CHANGED
                                     PAGE.RUN(132, PInvHeader, PInvHeader."Sell-to Customer No.");
                                   END ELSE BEGIN
                                     PInvHeader.SETRANGE("Sell-to Customer No.");
                                     IF PInvHeader.FIND('+') THEN;
                                 // AT2013 CHANGED
                                     PAGE.RUN(132, PInvHeader, PInvHeader."Sell-to Customer Name");
                                   END;
                                 END ELSE
                                 // AT2013 CHANGED
                                   PAGE.RUN(132);
                                 PInvHeader.RESET;
                               END;
                                }
      { 1000000006;1 ;Action    ;
                      Name=SalesCrM;
                      CaptionML=[DEU=Gutschriften;
                                 ENU=Credit Memos];
                      Promoted=Yes;
                      Image=CreditMemo;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SalesHeader.RESET;
                                 SalesHeader.SETRANGE("Document Type", SalesHeader."Document Type"::"Credit Memo");
                                 IF OriginTab = 18 THEN BEGIN
                                   SalesHeader.SETRANGE("Sell-to Customer No.", OriginKey1);
                                   IF SalesHeader.FIND('+') THEN BEGIN
                                 // AT2013 CHANGED
                                     PAGE.RUN(44, SalesHeader, SalesHeader."Sell-to Customer No.");
                                   END ELSE BEGIN
                                     SalesHeader.SETRANGE("Sell-to Customer No.");
                                     IF SalesHeader.FIND('+') THEN;
                                 // AT2013 CHANGED
                                     PAGE.RUN(44, SalesHeader, SalesHeader."No.");
                                   END;
                                 END ELSE
                                 // AT2013 CHANGED
                                   PAGE.RUN(44);
                               END;
                                }
      { 7       ;1   ;Action    ;
                      Name=PostedSalesCrM;
                      CaptionML=[DEU=Gebuchte Gutschriften;
                                 ENU=Posted Credit Memos];
                      Promoted=Yes;
                      Image=CreditMemo;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 PCrMHeader.RESET;
                                 IF OriginTab = 18 THEN BEGIN
                                   PCrMHeader.SETRANGE("Sell-to Customer No.", OriginKey1);
                                   IF PCrMHeader.FIND('+') THEN BEGIN
                                 // AT2013 CHANGED
                                     PAGE.RUN(134, PCrMHeader, PCrMHeader."Sell-to Customer No.");
                                   END ELSE BEGIN
                                     PCrMHeader.SETRANGE("Sell-to Customer No.");
                                     IF PCrMHeader.FIND('+') THEN;
                                 // AT2013 CHANGED
                                     PAGE.RUN(134, PCrMHeader, PCrMHeader."Sell-to Customer Name");
                                   END;
                                 END ELSE
                                 // AT2013 CHANGED
                                   PAGE.RUN(134);
                                 PCrMHeader.RESET;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000014;1;Field  ;
                CaptionML=[DEU=Name;
                           ENU=Name];
                SourceExpr=Name;
                Editable=FALSE;
                Style=Standard;
                StyleExpr=TRUE }

    { 1000000013;1;Field  ;
                CaptionML=[DEU=Telefon-Nr.;
                           ENU=Phone No.];
                SourceExpr=PhoneNo;
                Editable=FALSE }

    { 1000000012;1;Field  ;
                CaptionML=[DEU=Herkunft;
                           ENU=Origin];
                SourceExpr=Origin;
                Editable=FALSE }

    { 1000000021;1;Field  ;
                CaptionML=[DEU=Herkunft-Nr.;
                           ENU=Origin No.];
                SourceExpr=OriginNr;
                Editable=FALSE }

  }
  CODE
  {
    VAR
      Text001@1008 : TextConst 'DEU=Debitor;ENU=Customer';
      Text002@1010 : TextConst 'DEU=Kreditor;ENU=Vendor';
      Text003@1011 : TextConst 'DEU=Kontaktperson;ENU=Contact person';
      Text004@1012 : TextConst 'DEU=Interessent;ENU=Prospect';
      ATTelephony@1005 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{7D58078D-E0FB-4D64-9829-B909B8F6D8F6}:'activeTAPI-Telephony'.Telephony";
      ATEventSource@1014 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{206D2787-8575-4750-A727-38FC5DBFA1A3}:'activeTAPI-Telephony'.EventSource" WITHEVENTS;
      Cust@1000000003 : Record 18;
      Vend@1000000002 : Record 23;
      ContAtt@1009 : Record 5050;
      SalesHeader@1000 : Record 36;
      PInvHeader@1001 : Record 112;
      PCrMHeader@1002 : Record 114;
      TAPIEinr@1000000012 : Record 56782;
      TAPIUser@1000000017 : Record 56783;
      TAPIFu@1000000022 : Codeunit 56780;
      Name@1000000011 : Text[50];
      PhoneNo@1000000010 : Text[30];
      Origin@1000000009 : Text[30];
      OriginNr@1000000008 : Text[30];
      TAPIDriverName@1000000018 : Text[50];
      MachName@1003 : Text[50];
      OriginKey1@1000000005 : Code[20];
      OriginKey2@1000000004 : Code[20];
      OriginTab@1000000007 : Integer;
      LineEntryNo@1000000006 : Integer;
      LineMediaMode_InteractiveVoice@1000000013 : Integer;
      LineMediaMode_DataModem@1000000014 : Integer;
      LenOfInternal@1000000015 : Integer;
      TestNo@1000000021 : Integer;
      CallDataErstellen@1000000016 : Boolean;
      Text005@1006 : TextConst 'DEU=Sie mÅssen Name TAPI Leitung bei PC %1 eingeben (TAPI Einrichtung, PC''s und TAPI Leitungen).;ENU=You must input TAPI Line name for PC %1 (TAPI Setup, PC''s and TAPI Lines).';
      Text006@1007 : TextConst 'DEU=Sie mÅssen PC %1 und Name TAPI Leitung anlegen (TAPI Einrichtung, PC''s und TAPI Leitungen).;ENU=You must input PC %1 and TAPI Line name (TAPI Setup, PC''s and TAPI Lines).';
      Text007@1013 : TextConst 'DEU=Kontakt;ENU=Contact';
      Text19012710@19068865 : TextConst 'DEU=Ankommender Anruf:;ENU=Incoming Call:';
      Text19063590@19002408 : TextConst 'DEU=Telefonnr. gefunden;ENU=Phone No. found';

    PROCEDURE DefVar@1(NewName@1000 : Text[50];NewPhoneNo@1001 : Text[30];NewOriginTab@1002 : Integer;NewOriginKey1@1003 : Code[20];NewOriginKey2@1004 : Code[20]);
    BEGIN
      Name := NewName;
      PhoneNo := NewPhoneNo;
      OriginTab := NewOriginTab;
      OriginKey1 := NewOriginKey1;
      OriginKey2 := NewOriginKey2;
      CASE OriginTab OF
      // Customer / Debitor
        18:
          BEGIN
            Origin := Text001;
            OriginNr := DELCHR(OriginKey1,'<>');
          END;
      // Vendor / Kreditor
        23:
          BEGIN
            Origin := Text002;
            OriginNr := DELCHR(OriginKey1,'<>');
          END;
      // Contact / Kontakt
        5050:
          BEGIN
            Origin := Text007;
            OriginNr := DELCHR(OriginKey1,'<>');
          END;
        ELSE BEGIN
          Origin := '';
          OriginNr := '';
        END;
      END;
    END;

    EVENT ATEventSource@1014::CallNew@1(CurrentCall@1113900000 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{BA7151F3-8ECC-4507-9F7C-1C38E76F0054}:'activeTAPI-Telephony'._ActiveCall");
    BEGIN
    END;

    EVENT ATEventSource@1014::CallFinished@2(CurrentCall@1113900000 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{BA7151F3-8ECC-4507-9F7C-1C38E76F0054}:'activeTAPI-Telephony'._ActiveCall");
    BEGIN
      CurrPage.CLOSE;
    END;

    EVENT ATEventSource@1014::lineMessage@3(CurrentCall@1113900005 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{BA7151F3-8ECC-4507-9F7C-1C38E76F0054}:'activeTAPI-Telephony'._ActiveCall";CallHandleOrLineHandle@1113900004 : Integer;message@1113900003 : Integer;param1@1113900002 : Integer;param2@1113900001 : Integer;param3@1113900000 : Integer);
    BEGIN
    END;

    EVENT ATEventSource@1014::CallUserInfo@4(CurrentCall@1113900003 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{BA7151F3-8ECC-4507-9F7C-1C38E76F0054}:'activeTAPI-Telephony'._ActiveCall";UserInfoBits@1113900002 : Integer;OldValue@1113900001 : Text[1024];NewValue@1113900000 : Text[1024]);
    BEGIN
    END;

    EVENT ATEventSource@1014::WatchDog@5();
    BEGIN
    END;

    BEGIN
    {
      AT05.00       16.06.2007  Length of all name-fields changed from 30 to 50
      AT05.00.01    13.03.2008  New Connection with Automation objects
      AT2011        05.04.2011  Changes for RTC: CREATE, Order of buttons
                                Old Code deleted
      AT2011.3      11.10.2011  Reassignment of Automation Variables
      AT2013        11.05.2013  FORM replaced by PAGE
    }
    END.
  }
}

OBJECT Page 56781 Incoming call
{
  OBJECT-PROPERTIES
  {
    Date=17.08.19;
    Time=19:00:00;
    Modified=Yes;
    Version List=AO,AT2018;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[DEU=Ankommender Anruf;
               ENU=Incoming call];
    InsertAllowed=No;
    DeleteAllowed=No;
    PageType=Card;
    TimerUpdate=1;
    OnInit=BEGIN
             // IF ISCLEAR( AppTrace) THEN
             //  CREATE( AppTrace, TRUE, TRUE);

             IF ISCLEAR(WSHShell) THEN
               CREATE( WSHShell, TRUE, TRUE);

             // AppTrace.DebugMessage('OnInit: Incoming Call');
           END;

    OnOpenPage=BEGIN
                 // AppTrace.DebugMessage('OnOpenPage: Incoming Call');

                 // AT2017 BEGIN
                 // AT2018   approximately 3 seconds
                 FOR i := 1 TO 30000000 DO BEGIN
                   i := i + 1;
                 END;

                 // AppTrace.DebugMessage(STRSUBSTNO('Timer OnControlAddIn: Index %1 Message %2 vor WSH', FORMAT(Index), Data));
                 WSHShell.SendKeys('{ESC}');
                 // AppTrace.DebugMessage(STRSUBSTNO('Timer OnControlAddIn: Index %1 Message %2 nach WSH', FORMAT(Index), Data));
                 // AT2017 END
               END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 2   ;1   ;Field     ;
                CaptionML=[DEU=Name;
                           ENU=Name];
                SourceExpr=Name;
                Editable=FALSE;
                Style=Standard;
                StyleExpr=TRUE }

    { 4   ;1   ;Field     ;
                CaptionML=[DEU=Telefon-Nr.;
                           ENU=Phone No.];
                SourceExpr=PhoneNo;
                Editable=FALSE }

    { 6   ;1   ;Field     ;
                CaptionML=[DEU=Herkunft-Nr.;
                           ENU=Origin No.];
                SourceExpr=OriginNr;
                Editable=FALSE }

    { 9   ;1   ;Field     ;
                CaptionML=[DEU=Herkunft;
                           ENU=Origin];
                SourceExpr=Origin;
                Editable=FALSE }

  }
  CODE
  {
    VAR
      AppTrace@1113900001 : Automation "{600E23A8-24BF-43EE-BA93-691E0DFFAD1A} 2.0:{1B61767C-91A3-4632-9E92-A8C29C7DA936}:'activeTAPI_NET_Services'.AppTrace";
      WSHShell@1113900006 : Automation "{F935DC20-1CF0-11D0-ADB9-00C04FD58A0B} 1.0:{72C24DD5-D70A-438B-8A42-98424B88AFB8}:'Windows Script Host Object Model'.WshShell";
      Cust@1113900004 : Record 18;
      Vend@1113900003 : Record 23;
      ContAtt@1113900002 : Record 5050;
      Name@1000 : Text[50];
      PhoneNo@1001 : Text[30];
      Origin@1002 : Text[50];
      OriginNr@1014 : Text[30];
      "RTC-Timer"@1113900000 : Text[10];
      OriginTab@1003 : Integer;
      Counter@1113900005 : Integer;
      OriginKey1@1004 : Code[20];
      OriginKey2@1005 : Code[20];
      Text001@1008 : TextConst 'DEU=Debitor;ENU=Customer';
      Text002@1010 : TextConst 'DEU=Kreditor;ENU=Vendor';
      Text003@1011 : TextConst 'DEU=Kontaktperson;ENU=Contact person';
      Text004@1012 : TextConst 'DEU=Interessent;ENU=Prospect';
      Text005@1013 : TextConst 'DEU=Kontakt;ENU=Contact';
      Text19012710@19068865 : TextConst 'DEU=Ankommender Anruf:;ENU=Incoming Call:';
      i@1000000000 : Integer;

    PROCEDURE DefVar@1(NewName@1000 : Text[50];NewPhoneNo@1001 : Text[30];NewOriginTab@1002 : Integer;NewOriginKey1@1003 : Code[20];NewOriginKey2@1004 : Code[20]);
    BEGIN
      Name := NewName;
      PhoneNo := NewPhoneNo;
      OriginTab := NewOriginTab;
      OriginKey1 := NewOriginKey1;
      OriginKey2 := NewOriginKey2;
      CASE OriginTab OF
      // Customer / Debitor
        18:
          BEGIN
            Origin := Text001;
            OriginNr := DELCHR(OriginKey1,'<>');
          END;
      // Vendor / Kreditor
        23:
          BEGIN
            Origin := Text002;
            OriginNr := DELCHR(OriginKey1,'<>');
          END;
      // Contact / Kontakt
        5050:
          BEGIN
            Origin := Text005;
            OriginNr := DELCHR(OriginKey1,'<>');
          END;
        ELSE BEGIN
          Origin := '';
          OriginNr := '';
        END;
      END;
    END;

    BEGIN
    {
      AT2011   05.04.2011   New for RTC: Timer for closing page (Unit: 1/10 Sec.; f.e. 50 = 5 Sec.)
                            AppTrace, Windows Script Host, Old Code deleted

      AT2017  20.05.2017    Timer deleted, loop for waiting until ClosePage
      AT2018  17.08.2019    Waiting time until page closes
    }
    END.
  }
}

OBJECT Page 56782 TAPI Setup Card
{
  OBJECT-PROPERTIES
  {
    Date=15.01.17;
    Time=12:00:00;
    Modified=Yes;
    Version List=AT2011;
  }
  PROPERTIES
  {
    CaptionML=[DEU=TAPI Einrichtung Karte;
               ENU=TAPI Setup Card];
    DeleteAllowed=No;
    SourceTable=Table56782;
    PageType=Card;
    ActionList=ACTIONS
    {
      { 1113900000;  ;ActionContainer;
                      CaptionML=DEU=Start;
                      ActionContainerType=ActionItems }
      { 1113900001;1 ;Action    ;
                      Name=CreateSetupData;
                      CaptionML=[DEU=Einrichtungsdaten erstellen;
                                 ENU=Create Setup Data];
                      Promoted=Yes;
                      Image=Setup;
                      PromotedCategory=New;
                      OnAction=BEGIN
                                 // AT2017 BEGIN
                                 IF TAPISetUp.GET THEN
                                   MESSAGE(Text001)
                                 ELSE BEGIN
                                   TAPISetUp.INIT;
                                   TAPISetUp."Length of internal phone No." := 2;
                                   TAPISetUp."Action for incoming call" := TAPISetUp."Action for incoming call"::"Show caller for short time";
                                   TAPISetUp."Create call data" := FALSE;
                                   TAPISetUp."TAPI line name" := '';
                                   TAPISetUp."Trace level" := 0;
                                   TAPISetUp."Min. length fÅr Phoneindex" := 5;
                                   TAPISetUp."Format Phone Numbers" := TRUE;
                                   TAPISetUp."Format Fax Numbers" := TRUE;
                                   TAPISetUp."Check of double numbers" := TAPISetUp."Check of double numbers"::"only unblocked numbers";
                                   TAPISetUp."Create Interaction Log Entry" := FALSE;
                                   TAPISetUp."Log internal calls" := FALSE;
                                   TAPISetUp."Runs in Developer Mode" := FALSE;
                                   TAPISetUp.INSERT;
                                   CurrPage.UPDATE;
                                 END;
                                 // AT2017 END
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[DEU=Allgemein;
                           ENU=General] }

    { 2   ;2   ;Field     ;
                SourceExpr="Length of internal phone No." }

    { 4   ;2   ;Field     ;
                SourceExpr="Action for incoming call" }

    { 6   ;2   ;Field     ;
                SourceExpr="Create call data" }

    { 8   ;2   ;Field     ;
                SourceExpr="TAPI line name" }

    { 11  ;2   ;Field     ;
                SourceExpr="Min. length fÅr Phoneindex" }

    { 13  ;2   ;Field     ;
                SourceExpr="Format Phone Numbers" }

    { 1000000000;2;Field  ;
                SourceExpr="Format Fax Numbers" }

    { 1000000002;2;Field  ;
                CaptionML=[DEU=PrÅfung doppelte Nummern;
                           ENU=Check of double numbers];
                SourceExpr="Check of double numbers" }

    { 1000000004;2;Field  ;
                SourceExpr="Create Interaction Log Entry" }

    { 1108800000;2;Field  ;
                SourceExpr="Log internal calls" }

  }
  CODE
  {
    VAR
      TAPISetUp@1000000000 : Record 56782;
      Text001@1000000001 : TextConst 'DEU=Einrichtungsdaten sid schon vorhanden.;ENU=Setup Data already exist.';
      Text002@1000000002 : TextConst 'DEU=Einrichtungsdaten wurden angelegt.;ENU=Setup Data were created.';

    BEGIN
    {
      AT01.20      08.09.2003  Fields added: Min. length fÅr Phoneindex
                                             Format Phone Numbers (at the end)
      AT04.00      04.11.2005  Field added: Format Fax Numbers
      AT2009       06.11.2009  Field added: Check of double numbers
                               Field added: Create Interaction Log Entry
      AT2011       05.04.2011  Field added: Log internal calls
      AT2017       15.01.2017  Action: Create Setup Data
    }
    END.
  }
}

OBJECT Page 56783 TAPI User
{
  OBJECT-PROPERTIES
  {
    Date=15.01.17;
    Time=12:00:00;
    Modified=Yes;
    Version List=AT2011;
  }
  PROPERTIES
  {
    CaptionML=[DEU=TAPI Benutzer;
               ENU=TAPI User];
    SourceTable=Table56783;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=User }

    { 17  ;2   ;Field     ;
                SourceExpr=Blocked }

    { 15  ;2   ;Field     ;
                SourceExpr="Action for incoming call" }

    { 4   ;2   ;Field     ;
                SourceExpr="Action for new ext. Phone No." }

    { 1000000000;2;Field  ;
                SourceExpr="Action for end of incom. call" }

    { 1000000002;2;Field  ;
                SourceExpr="Action for end of outgo. call" }

    { 6   ;2   ;Field     ;
                SourceExpr="Start activeTAPI Dialer" }

    { 8   ;2   ;Field     ;
                Lookup=Yes;
                SourceExpr="Directory of dialer";
                OnLookup=BEGIN
                           // AT2009.01 INSERT BEGIN
                           IF ISSERVICETIER THEN BEGIN
                           END ELSE BEGIN
                           // AT2009.01 INSERT END
                             IF "Start activeTAPI Dialer" THEN BEGIN
                               ImpName := BLOBTemp.IMPORT('*.exe',TRUE);
                               IF ImpName <> '' THEN BEGIN
                                 CLEAR(BLOBTemp);
                                 "Directory of dialer" := ImpName;
                               END;
                               CurrPage.UPDATE;
                             END;
                           // AT2009.01 INSERT BEGIN
                           END;
                           // AT2009.01 INSERT END
                         END;
                          }

    { 10  ;2   ;Field     ;
                SourceExpr="TAPI line name" }

  }
  CODE
  {
    VAR
      ImpName@1000000000 : Text[500];

    BEGIN
    {
      AT2009   06.11.2009   New fields: "Action for end of incom. call", "Action for end of outgo. call"
      AT2011   05.04.2011   Page created, changes for RTC: IMPORT bei Directory of dialer
    }
    END.
  }
}

OBJECT Page 56784 TAPI Logs
{
  OBJECT-PROPERTIES
  {
    Date=15.01.17;
    Time=12:00:00;
    Modified=Yes;
    Version List=AT2015;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[DEU=TAPI Protokolle;
               ENU=TAPI Logs];
    SourceTable=Table56780;
    SourceTableView=SORTING(User,Entry No.);
    PageType=List;
    OnOpenPage=BEGIN
                 // AT2009 BEGIN
                 IF (UserSetUp.GET(USERID)) AND (UserSetUp."See TAPI Logfile completely") THEN BEGIN
                   SETRANGE(User, USERID);
                 END ELSE BEGIN
                   FILTERGROUP := 2;
                   SETRANGE(User, USERID);
                   FILTERGROUP := 0;
                 END;
                 // AT2009 END
               END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000000;1 ;Action    ;
                      CaptionML=[DEU=&Anrufen;
                                 ENU=&Dial];
                      Promoted=Yes;
                      Image=Calls;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 // AT2015 CHANGED
                                 { ORIGINAL
                                 // AT2009 BEGIN
                                 IF Direction = Direction::out THEN
                                   PhoneNo := "Called ID"
                                 ELSE
                                   PhoneNo := "Caller ID";
                                 TAPIFu.DialNo(PhoneNo);
                                 END }
                                 // AT2009 END
                                 IF "Remote ID" <> '' THEN
                                   TAPIFu.DialNo("Remote ID");
                                 // AT2015
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Entry No." }

    { 4   ;2   ;Field     ;
                SourceExpr="Key local" }

    { 6   ;2   ;Field     ;
                SourceExpr=Date }

    { 8   ;2   ;Field     ;
                SourceExpr=Time }

    { 10  ;2   ;Field     ;
                SourceExpr=User }

    { 12  ;2   ;Field     ;
                SourceExpr=Direction }

    { 14  ;2   ;Field     ;
                SourceExpr=State }

    { 16  ;2   ;Field     ;
                SourceExpr=External }

    { 18  ;2   ;Field     ;
                SourceExpr="Duration (Sec.)" }

    { 20  ;2   ;Field     ;
                SourceExpr="Remote ID" }

    { 22  ;2   ;Field     ;
                SourceExpr="Remote ID Name" }

    { 59  ;2   ;Field     ;
                SourceExpr="Local ID" }

    { 61  ;2   ;Field     ;
                SourceExpr="Local ID Name" }

    { 24  ;2   ;Field     ;
                SourceExpr="Key global";
                Visible=FALSE }

    { 53  ;2   ;Field     ;
                SourceExpr=UserInfo2;
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Caller ID" }

    { 32  ;2   ;Field     ;
                SourceExpr="Called ID" }

    { 36  ;2   ;Field     ;
                SourceExpr="Connected ID";
                Visible=FALSE }

    { 40  ;2   ;Field     ;
                SourceExpr="Redirection ID";
                Visible=FALSE }

    { 44  ;2   ;Field     ;
                SourceExpr="Redirecting ID";
                Visible=FALSE }

    { 55  ;2   ;Field     ;
                SourceExpr=Reference }

    { 57  ;2   ;Field     ;
                SourceExpr=Note }

  }
  CODE
  {
    VAR
      "***** activeTAPI *****"@1000000000 : Integer;
      UserSetUp@1000000001 : Record 91;
      PhoneNo@1000000002 : Text[30];
      TAPIFu@1000000003 : Codeunit 56780;

    BEGIN
    {
      AT01.20      08.09.2003 Fields Added:   Local ID (Name), Remote ID (Name)
                              Fields deleted: UserInfo, UserInfo1
      AT2009       06.11.2009 Global Var UserSetup Rec 91
                              Filter according to User SetUp
                              SourceTableView changed from  SORTING(Entry No.)  to  SORTING(User,Entry No.)
                              Global Vars: PhoneNo   Text 30
                                           TAPIFu    CU 56780
                              Button Dial
      AT2011       05.04.2011 Page created
      AT2013       11.05.2013 Button Dial: Promoted Yes, PromotedCategory Process, Image Calls
      AT2015       02.12.2014 Dial Remote ID
    }
    END.
  }
}

OBJECT Page 56785 Page with Timer
{
  OBJECT-PROPERTIES
  {
    Date=18.06.19;
    Time=22:15:10;
    Modified=Yes;
    Version List=AT2017;
  }
  PROPERTIES
  {
    Editable=No;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    PageType=ConfirmationDialog;
    OnInit=BEGIN
             // IF ISCLEAR( AppTrace) THEN
             //  CREATE( AppTrace, TRUE, TRUE);

             // AppTrace.DebugMessage('OnInit: Page with Timer');
           END;

    OnOpenPage=VAR
                 ATUser@1000000000 : Boolean;
               BEGIN
                 // AT 2015
                 ATUser := FALSE;
                 IF UserSetUp.GET(USERID) THEN
                   IF (UserSetUp."Use activeTAPI") THEN
                     ATUser := TRUE;

                 IF NOT ATUser THEN BEGIN
                   IF ISCLEAR(WSHShell) THEN
                     CREATE(WSHShell, TRUE, TRUE);
                   WSHShell.SendKeys('{ESC}');
                   IF NOT ISCLEAR(WSHShell) THEN
                     CLEAR(WSHShell);
                     Confirmed := TRUE;
                 END;
                 // AT 2015

                 // Load Tracing

                 {
                 We use Schmidt e-Services AppTrace to trace some important information
                 into an File or UDP or ...
                 }
                 // AT2011
                 { ###
                 IF ISCLEAR(AppTrace) THEN BEGIN
                   CREATE(AppTrace,TRUE,TRUE);
                   AppTrace.InfoMessage('Start Trace in Page 56785');  // Trace a first INFO-Message
                 END;
                 }

                 IF ISCLEAR(ATTelephony) THEN BEGIN

                   // AT2011.3 refactored / Åberarbeitet

                   TestNo := TAPIFu.TAPIRights;
                   IF TestNo < 2 THEN
                     EXIT;

                   // Load and Initialize Telephony

                   {
                   The TelephonyService is activeTAPI's services layer to which all
                   applications must connect. Connecting to the service performs two
                   actions:
                   a) It registers Navision's EventHandler-Object (which has to be
                      created from Navision before)
                   b) It returns the activeTAPI.Telephony object which is THE
                      activeTAPI telephony.
                   }

                   // ### AppTrace.InfoMessage('Initialize ATTelephony');

                   IF ISCLEAR(ATTelephony) THEN
                     CREATE(ATTelephony,TRUE,TRUE);

                   ATTelephony.Initialize('NAV Client');


                   // Configuration of Telephony

                   // ### AppTrace.InfoMessage('Configure ATTelephony');

                   TAPIEInr.GET;
                   {
                   Overwrite activeTAPI's configuration settings with the values defined in
                   Navision's TAPI-Setup.
                   }

                   ATConfiguration := ATTelephony.activeTAPI_Configuration;

                   // Length of internal Phone No. / LÑnge der internen Rufnummern
                   ATConfiguration.LenOfInternal := TAPIEInr."Length of internal phone No.";

                   // Create Global key for (redirected) calls /
                   // Zentralen SchlÅssel fÅr (weitergeleitete) Telefonate erstellen
                   ATConfiguration.AutoSetCallData := TAPIEInr."Create call data";


                   // Configuration and Start of Line-Device

                   // Standard Setup for Phoning / Standard-Einstellung fÅr Telefonie
                   LineMediaMode_InteractiveVoice := 4;

                   // Standard Setup for Modem Phoning / Standard-Einstellung fÅr Modem-Telefonie
                   LineMediaMode_DataModem := 16;

                   // Owner Privilegs for selected line / Steuer-Rechte auf der gewÑhlten Leitung
                   LineCallPrivilegs_Owner := 4;

                   TAPIDriverName := TAPIFu.TAPILineReady(TestNo);

                   // ### AppTrace.InfoMessage('Close open lines');
                   WHILE ATTelephony.Lines.Count > 0 DO BEGIN
                     ATTelephony.LineClose;
                   END;

                   // Open the Line on which we want to communicate (TAPIDriverName -> LineDeviceName)
                   // ### AppTrace.InfoMessage('Line open');
                   ATTelephony.LineOpen(TAPIDriverName,LineCallPrivilegs_Owner,LineMediaMode_InteractiveVoice);

                   // AT2011 Start Dialer / Start WÑhlhilfe
                   TAPIFu.BeginOfTAPI;
                 END;

                 // Create the RTC event proxy object
                 // (This object will receive and queue the telephony events)
                 IF ISCLEAR( RtcEventManager) THEN BEGIN
                   // ### AppTrace.DebugMessage('Create RTC Eventmanager');
                   CREATE( RtcEventManager, TRUE, TRUE);
                 END;

                 // AppTrace.DebugMessage('OnOpenPage: Page with Timer');
               END;

    OnClosePage=BEGIN
                  // AppTrace.DebugMessage('OnClosePage: Page with Timer');

                  // AT 2015 BEGIN
                  { ###
                  IF NOT ISCLEAR(AppTrace) THEN
                    CLEAR(AppTrace);
                  }

                  IF NOT ISCLEAR( RtcEventManager) THEN
                    CLEAR(RtcEventManager);

                  IF NOT ISCLEAR(ATTelephony) THEN BEGIN
                    ATTelephony.Terminate;
                    CLEAR(ATTelephony);
                  END;
                  // AT 2015 END

                  TAPIFu.EndOfTAPI;
                END;

    OnQueryClosePage=BEGIN
                       IF Confirmed THEN
                         EXIT(TRUE)
                       ELSE
                         IF NOT CONFIRM(Text1000000000) THEN
                           EXIT(FALSE)
                         ELSE
                           EXIT(TRUE);
                     END;

  }
  CONTROLS
  {
    { 1113900000;0;Container;
                ContainerType=ContentArea }

    { 1113900001;1;Group  ;
                Name=Allgemein;
                GroupType=Group }

    { 1000000000;2;Field  ;
                Name=PingPong;
                CaptionML=DEU=Timer - DO NOT REMOVE;
                ControlAddIn=[Microsoft.Dynamics.Nav.Client.PingPong;PublicKeyToken=31bf3856ad364e35] }

  }
  CODE
  {
    VAR
      ATTelephony@1113900007 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{7D58078D-E0FB-4D64-9829-B909B8F6D8F6}:'activeTAPI-Telephony'.Telephony";
      ATConfiguration@1113900008 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{1000FBBF-6480-40B4-B257-F077F04F59CF}:'activeTAPI-Telephony'.Configuration";
      RtcEventManager@1113900014 : Automation "{73E3A62C-9FED-4510-A909-E99B0A09401D} 1.0:{C4F5A613-4F8D-42A9-9B02-6D46566C8631}:'activeTAPI_RTC_Services'.RtcEventManager";
      CallNewEventArgs@1113900019 : Automation "{73E3A62C-9FED-4510-A909-E99B0A09401D} 1.0:{CEAB649D-F59A-4C07-B870-331B97D00C41}:'activeTAPI_RTC_Services'.ICallNewEventArgs";
      CallFinishedEventArgs@1113900018 : Automation "{73E3A62C-9FED-4510-A909-E99B0A09401D} 1.0:{71C8C807-6938-4AC6-AF94-FB1CC85A5EFD}:'activeTAPI_RTC_Services'.ICallFinishedEventArgs";
      LineMessageEventArgs@1113900016 : Automation "{73E3A62C-9FED-4510-A909-E99B0A09401D} 1.0:{A3593B54-81F2-42AF-9326-1FCB5EBA420F}:'activeTAPI_RTC_Services'.ILineMessageEventArgs";
      CallUserInfoEventArgs@1113900015 : Automation "{73E3A62C-9FED-4510-A909-E99B0A09401D} 1.0:{F608D7F7-1C9B-4C26-8054-CF1CBA701AC6}:'activeTAPI_RTC_Services'.ICallUserInfoEventArgs";
      AppTrace@1113900002 : Automation "{600E23A8-24BF-43EE-BA93-691E0DFFAD1A} 2.0:{1B61767C-91A3-4632-9E92-A8C29C7DA936}:'activeTAPI_NET_Services'.AppTrace";
      Text1000000000@1113900000 : TextConst 'DEU=Mit dem Schlie·en dieser Page beenden Sie die Telefonie-Verarbeitung. Fortfahren ?;ENU=If you close thos page, you will stop processing of telephony. Continue ?';
      WSHShell@1113900005 : Automation "{F935DC20-1CF0-11D0-ADB9-00C04FD58A0B} 1.0:{72C24DD5-D70A-438B-8A42-98424B88AFB8}:'Windows Script Host Object Model'.WshShell";
      TAPIFu@1113900003 : Codeunit 56780;
      UserSetUp@1113900017 : Record 91;
      TAPIEInr@1113900006 : Record 56782;
      RtcEventLoopActive@1113900013 : Boolean;
      Confirmed@1113900001 : Boolean;
      LineCallPrivilegs_Owner@1113900012 : Integer;
      LineMediaMode_InteractiveVoice@1113900011 : Integer;
      LineMediaMode_DataModem@1113900010 : Integer;
      TestNo@1113900009 : Integer;
      EventType@1113900020 : Integer;
      TAPIDriverName@1113900004 : Text[50];

    EVENT PingPong@-1000000000::AddInReady@2();
    BEGIN
      // AT2017 BEGIN
      CurrPage.PingPong.Ping(100);
      // AT2017 END
    END;

    EVENT PingPong@-1000000000::Pong@3();
    BEGIN
      // AT2017 BEGIN
      // code runs every 100ms
      REPEAT
        EventType := RtcEventManager.GetNextEvent();
      // ###   AppTrace.InfoMessage( 'Got EventArguments of Type' +  FORMAT(EventType));

        // None = 0, CallNew = 1, CallFinished = 2, LineMessage = 3, CallUserInfo = 4
        CASE EventType OF
          0: BEGIN
      // ###          AppTrace.DebugMessage( 'Empty Queue');
             END;
          1: BEGIN
      // ###          AppTrace.DebugMessage( 'Got CallNew');
               CallNewEventArgs := RtcEventManager.GetCallNewEventArgs;
               TAPIFu.HandleCallNew(CallNewEventArgs.CurrentCall);
      // ###          AppTrace.DebugMessage( 'Got CallNew after Handle');
             END;
          2: BEGIN
      // ###          AppTrace.InfoMessage( 'Got CallFinished');
               CallFinishedEventArgs := RtcEventManager.GetCallFinishedEventArgs;
               TAPIFu.HandleCallFinished(CallFinishedEventArgs.CurrentCall);
      // ###          AppTrace.InfoMessage( 'Got CallFinished after Handle');
             END;
          3: BEGIN
      // ###          AppTrace.InfoMessage( 'Got LineMessage');
               LineMessageEventArgs := RtcEventManager.GetLineMessageEventArgs;
               TAPIFu.HandleLineMessage(LineMessageEventArgs.CurrentCall);
      // ###          AppTrace.InfoMessage( 'Got LineMessage after Handle');
             END;
          4: BEGIN
      // ###          AppTrace.InfoMessage( 'Got CallUserInfo');
               CallUserInfoEventArgs := RtcEventManager.GetCallUserInfoEventArgs;
               TAPIFu.HandleCallUserInfo(CallUserInfoEventArgs.CurrentCall, CallUserInfoEventArgs.UserInfoBits);
      // ###          AppTrace.InfoMessage( 'Got CallUserInfo after Handle');
             END;
        END;
      UNTIL EventType=0;

      CurrPage.PingPong.Ping(100);
      // AT2017 END
    END;

    BEGIN
    {
      AT2011   05.04.2011  New for RTC: Page with Timer, calls CU 56783, AppTrace
                           Warning OnClosePage
      AT2011.3 11.10.2011  Transfer of old Codeunit 56783 "TAPI for RTC" to this page
      AT2013   24.05.2014  Page Type Confirmation Dialog (thanks to Peter) instead of Card
               02.12.2014  No, it must be Card, because of 2 Errors while closing of NAV
      AT2015   03.02.2015  Clear all Automation Variables before Page Close
                           OnOpenPage   Local Var ATUser Boolean
                           PageType Confirmation Dialog: Non visible (Standard)
                           Option PageType Card: Page becomes visible
      AT2017   20.05.2017  activeTAPI-Timer deleted, use of PingPong-Timer
    }
    END.
  }
}

OBJECT Page 56786 Menu Phone No. not found
{
  OBJECT-PROPERTIES
  {
    Date=15.01.17;
    Time=12:00:00;
    Modified=Yes;
    Version List=AO,AT2013;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[DEU=Auswahl Telefonnr. nicht gefunden;
               ENU=Menu Phone No. not found];
    PageType=Card;
    OnOpenPage=BEGIN
                 TestNo := TAPIFu.TAPIRights;

                 LineEntryNo := 0;

                 TAPIEinr.GET;

                 TAPIUser.INIT;
                 IF TAPIUser.GET(USERID) THEN ;

                 // Standard Setup for Phoning / Standard-Einstellung fÅr Telefonie
                 LineMediaMode_InteractiveVoice := 4;

                 // Standard Setup for Modem Phoning / Standard-Einstellung fÅr Modem-Telefonie
                 LineMediaMode_DataModem := 16;

                 // Length of internal Phone No. / LÑnge der internen Rufnummern
                 LenOfInternal := TAPIEinr."Length of internal phone No.";

                 // Create Global key for (redirected) calls /
                 // Zentralen SchlÅssel fÅr (weitergeleitete) Telefonate erstellen
                 CallDataErstellen := TAPIEinr."Create call data";

                 TAPIDriverName := TAPIFu.TAPILineReady(TestNo);

                 // AT2011 CHANGED
                 IF ISCLEAR(ATEventSource) THEN
                   CREATE(ATEventSource,TRUE,TRUE);

                 IF ISCLEAR(ATTelephony) THEN
                   CREATE(ATTelephony,TRUE,TRUE);
                 // AT2011 END
               END;

    OnClosePage=BEGIN
                  // AT2011 CHANGED
                  CLEAR(ATTelephony);
                  CLEAR(ATEventSource);
                  // AT2011 END
                END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000000;1 ;Action    ;
                      Name=CustList;
                      CaptionML=[DEU=Suchen (Debitor öbersicht);
                                 ENU=Find (Customer List)];
                      Promoted=Yes;
                      Image=CustomerList;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 // AT2013 CHANGED
                                 PAGE.RUN(22);
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=CustCard;
                      CaptionML=[DEU=Debitor anlegen (Karte);
                                 ENU=Insert Customer (Card)];
                      Promoted=Yes;
                      Image=Customer;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 // AT2013 CHANGED
                                 PAGE.RUN(21);
                               END;
                                }
      { 1000000002;1 ;Action    ;
                      Name=ContCard;
                      CaptionML=[DEU=Kontakt anlegen (Karte);
                                 ENU=Insert Contact (Card)];
                      Promoted=Yes;
                      Image=Company;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 // AT2013 CHANGED
                                 PAGE.RUN(5050);
                               END;
                                }
      { 3       ;1   ;Action    ;
                      Name=ItemList;
                      CaptionML=[DEU=Lager (Artikel-öbersicht);
                                 ENU=Inventory (Item List)];
                      Promoted=Yes;
                      Image=Item;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 // AT2013 CHANGED
                                 PAGE.RUN(31);
                               END;
                                }
      { 5       ;1   ;Action    ;
                      Name=PhoneNoFindAgain;
                      CaptionML=[DEU=Telefonnr. erneut suchen;
                                 ENU=Find Phone No. again];
                      Promoted=Yes;
                      Image=Find;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CurrPage.CLOSE;
                                 TAPIFu.PhoneNoFindAgain(PhoneNo);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000006;1;Field  ;
                CaptionML=[DEU=Telefon-Nr.;
                           ENU=Phone No.];
                SourceExpr=PhoneNo;
                Editable=FALSE }

  }
  CODE
  {
    VAR
      ATTelephony@1003 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{7D58078D-E0FB-4D64-9829-B909B8F6D8F6}:'activeTAPI-Telephony'.Telephony" WITHEVENTS;
      ATEventSource@1002 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{206D2787-8575-4750-A727-38FC5DBFA1A3}:'activeTAPI-Telephony'.EventSource" WITHEVENTS;
      TAPIEinr@1000000001 : Record 56782;
      TAPIUser@1000000002 : Record 56783;
      TAPIFu@1000 : Codeunit 56780;
      PhoneNo@1000000008 : Text[30];
      TAPIDriverName@1000000007 : Text[50];
      MachName@1006 : Text[50];
      LineEntryNo@1000000000 : Integer;
      LineMediaMode_InteractiveVoice@1000000003 : Integer;
      LineMediaMode_DataModem@1000000004 : Integer;
      LenOfInternal@1000000005 : Integer;
      TestNo@1000000011 : Integer;
      CallDataErstellen@1000000006 : Boolean;
      Text19012710@19068865 : TextConst 'DEU=Ankommender Anruf:;ENU=Incoming Call:';
      Text19068692@19039855 : TextConst 'DEU=Telefonnr. nicht gefunden;ENU=Phone No. not found';

    PROCEDURE DefVar@1(NewPhoneNo@1001 : Text[30]);
    BEGIN
      PhoneNo := NewPhoneNo;
    END;

    EVENT ATEventSource@1002::CallNew@1(CurrentCall@1113900000 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{BA7151F3-8ECC-4507-9F7C-1C38E76F0054}:'activeTAPI-Telephony'._ActiveCall");
    BEGIN
    END;

    EVENT ATEventSource@1002::CallFinished@2(CurrentCall@1113900000 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{BA7151F3-8ECC-4507-9F7C-1C38E76F0054}:'activeTAPI-Telephony'._ActiveCall");
    BEGIN
      CurrPage.CLOSE;
    END;

    EVENT ATEventSource@1002::lineMessage@3(CurrentCall@1113900005 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{BA7151F3-8ECC-4507-9F7C-1C38E76F0054}:'activeTAPI-Telephony'._ActiveCall";CallHandleOrLineHandle@1113900004 : Integer;message@1113900003 : Integer;param1@1113900002 : Integer;param2@1113900001 : Integer;param3@1113900000 : Integer);
    BEGIN
    END;

    EVENT ATEventSource@1002::CallUserInfo@4(CurrentCall@1113900003 : Automation "{4A0E722A-1AD9-4643-8635-64564418E226} 1.1:{BA7151F3-8ECC-4507-9F7C-1C38E76F0054}:'activeTAPI-Telephony'._ActiveCall";UserInfoBits@1113900002 : Integer;OldValue@1113900001 : Text[1024];NewValue@1113900000 : Text[1024]);
    BEGIN
    END;

    EVENT ATEventSource@1002::WatchDog@5();
    BEGIN
    END;

    BEGIN
    {
      AT01a     13.03.2008   New Connection with Automation objects
      AT2011    05.04.2011   Changes for RTC: CREATE, new EventSource
      AT2011.3  11.10.2011   Reassignment of Automation Variables
      AT2013    11.05.2013   FORM replaced by PAGE
    }
    END.
  }
}

OBJECT Page 56787 TAPI Lines
{
  OBJECT-PROPERTIES
  {
    Date=15.01.17;
    Time=12:00:00;
    Modified=Yes;
    Version List=AT2011;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[DEU=TAPI Leitungen;
               ENU=TAPI Lines];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table56784;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 1000000000;2;Field  ;
                SourceExpr="TAPI Line name" }

  }
  CODE
  {

    BEGIN
    {
      AT2011   05.04.2011 Page created
    }
    END.
  }
}

OBJECT Page 56788 End of Call in
{
  OBJECT-PROPERTIES
  {
    Date=17.08.19;
    Time=19:00:00;
    Modified=Yes;
    Version List=AT2018;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Abschlu· Telefonat eingehend;
               ENU=End of call in];
    InsertAllowed=No;
    DeleteAllowed=No;
    PageType=Card;
    OnInit=BEGIN
             CallBackEnable := TRUE;
           END;

    OnOpenPage=BEGIN
                 IF TAPIFu.TAPIRights < 2 THEN
                   ERROR(Text007,USERID);

                 TAPISetup.GET;

                 TAPIUser.INIT;
                 IF TAPIUser.GET(USERID) THEN;

                 RefText := '';
                 NoteText := '';

                 // AT2009 BEGIN
                 IF Found THEN
                   CallBackEnable := TRUE
                 ELSE
                   CallBackEnable := FALSE;
                 // AT2009 END

                 // AT2011 START
                 IF Found THEN
                   TextFound := Text005
                 ELSE
                   TextFound := Text006;
                 // AT2011 END
               END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000000;1 ;Action    ;
                      Name=CallBack;
                      CaptionML=[DEU=&ZurÅckrufen;
                                 ENU=&Call back];
                      Promoted=Yes;
                      Enabled=CallBackEnable;
                      Image=Calls;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 // AT2009 BEGIN
                                 // AT2018
                                 TAPILog.RESET;
                                 TAPILog.LOCKTABLE;
                                 TAPILog.SETRANGE("Key local", GUID);
                                 IF TAPILog.FINDSET THEN BEGIN
                                   TAPILog.Closed := TRUE;
                                   TAPILog.Reference := RefText;
                                   TAPILog.Note := NoteText;
                                   TAPILog.MODIFY;
                                 END;
                                 CurrPage.CLOSE;

                                 TAPIFu.DialNo(PhoneNo);
                                 // AT2009 END
                               END;
                                }
      { 3       ;1   ;Action    ;
                      Name=Done;
                      CaptionML=[DEU=Erledigt;
                                 ENU=Done];
                      Promoted=Yes;
                      Image=Approve;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 // AT2018
                                 TAPILog.RESET;
                                 TAPILog.LOCKTABLE;
                                 TAPILog.SETRANGE("Key local", GUID);
                                 IF TAPILog.FINDSET THEN BEGIN
                                   TAPILog.Reference := RefText;
                                   TAPILog.Note := NoteText;
                                   TAPILog.Closed := TRUE;
                                   TAPILog.MODIFY;
                                 END;

                                 CurrPage.CLOSE;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 9   ;1   ;Field     ;
                CaptionML=[DEU=Suche;
                           ENU=Find];
                SourceExpr=TextFound;
                Editable=FALSE;
                Style=Standard;
                StyleExpr=TRUE }

    { 1000000013;1;Field  ;
                CaptionML=[DEU=Telefon-Nr.;
                           ENU=Phone No.];
                SourceExpr=PhoneNo;
                Editable=FALSE }

    { 1000000014;1;Field  ;
                CaptionML=[DEU=Name;
                           ENU=Name];
                SourceExpr=Name;
                Editable=FALSE;
                Style=Standard;
                StyleExpr=TRUE }

    { 1000000012;1;Field  ;
                CaptionML=[DEU=Herkunft;
                           ENU=Origin];
                SourceExpr=Origin;
                Editable=FALSE }

    { 1000000021;1;Field  ;
                CaptionML=[DEU=Herkunft-Nr.;
                           ENU=Origin No.];
                SourceExpr=OriginNr;
                Editable=FALSE }

    { 10  ;1   ;Field     ;
                Name=<ReferenceText>;
                CaptionML=[DEU=Bezug;
                           ENU=Reference];
                SourceExpr=RefText;
                OnValidate=BEGIN
                             IF STRLEN(RefText) = 1 THEN BEGIN
                               RefKurz := DELCHR(RefText, '<>');
                               RefKurz := UPPERCASE(RefKurz);
                               CASE COPYSTR(RefKurz,1,1) OF
                                 'N': RefText := 'Angebot Nr. ';
                                 'A': RefText := 'Auftrag Nr. ';
                                 'R': RefText := 'Reklamation Nr. ';
                               END;
                             END;
                           END;
                            }

    { 12  ;1   ;Field     ;
                CaptionML=[DEU=Bemerkung;
                           ENU=Note];
                SourceExpr=NoteText }

  }
  CODE
  {
    VAR
      Text001@1008 : TextConst 'DEU=Debitor;ENU=Customer';
      Text002@1010 : TextConst 'DEU=Kreditor;ENU=Vendor';
      Text003@1011 : TextConst 'DEU=Kontaktperson;ENU=Contact person';
      Text004@1012 : TextConst 'DEU=Interessent;ENU=Prospect';
      Cust@1000000003 : Record 18;
      Vend@1000000002 : Record 23;
      ContAtt@1029 : Record 5050;
      TAPIUser@1016 : Record 56783;
      TAPILog@1020 : Record 56780;
      TAPICallActions@1019 : Record 56785;
      TAPISetup@1022 : Record 56782;
      TAPIFu@1023 : Codeunit 56780;
      GUID@1000 : Text[40];
      Name@1005 : Text[50];
      PhoneNo@1003 : Text[30];
      Origin@1002 : Text[30];
      OriginNr@1001 : Text[30];
      TextFound@1004 : Text[30];
      RefText@1018 : Text[30];
      RefKurz@1024 : Text[1];
      NoteText@1017 : Text[80];
      Text005@1014 : TextConst 'DEU=Telefonnr. gefunden;ENU=Phone No. found';
      Text006@1015 : TextConst 'DEU=Telefonnr. nicht gefunden;ENU=Phone No. not found';
      OriginKey1@1021 : Code[20];
      OriginKey2@1013 : Code[20];
      OriginTab@1009 : Integer;
      EntryNo@1007 : Integer;
      LfdNr@1032 : Integer;
      Found@1006 : Boolean;
      Text007@1000000005 : TextConst 'DEU=FÅr Benutzer %1 ist keine Telefonie eingerichtet.;ENU=For User %1 there exists no Phone Setup.';
      Text008@1030 : TextConst 'DEU=Kontakt;ENU=Contact';
      CallBackEnable@19050219 : Boolean INDATASET;
      Text19044136@19057201 : TextConst 'DEU=Abschlu· Anruf eingehend:;ENU=End of Call in:';

    PROCEDURE DefVar@1(NewGUID@1005 : Text[40];NewFound@1006 : Boolean;NewName@1000 : Text[50];NewPhoneNo@1001 : Text[30];NewOriginTab@1002 : Integer;NewOriginKey1@1003 : Code[20];NewOriginKey2@1004 : Code[20]);
    BEGIN
      GUID := NewGUID;
      Found := NewFound;
      Name := NewName;
      PhoneNo := NewPhoneNo;
      OriginTab := NewOriginTab;
      OriginKey1 := NewOriginKey1;
      OriginKey2 := NewOriginKey2;
      IF Found THEN BEGIN
        CASE OriginTab OF
          // Customer / Debitor
          18:
            BEGIN
              Origin := Text001;
              OriginNr := DELCHR(OriginKey1,'<>');
            END;
          // Vendor / Kreditor
          23:
            BEGIN
              Origin := Text002;
              OriginNr := DELCHR(OriginKey1,'<>');
            END;
          // Contact / Kontakt
          5050:
            BEGIN
              Origin := Text008;
              OriginNr := DELCHR(OriginKey1,'<>');
            END;
          ELSE BEGIN
            Origin := '';
            OriginNr := '';
          END;
          // AT2011 TextFound transferred to OnOpenPage
        END;
      END ELSE BEGIN
        Origin := '';
        OriginNr := '';
        // AT2011 TextFound transferred to OnOpenPage
      END;
    END;

    BEGIN
    {
      AT05.00    16.06.2007  Length of all name-fields changed form 30 to 50
      AT2009     06.11.2009  Button "Call back", if found
      AT2011     05.04.2011  Changes for RTC (Order of buttons),
                             Old Code deleted, TextFound transferred to OnOpenPage
                 08.04.2011  Error text found corrected
      AT2018     17.08.2019  Table locking
    }
    END.
  }
}

OBJECT Page 56789 End of Call out
{
  OBJECT-PROPERTIES
  {
    Date=17.08.19;
    Time=19:00:00;
    Modified=Yes;
    Version List=AT2018;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Abschlu· Telefonat ausgehend;
               ENU=End of call out];
    InsertAllowed=No;
    DeleteAllowed=No;
    PageType=Card;
    OnInit=BEGIN
             CreaInteractionLogEnable := TRUE;
             TryAgainEnable := TRUE;
             CreaInteractionLogVisible := TRUE;
           END;

    OnOpenPage=BEGIN
                 IF TAPIFu.TAPIRights < 2 THEN
                   ERROR(Text007,USERID);

                 TAPISetup.GET;

                 TAPIUser.INIT;
                 IF TAPIUser.GET(USERID) THEN;

                 // AT04.00 BEGIN
                 TAPILog.INIT;
                 IF (TAPILog.GET(GUID)) AND (TAPILog.State = TAPILog.State::"not connected") THEN
                   TryAgainEnable := TRUE
                 ELSE
                   TryAgainEnable := FALSE;
                 // AT04.00 END

                 RefText := '';
                 NoteText := '';

                 // AT2009 BEGIN
                 IF (TAPISetup."Create Interaction Log Entry") AND (Found) THEN BEGIN
                   CreaInteractionLogVisible := TRUE;
                   CreaInteractionLogEnable := TRUE;
                 END ELSE BEGIN
                   CreaInteractionLogEnable := FALSE;
                   CreaInteractionLogVisible := FALSE;
                 END;
                 // AT2009 END

                 // AT2011 START
                 IF Found THEN
                   TextFound := Text005
                 ELSE
                   TextFound := Text006;
                 // AT2011 END
               END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000001;1 ;Action    ;
                      Name=CreaInteractionLog;
                      CaptionML=[DEU=Akt.-Protokoll erst.;
                                 ENU=Create Interact. Log];
                      Promoted=Yes;
                      Visible=CreaInteractionLogVisible;
                      Enabled=CreaInteractionLogEnable;
                      Image=CreateInteraction;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 // AT2009 BEGIN
                                 Verb := FALSE;
                                 // AT2018
                                 TAPILog.RESET;
                                 TAPILog.LOCKTABLE;
                                 TAPILog.SETRANGE("Key local", GUID);
                                 IF TAPILog.FINDSET THEN BEGIN
                                   TAPILog.Closed := TRUE;
                                   TAPILog.Reference := RefText;
                                   TAPILog.Note := NoteText;
                                   TAPILog.MODIFY;
                                   IF TAPILog.State = TAPILog.State::connected THEN
                                     Verb := TRUE;
                                 END;
                                 TAPILog.RESET;

                                 CurrPage.EDITABLE(FALSE);
                                 TAPIFu.CreateInteractLogEntry(GUID, Found, Name, PhoneNo, OriginTab, OriginKey1, OriginKey2, Verb);
                                 CurrPage.CLOSE;
                                 // AT2009 END
                               END;
                                }
      { 1000000000;1 ;Action    ;
                      Name=TryAgain;
                      CaptionML=[DEU=Erneut anrufen;
                                 ENU=Dial again];
                      Promoted=Yes;
                      Enabled=TryAgainEnable;
                      Image=Calls;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 // AT04.00 BEGIN
                                 // AT2018
                                 TAPILog.RESET;
                                 TAPILog.LOCKTABLE;
                                 TAPILog.SETRANGE("Key local", GUID);
                                 IF TAPILog.FINDSET THEN BEGIN
                                   TAPILog.Closed := TRUE;
                                   TAPILog.Reference := RefText;
                                   TAPILog.Note := NoteText;
                                   TAPILog.MODIFY;
                                 END;
                                 TAPILog.RESET;

                                 CurrPage.CLOSE;

                                 TAPIFu.DialNo(PhoneNo);
                                 // AT04.00 END
                               END;
                                }
      { 3       ;1   ;Action    ;
                      Name=Done;
                      CaptionML=[DEU=Erledigt;
                                 ENU=Done];
                      Promoted=Yes;
                      Image=Approve;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 // AT2018
                                 TAPILog.RESET;
                                 TAPILog.LOCKTABLE;
                                 TAPILog.SETRANGE("Key local", GUID);
                                 IF TAPILog.FINDSET THEN BEGIN
                                   TAPILog.Closed := TRUE;
                                   TAPILog.Reference := RefText;
                                   TAPILog.Note := NoteText;
                                   TAPILog.MODIFY;
                                 END;
                                 TAPILog.RESET;

                                 CurrPage.CLOSE;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 9   ;1   ;Field     ;
                CaptionML=[DEU=Suche;
                           ENU=Find];
                SourceExpr=TextFound;
                Editable=FALSE;
                Style=Standard;
                StyleExpr=TRUE }

    { 1000000013;1;Field  ;
                CaptionML=[DEU=Telefon-Nr.;
                           ENU=Phone No.];
                SourceExpr=PhoneNo;
                Editable=FALSE }

    { 1000000014;1;Field  ;
                CaptionML=[DEU=Name;
                           ENU=Name];
                SourceExpr=Name;
                Editable=FALSE;
                Style=Standard;
                StyleExpr=TRUE }

    { 1000000012;1;Field  ;
                CaptionML=[DEU=Herkunft;
                           ENU=Origin];
                SourceExpr=Origin;
                Editable=FALSE }

    { 1000000021;1;Field  ;
                CaptionML=[DEU=Herkunft-Nr.;
                           ENU=Origin No.];
                SourceExpr=OriginNr;
                Editable=FALSE }

    { 10  ;1   ;Field     ;
                Name=<ReferenceText>;
                CaptionML=[DEU=Bezug;
                           ENU=Reference];
                SourceExpr=RefText;
                OnValidate=BEGIN
                             IF STRLEN(RefText) = 1 THEN BEGIN
                               RefKurz := DELCHR(RefText, '<>');
                               RefKurz := UPPERCASE(RefKurz);
                               CASE COPYSTR(RefKurz,1,1) OF
                                 'N': RefText := 'Angebot Nr. ';
                                 'A': RefText := 'Auftrag Nr. ';
                                 'R': RefText := 'Reklamation Nr. ';
                               END;
                             END;
                           END;
                            }

    { 12  ;1   ;Field     ;
                CaptionML=[DEU=Bemerkung;
                           ENU=Note];
                SourceExpr=NoteText }

  }
  CODE
  {
    VAR
      Text001@1008 : TextConst 'DEU=Debitor;ENU=Customer';
      Text002@1010 : TextConst 'DEU=Kreditor;ENU=Vendor';
      Text003@1011 : TextConst 'DEU=Kontaktperson;ENU=Contact person';
      Text004@1012 : TextConst 'DEU=Interessent;ENU=Prospect';
      Cust@1000000003 : Record 18;
      Vend@1000000002 : Record 23;
      ContAtt@1025 : Record 5050;
      TAPIUser@1016 : Record 56783;
      TAPILog@1020 : Record 56780;
      TAPISetup@1022 : Record 56782;
      TAPIFu@1023 : Codeunit 56780;
      GUID@1000 : Text[40];
      Name@1005 : Text[50];
      PhoneNo@1003 : Text[30];
      Origin@1002 : Text[30];
      OriginNr@1001 : Text[30];
      TextFound@1004 : Text[30];
      RefText@1018 : Text[30];
      RefKurz@1000000004 : Text[30];
      NoteText@1017 : Text[80];
      OriginKey1@1007 : Code[20];
      OriginKey2@1006 : Code[20];
      OriginTab@1009 : Integer;
      EntryNo@1021 : Integer;
      LfdNr@1034 : Integer;
      Found@1013 : Boolean;
      Text005@1014 : TextConst 'DEU=Telefonnr. gefunden;ENU=Phone No. found';
      Text006@1015 : TextConst 'DEU=Telefonnr. nicht gefunden;ENU=Phone No. not found';
      Text007@1000000005 : TextConst 'DEU=FÅr Benutzer %1 ist keine Telefonie eingerichtet.;ENU=For User %1 there exists no Phone Setup.';
      Text008@1026 : TextConst 'DEU=Kontakt;ENU=Contact';
      Verb@1000000000 : Boolean;
      CreaInteractionLogVisible@19011882 : Boolean INDATASET;
      TryAgainEnable@19040024 : Boolean INDATASET;
      CreaInteractionLogEnable@19036515 : Boolean INDATASET;

    PROCEDURE DefVar@1(NewGUID@1005 : Text[40];NewFound@1006 : Boolean;NewName@1000 : Text[50];NewPhoneNo@1001 : Text[30];NewOriginTab@1002 : Integer;NewOriginKey1@1003 : Code[20];NewOriginKey2@1004 : Code[20]);
    BEGIN
      GUID := NewGUID;
      Found := NewFound;
      Name := NewName;
      PhoneNo := NewPhoneNo;
      OriginTab := NewOriginTab;
      OriginKey1 := NewOriginKey1;
      OriginKey2 := NewOriginKey2;
      IF Found THEN BEGIN
        CASE OriginTab OF
          // Customer / Debitor
          18:
            BEGIN
              Origin := Text001;
              OriginNr := DELCHR(OriginKey1,'<>');
            END;
          // Vendor / Kreditor
          23:
            BEGIN
              Origin := Text002;
              OriginNr := DELCHR(OriginKey1,'<>');
            END;
          // Kontaktperson
          5050:
            BEGIN
              Origin := Text008;
              OriginNr := DELCHR(OriginKey1,'<>');
            END;
          ELSE BEGIN
            Origin := '';
            OriginNr := '';
          END;
          // AT2011 TextFound transferred to OnOpenPage
        END;
      END ELSE BEGIN
        Origin := '';
        OriginNr := '';
        // AT2011 TextFound transferred to OnOpenPageEND;
      END;
    END;

    BEGIN
    {
      AT04.00    04.11.2005  Dial again if not connected
      AT05.00    16.06.2007  Length of all name-fields changed form 30 to 50
      AT2009     06.11.2009  Option Create Interaction Log Entry
      AT2011     05.04.2011  Changes for RTC (Order of buttons),
                             delete old Code, TextFound transferred to OnOpenPage
      AT2018     17.08.2019  Table locking

    }
    END.
  }
}

OBJECT Page 56790 Phone Indexes
{
  OBJECT-PROPERTIES
  {
    Date=15.01.17;
    Time=12:00:00;
    Modified=Yes;
    Version List=AT2011;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Telefon-Indices;
               ENU=Phone Indexes];
    SourceTable=Table56781;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Table of origin" }

    { 4   ;2   ;Field     ;
                SourceExpr="No. of origin" }

    { 6   ;2   ;Field     ;
                SourceExpr="No. 2 of origin" }

    { 8   ;2   ;Field     ;
                SourceExpr="Type of origin" }

    { 10  ;2   ;Field     ;
                SourceExpr="Name of origin" }

    { 12  ;2   ;Field     ;
                SourceExpr="Phone No." }

  }
  CODE
  {

    BEGIN
    {
      AT2011   05.04.2011   Page created
    }
    END.
  }
}

OBJECT Page 56791 Notes for Phone-Index
{
  OBJECT-PROPERTIES
  {
    Date=15.01.17;
    Time=12:00:00;
    Modified=Yes;
    Version List=AT2011;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Hinweise fÅr Telefon-Index;
               ENU=Notes for Phone-Index];
    SourceTable=Table56785;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Lfd.Nr." }

    { 4   ;2   ;Field     ;
                SourceExpr=Text }

  }
  CODE
  {

    BEGIN
    {
      At2011   05.04.2011   Page created
    }
    END.
  }
}

OBJECT Page 56792 Find Phone No.
{
  OBJECT-PROPERTIES
  {
    Date=15.01.17;
    Time=12:00:00;
    Modified=Yes;
    Version List=AT2013;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Telefonnr. suchen;
               ENU=Find Phone No.];
    SaveValues=Yes;
    SourceTable=Table56786;
    PageType=NavigatePage;
    OnInit=BEGIN
             ShowEnable := TRUE;
           END;

    OnOpenPage=BEGIN
                 PhoneNo := '';
                 ShowEnable := FALSE;
                 RESET;
                 DELETEALL;
               END;

    OnFindRecord=BEGIN
                   PhoneIndexTemp := Rec;
                   IF NOT PhoneIndexTemp.FIND(Which) THEN
                     EXIT(FALSE);
                   Rec := PhoneIndexTemp;
                   EXIT(TRUE);
                 END;

    OnNextRecord=VAR
                   CurrentSteps@1001 : Integer;
                 BEGIN
                   PhoneIndexTemp := Rec;
                   CurrentSteps := PhoneIndexTemp.NEXT(Steps);
                   IF CurrentSteps <> 0 THEN
                     Rec := PhoneIndexTemp;
                   EXIT(CurrentSteps);
                 END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 21      ;1   ;Action    ;
                      Name=Show;
                      CaptionML=[DEU=An&zeigen;
                                 ENU=&Show];
                      Promoted=Yes;
                      Enabled=ShowEnable;
                      Image=View;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowRecords;
                               END;
                                }
      { 2       ;1   ;Action    ;
                      CaptionML=[DEU=&Suchen;
                                 ENU=Fi&nd];
                      Promoted=Yes;
                      Image=Find;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 RESET;
                                 DELETEALL;

                                 IF STRLEN(PhoneNo) > 1 THEN BEGIN
                                   IF COPYSTR(PhoneNo,1,1) = '0' THEN BEGIN
                                     Len := STRLEN(PhoneNo);
                                     PhoneNo := COPYSTR(PhoneNo, 2,Len-1);
                                   END;
                                 END;

                                 PhoneNoClean := CONVERTSTR(PhoneNo,'-_+()/','      ');
                                 PhoneNoClean := DELCHR(PhoneNoClean, '<=>');
                                 PhoneNo := PhoneNoClean;
                                 FindRecords;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 3   ;1   ;Field     ;
                CaptionML=[DEU=Gesuchte Telefonnr.;
                           ENU=Phone No. to find];
                SourceExpr=PhoneNo }

    { 16  ;1   ;Group     ;
                Name=Results;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000000000;2;Field  ;
                Name=TableName;
                SourceExpr="Table Name" }

    { 1000000002;2;Field  ;
                SourceExpr="No. of origin" }

    { 1000000004;2;Field  ;
                SourceExpr="Name of origin" }

    { 1000000006;2;Field  ;
                SourceExpr="Phone No." }

  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'DEU=Keinen Eintrag mit dieser Telefonnummer gefunden.;ENU=No Entry found with this Phone No.';
      Text001@1002 : TextConst 'DEU=DatensÑtze werden gezÑhlt...;ENU=Counting records...';
      Text003@1003 : TextConst 'DEU=Geb. Verkaufsrechnung;ENU=Posted Sales Invoice';
      Text004@1004 : TextConst 'DEU=Geb. Verkaufsgutschrift;ENU=Posted Sales Credit Memo';
      Text005@1005 : TextConst 'DEU=Geb. Verkaufslieferung;ENU=Posted Sales Shipment';
      Text006@1006 : TextConst 'DEU=Registrierte Mahnung;ENU=Issued Reminder';
      Text007@1007 : TextConst 'DEU=Registrierte Zinsrechnungen;ENU=Issued Finance Charge Memo';
      Text008@1008 : TextConst 'DEU=Geb. Einkaufsrechnung;ENU=Posted Purchase Invoice';
      Text009@1009 : TextConst 'DEU=Geb. Einkaufsgutschrift;ENU=Posted Purchase Credit Memo';
      Text010@1010 : TextConst 'DEU=Geb. Einkaufslieferung;ENU=Posted Purchase Receipt';
      Text011@1011 : TextConst 'DEU=Die Belegnummer wurde mehrmals verwendet.;ENU=The document number has been used more than once.';
      Text012@1012 : TextConst 'DEU=Diese Kombination von Belegnummer und Buchungsdatum wurde mehrmals verwendet.;ENU=This combination of document number and posting date has been used more than once.';
      Text013@1013 : TextConst 'DEU=Es gibt keine geb. DatensÑtze mit dieser Belegnummer.;ENU=There are no posted records with this document number.';
      Text014@1014 : TextConst 'DEU=Es gibt keine DatensÑtze mit dieser Kombination aus Belegnummer und Buchungsdatum.;ENU=There are no posted records with this combination of document number and posting date.';
      Text015@1015 : TextConst 'DEU=Die Suche ergibt zu viele externe Belege. Bitte geben Sie eine Kontaktnr. an.;ENU=The search results in too many external documents. Please specify a business contact no.';
      Text016@1016 : TextConst 'DEU=Das Suchergebnis ist in zu vielen externen Belegen. Bitte verwenden Sie Navigate auf den relevanten Posten.;ENU=The search results in too many external documents. Please use Navigate from the relevant ledger entries.';
      Text017@1017 : TextConst 'DEU=Gebuchte RÅcksendung;ENU=Posted Return Receipt';
      Text018@1018 : TextConst 'DEU=Gebuchte RÅcklieferung;ENU=Posted Return Shipment';
      Text019@1019 : TextConst 'DEU=Geb. Umlag.-Ausgang;ENU=Posted Transfer Shipment';
      Text020@1020 : TextConst 'DEU=Geb. Umlag.-Eingang;ENU=Posted Transfer Receipt';
      Text021@1061 : TextConst 'DEU=Verkaufsauftrag;ENU=Sales Order';
      Text022@1080 : TextConst 'DEU=Verkaufsrechnung;ENU=Sales Invoice';
      Text023@1081 : TextConst 'DEU=Verkaufsreklamation;ENU=Sales Return Order';
      Text024@1082 : TextConst 'DEU=Verkaufsgutschrift;ENU=Sales Credit Memo';
      Text99000000@1021 : TextConst 'DEU=Fertigungsauftrag;ENU=Production Order';
      PhoneNo@1000000000 : Text[30];
      PhoneNoClean@1000000002 : Text[30];
      EntryExists@1000000003 : Boolean;
      PhoneIndex@1000000004 : Record 56781;
      PhoneIndexTemp@1000000001 : Record 56786;
      Window@1000000006 : Dialog;
      Cust@1000000007 : Record 18;
      Vend@1000000008 : Record 23;
      Cont@1000000009 : Record 5050;
      Len@1000000005 : Integer;
      ShowEnable@19017131 : Boolean INDATASET;

    LOCAL PROCEDURE FindRecords@2();
    BEGIN
      Window.OPEN(Text001);
      PhoneIndex.RESET;
      PhoneIndex.SETCURRENTKEY("Phone No.");
      // PhoneIndex.SETRANGE("Phone No.", PhoneNoClean);
      IF PhoneIndex.FIND('-') THEN BEGIN
        REPEAT
          IF STRPOS(PhoneIndex."Phone No.", PhoneNoClean) > 0 THEN BEGIN
            TRANSFERFIELDS(PhoneIndex);
            CASE PhoneIndex."Table of origin" OF
              18: "Table Name" := Cust.TABLECAPTION;
              23: "Table Name" := Vend.TABLECAPTION;
              5050: "Table Name" := Cont.TABLECAPTION;
              ELSE
                "Table Name" := FORMAT(PhoneIndex."Table of origin");
            END;
            INSERT;
          END;
        UNTIL PhoneIndex.NEXT = 0;
        Window.CLOSE;
        EntryExists := TRUE;
        UpdatePageAfterFindRecords;
      END ELSE BEGIN
        Window.CLOSE;
        MESSAGE(Text000);
      END;
    END;

    LOCAL PROCEDURE UpdatePageAfterFindRecords@15();
    BEGIN
      ShowEnable := EntryExists;
      CurrPage.UPDATE(FALSE);
      EntryExists := FIND('-');
      IF EntryExists THEN;
    END;

    LOCAL PROCEDURE ShowRecords@6();
    BEGIN
      PhoneIndexTemp := Rec;
      CASE PhoneIndexTemp."Table of origin" OF
        DATABASE::Customer:
          BEGIN
            Cust.RESET;
            Cust.SETRANGE("No.", "No. of origin");
            IF Cust.FIND('-') THEN
      // AT2013 CHANGED
              PAGE.RUN(21,Cust);
          END;
        DATABASE::Vendor:
          BEGIN
            Vend.RESET;
            Vend.SETRANGE("No.", "No. of origin");
            IF Vend.FIND('-') THEN
      // AT2013 CHANGED
              PAGE.RUN(26,Vend);
          END;
        DATABASE::Contact:
          BEGIN
            Cont.RESET;
            Cont.SETRANGE("No.", "No. of origin");
            IF Cust.FIND('-') THEN
      // AT2013 CHANGED
              PAGE.RUN(5050,Cont);
          END;
      END;
    END;

    BEGIN
    {
      AT04.00    04.11.2005   Created
      AT2009     26.08.2010   New compiled (change in table 56786 Phone Index Temp)
      AT2011     05.04.2011   Page created
      AT2013     11.05.2013   Form replaced by Page
                              Function renamed UpdatePageAfterFindRecords
    }
    END.
  }
}


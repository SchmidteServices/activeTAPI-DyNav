OBJECT Table 18 Customer
{
  OBJECT-PROPERTIES
  {
    Date=17.03.11;
    Time=19:06:41;
    Modified=Yes;
    Version List=NAVW16.00.10,LIQEM5.00,NAVDACH5.00.01,AT2009;
  }
  PROPERTIES
  {
    Permissions=TableData 21=r;
    DataCaptionFields=No.,Name;
    OnInsert=BEGIN
               IF "No." = '' THEN BEGIN
                 SalesSetup.GET;
                 SalesSetup.TESTFIELD("Customer Nos.");
                 NoSeriesMgt.InitSeries(SalesSetup."Customer Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;
               IF "Invoice Disc. Code" = '' THEN
                 "Invoice Disc. Code" := "No.";

               IF NOT InsertFromContact THEN
                 UpdateContFromCust.OnInsert(Rec);

               DimMgt.UpdateDefaultDim(
                 DATABASE::Customer,"No.",
                 "Global Dimension 1 Code","Global Dimension 2 Code");
             END;

    OnModify=BEGIN
               "Last Date Modified" := TODAY;

               IF (Name <> xRec.Name) OR
                  ("Search Name" <> xRec."Search Name") OR
                  ("Name 2" <> xRec."Name 2") OR
                  (Address <> xRec.Address) OR
                  ("Address 2" <> xRec."Address 2") OR
                  (City <> xRec.City) OR
                  ("Phone No." <> xRec."Phone No.") OR
                  ("Telex No." <> xRec."Telex No.") OR
                  ("Territory Code" <> xRec."Territory Code") OR
                  ("Currency Code" <> xRec."Currency Code") OR
                  ("Language Code" <> xRec."Language Code") OR
                  ("Salesperson Code" <> xRec."Salesperson Code") OR
                  ("Country/Region Code" <> xRec."Country/Region Code") OR
                  ("Fax No." <> xRec."Fax No.") OR
                  ("Telex Answer Back" <> xRec."Telex Answer Back") OR
                  ("VAT Registration No." <> xRec."VAT Registration No.") OR
                  ("Post Code" <> xRec."Post Code") OR
                  (County <> xRec.County) OR
                  ("E-Mail" <> xRec."E-Mail") OR
                  ("Home Page" <> xRec."Home Page") OR
                  (Contact <> xRec.Contact)
               THEN BEGIN
                 MODIFY;
                 UpdateContFromCust.OnModify(Rec);
               END;
             END;

    OnDelete=VAR
               CampaignTargetGr@1000 : Record 7030;
               ContactBusRel@1001 : Record 5054;
               Job@1004 : Record 167;
               CreditCards@1005 : Record 827;
               CampaignTargetGrMgmt@1002 : Codeunit 7030;
               StdCustSalesCode@1003 : Record 172;
             BEGIN
               CreditCards.DeleteByCustomer(Rec);

               ServiceItem.SETRANGE("Customer No.","No.");
               IF ServiceItem.FIND('-') THEN
                 IF CONFIRM(
                      Text008,
                      FALSE,
                      TABLECAPTION,
                      "No.",
                      ServiceItem.FIELDCAPTION("Customer No."))
                 THEN
                   ServiceItem.MODIFYALL("Customer No.",'')
                 ELSE
                   ERROR(Text009);

               Job.SETRANGE("Bill-to Customer No.","No.");
               IF Job.FIND('-') THEN
                 ERROR(Text015,TABLECAPTION,"No.",Job.TABLECAPTION);

               MoveEntries.MoveCustEntries(Rec);

               CommentLine.SETRANGE("Table Name",CommentLine."Table Name"::Customer);
               CommentLine.SETRANGE("No.","No.");
               CommentLine.DELETEALL;

               CustBankAcc.SETRANGE("Customer No.","No.");
               CustBankAcc.DELETEALL;

               ShipToAddr.SETRANGE("Customer No.","No.");
               ShipToAddr.DELETEALL;

               SalesPrice.SETRANGE("Sales Type",SalesPrice."Sales Type"::Customer);
               SalesPrice.SETRANGE("Sales Code","No.");
               SalesPrice.DELETEALL;

               SalesLineDisc.SETRANGE("Sales Type",SalesLineDisc."Sales Type"::Customer);
               SalesLineDisc.SETRANGE("Sales Code","No.");
               SalesLineDisc.DELETEALL;

               SalesPrepmtPct.SETCURRENTKEY("Sales Type","Sales Code");
               SalesPrepmtPct.SETRANGE("Sales Type",SalesPrepmtPct."Sales Type"::Customer);
               SalesPrepmtPct.SETRANGE("Sales Code","No.");
               SalesPrepmtPct.DELETEALL;

               StdCustSalesCode.SETRANGE("Customer No.","No.");
               StdCustSalesCode.DELETEALL(TRUE);

               ItemCrossReference.SETCURRENTKEY("Cross-Reference Type","Cross-Reference Type No.");
               ItemCrossReference.SETRANGE("Cross-Reference Type",ItemCrossReference."Cross-Reference Type"::Customer);
               ItemCrossReference.SETRANGE("Cross-Reference Type No.","No.");
               ItemCrossReference.DELETEALL;

               SalesOrderLine.SETCURRENTKEY("Document Type","Bill-to Customer No.");
               SalesOrderLine.SETFILTER(
                 "Document Type",'%1|%2',
                 SalesOrderLine."Document Type"::Order,
                 SalesOrderLine."Document Type"::"Return Order");
               SalesOrderLine.SETRANGE("Bill-to Customer No.","No.");
               IF SalesOrderLine.FIND('-') THEN
                 ERROR(
                   Text000,
                   TABLECAPTION,"No.",SalesOrderLine."Document Type");

               SalesOrderLine.SETRANGE("Bill-to Customer No.");
               SalesOrderLine.SETRANGE("Sell-to Customer No.","No.");
               IF SalesOrderLine.FIND('-') THEN
                 ERROR(
                   Text000,
                   TABLECAPTION,"No.",SalesOrderLine."Document Type");

               CampaignTargetGr.SETRANGE("No.",Rec."No.");
               CampaignTargetGr.SETRANGE(Type,CampaignTargetGr.Type::Customer);
               IF CampaignTargetGr.FIND('-') THEN BEGIN
                 ContactBusRel.SETRANGE("Link to Table",ContactBusRel."Link to Table"::Customer);
                 ContactBusRel.SETRANGE("No.",Rec."No.");
                 ContactBusRel.FIND('-');
                 REPEAT
                   CampaignTargetGrMgmt.ConverttoContact(Rec,ContactBusRel."Contact No.");
                 UNTIL CampaignTargetGr.NEXT = 0;
               END;

               ServContract.SETFILTER(Status,'<>%1',ServContract.Status::Canceled);
               ServContract.SETRANGE("Customer No.","No.");
               IF ServContract.FIND('-') THEN
                 ERROR(
                   Text007,
                   TABLECAPTION,"No.");

               ServContract.SETRANGE(Status);
               ServContract.MODIFYALL("Customer No.",'');

               ServContract.SETFILTER(Status,'<>%1',ServContract.Status::Canceled);
               ServContract.SETRANGE("Bill-to Customer No.","No.");
               IF ServContract.FIND('-') THEN
                 ERROR(
                   Text007,
                   TABLECAPTION,"No.");

               ServContract.SETRANGE(Status);
               ServContract.MODIFYALL("Bill-to Customer No.",'');

               ServHeader.SETCURRENTKEY("Customer No.","Order Date");
               ServHeader.SETRANGE("Customer No.","No.");
               IF ServHeader.FIND('-') THEN
                 ERROR(
                   Text013,
                   TABLECAPTION,"No.",ServHeader."Document Type");

               ServHeader.SETRANGE("Bill-to Customer No.");
               IF ServHeader.FIND('-') THEN
                 ERROR(
                   Text013,
                   TABLECAPTION,"No.",ServHeader."Document Type");

               UpdateContFromCust.OnDelete(Rec);

               DimMgt.DeleteDefaultDim(DATABASE::Customer,"No.");

               MobSalesmgt.CustOnDelete(Rec);

               // AT01 BEGIN
               TAPIFu.DeletePhoneIndex(18, "No.",'',0);
               // AT01 END
             END;

    OnRename=BEGIN
               "Last Date Modified" := TODAY;
             END;

    CaptionML=[DEU=Debitor;
               ENU=Customer];
    LookupFormID=Form22;
    DrillDownFormID=Form22;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;AltSearchField=Search Name;
                                                   OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  NoSeriesMgt.TestManual(SalesSetup."Customer Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                                IF "Invoice Disc. Code" = '' THEN
                                                                  "Invoice Disc. Code" := "No.";
                                                              END;

                                                   CaptionML=[DEU=Nr.;
                                                              ENU=No.] }
    { 2   ;   ;Name                ;Text50        ;OnValidate=BEGIN
                                                                IF ("Search Name" = UPPERCASE(xRec.Name)) OR ("Search Name" = '') THEN
                                                                  "Search Name" := Name;

                                                                // AT01.20 BEGIN
                                                                IF Name <> xRec.Name THEN
                                                                  TAPIFu.PhoneIndexCust(Rec);
                                                                // AT01.20 END
                                                              END;

                                                   CaptionML=[DEU=Name;
                                                              ENU=Name] }
    { 3   ;   ;Search Name         ;Code50        ;CaptionML=[DEU=Suchbegriff;
                                                              ENU=Search Name] }
    { 4   ;   ;Name 2              ;Text50        ;CaptionML=[DEU=Name 2;
                                                              ENU=Name 2] }
    { 5   ;   ;Address             ;Text50        ;CaptionML=[DEU=Adresse;
                                                              ENU=Address] }
    { 6   ;   ;Address 2           ;Text50        ;CaptionML=[DEU=Adresse 2;
                                                              ENU=Address 2] }
    { 7   ;   ;City                ;Text30        ;OnValidate=BEGIN
                                                                PostCode.ValidateCity(City,"Post Code");
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookUpCity(City,"Post Code",TRUE);
                                                            END;

                                                   CaptionML=[DEU=Ort;
                                                              ENU=City] }
    { 8   ;   ;Contact             ;Text50        ;OnValidate=BEGIN
                                                                IF RMSetup.GET THEN
                                                                  IF RMSetup."Bus. Rel. Code for Customers" <> '' THEN
                                                                    IF (xRec.Contact = '') AND (xRec."Primary Contact No." = '') THEN BEGIN
                                                                      MODIFY;
                                                                      UpdateContFromCust.OnModify(Rec);
                                                                      UpdateContFromCust.InsertNewContactPerson(Rec,FALSE);
                                                                      MODIFY(TRUE);
                                                                    END
                                                              END;

                                                   CaptionML=[DEU=Kontakt;
                                                              ENU=Contact] }
    { 9   ;   ;Phone No.           ;Text30        ;OnValidate=BEGIN
                                                                // AT01 BEGIN
                                                                TAPIFu.PhoneIndexCust(Rec);
                                                                // AT01 END
                                                                // AT 01.20 BEGIN
                                                                TAPISetUp.GET;
                                                                IF TAPISetUp."Format Phone Numbers" THEN
                                                                // AT2009 CHANGED
                                                                  "Phone No." := TAPIFuSI.ConvToCanonic("Phone No.");
                                                                // AT2009 END
                                                                // AT01.20 END
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[DEU=Telefonnr.;
                                                              ENU=Phone No.] }
    { 10  ;   ;Telex No.           ;Text20        ;CaptionML=[DEU=Telexnr.;
                                                              ENU=Telex No.] }
    { 14  ;   ;Our Account No.     ;Text20        ;CaptionML=[DEU=Unsere Kontonr.;
                                                              ENU=Our Account No.] }
    { 15  ;   ;Territory Code      ;Code10        ;TableRelation=Territory;
                                                   CaptionML=[DEU=Gebietscode;
                                                              ENU=Territory Code] }
    { 16  ;   ;Global Dimension 1 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Global Dimension 1 Code");
                                                              END;

                                                   CaptionML=[DEU=Globaler Dimensionscode 1;
                                                              ENU=Global Dimension 1 Code];
                                                   CaptionClass='1,1,1' }
    { 17  ;   ;Global Dimension 2 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Global Dimension 2 Code");
                                                              END;

                                                   CaptionML=[DEU=Globaler Dimensionscode 2;
                                                              ENU=Global Dimension 2 Code];
                                                   CaptionClass='1,1,2' }
    { 18  ;   ;Chain Name          ;Code10        ;CaptionML=[DEU=Unternehmenskette;
                                                              ENU=Chain Name] }
    { 19  ;   ;Budgeted Amount     ;Decimal       ;CaptionML=[DEU=Budgetierter Betrag;
                                                              ENU=Budgeted Amount];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 20  ;   ;Credit Limit (LCY)  ;Decimal       ;CaptionML=[DEU=Kreditlimit (MW);
                                                              ENU=Credit Limit (LCY)];
                                                   AutoFormatType=1 }
    { 21  ;   ;Customer Posting Group;Code10      ;TableRelation="Customer Posting Group";
                                                   CaptionML=[DEU=Debitorenbuchungsgruppe;
                                                              ENU=Customer Posting Group] }
    { 22  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   CaptionML=[DEU=WÑhrungscode;
                                                              ENU=Currency Code] }
    { 23  ;   ;Customer Price Group;Code10        ;TableRelation="Customer Price Group";
                                                   CaptionML=[DEU=Debitorenpreisgruppe;
                                                              ENU=Customer Price Group] }
    { 24  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   CaptionML=[DEU=Sprachcode;
                                                              ENU=Language Code] }
    { 26  ;   ;Statistics Group    ;Integer       ;CaptionML=[DEU=Statistikgruppe;
                                                              ENU=Statistics Group] }
    { 27  ;   ;Payment Terms Code  ;Code10        ;TableRelation="Payment Terms";
                                                   CaptionML=[DEU=Zlg.-Bedingungscode;
                                                              ENU=Payment Terms Code] }
    { 28  ;   ;Fin. Charge Terms Code;Code10      ;TableRelation="Finance Charge Terms";
                                                   CaptionML=[DEU=Zinskonditionencode;
                                                              ENU=Fin. Charge Terms Code] }
    { 29  ;   ;Salesperson Code    ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[DEU=VerkÑufercode;
                                                              ENU=Salesperson Code] }
    { 30  ;   ;Shipment Method Code;Code10        ;TableRelation="Shipment Method";
                                                   CaptionML=[DEU=Lieferbedingungscode;
                                                              ENU=Shipment Method Code] }
    { 31  ;   ;Shipping Agent Code ;Code10        ;TableRelation="Shipping Agent";
                                                   OnValidate=BEGIN
                                                                IF "Shipping Agent Code" <> xRec."Shipping Agent Code" THEN
                                                                  VALIDATE("Shipping Agent Service Code",'');
                                                              END;

                                                   CaptionML=[DEU=Zustellercode;
                                                              ENU=Shipping Agent Code] }
    { 32  ;   ;Place of Export     ;Code20        ;CaptionML=[DEU=Transitstelle;
                                                              ENU=Place of Export] }
    { 33  ;   ;Invoice Disc. Code  ;Code20        ;TableRelation=Customer;
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DEU=Rechnungsrabattcode;
                                                              ENU=Invoice Disc. Code] }
    { 34  ;   ;Customer Disc. Group;Code10        ;TableRelation="Customer Discount Group";
                                                   CaptionML=[DEU=Debitorenrabattgruppe;
                                                              ENU=Customer Disc. Group] }
    { 35  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[DEU=LÑnder-/Regionscode;
                                                              ENU=Country/Region Code] }
    { 36  ;   ;Collection Method   ;Code20        ;CaptionML=[DEU=Einzugsverfahren;
                                                              ENU=Collection Method] }
    { 37  ;   ;Amount              ;Decimal       ;CaptionML=[DEU=Betrag;
                                                              ENU=Amount];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 38  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Comment Line" WHERE (Table Name=CONST(Customer),
                                                                                           No.=FIELD(No.)));
                                                   CaptionML=[DEU=Bemerkung;
                                                              ENU=Comment];
                                                   Editable=No }
    { 39  ;   ;Blocked             ;Option        ;OnValidate=BEGIN
                                                                // AT2009 BEGIN
                                                                IF Blocked <> xRec.Blocked THEN
                                                                  TAPIFu.PhoneIndexCust(Rec);
                                                                // AT2009 END
                                                              END;

                                                   CaptionML=[DEU=Gesperrt;
                                                              ENU=Blocked];
                                                   OptionCaptionML=[DEU=" ,Liefern,Fakturieren,Alle";
                                                                    ENU=" ,Ship,Invoice,All"];
                                                   OptionString=[ ,Ship,Invoice,All] }
    { 40  ;   ;Invoice Copies      ;Integer       ;CaptionML=[DEU=Anzahl Rechnungskopien;
                                                              ENU=Invoice Copies] }
    { 41  ;   ;Last Statement No.  ;Integer       ;CaptionML=[DEU=Letzte Kontoauszugsnr.;
                                                              ENU=Last Statement No.] }
    { 42  ;   ;Print Statements    ;Boolean       ;CaptionML=[DEU=KontoauszÅge drucken;
                                                              ENU=Print Statements] }
    { 45  ;   ;Bill-to Customer No.;Code20        ;TableRelation=Customer;
                                                   CaptionML=[DEU=Rech. an Deb.-Nr.;
                                                              ENU=Bill-to Customer No.] }
    { 46  ;   ;Priority            ;Integer       ;CaptionML=[DEU=PrioritÑt;
                                                              ENU=Priority] }
    { 47  ;   ;Payment Method Code ;Code10        ;TableRelation="Payment Method";
                                                   CaptionML=[DEU=Zahlungsformcode;
                                                              ENU=Payment Method Code] }
    { 54  ;   ;Last Date Modified  ;Date          ;CaptionML=[DEU=Korrigiert am;
                                                              ENU=Last Date Modified];
                                                   Editable=No }
    { 55  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=Datumsfilter;
                                                              ENU=Date Filter] }
    { 56  ;   ;Global Dimension 1 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   CaptionML=[DEU=Globaler Dimensionsfilter 1;
                                                              ENU=Global Dimension 1 Filter];
                                                   CaptionClass='1,3,1' }
    { 57  ;   ;Global Dimension 2 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   CaptionML=[DEU=Globaler Dimensionsfilter 2;
                                                              ENU=Global Dimension 2 Filter];
                                                   CaptionClass='1,3,2' }
    { 58  ;   ;Balance             ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Customer No.=FIELD(No.),
                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                              Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Saldo;
                                                              ENU=Balance];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 59  ;   ;Balance (LCY)       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Customer No.=FIELD(No.),
                                                                                                                      Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                      Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                      Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Saldo (MW);
                                                              ENU=Balance (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 60  ;   ;Net Change          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Customer No.=FIELD(No.),
                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                              Posting Date=FIELD(Date Filter),
                                                                                                              Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Bewegung;
                                                              ENU=Net Change];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 61  ;   ;Net Change (LCY)    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Customer No.=FIELD(No.),
                                                                                                                      Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                      Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                      Posting Date=FIELD(Date Filter),
                                                                                                                      Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Bewegung (MW);
                                                              ENU=Net Change (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 62  ;   ;Sales (LCY)         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Cust. Ledger Entry"."Sales (LCY)" WHERE (Customer No.=FIELD(No.),
                                                                                                             Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                             Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                             Posting Date=FIELD(Date Filter),
                                                                                                             Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Verkauf (MW);
                                                              ENU=Sales (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 63  ;   ;Profit (LCY)        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Cust. Ledger Entry"."Profit (LCY)" WHERE (Customer No.=FIELD(No.),
                                                                                                              Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                              Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                              Posting Date=FIELD(Date Filter),
                                                                                                              Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=DB (MW);
                                                              ENU=Profit (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 64  ;   ;Inv. Discounts (LCY);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Cust. Ledger Entry"."Inv. Discount (LCY)" WHERE (Customer No.=FIELD(No.),
                                                                                                                     Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                     Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                     Posting Date=FIELD(Date Filter),
                                                                                                                     Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Rechnungsrabatte (MW);
                                                              ENU=Inv. Discounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 65  ;   ;Pmt. Discounts (LCY);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Customer No.=FIELD(No.),
                                                                                                                       Entry Type=FILTER(Payment Discount..'Payment Discount (VAT Adjustment)'),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Skonto (MW);
                                                              ENU=Pmt. Discounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 66  ;   ;Balance Due         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Customer No.=FIELD(No.),
                                                                                                              Posting Date=FIELD(UPPERLIMIT(Date Filter)),
                                                                                                              Initial Entry Due Date=FIELD(Date Filter),
                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                              Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=FÑlliger Saldo;
                                                              ENU=Balance Due];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 67  ;   ;Balance Due (LCY)   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Customer No.=FIELD(No.),
                                                                                                                      Posting Date=FIELD(UPPERLIMIT(Date Filter)),
                                                                                                                      Initial Entry Due Date=FIELD(Date Filter),
                                                                                                                      Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                      Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                      Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=FÑlliger Saldo (MW);
                                                              ENU=Balance Due (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 69  ;   ;Payments            ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Payment),
                                                                                                               Entry Type=CONST(Initial Entry),
                                                                                                               Customer No.=FIELD(No.),
                                                                                                               Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                               Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                               Posting Date=FIELD(Date Filter),
                                                                                                               Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Zahlungen;
                                                              ENU=Payments];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 70  ;   ;Invoice Amounts     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Invoice),
                                                                                                              Entry Type=CONST(Initial Entry),
                                                                                                              Customer No.=FIELD(No.),
                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                              Posting Date=FIELD(Date Filter),
                                                                                                              Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Fakturierter Betrag;
                                                              ENU=Invoice Amounts];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 71  ;   ;Cr. Memo Amounts    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Credit Memo),
                                                                                                               Entry Type=CONST(Initial Entry),
                                                                                                               Customer No.=FIELD(No.),
                                                                                                               Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                               Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                               Posting Date=FIELD(Date Filter),
                                                                                                               Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Gutgeschriebener Betrag;
                                                              ENU=Cr. Memo Amounts];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 72  ;   ;Finance Charge Memo Amounts;Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Finance Charge Memo),
                                                                                                              Entry Type=CONST(Initial Entry),
                                                                                                              Customer No.=FIELD(No.),
                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                              Posting Date=FIELD(Date Filter),
                                                                                                              Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Zinsrechnungsbetrag;
                                                              ENU=Finance Charge Memo Amounts];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 74  ;   ;Payments (LCY)      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Payment),
                                                                                                                       Entry Type=CONST(Initial Entry),
                                                                                                                       Customer No.=FIELD(No.),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Bezahlt (MW);
                                                              ENU=Payments (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 75  ;   ;Inv. Amounts (LCY)  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Invoice),
                                                                                                                      Entry Type=CONST(Initial Entry),
                                                                                                                      Customer No.=FIELD(No.),
                                                                                                                      Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                      Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                      Posting Date=FIELD(Date Filter),
                                                                                                                      Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Fakturierter Betrag (MW);
                                                              ENU=Inv. Amounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 76  ;   ;Cr. Memo Amounts (LCY);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Credit Memo),
                                                                                                                       Entry Type=CONST(Initial Entry),
                                                                                                                       Customer No.=FIELD(No.),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Gutgeschriebener Betrag (MW);
                                                              ENU=Cr. Memo Amounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 77  ;   ;Fin. Charge Memo Amounts (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Finance Charge Memo),
                                                                                                                      Entry Type=CONST(Initial Entry),
                                                                                                                      Customer No.=FIELD(No.),
                                                                                                                      Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                      Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                      Posting Date=FIELD(Date Filter),
                                                                                                                      Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Zinsrechnungsbetrag (MW);
                                                              ENU=Fin. Charge Memo Amounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 78  ;   ;Outstanding Orders  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Outstanding Amount" WHERE (Document Type=CONST(Order),
                                                                                                            Bill-to Customer No.=FIELD(No.),
                                                                                                            Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                            Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                            Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Auftragsbestand;
                                                              ENU=Outstanding Orders];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 79  ;   ;Shipped Not Invoiced;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Shipped Not Invoiced" WHERE (Document Type=CONST(Order),
                                                                                                              Bill-to Customer No.=FIELD(No.),
                                                                                                              Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                              Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                              Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Nicht fakt. Lieferungen;
                                                              ENU=Shipped Not Invoiced];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 80  ;   ;Application Method  ;Option        ;CaptionML=[DEU=Ausgleichsmethode;
                                                              ENU=Application Method];
                                                   OptionCaptionML=[DEU=Offener Posten,Saldomethode;
                                                                    ENU=Manual,Apply to Oldest];
                                                   OptionString=Manual,Apply to Oldest }
    { 82  ;   ;Prices Including VAT;Boolean       ;CaptionML=[DEU=Preise inkl. MwSt.;
                                                              ENU=Prices Including VAT] }
    { 83  ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   CaptionML=[DEU=Lagerortcode;
                                                              ENU=Location Code] }
    { 84  ;   ;Fax No.             ;Text30        ;OnValidate=BEGIN
                                                                // AT 04.00 BEGIN
                                                                TAPISetUp.GET;
                                                                IF TAPISetUp."Format Fax Numbers" THEN
                                                                // AT2009 CHANGED
                                                                  "Fax No." := TAPIFuSI.ConvToCanonic("Fax No.");
                                                                // AT2009 END
                                                                // AT04.00 END
                                                              END;

                                                   CaptionML=[DEU=Faxnr.;
                                                              ENU=Fax No.] }
    { 85  ;   ;Telex Answer Back   ;Text20        ;CaptionML=[DEU=Telex Namengeber;
                                                              ENU=Telex Answer Back] }
    { 86  ;   ;VAT Registration No.;Text20        ;OnValidate=VAR
                                                                VATRegNoFormat@1000 : Record 381;
                                                              BEGIN
                                                                VATRegNoFormat.Test("VAT Registration No.","Country/Region Code","No.",DATABASE::Customer);
                                                              END;

                                                   CaptionML=[DEU=USt-IdNr.;
                                                              ENU=VAT Registration No.] }
    { 87  ;   ;Combine Shipments   ;Boolean       ;CaptionML=[DEU=Sammelrechnung;
                                                              ENU=Combine Shipments] }
    { 88  ;   ;Gen. Bus. Posting Group;Code10     ;TableRelation="Gen. Business Posting Group";
                                                   OnValidate=BEGIN
                                                                IF xRec."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group" THEN
                                                                  IF GenBusPostingGrp.ValidateVatBusPostingGroup(GenBusPostingGrp,"Gen. Bus. Posting Group") THEN
                                                                    VALIDATE("VAT Bus. Posting Group",GenBusPostingGrp."Def. VAT Bus. Posting Group");
                                                              END;

                                                   CaptionML=[DEU=GeschÑftsbuchungsgruppe;
                                                              ENU=Gen. Bus. Posting Group] }
    { 89  ;   ;Picture             ;BLOB          ;CaptionML=[DEU=Bild;
                                                              ENU=Picture];
                                                   SubType=Bitmap }
    { 91  ;   ;Post Code           ;Code20        ;TableRelation="Post Code";
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code");
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookUpPostCode(City,"Post Code",TRUE);
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DEU=PLZ-Code;
                                                              ENU=Post Code] }
    { 92  ;   ;County              ;Text30        ;CaptionML=[DEU=Bundesregion;
                                                              ENU=County] }
    { 97  ;   ;Debit Amount        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Debit Amount" WHERE (Customer No.=FIELD(No.),
                                                                                                                      Entry Type=FILTER(<>Application),
                                                                                                                      Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                      Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                      Posting Date=FIELD(Date Filter),
                                                                                                                      Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Sollbetrag;
                                                              ENU=Debit Amount];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 98  ;   ;Credit Amount       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Credit Amount" WHERE (Customer No.=FIELD(No.),
                                                                                                                       Entry Type=FILTER(<>Application),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Habenbetrag;
                                                              ENU=Credit Amount];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 99  ;   ;Debit Amount (LCY)  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Debit Amount (LCY)" WHERE (Customer No.=FIELD(No.),
                                                                                                                            Entry Type=FILTER(<>Application),
                                                                                                                            Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                            Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                            Posting Date=FIELD(Date Filter),
                                                                                                                            Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Sollbetrag (MW);
                                                              ENU=Debit Amount (LCY)];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 100 ;   ;Credit Amount (LCY) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Credit Amount (LCY)" WHERE (Customer No.=FIELD(No.),
                                                                                                                             Entry Type=FILTER(<>Application),
                                                                                                                             Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                             Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                             Posting Date=FIELD(Date Filter),
                                                                                                                             Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Habenbetrag (MW);
                                                              ENU=Credit Amount (LCY)];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 102 ;   ;E-Mail              ;Text80        ;ExtendedDatatype=E-Mail;
                                                   CaptionML=[DEU=E-Mail;
                                                              ENU=E-Mail] }
    { 103 ;   ;Home Page           ;Text80        ;ExtendedDatatype=URL;
                                                   CaptionML=[DEU=Homepage;
                                                              ENU=Home Page] }
    { 104 ;   ;Reminder Terms Code ;Code10        ;TableRelation="Reminder Terms";
                                                   CaptionML=[DEU=Mahnmethodencode;
                                                              ENU=Reminder Terms Code] }
    { 105 ;   ;Reminder Amounts    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Reminder),
                                                                                                              Entry Type=CONST(Initial Entry),
                                                                                                              Customer No.=FIELD(No.),
                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                              Posting Date=FIELD(Date Filter),
                                                                                                              Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Mahnbetrag;
                                                              ENU=Reminder Amounts];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 106 ;   ;Reminder Amounts (LCY);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Reminder),
                                                                                                                      Entry Type=CONST(Initial Entry),
                                                                                                                      Customer No.=FIELD(No.),
                                                                                                                      Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                      Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                      Posting Date=FIELD(Date Filter),
                                                                                                                      Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Mahnbetrag (MW);
                                                              ENU=Reminder Amounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 107 ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[DEU=Nummernserie;
                                                              ENU=No. Series];
                                                   Editable=No }
    { 108 ;   ;Tax Area Code       ;Code20        ;TableRelation="Tax Area";
                                                   CaptionML=[DEU=Steuergebietscode;
                                                              ENU=Tax Area Code] }
    { 109 ;   ;Tax Liable          ;Boolean       ;CaptionML=[DEU=Steuerpflichtig;
                                                              ENU=Tax Liable] }
    { 110 ;   ;VAT Bus. Posting Group;Code10      ;TableRelation="VAT Business Posting Group";
                                                   CaptionML=[DEU=MwSt.-GeschÑftsbuchungsgruppe;
                                                              ENU=VAT Bus. Posting Group] }
    { 111 ;   ;Currency Filter     ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Currency;
                                                   CaptionML=[DEU=WÑhrungsfilter;
                                                              ENU=Currency Filter] }
    { 113 ;   ;Outstanding Orders (LCY);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Outstanding Amount (LCY)" WHERE (Document Type=CONST(Order),
                                                                                                                  Bill-to Customer No.=FIELD(No.),
                                                                                                                  Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                  Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                  Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Auftragsbestand (MW);
                                                              ENU=Outstanding Orders (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 114 ;   ;Shipped Not Invoiced (LCY);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Shipped Not Invoiced (LCY)" WHERE (Document Type=CONST(Order),
                                                                                                                    Bill-to Customer No.=FIELD(No.),
                                                                                                                    Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                    Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                    Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Nicht fakt. Lieferungen (MW);
                                                              ENU=Shipped Not Invoiced (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 115 ;   ;Reserve             ;Option        ;InitValue=Optional;
                                                   CaptionML=[DEU=Reservieren;
                                                              ENU=Reserve];
                                                   OptionCaptionML=[DEU=Nie,Optional,Immer;
                                                                    ENU=Never,Optional,Always];
                                                   OptionString=Never,Optional,Always }
    { 116 ;   ;Block Payment Tolerance;Boolean    ;CaptionML=[DEU=Zahlungstoleranz sperren;
                                                              ENU=Block Payment Tolerance] }
    { 117 ;   ;Pmt. Disc. Tolerance (LCY);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Customer No.=FIELD(No.),
                                                                                                                       Entry Type=FILTER(Payment Discount Tolerance|'Payment Discount Tolerance (VAT Adjustment)'|'Payment Discount Tolerance (VAT Excl.)'),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Skontotoleranz (MW);
                                                              ENU=Pmt. Disc. Tolerance (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 118 ;   ;Pmt. Tolerance (LCY);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Customer No.=FIELD(No.),
                                                                                                                       Entry Type=FILTER(Payment Tolerance|'Payment Tolerance (VAT Adjustment)'|'Payment Tolerance (VAT Excl.)'),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Zahlungstoleranz (MW);
                                                              ENU=Pmt. Tolerance (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 119 ;   ;IC Partner Code     ;Code20        ;TableRelation="IC Partner";
                                                   OnValidate=VAR
                                                                CustLedgEntry@1001 : Record 21;
                                                                AccountingPeriod@1000 : Record 50;
                                                                ICPartner@1002 : Record 413;
                                                              BEGIN
                                                                IF xRec."IC Partner Code" <> "IC Partner Code" THEN BEGIN
                                                                  CustLedgEntry.SETCURRENTKEY("Customer No.","Posting Date");
                                                                  CustLedgEntry.SETRANGE("Customer No.","No.");
                                                                  AccountingPeriod.SETRANGE(Closed,FALSE);
                                                                  IF AccountingPeriod.FIND('-') THEN
                                                                    CustLedgEntry.SETFILTER("Posting Date",'>=%1',AccountingPeriod."Starting Date");
                                                                  IF CustLedgEntry.FIND('-') THEN
                                                                    IF NOT CONFIRM(Text011,FALSE,TABLECAPTION) THEN
                                                                      "IC Partner Code" := xRec."IC Partner Code";

                                                                  CustLedgEntry.RESET;
                                                                  IF NOT CustLedgEntry.SETCURRENTKEY("Customer No.",Open) THEN
                                                                    CustLedgEntry.SETCURRENTKEY("Customer No.");
                                                                  CustLedgEntry.SETRANGE("Customer No.","No.");
                                                                  CustLedgEntry.SETRANGE(Open,TRUE);
                                                                  IF CustLedgEntry.FIND('+') THEN
                                                                    ERROR(Text012,FIELDCAPTION("IC Partner Code"),TABLECAPTION);
                                                                END;

                                                                IF "IC Partner Code" <> '' THEN BEGIN
                                                                  ICPartner.GET("IC Partner Code");
                                                                  IF (ICPartner."Customer No." <> '') AND (ICPartner."Customer No." <> "No.") THEN
                                                                    ERROR(Text010,FIELDCAPTION("IC Partner Code"),"IC Partner Code",TABLECAPTION,ICPartner."Customer No.");
                                                                  ICPartner."Customer No." := "No.";
                                                                  ICPartner.MODIFY;
                                                                END;

                                                                IF (xRec."IC Partner Code" <> "IC Partner Code") AND ICPartner.GET(xRec."IC Partner Code") THEN BEGIN
                                                                  ICPartner."Customer No." := '';
                                                                  ICPartner.MODIFY;
                                                                END;
                                                              END;

                                                   CaptionML=[DEU=IC-Partnercode;
                                                              ENU=IC Partner Code] }
    { 120 ;   ;Refunds             ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Refund),
                                                                                                              Entry Type=CONST(Initial Entry),
                                                                                                              Customer No.=FIELD(No.),
                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                              Posting Date=FIELD(Date Filter),
                                                                                                              Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Erstattungen;
                                                              ENU=Refunds] }
    { 121 ;   ;Refunds (LCY)       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Refund),
                                                                                                                      Entry Type=CONST(Initial Entry),
                                                                                                                      Customer No.=FIELD(No.),
                                                                                                                      Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                      Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                      Posting Date=FIELD(Date Filter),
                                                                                                                      Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Erstattungen (MW);
                                                              ENU=Refunds (LCY)] }
    { 122 ;   ;Other Amounts       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Initial Document Type=CONST(" "),
                                                                                                              Entry Type=CONST(Initial Entry),
                                                                                                              Customer No.=FIELD(No.),
                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                              Posting Date=FIELD(Date Filter),
                                                                                                              Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Weitere BetrÑge;
                                                              ENU=Other Amounts] }
    { 123 ;   ;Other Amounts (LCY) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(" "),
                                                                                                                      Entry Type=CONST(Initial Entry),
                                                                                                                      Customer No.=FIELD(No.),
                                                                                                                      Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                      Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                      Posting Date=FIELD(Date Filter),
                                                                                                                      Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Weitere BetrÑge (MW);
                                                              ENU=Other Amounts (LCY)] }
    { 124 ;   ;Prepayment %        ;Decimal       ;CaptionML=[DEU=Vorauszahlung %;
                                                              ENU=Prepayment %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 125 ;   ;Outstanding Invoices (LCY);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Outstanding Amount (LCY)" WHERE (Document Type=CONST(Invoice),
                                                                                                                  Bill-to Customer No.=FIELD(No.),
                                                                                                                  Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                  Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                  Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Ausstehende Rechnungen (MW);
                                                              ENU=Outstanding Invoices (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 126 ;   ;Outstanding Invoices;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Outstanding Amount" WHERE (Document Type=CONST(Invoice),
                                                                                                            Bill-to Customer No.=FIELD(No.),
                                                                                                            Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                            Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                            Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Ausstehende Rechnungen;
                                                              ENU=Outstanding Invoices];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 130 ;   ;Bill-to No. Of Archived Doc.;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header Archive" WHERE (Document Type=CONST(Order),
                                                                                                   Bill-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl archivierter Belege fÅr Rech. an;
                                                              ENU=Bill-to No. Of Archived Doc.] }
    { 131 ;   ;Sell-to No. Of Archived Doc.;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header Archive" WHERE (Document Type=CONST(Order),
                                                                                                   Sell-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl archivierter Belege fÅr Verk. an;
                                                              ENU=Sell-to No. Of Archived Doc.] }
    { 5049;   ;Primary Contact No. ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                Cont@1000 : Record 5050;
                                                                ContBusRel@1001 : Record 5054;
                                                              BEGIN
                                                                Contact := '';
                                                                IF "Primary Contact No." <> '' THEN BEGIN
                                                                  Cont.GET("Primary Contact No.");

                                                                  ContBusRel.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
                                                                  ContBusRel.SETRANGE("No.","No.");
                                                                  ContBusRel.FIND('-');

                                                                  IF Cont."Company No." <> ContBusRel."Contact No." THEN
                                                                    ERROR(Text003,Cont."No.",Cont.Name,"No.",Name);

                                                                  IF Cont.Type = Cont.Type::Person THEN
                                                                    Contact := Cont.Name
                                                                END;
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1000 : Record 5050;
                                                              ContBusRel@1001 : Record 5054;
                                                            BEGIN
                                                              ContBusRel.SETCURRENTKEY("Link to Table","No.");
                                                              ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
                                                              ContBusRel.SETRANGE("No.","No.");
                                                              IF ContBusRel.FINDFIRST THEN
                                                                Cont.SETRANGE("Company No.",ContBusRel."Contact No.")
                                                              ELSE
                                                                Cont.SETRANGE("No.",'');

                                                              IF "Primary Contact No." <> '' THEN
                                                                IF Cont.GET("Primary Contact No.") THEN ;
                                                              IF FORM.RUNMODAL(0,Cont) = ACTION::LookupOK THEN
                                                                VALIDATE("Primary Contact No.",Cont."No.");
                                                            END;

                                                   CaptionML=[DEU=PrimÑre Kontaktnr.;
                                                              ENU=Primary Contact No.] }
    { 5700;   ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   CaptionML=[DEU=ZustÑndigkeitseinheitencode;
                                                              ENU=Responsibility Center] }
    { 5750;   ;Shipping Advice     ;Option        ;CaptionML=[DEU=Versandanweisung;
                                                              ENU=Shipping Advice];
                                                   OptionCaptionML=[DEU=Teillieferung,Komplettlieferung;
                                                                    ENU=Partial,Complete];
                                                   OptionString=Partial,Complete }
    { 5790;   ;Shipping Time       ;DateFormula   ;CaptionML=[DEU=Transportzeit;
                                                              ENU=Shipping Time] }
    { 5792;   ;Shipping Agent Service Code;Code10 ;TableRelation="Shipping Agent Services".Code WHERE (Shipping Agent Code=FIELD(Shipping Agent Code));
                                                   OnValidate=BEGIN
                                                                IF ("Shipping Agent Code" <> '') AND
                                                                   ("Shipping Agent Service Code" <> '')
                                                                THEN
                                                                  IF ShippingAgentService.GET("Shipping Agent Code","Shipping Agent Service Code") THEN
                                                                    "Shipping Time" := ShippingAgentService."Shipping Time"
                                                                  ELSE
                                                                    EVALUATE("Shipping Time",'<>');
                                                              END;

                                                   CaptionML=[DEU=Zustellertransportartencode;
                                                              ENU=Shipping Agent Service Code] }
    { 5900;   ;Service Zone Code   ;Code10        ;TableRelation="Service Zone";
                                                   CaptionML=[DEU=Servicegebietscode;
                                                              ENU=Service Zone Code] }
    { 5902;   ;Contract Gain/Loss Amount;Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Contract Gain/Loss Entry".Amount WHERE (Customer No.=FIELD(No.),
                                                                                                            Ship-to Code=FIELD(Ship-to Filter),
                                                                                                            Change Date=FIELD(Date Filter)));
                                                   CaptionML=[DEU=Gewinn-/Verlustbetrag (Vertr.);
                                                              ENU=Contract Gain/Loss Amount];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5903;   ;Ship-to Filter      ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(No.));
                                                   CaptionML=[DEU=Lief. an Filter;
                                                              ENU=Ship-to Filter] }
    { 5910;   ;Outstanding Serv. Orders (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Line"."Outstanding Amount (LCY)" WHERE (Document Type=CONST(Order),
                                                                                                                    Bill-to Customer No.=FIELD(No.),
                                                                                                                    Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                    Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                    Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Serviceauftragsbestand (MW);
                                                              ENU=Outstanding Serv. Orders (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5911;   ;Serv Shipped Not Invoiced(LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Line"."Shipped Not Invoiced (LCY)" WHERE (Document Type=CONST(Order),
                                                                                                                      Bill-to Customer No.=FIELD(No.),
                                                                                                                      Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                      Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                      Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Service Lief. nicht fakt. Betrag (MW);
                                                              ENU=Serv Shipped Not Invoiced(LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 7001;   ;Allow Line Disc.    ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[DEU=Zeilenrabatt zulassen;
                                                              ENU=Allow Line Disc.] }
    { 7171;   ;No. of Quotes       ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Quote),
                                                                                           Sell-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Angebote;
                                                              ENU=No. of Quotes];
                                                   Editable=No }
    { 7172;   ;No. of Blanket Orders;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Blanket Order),
                                                                                           Sell-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl RahmenauftrÑge;
                                                              ENU=No. of Blanket Orders];
                                                   Editable=No }
    { 7173;   ;No. of Orders       ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Order),
                                                                                           Sell-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl AuftrÑge;
                                                              ENU=No. of Orders];
                                                   Editable=No }
    { 7174;   ;No. of Invoices     ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Invoice),
                                                                                           Sell-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Rechnungen;
                                                              ENU=No. of Invoices];
                                                   Editable=No }
    { 7175;   ;No. of Return Orders;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Return Order),
                                                                                           Sell-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Reklamationen;
                                                              ENU=No. of Return Orders];
                                                   Editable=No }
    { 7176;   ;No. of Credit Memos ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Credit Memo),
                                                                                           Sell-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Gutschriften;
                                                              ENU=No. of Credit Memos];
                                                   Editable=No }
    { 7177;   ;No. of Pstd. Shipments;Integer     ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Shipment Header" WHERE (Sell-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl gebuchter Lieferungen;
                                                              ENU=No. of Pstd. Shipments];
                                                   Editable=No }
    { 7178;   ;No. of Pstd. Invoices;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Invoice Header" WHERE (Sell-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl gebuchter Rechnungen;
                                                              ENU=No. of Pstd. Invoices];
                                                   Editable=No }
    { 7179;   ;No. of Pstd. Return Receipts;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Return Receipt Header" WHERE (Sell-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anz. gebuchter RÅcksendungen;
                                                              ENU=No. of Pstd. Return Receipts];
                                                   Editable=No }
    { 7180;   ;No. of Pstd. Credit Memos;Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Cr.Memo Header" WHERE (Sell-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl gebuchter Gutschriften;
                                                              ENU=No. of Pstd. Credit Memos];
                                                   Editable=No }
    { 7181;   ;No. of Ship-to Addresses;Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Count("Ship-to Address" WHERE (Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Lieferadressen;
                                                              ENU=No. of Ship-to Addresses];
                                                   Editable=No }
    { 7182;   ;Bill-To No. of Quotes;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Quote),
                                                                                           Bill-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Angebote fÅr Rechnungsadresse;
                                                              ENU=Bill-To No. of Quotes];
                                                   Editable=No }
    { 7183;   ;Bill-To No. of Blanket Orders;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Blanket Order),
                                                                                           Bill-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl RahmenauftrÑge fÅr Rechnungsadresse;
                                                              ENU=Bill-To No. of Blanket Orders];
                                                   Editable=No }
    { 7184;   ;Bill-To No. of Orders;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Order),
                                                                                           Bill-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl AuftrÑge fÅr Rechnungsadresse;
                                                              ENU=Bill-To No. of Orders];
                                                   Editable=No }
    { 7185;   ;Bill-To No. of Invoices;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Invoice),
                                                                                           Bill-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Rechungen fÅr Rechnungsadresse;
                                                              ENU=Bill-To No. of Invoices];
                                                   Editable=No }
    { 7186;   ;Bill-To No. of Return Orders;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Return Order),
                                                                                           Bill-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Reklamationen fÅr Rechnungsadresse;
                                                              ENU=Bill-To No. of Return Orders];
                                                   Editable=No }
    { 7187;   ;Bill-To No. of Credit Memos;Integer;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Credit Memo),
                                                                                           Bill-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Gutschriften fÅr Rechnungsadresse;
                                                              ENU=Bill-To No. of Credit Memos];
                                                   Editable=No }
    { 7188;   ;Bill-To No. of Pstd. Shipments;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Shipment Header" WHERE (Bill-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl gebuchter Lieferungen fÅr Rechnungsadresse;
                                                              ENU=Bill-To No. of Pstd. Shipments];
                                                   Editable=No }
    { 7189;   ;Bill-To No. of Pstd. Invoices;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Invoice Header" WHERE (Bill-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl gebuchter Rechnungen fÅr Rechnungsadresse;
                                                              ENU=Bill-To No. of Pstd. Invoices];
                                                   Editable=No }
    { 7190;   ;Bill-To No. of Pstd. Return R.;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Return Receipt Header" WHERE (Bill-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl geb. Retourenbel. fÅr Rechnungsadresse;
                                                              ENU=Bill-To No. of Pstd. Return R.];
                                                   Editable=No }
    { 7191;   ;Bill-To No. of Pstd. Cr. Memos;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Cr.Memo Header" WHERE (Bill-to Customer No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anz. geb. Gutschr. fÅr Rechnungsadresse;
                                                              ENU=Bill-To No. of Pstd. Cr. Memos];
                                                   Editable=No }
    { 7600;   ;Base Calendar Code  ;Code10        ;TableRelation="Base Calendar";
                                                   CaptionML=[DEU=Basiskalendercode;
                                                              ENU=Base Calendar Code] }
    { 7601;   ;Copy Sell-to Addr. to Qte From;Option;
                                                   CaptionML=[DEU=Verk. an Adr. in Ang. v. kop.;
                                                              ENU=Copy Sell-to Addr. to Qte From];
                                                   OptionCaptionML=[DEU=Unternehmen,Person;
                                                                    ENU=Company,Person];
                                                   OptionString=Company,Person }
    { 5055250;;Liq. Payment Terms Code;Code10     ;TableRelation="Payment Terms";
                                                   CaptionML=[DEU=Liq. Zlg.-Bedingungscode;
                                                              ENU=Liq. Payment Terms Code] }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Search Name                              }
    {    ;Customer Posting Group                   }
    {    ;Currency Code                            }
    {    ;Country/Region Code                      }
    {    ;Gen. Bus. Posting Group                  }
    {    ;Name,Address,City                        }
    {    ;VAT Registration No.                     }
    {    ;Name                                    ;KeyGroups=SearchCol }
    {    ;City                                    ;KeyGroups=SearchCol }
    {    ;Post Code                               ;KeyGroups=SearchCol }
    {    ;Phone No.                               ;KeyGroups=SearchCol }
    {    ;Contact                                 ;KeyGroups=SearchCol }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Name,City,Post Code,Phone No.,Contact }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'DEU=Sie kînnen %1 %2 nicht lîschen, da noch ein(e) %3 (oder mehrere) fÅr diesen Debitor vorhanden ist.;ENU=You cannot delete %1 %2 because there is at least one outstanding Sales %3 for this customer.';
      Text002@1001 : TextConst 'DEU=Mîchten Sie einen Kontakt fÅr %1 %2 erstellen?;ENU=Do you wish to create a contact for %1 %2?';
      SalesSetup@1002 : Record 311;
      CommentLine@1004 : Record 97;
      SalesOrderLine@1005 : Record 37;
      CustBankAcc@1006 : Record 287;
      ShipToAddr@1007 : Record 222;
      PostCode@1008 : Record 225;
      GenBusPostingGrp@1009 : Record 250;
      ShippingAgentService@1010 : Record 5790;
      ItemCrossReference@1016 : Record 5717;
      RMSetup@1018 : Record 5079;
      SalesPrice@1021 : Record 7002;
      SalesLineDisc@1022 : Record 7004;
      SalesPrepmtPct@1003 : Record 459;
      ServContract@1026 : Record 5965;
      ServHeader@1034 : Record 5900;
      ServiceItem@1027 : Record 5940;
      NoSeriesMgt@1011 : Codeunit 396;
      MoveEntries@1012 : Codeunit 361;
      UpdateContFromCust@1013 : Codeunit 5056;
      DimMgt@1014 : Codeunit 408;
      MobSalesmgt@1019 : Codeunit 8726;
      InsertFromContact@1015 : Boolean;
      Text003@1020 : TextConst 'DEU=Kontakt %1 %2 ist nicht mit Debitor %3 %4 verknÅpft.;ENU=Contact %1 %2 is not related to customer %3 %4.';
      Text004@1023 : TextConst 'DEU=buchen;ENU=post';
      Text005@1024 : TextConst 'DEU=erstellen;ENU=create';
      Text006@1025 : TextConst 'DEU=Sie kînnen diese Belegart nicht %1, wenn der Debitor %2 fÅr die Art %3 gesperrt ist.;ENU=You cannot %1 this type of document when Customer %2 is blocked with type %3';
      Text007@1028 : TextConst 'DEU=Sie kînnen %1 %2 nicht lîschen, da fÅr diesen Debitor mindestens ein nicht stornierter Servicevertrag vorhanden ist.;ENU=You cannot delete %1 %2 because there is at least one not cancelled Service Contract for this customer.';
      Text008@1029 : TextConst 'DEU=Wenn Sie %1 %2 lîschen, wird die %3 fÅr die verknÅpften Serviceartikel ebenfalls gelîscht. Mîchten Sie fortfahren?;ENU=Deleting the %1 %2 will cause the %3 to be deleted for the associated Service Items. Do you want to continue?';
      Text009@1030 : TextConst 'DEU=Debitor kann nicht gelîscht werden.;ENU=Cannot delete customer.';
      Text010@1031 : TextConst 'DEU=%1 %2 wurde %3 %4 zugewiesen.\Derselbe %1 kann nicht auf mehr als einen %3 eingegeben werden. Geben Sie einen anderen Code ein.;ENU=The %1 %2 has been assigned to %3 %4.\The same %1 cannot be entered on more than one %3. Enter another code.';
      Text011@1033 : TextConst 'DEU=Das Abstimmen von IC-Buchungen kann schwierig sein, wenn Sie den IC-Partnercode Ñndern, weil %1 Posten in einem noch nicht geschlossenen GeschÑftsjahr aufweist.\ Mîchten Sie den IC-Partnercode trotzdem Ñndern?;ENU=Reconciling IC transactions may be difficult if you change IC Partner Code because this %1 has ledger entries in a fiscal year that has not yet been closed.\ Do you still want to change the IC Partner Code?';
      Text012@1032 : TextConst 'DEU=Sie kînnen den Inhalt des Feldes %1 nicht Ñndern, weil fÅr dieses %2 ein oder mehrere offene Posten vorliegen.;ENU=You cannot change the contents of the %1 field because this %2 has one or more open ledger entries.';
      Text013@1035 : TextConst 'DEU=Sie kînnen %1 %2 nicht lîschen, da noch mindestens ein ausstehender Service-%3 fÅr diesen Debitor vorhanden ist.;ENU=You cannot delete %1 %2 because there is at least one outstanding Service %3 for this customer.';
      Text014@1017 : TextConst 'DEU=Bevor Sie Online Map verwenden kînnen, mÅssen Sie die Felder des Fensters ''Online Map-Einrichtung'' ausfÅllen.\Informationen hierzu finden Sie in der Hilfe zum Einrichten von Online Map.;ENU=Before you can use Online Map, you must fill in the Online Map Setup window.\See Setting Up Online Map in Help.';
      Text015@1036 : TextConst 'DEU=%1 ''%2'' kann nicht gelîscht werden, da dem Debitor mindestens ein Objekt vom Typ %3 zugeordnet ist.;ENU=You cannot delete %1 %2 because there is at least one %3 associated to this customer.';
      "*** actTAPI ***"@1113900000 : Integer;
      TAPIFu@1113900001 : Codeunit 56780;
      TAPISetUp@1113900002 : Record 56782;
      TAPIFuSI@1113900003 : Codeunit 56782;

    PROCEDURE AssistEdit@2(OldCust@1000 : Record 18) : Boolean;
    VAR
      Cust@1001 : Record 18;
    BEGIN
      WITH Cust DO BEGIN
        Cust := Rec;
        SalesSetup.GET;
        SalesSetup.TESTFIELD("Customer Nos.");
        IF NoSeriesMgt.SelectSeries(SalesSetup."Customer Nos.",OldCust."No. Series","No. Series") THEN BEGIN
          NoSeriesMgt.SetSeries("No.");
          Rec := Cust;
          EXIT(TRUE);
        END;
      END;
    END;

    PROCEDURE ValidateShortcutDimCode@29(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.SaveDefaultDim(DATABASE::Customer,"No.",FieldNumber,ShortcutDimCode);
      MODIFY;
    END;

    PROCEDURE ShowContact@1();
    VAR
      ContBusRel@1000 : Record 5054;
      Cont@1001 : Record 5050;
    BEGIN
      IF "No." = '' THEN
        EXIT;

      ContBusRel.SETCURRENTKEY("Link to Table","No.");
      ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
      ContBusRel.SETRANGE("No.","No.");
      IF NOT ContBusRel.FIND('-') THEN BEGIN
        IF NOT CONFIRM(Text002,FALSE,TABLECAPTION,"No.") THEN
          EXIT;
        UpdateContFromCust.InsertNewContact(Rec,FALSE);
        ContBusRel.FIND('-');
      END;
      COMMIT;

      IF ISSERVICETIER THEN BEGIN
        Cont.SETCURRENTKEY("Company Name","Company No.",Type,Name);
        Cont.SETRANGE("Company No.",ContBusRel."Contact No.");
        FORM.RUN(FORM::"Contact List",Cont);
        EXIT;
      END;

      Cont.GET(ContBusRel."Contact No.");
      FORM.RUN(FORM::"Contact Card",Cont);
    END;

    PROCEDURE SetInsertFromContact@3(FromContact@1000 : Boolean);
    BEGIN
      InsertFromContact := FromContact;
    END;

    PROCEDURE CheckBlockedCustOnDocs@5(Cust2@1000 : Record 18;DocType@1001 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order';Shipment@1005 : Boolean;Transaction@1003 : Boolean);
    BEGIN
      WITH Cust2 DO BEGIN
        IF ((Blocked = Blocked::All) OR
            ((Blocked = Blocked::Invoice) AND (DocType IN [DocType::Quote,DocType::Order,DocType::Invoice,DocType::"Blanket Order"])) OR
            ((Blocked = Blocked::Ship) AND (DocType IN [DocType::Quote,DocType::Order,DocType::"Blanket Order"]) AND
             (NOT Transaction)) OR
            ((Blocked = Blocked::Ship) AND (DocType IN [DocType::Quote,DocType::Order,DocType::Invoice,DocType::"Blanket Order"]) AND
             Shipment AND Transaction))
        THEN
          CustBlockedErrorMessage(Cust2,Transaction);
      END;
    END;

    PROCEDURE CheckBlockedCustOnJnls@7(Cust2@1003 : Record 18;DocType@1002 : ' ,Payment,Invoice,Credit Memo,Finance Charge,Reminder,Refund';Transaction@1000 : Boolean);
    BEGIN
      WITH Cust2 DO BEGIN
        IF (Blocked = Blocked::All) OR
           ((Blocked = Blocked::Invoice) AND (DocType IN [DocType::Invoice,DocType::" "]))
        THEN
          CustBlockedErrorMessage(Cust2,Transaction)
      END;
    END;

    PROCEDURE CustBlockedErrorMessage@4(Cust2@1001 : Record 18;Transaction@1000 : Boolean);
    VAR
      Action@1002 : Text[30];
    BEGIN
      IF Transaction THEN
        Action := Text004
      ELSE
        Action := Text005;
      ERROR(Text006,Action,Cust2."No.",Cust2.Blocked);
    END;

    PROCEDURE LookUpAdjmtValueEntries@6(CustDateFilter@1002 : Text[30]);
    VAR
      ValueEntry@1001 : Record 5802;
    BEGIN
      ValueEntry.SETCURRENTKEY("Source Type","Source No.");
      ValueEntry.SETRANGE("Source Type",ValueEntry."Source Type"::Customer);
      ValueEntry.SETRANGE("Source No.","No.");
      ValueEntry.SETFILTER("Posting Date",CustDateFilter);
      ValueEntry.SETFILTER("Global Dimension 1 Code",GETFILTER("Global Dimension 1 Filter"));
      ValueEntry.SETFILTER("Global Dimension 2 Code",GETFILTER("Global Dimension 2 Filter"));
      ValueEntry.SETRANGE(Adjustment,TRUE);
      ValueEntry.SETRANGE("Expected Cost",FALSE);
      FORM.RUNMODAL(0,ValueEntry);
    END;

    PROCEDURE DisplayMap@8();
    VAR
      MapPoint@1001 : Record 800;
      MapMgt@1000 : Codeunit 802;
    BEGIN
      IF MapPoint.FIND('-') THEN
        MapMgt.MakeSelection(DATABASE::Customer,GETPOSITION)
      ELSE
        MESSAGE(Text014);
    END;

    BEGIN
    {
      AT01 actTAPI 04.06.2003 Build Phone Index: Global Var TAPIFu CU 567890
                              Call in the OnValidate-Trigger of every Phone No. (1x)
                              Delete PhoneIndex
      AT01.20      08.09.2003 Create/modify PhoneIndex, if Name is changed
                              Option: Format Phone No. in the OnValidate-Trigger
                                of every Phone No. (1x)
                              Global Var: TAPISetUp Rec 56782
      AT04.00      04.11.2005 Option: Format Fax No. in the OnValidate-Trigger
                              of Fax No.
      AT2009       06.11.2009 Global Var TAPIFuSI CU 56782 (ConvToCanonic)
                              Modify PhoneIndex, if Blocked is changed
    }
    END.
  }
}

OBJECT Table 23 Vendor
{
  OBJECT-PROPERTIES
  {
    Date=06.11.09;
    Time=10:00:00;
    Modified=Yes;
    Version List=NAVW16.00,LIQEM5.00,NAVDACH5.00.01,AT2009;
  }
  PROPERTIES
  {
    Permissions=TableData 25=r;
    DataCaptionFields=No.,Name;
    OnInsert=BEGIN
               IF "No." = '' THEN BEGIN
                 PurchSetup.GET;
                 PurchSetup.TESTFIELD("Vendor Nos.");
                 NoSeriesMgt.InitSeries(PurchSetup."Vendor Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;
               IF "Invoice Disc. Code" = '' THEN
                 "Invoice Disc. Code" := "No.";

               IF NOT InsertFromContact THEN
                 UpdateContFromVend.OnInsert(Rec);

               DimMgt.UpdateDefaultDim(
                 DATABASE::Vendor,"No.",
                 "Global Dimension 1 Code","Global Dimension 2 Code");
             END;

    OnModify=BEGIN
               "Last Date Modified" := TODAY;

               IF (Name <> xRec.Name) OR
                  ("Search Name" <> xRec."Search Name") OR
                  ("Name 2" <> xRec."Name 2") OR
                  (Address <> xRec.Address) OR
                  ("Address 2" <> xRec."Address 2") OR
                  (City <> xRec.City) OR
                  ("Phone No." <> xRec."Phone No.") OR
                  ("Telex No." <> xRec."Telex No.") OR
                  ("Territory Code" <> xRec."Territory Code") OR
                  ("Currency Code" <> xRec."Currency Code") OR
                  ("Language Code" <> xRec."Language Code") OR
                  ("Purchaser Code" <> xRec."Purchaser Code") OR
                  ("Country/Region Code" <> xRec."Country/Region Code") OR
                  ("Fax No." <> xRec."Fax No.") OR
                  ("Telex Answer Back" <> xRec."Telex Answer Back") OR
                  ("VAT Registration No." <> xRec."VAT Registration No.") OR
                  ("Post Code" <> xRec."Post Code") OR
                  (County <> xRec.County) OR
                  ("E-Mail" <> xRec."E-Mail") OR
                  ("Home Page" <> xRec."Home Page")
               THEN BEGIN
                 MODIFY;
                 UpdateContFromVend.OnModify(Rec);
               END;
             END;

    OnDelete=VAR
               ItemVendor@1000 : Record 99;
               PurchPrice@1001 : Record 7012;
               PurchLineDiscount@1002 : Record 7014;
               PurchPrepmtPct@1003 : Record 460;
             BEGIN
               MoveEntries.MoveVendorEntries(Rec);

               CommentLine.SETRANGE("Table Name",CommentLine."Table Name"::Vendor);
               CommentLine.SETRANGE("No.","No.");
               CommentLine.DELETEALL;

               VendBankAcc.SETRANGE("Vendor No.","No.");
               VendBankAcc.DELETEALL;

               OrderAddr.SETRANGE("Vendor No.","No.");
               OrderAddr.DELETEALL;

               ItemCrossReference.SETCURRENTKEY("Cross-Reference Type","Cross-Reference Type No.");
               ItemCrossReference.SETRANGE("Cross-Reference Type",ItemCrossReference."Cross-Reference Type"::Vendor);
               ItemCrossReference.SETRANGE("Cross-Reference Type No.","No.");
               ItemCrossReference.DELETEALL;

               PurchOrderLine.SETCURRENTKEY("Document Type","Pay-to Vendor No.");
               PurchOrderLine.SETFILTER(
                 "Document Type",'%1|%2',
                 PurchOrderLine."Document Type"::Order,
                 PurchOrderLine."Document Type"::"Return Order");
               PurchOrderLine.SETRANGE("Pay-to Vendor No.","No.");
               IF PurchOrderLine.FIND('-') THEN
                 ERROR(
                   Text000,
                   TABLECAPTION,"No.",
                   PurchOrderLine."Document Type");

               PurchOrderLine.SETRANGE("Pay-to Vendor No.");
               PurchOrderLine.SETRANGE("Buy-from Vendor No.","No.");
               IF PurchOrderLine.FIND('-') THEN
                 ERROR(
                   Text000,
                   TABLECAPTION,"No.");


               UpdateContFromVend.OnDelete(Rec);

               DimMgt.DeleteDefaultDim(DATABASE::Vendor,"No.");

               ServiceItem.SETRANGE("Vendor No.","No.");
               ServiceItem.MODIFYALL("Vendor No.",'');

               ItemVendor.SETRANGE("Vendor No.","No.");
               ItemVendor.DELETEALL(TRUE);

               PurchPrice.SETCURRENTKEY("Vendor No.");
               PurchPrice.SETRANGE("Vendor No.","No.");
               PurchPrice.DELETEALL(TRUE);

               PurchLineDiscount.SETCURRENTKEY("Vendor No.");
               PurchLineDiscount.SETRANGE("Vendor No.","No.");
               PurchLineDiscount.DELETEALL(TRUE);

               PurchPrepmtPct.SETCURRENTKEY("Vendor No.");
               PurchPrepmtPct.SETRANGE("Vendor No.","No.");
               PurchPrepmtPct.DELETEALL(TRUE);

               // AT01 BEGIN
               TAPIFu.DeletePhoneIndex(23, "No.", '',0);
               // AT01 END
             END;

    OnRename=BEGIN
               "Last Date Modified" := TODAY;
             END;

    CaptionML=[DEU=Kreditor;
               ENU=Vendor];
    LookupFormID=Form27;
    DrillDownFormID=Form27;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;AltSearchField=Search Name;
                                                   OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  PurchSetup.GET;
                                                                  NoSeriesMgt.TestManual(PurchSetup."Vendor Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                                IF "Invoice Disc. Code" = '' THEN
                                                                  "Invoice Disc. Code" := "No.";
                                                              END;

                                                   CaptionML=[DEU=Nr.;
                                                              ENU=No.] }
    { 2   ;   ;Name                ;Text50        ;OnValidate=BEGIN
                                                                IF ("Search Name" = UPPERCASE(xRec.Name)) OR ("Search Name" = '') THEN
                                                                  "Search Name" := Name;

                                                                // AT01.20 BEGIN
                                                                IF Name <> xRec.Name THEN
                                                                  TAPIFu.PhoneIndexVend(Rec);
                                                                // AT01.20 END
                                                              END;

                                                   CaptionML=[DEU=Name;
                                                              ENU=Name] }
    { 3   ;   ;Search Name         ;Code50        ;CaptionML=[DEU=Suchbegriff;
                                                              ENU=Search Name] }
    { 4   ;   ;Name 2              ;Text50        ;CaptionML=[DEU=Name 2;
                                                              ENU=Name 2] }
    { 5   ;   ;Address             ;Text50        ;CaptionML=[DEU=Adresse;
                                                              ENU=Address] }
    { 6   ;   ;Address 2           ;Text50        ;CaptionML=[DEU=Adresse 2;
                                                              ENU=Address 2] }
    { 7   ;   ;City                ;Text30        ;OnValidate=BEGIN
                                                                PostCode.ValidateCity(City,"Post Code");
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookUpCity(City,"Post Code",TRUE);
                                                            END;

                                                   CaptionML=[DEU=Ort;
                                                              ENU=City] }
    { 8   ;   ;Contact             ;Text50        ;OnValidate=BEGIN
                                                                IF RMSetup.GET THEN
                                                                  IF RMSetup."Bus. Rel. Code for Vendors" <> '' THEN
                                                                    IF (xRec.Contact = '') AND (xRec."Primary Contact No." = '') THEN BEGIN
                                                                      MODIFY;
                                                                      UpdateContFromVend.OnModify(Rec);
                                                                      UpdateContFromVend.InsertNewContactPerson(Rec,FALSE);
                                                                      MODIFY(TRUE);
                                                                    END
                                                              END;

                                                   CaptionML=[DEU=Kontakt;
                                                              ENU=Contact] }
    { 9   ;   ;Phone No.           ;Text30        ;OnValidate=BEGIN
                                                                // AT01 BEGIN
                                                                TAPIFu.PhoneIndexVend(Rec);
                                                                // AT01 END
                                                                // AT01.20 BEGIN
                                                                TAPISetUp.GET;
                                                                IF TAPISetUp."Format Phone Numbers" THEN
                                                                // AT2009 CHANGED
                                                                  "Phone No." := TAPIFuSI.ConvToCanonic("Phone No.");
                                                                // AT2009 END
                                                                // AT01.20 END
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[DEU=Telefonnr.;
                                                              ENU=Phone No.] }
    { 10  ;   ;Telex No.           ;Text20        ;CaptionML=[DEU=Telexnr.;
                                                              ENU=Telex No.] }
    { 14  ;   ;Our Account No.     ;Text20        ;CaptionML=[DEU=Unsere Kontonr.;
                                                              ENU=Our Account No.] }
    { 15  ;   ;Territory Code      ;Code10        ;TableRelation=Territory;
                                                   CaptionML=[DEU=Gebietscode;
                                                              ENU=Territory Code] }
    { 16  ;   ;Global Dimension 1 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Global Dimension 1 Code");
                                                              END;

                                                   CaptionML=[DEU=Globaler Dimensionscode 1;
                                                              ENU=Global Dimension 1 Code];
                                                   CaptionClass='1,1,1' }
    { 17  ;   ;Global Dimension 2 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Global Dimension 2 Code");
                                                              END;

                                                   CaptionML=[DEU=Globaler Dimensionscode 2;
                                                              ENU=Global Dimension 2 Code];
                                                   CaptionClass='1,1,2' }
    { 19  ;   ;Budgeted Amount     ;Decimal       ;CaptionML=[DEU=Budgetierter Betrag;
                                                              ENU=Budgeted Amount];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 21  ;   ;Vendor Posting Group;Code10        ;TableRelation="Vendor Posting Group";
                                                   CaptionML=[DEU=Kreditorenbuchungsgruppe;
                                                              ENU=Vendor Posting Group] }
    { 22  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   CaptionML=[DEU=WÑhrungscode;
                                                              ENU=Currency Code] }
    { 24  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   CaptionML=[DEU=Sprachcode;
                                                              ENU=Language Code] }
    { 26  ;   ;Statistics Group    ;Integer       ;CaptionML=[DEU=Statistikgruppe;
                                                              ENU=Statistics Group] }
    { 27  ;   ;Payment Terms Code  ;Code10        ;TableRelation="Payment Terms";
                                                   CaptionML=[DEU=Zlg.-Bedingungscode;
                                                              ENU=Payment Terms Code] }
    { 28  ;   ;Fin. Charge Terms Code;Code10      ;TableRelation="Finance Charge Terms";
                                                   CaptionML=[DEU=Zinskonditionencode;
                                                              ENU=Fin. Charge Terms Code] }
    { 29  ;   ;Purchaser Code      ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[DEU=EinkÑufercode;
                                                              ENU=Purchaser Code] }
    { 30  ;   ;Shipment Method Code;Code10        ;TableRelation="Shipment Method";
                                                   CaptionML=[DEU=Lieferbedingungscode;
                                                              ENU=Shipment Method Code] }
    { 31  ;   ;Shipping Agent Code ;Code10        ;TableRelation="Shipping Agent";
                                                   CaptionML=[DEU=Zustellercode;
                                                              ENU=Shipping Agent Code] }
    { 33  ;   ;Invoice Disc. Code  ;Code20        ;TableRelation=Vendor;
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DEU=Rechnungsrabattcode;
                                                              ENU=Invoice Disc. Code] }
    { 35  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[DEU=LÑnder-/Regionscode;
                                                              ENU=Country/Region Code] }
    { 38  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Comment Line" WHERE (Table Name=CONST(Vendor),
                                                                                           No.=FIELD(No.)));
                                                   CaptionML=[DEU=Bemerkung;
                                                              ENU=Comment];
                                                   Editable=No }
    { 39  ;   ;Blocked             ;Option        ;OnValidate=BEGIN
                                                                // AT2009 BEGIN
                                                                IF Blocked <> xRec.Blocked THEN
                                                                  TAPIFu.PhoneIndexVend(Rec);
                                                                // AT2009 END
                                                              END;

                                                   CaptionML=[DEU=Gesperrt;
                                                              ENU=Blocked];
                                                   OptionCaptionML=[DEU=" ,Zahlung,Alle";
                                                                    ENU=" ,Payment,All"];
                                                   OptionString=[ ,Payment,All] }
    { 45  ;   ;Pay-to Vendor No.   ;Code20        ;TableRelation=Vendor;
                                                   CaptionML=[DEU=Zahlung an Kred.-Nr.;
                                                              ENU=Pay-to Vendor No.] }
    { 46  ;   ;Priority            ;Integer       ;CaptionML=[DEU=PrioritÑt;
                                                              ENU=Priority] }
    { 47  ;   ;Payment Method Code ;Code10        ;TableRelation="Payment Method";
                                                   CaptionML=[DEU=Zahlungsformcode;
                                                              ENU=Payment Method Code] }
    { 54  ;   ;Last Date Modified  ;Date          ;CaptionML=[DEU=Korrigiert am;
                                                              ENU=Last Date Modified];
                                                   Editable=No }
    { 55  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=Datumsfilter;
                                                              ENU=Date Filter] }
    { 56  ;   ;Global Dimension 1 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   CaptionML=[DEU=Globaler Dimensionsfilter 1;
                                                              ENU=Global Dimension 1 Filter];
                                                   CaptionClass='1,3,1' }
    { 57  ;   ;Global Dimension 2 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   CaptionML=[DEU=Globaler Dimensionsfilter 2;
                                                              ENU=Global Dimension 2 Filter];
                                                   CaptionClass='1,3,2' }
    { 58  ;   ;Balance             ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Vendor No.=FIELD(No.),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Saldo;
                                                              ENU=Balance];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 59  ;   ;Balance (LCY)       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Saldo (MW);
                                                              ENU=Balance (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 60  ;   ;Net Change          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Vendor No.=FIELD(No.),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Posting Date=FIELD(Date Filter),
                                                                                                                Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Bewegung;
                                                              ENU=Net Change];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 61  ;   ;Net Change (LCY)    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Bewegung (MW);
                                                              ENU=Net Change (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 62  ;   ;Purchases (LCY)     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Vendor Ledger Entry"."Purchase (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                  Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                  Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                  Posting Date=FIELD(Date Filter),
                                                                                                                  Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Einkauf (MW);
                                                              ENU=Purchases (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 64  ;   ;Inv. Discounts (LCY);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Vendor Ledger Entry"."Inv. Discount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                       Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                       Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Rechnungsrabatte (MW);
                                                              ENU=Inv. Discounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 65  ;   ;Pmt. Discounts (LCY);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                       Entry Type=FILTER(Payment Discount..'Payment Discount (VAT Adjustment)'),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Skonto (MW);
                                                              ENU=Pmt. Discounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 66  ;   ;Balance Due         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Vendor No.=FIELD(No.),
                                                                                                                Posting Date=FIELD(UPPERLIMIT(Date Filter)),
                                                                                                                Initial Entry Due Date=FIELD(Date Filter),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=FÑlliger Saldo;
                                                              ENU=Balance Due];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 67  ;   ;Balance Due (LCY)   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                        Posting Date=FIELD(UPPERLIMIT(Date Filter)),
                                                                                                                        Initial Entry Due Date=FIELD(Date Filter),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=FÑlliger Saldo (MW);
                                                              ENU=Balance Due (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 69  ;   ;Payments            ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Payment),
                                                                                                               Entry Type=CONST(Initial Entry),
                                                                                                               Vendor No.=FIELD(No.),
                                                                                                               Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                               Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                               Posting Date=FIELD(Date Filter),
                                                                                                               Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Zahlungen;
                                                              ENU=Payments];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 70  ;   ;Invoice Amounts     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Invoice),
                                                                                                                Entry Type=CONST(Initial Entry),
                                                                                                                Vendor No.=FIELD(No.),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Posting Date=FIELD(Date Filter),
                                                                                                                Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Fakturierter Betrag;
                                                              ENU=Invoice Amounts];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 71  ;   ;Cr. Memo Amounts    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Credit Memo),
                                                                                                               Entry Type=CONST(Initial Entry),
                                                                                                               Vendor No.=FIELD(No.),
                                                                                                               Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                               Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                               Posting Date=FIELD(Date Filter),
                                                                                                               Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Gutgeschriebener Betrag;
                                                              ENU=Cr. Memo Amounts];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 72  ;   ;Finance Charge Memo Amounts;Decimal;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Finance Charge Memo),
                                                                                                                Entry Type=CONST(Initial Entry),
                                                                                                                Vendor No.=FIELD(No.),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Posting Date=FIELD(Date Filter),
                                                                                                                Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Zinsrechnungsbetrag;
                                                              ENU=Finance Charge Memo Amounts];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 74  ;   ;Payments (LCY)      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Payment),
                                                                                                                       Entry Type=CONST(Initial Entry),
                                                                                                                       Vendor No.=FIELD(No.),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Bezahlt (MW);
                                                              ENU=Payments (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 75  ;   ;Inv. Amounts (LCY)  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Invoice),
                                                                                                                        Entry Type=CONST(Initial Entry),
                                                                                                                        Vendor No.=FIELD(No.),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Fakturierter Betrag (MW);
                                                              ENU=Inv. Amounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 76  ;   ;Cr. Memo Amounts (LCY);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Credit Memo),
                                                                                                                       Entry Type=CONST(Initial Entry),
                                                                                                                       Vendor No.=FIELD(No.),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Gutgeschriebener Betrag (MW);
                                                              ENU=Cr. Memo Amounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 77  ;   ;Fin. Charge Memo Amounts (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Finance Charge Memo),
                                                                                                                        Entry Type=CONST(Initial Entry),
                                                                                                                        Vendor No.=FIELD(No.),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Zinsrechnungsbetrag (MW);
                                                              ENU=Fin. Charge Memo Amounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 78  ;   ;Outstanding Orders  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Outstanding Amount" WHERE (Document Type=CONST(Order),
                                                                                                               Pay-to Vendor No.=FIELD(No.),
                                                                                                               Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                               Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                               Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Bestellungsbestand;
                                                              ENU=Outstanding Orders];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 79  ;   ;Amt. Rcd. Not Invoiced;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Amt. Rcd. Not Invoiced" WHERE (Document Type=CONST(Order),
                                                                                                                   Pay-to Vendor No.=FIELD(No.),
                                                                                                                   Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                   Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                   Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Nicht fakt. Lieferbetrag;
                                                              ENU=Amt. Rcd. Not Invoiced];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 80  ;   ;Application Method  ;Option        ;CaptionML=[DEU=Ausgleichsmethode;
                                                              ENU=Application Method];
                                                   OptionCaptionML=[DEU=Offener Posten,Saldomethode;
                                                                    ENU=Manual,Apply to Oldest];
                                                   OptionString=Manual,Apply to Oldest }
    { 82  ;   ;Prices Including VAT;Boolean       ;OnValidate=VAR
                                                                PurchPrice@1000 : Record 7012;
                                                                Item@1001 : Record 27;
                                                                VATPostingSetup@1002 : Record 325;
                                                                Currency@1003 : Record 4;
                                                              BEGIN
                                                                PurchPrice.SETCURRENTKEY("Vendor No.");
                                                                PurchPrice.SETRANGE("Vendor No.","No.");
                                                                IF PurchPrice.FIND('-') THEN BEGIN
                                                                  IF VATPostingSetup.GET('','') THEN;
                                                                  IF CONFIRM(
                                                                       STRSUBSTNO(
                                                                         Text002,
                                                                         FIELDCAPTION("Prices Including VAT"),"Prices Including VAT",PurchPrice.TABLECAPTION),TRUE)
                                                                  THEN
                                                                    REPEAT
                                                                      IF PurchPrice."Item No." <> Item."No." THEN
                                                                        Item.GET(PurchPrice."Item No.");
                                                                      IF ("VAT Bus. Posting Group" <> VATPostingSetup."VAT Bus. Posting Group") OR
                                                                         (Item."VAT Prod. Posting Group" <> VATPostingSetup."VAT Prod. Posting Group")
                                                                      THEN
                                                                        VATPostingSetup.GET("VAT Bus. Posting Group",Item."VAT Prod. Posting Group");
                                                                      IF PurchPrice."Currency Code" = '' THEN
                                                                        Currency.InitRoundingPrecision
                                                                      ELSE
                                                                        IF PurchPrice."Currency Code" <> Currency.Code THEN
                                                                          Currency.GET(PurchPrice."Currency Code");
                                                                      IF VATPostingSetup."VAT %" <> 0 THEN BEGIN
                                                                        IF "Prices Including VAT" THEN
                                                                          PurchPrice."Direct Unit Cost" :=
                                                                            ROUND(
                                                                              PurchPrice."Direct Unit Cost" * (1 + VATPostingSetup."VAT %" / 100),
                                                                              Currency."Unit-Amount Rounding Precision")
                                                                        ELSE
                                                                          PurchPrice."Direct Unit Cost" :=
                                                                            ROUND(
                                                                              PurchPrice."Direct Unit Cost" / (1 + VATPostingSetup."VAT %" / 100),
                                                                              Currency."Unit-Amount Rounding Precision");
                                                                        PurchPrice.MODIFY;
                                                                      END;
                                                                    UNTIL PurchPrice.NEXT = 0;
                                                                END;
                                                              END;

                                                   CaptionML=[DEU=EK-Preise inkl. MwSt.;
                                                              ENU=Prices Including VAT] }
    { 84  ;   ;Fax No.             ;Text30        ;OnValidate=BEGIN
                                                                // AT 04.00 BEGIN
                                                                TAPISetUp.GET;
                                                                IF TAPISetUp."Format Fax Numbers" THEN
                                                                // AT2009 CHANGED
                                                                  "Fax No." := TAPIFuSI.ConvToCanonic("Fax No.");
                                                                // AT2009 END
                                                                // AT04.00 END
                                                              END;

                                                   CaptionML=[DEU=Faxnr.;
                                                              ENU=Fax No.] }
    { 85  ;   ;Telex Answer Back   ;Text20        ;CaptionML=[DEU=Telex Namengeber;
                                                              ENU=Telex Answer Back] }
    { 86  ;   ;VAT Registration No.;Text20        ;OnValidate=VAR
                                                                VATRegNoFormat@1000 : Record 381;
                                                              BEGIN
                                                                VATRegNoFormat.Test("VAT Registration No.","Country/Region Code","No.",DATABASE::Vendor);
                                                              END;

                                                   CaptionML=[DEU=USt-IdNr.;
                                                              ENU=VAT Registration No.] }
    { 88  ;   ;Gen. Bus. Posting Group;Code10     ;TableRelation="Gen. Business Posting Group";
                                                   OnValidate=BEGIN
                                                                IF xRec."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group" THEN
                                                                  IF GenBusPostingGrp.ValidateVatBusPostingGroup(GenBusPostingGrp,"Gen. Bus. Posting Group") THEN
                                                                    VALIDATE("VAT Bus. Posting Group",GenBusPostingGrp."Def. VAT Bus. Posting Group");
                                                              END;

                                                   CaptionML=[DEU=GeschÑftsbuchungsgruppe;
                                                              ENU=Gen. Bus. Posting Group] }
    { 89  ;   ;Picture             ;BLOB          ;CaptionML=[DEU=Bild;
                                                              ENU=Picture];
                                                   SubType=Bitmap }
    { 91  ;   ;Post Code           ;Code20        ;TableRelation="Post Code";
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code");
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookUpPostCode(City,"Post Code",TRUE);
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DEU=PLZ-Code;
                                                              ENU=Post Code] }
    { 92  ;   ;County              ;Text30        ;CaptionML=[DEU=Bundesregion;
                                                              ENU=County] }
    { 97  ;   ;Debit Amount        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Debit Amount" WHERE (Vendor No.=FIELD(No.),
                                                                                                                       Entry Type=FILTER(<>Application),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Sollbetrag;
                                                              ENU=Debit Amount];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 98  ;   ;Credit Amount       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Credit Amount" WHERE (Vendor No.=FIELD(No.),
                                                                                                                        Entry Type=FILTER(<>Application),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Habenbetrag;
                                                              ENU=Credit Amount];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 99  ;   ;Debit Amount (LCY)  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Debit Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                             Entry Type=FILTER(<>Application),
                                                                                                                             Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                             Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                             Posting Date=FIELD(Date Filter),
                                                                                                                             Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Sollbetrag (MW);
                                                              ENU=Debit Amount (LCY)];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 100 ;   ;Credit Amount (LCY) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Credit Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                              Entry Type=FILTER(<>Application),
                                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                              Posting Date=FIELD(Date Filter),
                                                                                                                              Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Habenbetrag (MW);
                                                              ENU=Credit Amount (LCY)];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 102 ;   ;E-Mail              ;Text80        ;ExtendedDatatype=E-Mail;
                                                   CaptionML=[DEU=E-Mail;
                                                              ENU=E-Mail] }
    { 103 ;   ;Home Page           ;Text80        ;ExtendedDatatype=URL;
                                                   CaptionML=[DEU=Homepage;
                                                              ENU=Home Page] }
    { 104 ;   ;Reminder Amounts    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Reminder),
                                                                                                                Entry Type=CONST(Initial Entry),
                                                                                                                Vendor No.=FIELD(No.),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Posting Date=FIELD(Date Filter),
                                                                                                                Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Mahnbetrag;
                                                              ENU=Reminder Amounts];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 105 ;   ;Reminder Amounts (LCY);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Reminder),
                                                                                                                        Entry Type=CONST(Initial Entry),
                                                                                                                        Vendor No.=FIELD(No.),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Mahnbetrag (MW);
                                                              ENU=Reminder Amounts (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 107 ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[DEU=Nummernserie;
                                                              ENU=No. Series];
                                                   Editable=No }
    { 108 ;   ;Tax Area Code       ;Code20        ;TableRelation="Tax Area";
                                                   CaptionML=[DEU=Steuergebietscode;
                                                              ENU=Tax Area Code] }
    { 109 ;   ;Tax Liable          ;Boolean       ;CaptionML=[DEU=Steuerpflichtig;
                                                              ENU=Tax Liable] }
    { 110 ;   ;VAT Bus. Posting Group;Code10      ;TableRelation="VAT Business Posting Group";
                                                   CaptionML=[DEU=MwSt.-GeschÑftsbuchungsgruppe;
                                                              ENU=VAT Bus. Posting Group] }
    { 111 ;   ;Currency Filter     ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Currency;
                                                   CaptionML=[DEU=WÑhrungsfilter;
                                                              ENU=Currency Filter] }
    { 113 ;   ;Outstanding Orders (LCY);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Outstanding Amount (LCY)" WHERE (Document Type=CONST(Order),
                                                                                                                     Pay-to Vendor No.=FIELD(No.),
                                                                                                                     Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                     Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                     Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Bestellungsbestand (MW);
                                                              ENU=Outstanding Orders (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 114 ;   ;Amt. Rcd. Not Invoiced (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Amt. Rcd. Not Invoiced (LCY)" WHERE (Document Type=CONST(Order),
                                                                                                                         Pay-to Vendor No.=FIELD(No.),
                                                                                                                         Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                         Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                         Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Nicht fakt. Lieferbetrag (MW);
                                                              ENU=Amt. Rcd. Not Invoiced (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 116 ;   ;Block Payment Tolerance;Boolean    ;CaptionML=[DEU=Zahlungstoleranz sperren;
                                                              ENU=Block Payment Tolerance] }
    { 117 ;   ;Pmt. Disc. Tolerance (LCY);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                       Entry Type=FILTER(Payment Discount Tolerance|'Payment Discount Tolerance (VAT Adjustment)'|'Payment Discount Tolerance (VAT Excl.)'),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Skontotoleranz (MW);
                                                              ENU=Pmt. Disc. Tolerance (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 118 ;   ;Pmt. Tolerance (LCY);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                       Entry Type=FILTER(Payment Tolerance|'Payment Tolerance (VAT Adjustment)'|'Payment Tolerance (VAT Excl.)'),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Zahlungstoleranz (MW);
                                                              ENU=Pmt. Tolerance (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 119 ;   ;IC Partner Code     ;Code20        ;TableRelation="IC Partner";
                                                   OnValidate=VAR
                                                                VendLedgEntry@1001 : Record 25;
                                                                AccountingPeriod@1000 : Record 50;
                                                                ICPartner@1002 : Record 413;
                                                              BEGIN
                                                                IF xRec."IC Partner Code" <> "IC Partner Code" THEN BEGIN
                                                                  VendLedgEntry.SETCURRENTKEY("Vendor No.","Posting Date");
                                                                  VendLedgEntry.SETRANGE("Vendor No.","No.");
                                                                  AccountingPeriod.SETRANGE(Closed,FALSE);
                                                                  IF AccountingPeriod.FIND('-') THEN
                                                                    VendLedgEntry.SETFILTER("Posting Date",'>=%1',AccountingPeriod."Starting Date");
                                                                  IF VendLedgEntry.FIND('-') THEN
                                                                    IF NOT CONFIRM(Text009,FALSE,TABLECAPTION) THEN
                                                                      "IC Partner Code" := xRec."IC Partner Code";

                                                                  VendLedgEntry.RESET;
                                                                  IF NOT VendLedgEntry.SETCURRENTKEY("Vendor No.",Open) THEN
                                                                    VendLedgEntry.SETCURRENTKEY("Vendor No.");
                                                                  VendLedgEntry.SETRANGE("Vendor No.","No.");
                                                                  VendLedgEntry.SETRANGE(Open,TRUE);
                                                                  IF VendLedgEntry.FIND('+') THEN
                                                                    ERROR(Text010,FIELDCAPTION("IC Partner Code"),TABLECAPTION);
                                                                END;

                                                                IF "IC Partner Code" <> '' THEN BEGIN
                                                                  ICPartner.GET("IC Partner Code");
                                                                  IF (ICPartner."Vendor No." <> '') AND (ICPartner."Vendor No." <> "No.") THEN
                                                                    ERROR(Text008,FIELDCAPTION("IC Partner Code"),"IC Partner Code",TABLECAPTION,ICPartner."Vendor No.");
                                                                  ICPartner."Vendor No." := "No.";
                                                                  ICPartner.MODIFY;
                                                                END;

                                                                IF (xRec."IC Partner Code" <> "IC Partner Code") AND ICPartner.GET(xRec."IC Partner Code") THEN BEGIN
                                                                  ICPartner."Vendor No." := '';
                                                                  ICPartner.MODIFY;
                                                                END;
                                                              END;

                                                   CaptionML=[DEU=IC-Partnercode;
                                                              ENU=IC Partner Code] }
    { 120 ;   ;Refunds             ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Refund),
                                                                                                                Entry Type=CONST(Initial Entry),
                                                                                                                Vendor No.=FIELD(No.),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Posting Date=FIELD(Date Filter),
                                                                                                                Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Erstattungen;
                                                              ENU=Refunds] }
    { 121 ;   ;Refunds (LCY)       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Refund),
                                                                                                                        Entry Type=CONST(Initial Entry),
                                                                                                                        Vendor No.=FIELD(No.),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Erstattungen (MW);
                                                              ENU=Refunds (LCY)] }
    { 122 ;   ;Other Amounts       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Initial Document Type=CONST(" "),
                                                                                                                Entry Type=CONST(Initial Entry),
                                                                                                                Vendor No.=FIELD(No.),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Posting Date=FIELD(Date Filter),
                                                                                                                Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Weitere BetrÑge;
                                                              ENU=Other Amounts] }
    { 123 ;   ;Other Amounts (LCY) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(" "),
                                                                                                                        Entry Type=CONST(Initial Entry),
                                                                                                                        Vendor No.=FIELD(No.),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Weitere BetrÑge (MW);
                                                              ENU=Other Amounts (LCY)] }
    { 124 ;   ;Prepayment %        ;Decimal       ;CaptionML=[DEU=Vorauszahlung %;
                                                              ENU=Prepayment %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 125 ;   ;Outstanding Invoices;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Outstanding Amount" WHERE (Document Type=CONST(Invoice),
                                                                                                               Pay-to Vendor No.=FIELD(No.),
                                                                                                               Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                               Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                               Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Ausstehende Rechnungen;
                                                              ENU=Outstanding Invoices];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 126 ;   ;Outstanding Invoices (LCY);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Outstanding Amount (LCY)" WHERE (Document Type=CONST(Invoice),
                                                                                                                     Pay-to Vendor No.=FIELD(No.),
                                                                                                                     Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                     Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                     Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[DEU=Ausstehende Rechnungen (MW);
                                                              ENU=Outstanding Invoices (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 130 ;   ;Pay-to No. Of Archived Doc.;Integer;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header Archive" WHERE (Document Type=CONST(Order),
                                                                                                      Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl archivierter Belege fÅr Zahlung an;
                                                              ENU=Pay-to No. Of Archived Doc.] }
    { 131 ;   ;Buy-from No. Of Archived Doc.;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header Archive" WHERE (Document Type=CONST(Order),
                                                                                                      Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl archivierter Belege fÅr Eink. von;
                                                              ENU=Buy-from No. Of Archived Doc.] }
    { 5049;   ;Primary Contact No. ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                Cont@1001 : Record 5050;
                                                                ContBusRel@1000 : Record 5054;
                                                              BEGIN
                                                                Contact := '';
                                                                IF "Primary Contact No." <> '' THEN BEGIN
                                                                  Cont.GET("Primary Contact No.");

                                                                  ContBusRel.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Vendor);
                                                                  ContBusRel.SETRANGE("No.","No.");
                                                                  ContBusRel.FIND('-');

                                                                  IF Cont."Company No." <> ContBusRel."Contact No." THEN
                                                                    ERROR(Text004,Cont."No.",Cont.Name,"No.",Name);

                                                                  IF Cont.Type = Cont.Type::Person THEN
                                                                    Contact := Cont.Name
                                                                END;
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1001 : Record 5050;
                                                              ContBusRel@1000 : Record 5054;
                                                            BEGIN
                                                              ContBusRel.SETCURRENTKEY("Link to Table","No.");
                                                              ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Vendor);
                                                              ContBusRel.SETRANGE("No.","No.");
                                                              IF ContBusRel.FINDFIRST THEN
                                                                Cont.SETRANGE("Company No.",ContBusRel."Contact No.")
                                                              ELSE
                                                                Cont.SETRANGE("No.",'');

                                                              IF "Primary Contact No." <> '' THEN
                                                                IF Cont.GET("Primary Contact No.") THEN ;
                                                              IF FORM.RUNMODAL(0,Cont) = ACTION::LookupOK THEN
                                                                VALIDATE("Primary Contact No.",Cont."No.");
                                                            END;

                                                   CaptionML=[DEU=PrimÑre Kontaktnr.;
                                                              ENU=Primary Contact No.] }
    { 5700;   ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   CaptionML=[DEU=ZustÑndigkeitseinheitencode;
                                                              ENU=Responsibility Center] }
    { 5701;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   CaptionML=[DEU=Lagerortcode;
                                                              ENU=Location Code] }
    { 5790;   ;Lead Time Calculation;DateFormula  ;CaptionML=[DEU=Beschaffungszeit;
                                                              ENU=Lead Time Calculation] }
    { 7177;   ;No. of Pstd. Receipts;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purch. Rcpt. Header" WHERE (Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anz. gebuchter ZugÑnge;
                                                              ENU=No. of Pstd. Receipts];
                                                   Editable=No }
    { 7178;   ;No. of Pstd. Invoices;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purch. Inv. Header" WHERE (Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl gebuchter Rechnungen;
                                                              ENU=No. of Pstd. Invoices];
                                                   Editable=No }
    { 7179;   ;No. of Pstd. Return Shipments;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Return Shipment Header" WHERE (Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anz. gebuchter RÅcklieferungen;
                                                              ENU=No. of Pstd. Return Shipments];
                                                   Editable=No }
    { 7180;   ;No. of Pstd. Credit Memos;Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purch. Cr. Memo Hdr." WHERE (Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl gebuchter Gutschriften;
                                                              ENU=No. of Pstd. Credit Memos];
                                                   Editable=No }
    { 7181;   ;Pay-to No. of Orders;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Order),
                                                                                              Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl der Bestellungen fÅr Zahlung an;
                                                              ENU=Pay-to No. of Orders];
                                                   Editable=No }
    { 7182;   ;Pay-to No. of Invoices;Integer     ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Invoice),
                                                                                              Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl der Rechnungen fÅr Zahlung an;
                                                              ENU=Pay-to No. of Invoices];
                                                   Editable=No }
    { 7183;   ;Pay-to No. of Return Orders;Integer;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Return Order),
                                                                                              Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl der Reklamationen fÅr Zahlung an;
                                                              ENU=Pay-to No. of Return Orders];
                                                   Editable=No }
    { 7184;   ;Pay-to No. of Credit Memos;Integer ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Credit Memo),
                                                                                              Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl der Gutschriften fÅr Zahlung an;
                                                              ENU=Pay-to No. of Credit Memos];
                                                   Editable=No }
    { 7185;   ;Pay-to No. of Pstd. Receipts;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Purch. Rcpt. Header" WHERE (Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl gebuchter Belege fÅr Zahlung an;
                                                              ENU=Pay-to No. of Pstd. Receipts];
                                                   Editable=No }
    { 7186;   ;Pay-to No. of Pstd. Invoices;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Purch. Inv. Header" WHERE (Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl gebuchter Rechnungen fÅr Zahlung an;
                                                              ENU=Pay-to No. of Pstd. Invoices];
                                                   Editable=No }
    { 7187;   ;Pay-to No. of Pstd. Return S.;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Return Shipment Header" WHERE (Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl gebuchter RÅcklieferungen fÅr Zahlung an;
                                                              ENU=Pay-to No. of Pstd. Return S.];
                                                   Editable=No }
    { 7188;   ;Pay-to No. of Pstd. Cr. Memos;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Purch. Cr. Memo Hdr." WHERE (Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl gebuchter Gutschriften fÅr Zahlung an;
                                                              ENU=Pay-to No. of Pstd. Cr. Memos];
                                                   Editable=No }
    { 7189;   ;No. of Quotes       ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Quote),
                                                                                              Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Angebote;
                                                              ENU=No. of Quotes];
                                                   Editable=No }
    { 7190;   ;No. of Blanket Orders;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Blanket Order),
                                                                                              Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl RahmenauftrÑge;
                                                              ENU=No. of Blanket Orders];
                                                   Editable=No }
    { 7191;   ;No. of Orders       ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Order),
                                                                                              Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl AuftrÑge;
                                                              ENU=No. of Orders] }
    { 7192;   ;No. of Invoices     ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Invoice),
                                                                                              Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Rechnungen;
                                                              ENU=No. of Invoices];
                                                   Editable=No }
    { 7193;   ;No. of Return Orders;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Return Order),
                                                                                              Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Reklamationen;
                                                              ENU=No. of Return Orders];
                                                   Editable=No }
    { 7194;   ;No. of Credit Memos ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Credit Memo),
                                                                                              Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Gutschriften;
                                                              ENU=No. of Credit Memos];
                                                   Editable=No }
    { 7195;   ;No. of Order Addresses;Integer     ;FieldClass=FlowField;
                                                   CalcFormula=Count("Order Address" WHERE (Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl der Bestelladressen;
                                                              ENU=No. of Order Addresses];
                                                   Editable=No }
    { 7196;   ;Pay-to No. of Quotes;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Quote),
                                                                                              Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl der Anfragen fÅr Zahlung an;
                                                              ENU=Pay-to No. of Quotes];
                                                   Editable=No }
    { 7197;   ;Pay-to No. of Blanket Orders;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Blanket Order),
                                                                                              Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl der Rahmenbestellungen fÅr Zahlung an;
                                                              ENU=Pay-to No. of Blanket Orders] }
    { 7600;   ;Base Calendar Code  ;Code10        ;TableRelation="Base Calendar";
                                                   CaptionML=[DEU=Basiskalendercode;
                                                              ENU=Base Calendar Code] }
    { 11000;  ;Registration No.    ;Text20        ;CaptionML=[DEU=Steuernummer;
                                                              ENU=Registration No.] }
    { 5005270;;Delivery Reminder Terms;Code10     ;TableRelation="Delivery Reminder Term";
                                                   CaptionML=[DEU=Lieferanmahnungsmethodencode;
                                                              ENU=Delivery Reminder Terms] }
    { 5055250;;Liq. Payment Terms Code;Code10     ;TableRelation="Payment Terms";
                                                   CaptionML=[DEU=Liq. Zhlg.-Bedingungscode;
                                                              ENU=Liq. Payment Terms Code] }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Search Name                              }
    {    ;Vendor Posting Group                     }
    {    ;Currency Code                            }
    {    ;Priority                                 }
    {    ;Country/Region Code                      }
    {    ;Gen. Bus. Posting Group                  }
    {    ;VAT Registration No.                     }
    {    ;Name                                    ;KeyGroups=SearchCol }
    {    ;City                                    ;KeyGroups=SearchCol }
    {    ;Post Code                               ;KeyGroups=SearchCol }
    {    ;Phone No.                               ;KeyGroups=SearchCol }
    {    ;Contact                                 ;KeyGroups=SearchCol }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Name,City,Post Code,Phone No.,Contact }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'DEU=Sie kînnen %1 %2 nicht lîschen, da noch ein(e) %3 (oder mehrere) fÅr diesen Kreditor vorhanden ist.;ENU=You cannot delete %1 %2 because there is at least one outstanding Purchase %3 for this vendor.';
      Text002@1001 : TextConst 'DEU=Sie haben die %1 auf %2 gesetzt. Mîchten Sie die %3-Preisliste entsprechend aktualisieren?;ENU=You have set %1 to %2. Do you want to update the %3 price list accordingly?';
      Text003@1002 : TextConst 'DEU=Mîchten Sie einen Kontakt fÅr %1 %2 erstellen?;ENU=Do you wish to create a contact for %1 %2?';
      PurchSetup@1003 : Record 312;
      CommentLine@1005 : Record 97;
      PurchOrderLine@1006 : Record 39;
      PostCode@1007 : Record 225;
      VendBankAcc@1008 : Record 288;
      OrderAddr@1009 : Record 224;
      GenBusPostingGrp@1010 : Record 250;
      ItemCrossReference@1016 : Record 5717;
      RMSetup@1020 : Record 5079;
      ServiceItem@1024 : Record 5940;
      NoSeriesMgt@1011 : Codeunit 396;
      MoveEntries@1012 : Codeunit 361;
      UpdateContFromVend@1013 : Codeunit 5057;
      DimMgt@1014 : Codeunit 408;
      InsertFromContact@1015 : Boolean;
      Text004@1019 : TextConst 'DEU=Kontakt %1 %2 ist nicht mit Kreditor %3 %4 verknÅpft.;ENU=Contact %1 %2 is not related to vendor %3 %4.';
      Text005@1021 : TextConst 'DEU=buchen;ENU=post';
      Text006@1022 : TextConst 'DEU=erstellen;ENU=create';
      Text007@1023 : TextConst 'DEU=Sie kînnen diese Belegart nicht %1, wenn der Kreditor %2 fÅr die Art %3 gesperrt ist.;ENU=You cannot %1 this type of document when Vendor %2 is blocked with type %3';
      Text008@1025 : TextConst 'DEU=%1 %2 wurde %3 %4 zugewiesen.\Derselbe %1 kann nicht auf mehr als einen %3 eingegeben werden.;ENU=The %1 %2 has been assigned to %3 %4.\The same %1 cannot be entered on more than one %3.';
      Text009@1027 : TextConst 'DEU=Das Abstimmen von IC-Buchungen kann schwierig sein, wenn Sie den IC-Partnercode Ñndern, weil %1 Posten in einem noch nicht geschlossenen GeschÑftsjahr aufweist.\ Mîchten Sie den IC-Partnercode trotzdem Ñndern?;ENU=Reconciling IC transactions may be difficult if you change IC Partner Code because this %1 has ledger entries in a fiscal year that has not yet been closed.\ Do you still want to change the IC Partner Code?';
      Text010@1026 : TextConst 'DEU=Sie kînnen den Inhalt des Feldes %1 nicht Ñndern, weil fÅr dieses %2 ein oder mehrere offene Posten vorliegen.;ENU=You cannot change the contents of the %1 field because this %2 has one or more open ledger entries.';
      Text011@1004 : TextConst 'DEU=Bevor Sie Online Map verwenden kînnen, mÅssen Sie die Felder des Fensters ''Online Map-Einrichtung'' ausfÅllen.\Informationen hierzu finden Sie in der Hilfe zum Einrichten von Online Map.;ENU=Before you can use Online Map, you must fill in the Online Map Setup window.\See Setting Up Online Map in Help.';
      "*** actTAPI ***"@1000000002 : Integer;
      TAPIFu@1000000001 : Codeunit 56780;
      TAPISetUp@1000000000 : Record 56782;
      TAPIFuSI@1000000003 : Codeunit 56782;

    PROCEDURE AssistEdit@2(OldVend@1000 : Record 23) : Boolean;
    VAR
      Vend@1001 : Record 23;
    BEGIN
      WITH Vend DO BEGIN
        Vend := Rec;
        PurchSetup.GET;
        PurchSetup.TESTFIELD("Vendor Nos.");
        IF NoSeriesMgt.SelectSeries(PurchSetup."Vendor Nos.",OldVend."No. Series","No. Series") THEN BEGIN
          PurchSetup.GET;
          PurchSetup.TESTFIELD("Vendor Nos.");
          NoSeriesMgt.SetSeries("No.");
          Rec := Vend;
          EXIT(TRUE);
        END;
      END;
    END;

    PROCEDURE ValidateShortcutDimCode@29(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.SaveDefaultDim(DATABASE::Vendor,"No.",FieldNumber,ShortcutDimCode);
      MODIFY;
    END;

    PROCEDURE LookupShortcutDimCode@28(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.SaveDefaultDim(DATABASE::Vendor,"No.",FieldNumber,ShortcutDimCode);
    END;

    PROCEDURE ShowContact@1();
    VAR
      ContBusRel@1000 : Record 5054;
      Cont@1001 : Record 5050;
    BEGIN
      IF "No." = '' THEN
        EXIT;

      ContBusRel.SETCURRENTKEY("Link to Table","No.");
      ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Vendor);
      ContBusRel.SETRANGE("No.","No.");
      IF NOT ContBusRel.FIND('-') THEN BEGIN
        IF NOT CONFIRM(Text003,FALSE,TABLECAPTION,"No.") THEN
          EXIT;
        UpdateContFromVend.InsertNewContact(Rec,FALSE);
        ContBusRel.FIND('-');
      END;
      COMMIT;

      IF ISSERVICETIER THEN BEGIN
        Cont.SETCURRENTKEY("Company Name","Company No.",Type,Name);
        Cont.SETRANGE("Company No.",ContBusRel."Contact No.");
        FORM.RUN(FORM::"Contact List",Cont);
        EXIT;
      END;

      Cont.GET(ContBusRel."Contact No.");
      FORM.RUN(FORM::"Contact Card",Cont);
    END;

    PROCEDURE SetInsertFromContact@3(FromContact@1000 : Boolean);
    BEGIN
      InsertFromContact := FromContact;
    END;

    PROCEDURE CheckBlockedVendOnDocs@4(Vend2@1003 : Record 23;Transaction@1000 : Boolean);
    BEGIN
      IF Vend2.Blocked = Vend2.Blocked::All THEN
        VendBlockedErrorMessage(Vend2,Transaction);
    END;

    PROCEDURE CheckBlockedVendOnJnls@5(Vend2@1005 : Record 23;DocType@1004 : ' ,Payment,Invoice,Credit Memo,Finance Charge,Reminder,Refund';Transaction@1003 : Boolean);
    BEGIN
      WITH Vend2 DO BEGIN
        IF (Blocked = Blocked::All) OR
           (Blocked = Blocked::Payment) AND (DocType = DocType::Payment)
        THEN
          VendBlockedErrorMessage(Vend2,Transaction);
      END;
    END;

    PROCEDURE VendBlockedErrorMessage@6(Vend2@1001 : Record 23;Transaction@1002 : Boolean);
    VAR
      Action@1000 : Text[30];
    BEGIN
      IF Transaction THEN
        Action := Text005
      ELSE
        Action := Text006;
      ERROR(Text007,Action,Vend2."No.",Vend2.Blocked);
    END;

    PROCEDURE DisplayMap@7();
    VAR
      MapPoint@1001 : Record 800;
      MapMgt@1000 : Codeunit 802;
    BEGIN
      IF MapPoint.FIND('-') THEN
        MapMgt.MakeSelection(DATABASE::Vendor,GETPOSITION)
      ELSE
        MESSAGE(Text011);
    END;

    BEGIN
    {
      AT01 actTAPI 04.06.2003 Build Phone Index: Global Var TAPIFu CU 56780
                              Call in the OnValidate-Trigger of every Phone No. (1x)
                              Delete PhoneIndex
      AT01.20      08.09.2003 Create/modify Phone-Index, if Name is changed
                              Option: Format Phone No. in the OnValidate-Trigger of
                                every Phone No. (1x)
                              Global Var: TAPISetUp Rec 56782
      AT04.00      04.11.2005 Option: Format Fax No. in the OnValidate-Trigger
                              of Fax No.
      AT2009       06.11.2009 Global Var TAPIFuSI CU 56782 (ConvToCanonic)
                              Modify PhoneIndex, if Blocked is changed
    }
    END.
  }
}

OBJECT Table 91 User Setup
{
  OBJECT-PROPERTIES
  {
    Date=06.11.09;
    Time=10:00:00;
    Modified=Yes;
    Version List=NAVW16.00,AT2009;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Benutzer Einrichtung;
               ENU=User Setup];
    LookupFormID=Form119;
    DrillDownFormID=Form119;
  }
  FIELDS
  {
    { 1   ;   ;User ID             ;Code20        ;TableRelation=User;
                                                   OnValidate=VAR
                                                                LoginMgt@1000 : Codeunit 418;
                                                              BEGIN
                                                                LoginMgt.ValidateUserID("User ID");
                                                              END;

                                                   OnLookup=VAR
                                                              LoginMgt@1000 : Codeunit 418;
                                                            BEGIN
                                                              LoginMgt.LookupUserID("User ID");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DEU=Benutzer-ID;
                                                              ENU=User ID];
                                                   NotBlank=Yes }
    { 2   ;   ;Allow Posting From  ;Date          ;CaptionML=[DEU=Buchungen zugel. ab;
                                                              ENU=Allow Posting From] }
    { 3   ;   ;Allow Posting To    ;Date          ;CaptionML=[DEU=Buchungen zugel. bis;
                                                              ENU=Allow Posting To] }
    { 4   ;   ;Register Time       ;Boolean       ;CaptionML=[DEU=Protokollzeit;
                                                              ENU=Register Time] }
    { 10  ;   ;Salespers./Purch. Code;Code10      ;TableRelation=Salesperson/Purchaser.Code;
                                                   OnValidate=VAR
                                                                UserSetup@1000 : Record 91;
                                                              BEGIN
                                                                IF "Salespers./Purch. Code" <> '' THEN BEGIN
                                                                  UserSetup.SETCURRENTKEY("Salespers./Purch. Code");
                                                                  UserSetup.SETRANGE("Salespers./Purch. Code","Salespers./Purch. Code");
                                                                  IF UserSetup.FIND('-') THEN
                                                                    ERROR(Text001,"Salespers./Purch. Code",UserSetup."User ID");
                                                                END;
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DEU=Verk.-/EinkÑufercode;
                                                              ENU=Salespers./Purch. Code] }
    { 11  ;   ;Approver ID         ;Code20        ;TableRelation="User Setup"."User ID";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DEU=Genehmiger-ID;
                                                              ENU=Approver ID] }
    { 12  ;   ;Sales Amount Approval Limit;Integer;OnValidate=BEGIN
                                                                IF "Unlimited Sales Approval" AND ("Sales Amount Approval Limit" <> 0) THEN
                                                                  ERROR(Text003,FIELDCAPTION("Sales Amount Approval Limit"),FIELDCAPTION("Unlimited Sales Approval"));
                                                                IF "Sales Amount Approval Limit" < 0 THEN
                                                                  ERROR(Text005);
                                                              END;

                                                   CaptionML=[DEU=Grenzbetrag fÅr Verkauf;
                                                              ENU=Sales Amount Approval Limit];
                                                   BlankZero=Yes }
    { 13  ;   ;Purchase Amount Approval Limit;Integer;
                                                   OnValidate=BEGIN
                                                                IF "Unlimited Purchase Approval" AND ("Purchase Amount Approval Limit" <> 0) THEN
                                                                  ERROR(Text003,FIELDCAPTION("Purchase Amount Approval Limit"),FIELDCAPTION("Unlimited Purchase Approval"));
                                                                IF "Purchase Amount Approval Limit" < 0 THEN
                                                                  ERROR(Text005);
                                                              END;

                                                   CaptionML=[DEU=Grenzbetrag fÅr Einkauf;
                                                              ENU=Purchase Amount Approval Limit];
                                                   BlankZero=Yes }
    { 14  ;   ;Unlimited Sales Approval;Boolean   ;OnValidate=BEGIN
                                                                IF "Unlimited Sales Approval" THEN
                                                                  "Sales Amount Approval Limit" := 0;
                                                              END;

                                                   CaptionML=[DEU=Unbegrenzte Verkaufsgenehmigung;
                                                              ENU=Unlimited Sales Approval] }
    { 15  ;   ;Unlimited Purchase Approval;Boolean;OnValidate=BEGIN
                                                                IF "Unlimited Purchase Approval" THEN
                                                                  "Purchase Amount Approval Limit" := 0;
                                                              END;

                                                   CaptionML=[DEU=Unbegrenzte Einkaufsgenehmigung;
                                                              ENU=Unlimited Purchase Approval] }
    { 16  ;   ;Substitute          ;Code20        ;TableRelation="User Setup";
                                                   CaptionML=[DEU=Stellvertreter;
                                                              ENU=Substitute] }
    { 17  ;   ;E-Mail              ;Text100       ;ExtendedDatatype=E-Mail;
                                                   CaptionML=[DEU=E-Mail;
                                                              ENU=E-Mail] }
    { 19  ;   ;Request Amount Approval Limit;Integer;
                                                   OnValidate=BEGIN
                                                                IF "Unlimited Request Approval" AND ("Request Amount Approval Limit" <> 0) THEN
                                                                  ERROR(Text003,FIELDCAPTION("Request Amount Approval Limit"),FIELDCAPTION("Unlimited Request Approval"));
                                                                IF "Request Amount Approval Limit" < 0 THEN
                                                                  ERROR(Text005);
                                                              END;

                                                   CaptionML=[DEU=Grenzbetrag fÅr Anfrageanforderung;
                                                              ENU=Request Amount Approval Limit];
                                                   BlankZero=Yes }
    { 20  ;   ;Unlimited Request Approval;Boolean ;OnValidate=BEGIN
                                                                IF "Unlimited Request Approval" THEN
                                                                  "Request Amount Approval Limit" := 0;
                                                              END;

                                                   CaptionML=[DEU=Unbegrenzte Anfragegenehmigung;
                                                              ENU=Unlimited Request Approval] }
    { 5600;   ;Allow FA Posting From;Date         ;CaptionML=[DEU=Anlagenbuchungen zugel. ab;
                                                              ENU=Allow FA Posting From] }
    { 5601;   ;Allow FA Posting To ;Date          ;CaptionML=[DEU=Anlagenbuchungen zugel. bis;
                                                              ENU=Allow FA Posting To] }
    { 5700;   ;Sales Resp. Ctr. Filter;Code10     ;TableRelation="Responsibility Center".Code;
                                                   CaptionML=[DEU=Verk.-ZustÑndigk.-Einh. Filter;
                                                              ENU=Sales Resp. Ctr. Filter] }
    { 5701;   ;Purchase Resp. Ctr. Filter;Code10  ;TableRelation="Responsibility Center";
                                                   CaptionML=[DEU=Eink.-ZustÑndigk.-Einh. Filter;
                                                              ENU=Purchase Resp. Ctr. Filter] }
    { 5900;   ;Service Resp. Ctr. Filter;Code10   ;TableRelation="Responsibility Center";
                                                   CaptionML=[DEU=Serv.-ZustÑndigk.-Einh. Filter;
                                                              ENU=Service Resp. Ctr. Filter] }
    { 56780;  ;Use active TAPI     ;Boolean       ;OnValidate=BEGIN
                                                                // AT01 BEGIN
                                                                IF "Use active TAPI" THEN BEGIN
                                                                  IF TAPIUser.GET("User ID") THEN BEGIN
                                                                    TAPIUser.Blocked := FALSE;
                                                                    TAPIUser.MODIFY;
                                                                  END;
                                                                END ELSE BEGIN
                                                                  IF TAPIUser.GET("User ID") THEN BEGIN
                                                                    TAPIUser.Blocked := TRUE;
                                                                    TAPIUser.MODIFY;
                                                                  END;
                                                                END;
                                                                // AT01 END
                                                              END;

                                                   CaptionML=DEU=Active TAPI benutzen }
    { 56781;  ;See TAPI Logfile completely;Boolean;CaptionML=DEU=TAPI Logbuch komplett ansehen }
  }
  KEYS
  {
    {    ;User ID                                 ;Clustered=Yes }
    {    ;Salespers./Purch. Code                   }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text001@1000 : TextConst 'DEU=Der VerkÑufer-/EinkÑufercode ''%1'' ist bereits einer anderen Benutzer-ID ''%2'' zugewiesen.;ENU=The %1 Salesperson/Purchaser code is already assigned to another User ID %2.';
      Text003@1002 : TextConst 'DEU="%1 und %2 kînnen nicht zugleich vorhanden sein. ";ENU="You cannot have both a %1 and %2. "';
      Text005@1004 : TextConst 'DEU=Die Genehmigungsgrenzwerte kînnen nicht kleiner als Null sein.;ENU=You cannot have approval limits less than zero.';
      "***** activeTAPI *****"@1000000001 : Integer;
      TAPIUser@1000000000 : Record 56783;

    BEGIN
    {
      AT01 actTAPI 04.06.2003  New Fields: 56789 Use active TAPI Bool (Global activation of activeTAPI)
                               OnValidate-Trigger
                               Global Var TAPIUser Rec 56780
      AT2009       06.11.2009  New field: See TAPI Logfile completely
                               If not actice, every user sees only his own calls
    }
    END.
  }
}

OBJECT Table 5050 Contact
{
  OBJECT-PROPERTIES
  {
    Date=17.03.11;
    Time=19:12:21;
    Modified=Yes;
    Version List=NAVW16.00.10,AT2009;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Name;
    OnInsert=BEGIN
               RMSetup.GET;

               IF "No." = '' THEN BEGIN
                 RMSetup.TESTFIELD("Contact Nos.");
                 NoSeriesMgt.InitSeries(RMSetup."Contact Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;

               IF NOT SkipDefaults THEN BEGIN
                 IF "Salesperson Code" = '' THEN
                   "Salesperson Code" := RMSetup."Default Salesperson Code";
                 IF "Territory Code" = '' THEN
                   "Territory Code" := RMSetup."Default Territory Code";
                 IF "Country/Region Code" = '' THEN
                   "Country/Region Code" := RMSetup."Default Country/Region Code";
                 IF "Language Code" = '' THEN
                   "Language Code" := RMSetup."Default Language Code";
                 IF "Correspondence Type" = "Correspondence Type"::" " THEN
                   "Correspondence Type" := RMSetup."Default Correspondence Type";
                 IF "Salutation Code" = '' THEN
                   IF Type = Type::Company THEN
                     "Salutation Code" := RMSetup."Def. Company Salutation Code"
                   ELSE
                     "Salutation Code" := RMSetup."Default Person Salutation Code";
               END;

               TypeChange;


               "Last Date Modified" := TODAY;
               "Last Time Modified" := TIME;
             END;

    OnModify=BEGIN
               OnModify(xRec);
             END;

    OnDelete=VAR
               Todo@1000 : Record 5080;
               SegLine@1001 : Record 5077;
               ContIndustGrp@1002 : Record 5058;
               ContactWebSource@1003 : Record 5060;
               ContJobResp@1004 : Record 5067;
               ContMailingGrp@1005 : Record 5056;
               ContProfileAnswer@1006 : Record 5089;
               RMCommentLine@1007 : Record 5061;
               ContAltAddr@1008 : Record 5051;
               ContAltAddrDateRange@1009 : Record 5052;
               InteractLogEntry@1010 : Record 5065;
               Opp@1011 : Record 5092;
               CreditCards@1017 : Record 827;
               CampaignTargetGrMgt@1016 : Codeunit 7030;
             BEGIN
               CreditCards.DeleteByContact(Rec);

               Todo.SETCURRENTKEY("Contact Company No.","Contact No.",Closed,Date);
               Todo.SETRANGE("Contact Company No.","Company No.");
               Todo.SETRANGE("Contact No.","No.");
               Todo.SETRANGE(Closed,FALSE);
               IF Todo.FIND('-') THEN
                 ERROR(Text000,TABLECAPTION,"No.");

               SegLine.SETCURRENTKEY("Contact No.");
               SegLine.SETRANGE("Contact No.","No.");
               IF SegLine.FIND('-') THEN
                 ERROR(Text001,TABLECAPTION,"No.");

               Opp.SETCURRENTKEY("Contact Company No.","Contact No.");
               Opp.SETRANGE("Contact Company No.","Company No.");
               Opp.SETRANGE("Contact No.","No.");
               Opp.SETRANGE(Status,Opp.Status::"Not Started",Opp.Status::"In Progress");
               IF Opp.FIND('-') THEN
                 ERROR(Text002,TABLECAPTION,"No.");

               CASE Type OF
                 Type::Company: BEGIN
                   ContBusRel.SETRANGE("Contact No.","No.");
                   ContBusRel.DELETEALL;
                   ContIndustGrp.SETRANGE("Contact No.","No.");
                   ContIndustGrp.DELETEALL;
                   ContactWebSource.SETRANGE("Contact No.","No.");
                   ContactWebSource.DELETEALL;
                   DuplMgt.RemoveContIndex(Rec,FALSE);
                   InteractLogEntry.SETCURRENTKEY("Contact Company No.");
                   InteractLogEntry.SETRANGE("Contact Company No.", "No.");
                   IF InteractLogEntry.FIND('-') THEN
                     REPEAT
                       CampaignTargetGrMgt.DeleteContfromTargetGr(InteractLogEntry);
                       CLEAR(InteractLogEntry."Contact Company No.");
                       CLEAR(InteractLogEntry."Contact No.");
                       InteractLogEntry.MODIFY;
                     UNTIL InteractLogEntry.NEXT = 0;

                   Cont.RESET;
                   Cont.SETCURRENTKEY("Company No.");
                   Cont.SETRANGE("Company No.","No.");
                   Cont.SETRANGE(Type,Type::Person);
                   IF Cont.FIND('-') THEN
                     REPEAT
                       RecRef.GETTABLE(Cont);
                       Cont.DELETE(TRUE);
                       ChangeLogMgt.LogDeletion(RecRef);
                     UNTIL Cont.NEXT = 0;

                   Opp.RESET;
                   Opp.SETCURRENTKEY("Contact Company No.","Contact No.");
                   Opp.SETRANGE("Contact Company No.","Company No.");
                   Opp.SETRANGE("Contact No.","No.");
                   IF Opp.FIND('-') THEN
                     REPEAT
                       CLEAR(Opp."Contact No.");
                       CLEAR(Opp."Contact Company No.");
                       Opp.MODIFY;
                     UNTIL Opp.NEXT = 0;

                   Todo.RESET;
                   Todo.SETCURRENTKEY("Contact Company No.");
                   Todo.SETRANGE("Contact Company No.","Company No.");
                   IF Todo.FIND('-') THEN
                     REPEAT
                       CLEAR(Todo."Contact No.");
                       CLEAR(Todo."Contact Company No.");
                       Todo.MODIFY;
                     UNTIL Todo.NEXT = 0;
                   SearchWordDetail.RESET;
                   SearchWordDetail.SETCURRENTKEY("No.","Sub No.","Table Name");
                   SearchWordDetail.SETRANGE("No.","No.");
                   SearchWordDetail.SETFILTER(
                     "Table Name",'%1|%2|%3',
                     SearchWordDetail."Table Name"::"Interaction Log Entry",
                     SearchWordDetail."Table Name"::"To-do",
                     SearchWordDetail."Table Name"::Opportunity);
                   IF SearchWordDetail.FIND('-') THEN BEGIN
                     REPEAT
                       SearchWordDetail.RENAME(
                         SearchWordDetail."Search Word Entry No.",
                         '',
                         SearchWordDetail."Sub No.",
                         SearchWordDetail."Table Name",
                         SearchWordDetail."Field No.",
                         SearchWordDetail."Word Position");
                     UNTIL SearchWordDetail.NEXT = 0;
                   END;
                 END;

                 Type::Person: BEGIN
                   ContJobResp.SETRANGE("Contact No.", "No.");
                   ContJobResp.DELETEALL;

                   InteractLogEntry.SETCURRENTKEY("Contact Company No.","Contact No.");
                   InteractLogEntry.SETRANGE("Contact Company No.","Company No.");
                   InteractLogEntry.SETRANGE("Contact No.","No.");
                   InteractLogEntry.MODIFYALL("Contact No.","Company No.");

                   Opp.RESET;
                   Opp.SETCURRENTKEY("Contact Company No.","Contact No.");
                   Opp.SETRANGE("Contact Company No.","Company No.");
                   Opp.SETRANGE("Contact No.","No.");
                   Opp.MODIFYALL("Contact No.","Company No.");

                   Todo.RESET;
                   Todo.SETCURRENTKEY("Contact Company No.","Contact No.");
                   Todo.SETRANGE("Contact Company No.","Company No.");
                   Todo.SETRANGE("Contact No.","No.");
                   Todo.MODIFYALL("Contact No.","Company No.");
                   SearchWordDetail.RESET;
                   SearchWordDetail.SETCURRENTKEY("No.","Sub No.","Table Name");
                   SearchWordDetail.SETRANGE("No.","No.");
                   SearchWordDetail.SETFILTER(
                     "Table Name",'%1|%2|%3',
                     SearchWordDetail."Table Name"::"Interaction Log Entry",
                     SearchWordDetail."Table Name"::"To-do",
                     SearchWordDetail."Table Name"::Opportunity);
                   IF SearchWordDetail.FIND('-') THEN BEGIN
                     REPEAT
                       SearchWordDetail.RENAME(
                         SearchWordDetail."Search Word Entry No.",
                         "Company No.",
                         SearchWordDetail."Sub No.",
                         SearchWordDetail."Table Name",
                         SearchWordDetail."Field No.",
                         SearchWordDetail."Word Position");
                     UNTIL SearchWordDetail.NEXT = 0;
                   END;
                 END;
               END;

               ContMailingGrp.SETRANGE("Contact No.","No.");
               ContMailingGrp.DELETEALL;

               ContProfileAnswer.SETRANGE("Contact No.","No.");
               ContProfileAnswer.DELETEALL;

               RMCommentLine.SETRANGE("Table Name",RMCommentLine."Table Name"::Contact);
               RMCommentLine.SETRANGE("No.","No.");
               RMCommentLine.SETRANGE("Sub No.",0);
               IF RMCommentLine.FIND('-') THEN
                 REPEAT
                   SearchManagement.DeleteCommentDetails(
                     RMCommentLine."No.",
                     RMCommentLine."Line No.");
                 UNTIL RMCommentLine.NEXT = 0;
               RMCommentLine.DELETEALL;

               ContAltAddr.SETRANGE("Contact No.","No.");
               ContAltAddr.DELETEALL;

               ContAltAddrDateRange.SETRANGE("Contact No.","No.");
               ContAltAddrDateRange.DELETEALL;
               SearchManagement.DeleteContactDetails("No.");

               // AT01 BEGIN
               TAPIFu.DeletePhoneIndex(5050, "No.", '', 0);
               // AT01 END
             END;

    OnRename=VAR
               SearchWordDetail2@1005 : Record 5118;
             BEGIN
               VALIDATE("Lookup Contact No.");

               SearchWordDetail.RESET;
               SearchWordDetail.SETRANGE("No.",xRec."No.");
               IF SearchWordDetail.FINDSET(TRUE,TRUE) THEN
                 REPEAT
                   SearchWordDetail2 := SearchWordDetail;
                   SearchWordDetail2.RENAME(
                     SearchWordDetail."Search Word Entry No.",
                     "No.",
                     SearchWordDetail."Sub No.",
                     SearchWordDetail."Table Name",
                     SearchWordDetail."Field No.",
                     SearchWordDetail."Word Position");
                 UNTIL SearchWordDetail.NEXT = 0;
             END;

    CaptionML=[DEU=Kontakt;
               ENU=Contact];
    LookupFormID=Form5052;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;AltSearchField=Search Name;
                                                   OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  RMSetup.GET;
                                                                  NoSeriesMgt.TestManual(RMSetup."Contact Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[DEU=Nr.;
                                                              ENU=No.] }
    { 2   ;   ;Name                ;Text50        ;OnValidate=BEGIN
                                                                NameBreakdown;
                                                                ProcessNameChange;

                                                                // AT01.20 BEGIN
                                                                IF Name <> xRec.Name THEN
                                                                  TAPIFu.PhoneIndexContAtt(Rec);
                                                                // AT01.20 END
                                                              END;

                                                   CaptionML=[DEU=Name;
                                                              ENU=Name] }
    { 3   ;   ;Search Name         ;Code50        ;CaptionML=[DEU=Suchbegriff;
                                                              ENU=Search Name] }
    { 4   ;   ;Name 2              ;Text50        ;CaptionML=[DEU=Name 2;
                                                              ENU=Name 2] }
    { 5   ;   ;Address             ;Text50        ;CaptionML=[DEU=Adresse;
                                                              ENU=Address] }
    { 6   ;   ;Address 2           ;Text50        ;CaptionML=[DEU=Adresse 2;
                                                              ENU=Address 2] }
    { 7   ;   ;City                ;Text30        ;OnValidate=BEGIN
                                                                PostCode.ValidateCity(City,"Post Code");
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookUpCity(City,"Post Code",TRUE);
                                                            END;

                                                   CaptionML=[DEU=Ort;
                                                              ENU=City] }
    { 9   ;   ;Phone No.           ;Text30        ;OnValidate=BEGIN
                                                                // AT01 BEGIN
                                                                TAPIFu.PhoneIndexContAtt(Rec);
                                                                // AT01 END
                                                                // AT01.20 BEGIN
                                                                TAPISetup.GET;
                                                                IF TAPISetup."Format Phone Numbers" THEN
                                                                // AT2009 CHANGED
                                                                  "Phone No." := TAPIFuSi.ConvToCanonic("Phone No.");
                                                                // AT2009 END
                                                                // AT01.20 END
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[DEU=Telefonnr.;
                                                              ENU=Phone No.] }
    { 10  ;   ;Telex No.           ;Text20        ;CaptionML=[DEU=Telexnr.;
                                                              ENU=Telex No.] }
    { 15  ;   ;Territory Code      ;Code10        ;TableRelation=Territory;
                                                   CaptionML=[DEU=Gebietscode;
                                                              ENU=Territory Code] }
    { 22  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   CaptionML=[DEU=WÑhrungscode;
                                                              ENU=Currency Code] }
    { 24  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   CaptionML=[DEU=Sprachcode;
                                                              ENU=Language Code] }
    { 29  ;   ;Salesperson Code    ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[DEU=VerkÑufercode;
                                                              ENU=Salesperson Code] }
    { 35  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[DEU=LÑnder-/Regionscode;
                                                              ENU=Country/Region Code] }
    { 38  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Rlshp. Mgt. Comment Line" WHERE (Table Name=CONST(Contact),
                                                                                                       No.=FIELD(No.),
                                                                                                       Sub No.=CONST(0)));
                                                   CaptionML=[DEU=Bemerkung;
                                                              ENU=Comment];
                                                   Editable=No }
    { 54  ;   ;Last Date Modified  ;Date          ;CaptionML=[DEU=Korrigiert am;
                                                              ENU=Last Date Modified];
                                                   Editable=No }
    { 84  ;   ;Fax No.             ;Text30        ;OnValidate=BEGIN
                                                                // AT 04.00 BEGIN
                                                                TAPISetup.GET;
                                                                IF TAPISetup."Format Fax Numbers" THEN
                                                                // AT2009 CHANGED
                                                                  "Fax No." := TAPIFuSi.ConvToCanonic("Fax No.");
                                                                // AT2009 END
                                                                // AT04.00 END
                                                              END;

                                                   CaptionML=[DEU=Faxnr.;
                                                              ENU=Fax No.] }
    { 85  ;   ;Telex Answer Back   ;Text20        ;CaptionML=[DEU=Telex Namengeber;
                                                              ENU=Telex Answer Back] }
    { 86  ;   ;VAT Registration No.;Text20        ;OnValidate=VAR
                                                                VATRegNoFormat@1000 : Record 381;
                                                              BEGIN
                                                                VATRegNoFormat.Test("VAT Registration No.","Country/Region Code","No.",DATABASE::Contact);
                                                              END;

                                                   CaptionML=[DEU=USt-IdNr.;
                                                              ENU=VAT Registration No.] }
    { 89  ;   ;Picture             ;BLOB          ;CaptionML=[DEU=Bild;
                                                              ENU=Picture];
                                                   SubType=Bitmap }
    { 91  ;   ;Post Code           ;Code20        ;TableRelation="Post Code";
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code");
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookUpPostCode(City,"Post Code",TRUE);
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DEU=PLZ-Code;
                                                              ENU=Post Code] }
    { 92  ;   ;County              ;Text30        ;CaptionML=[DEU=Bundesregion;
                                                              ENU=County] }
    { 102 ;   ;E-Mail              ;Text80        ;OnValidate=BEGIN
                                                                IF ("Search E-Mail" = UPPERCASE(xRec."E-Mail")) OR ("Search E-Mail" = '') THEN
                                                                  "Search E-Mail" := "E-Mail";
                                                              END;

                                                   ExtendedDatatype=E-Mail;
                                                   CaptionML=[DEU=E-Mail;
                                                              ENU=E-Mail] }
    { 103 ;   ;Home Page           ;Text80        ;ExtendedDatatype=URL;
                                                   CaptionML=[DEU=Homepage;
                                                              ENU=Home Page] }
    { 107 ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[DEU=Nummernserie;
                                                              ENU=No. Series] }
    { 5050;   ;Type                ;Option        ;OnValidate=BEGIN
                                                                IF CurrFieldNo <> 0 THEN BEGIN
                                                                  TypeChange;
                                                                  MODIFY;
                                                                END;
                                                              END;

                                                   CaptionML=[DEU=Art;
                                                              ENU=Type];
                                                   OptionCaptionML=[DEU=Unternehmen,Person;
                                                                    ENU=Company,Person];
                                                   OptionString=Company,Person }
    { 5051;   ;Company No.         ;Code20        ;TableRelation=Contact WHERE (Type=CONST(Company));
                                                   OnValidate=VAR
                                                                Opp@1000 : Record 5092;
                                                                OppEntry@1001 : Record 5093;
                                                                Todo@1002 : Record 5080;
                                                                InteractLogEntry@1003 : Record 5065;
                                                                SegLine@1005 : Record 5077;
                                                                SalesHeader@1004 : Record 36;
                                                                ChangeLogMgt@1006 : Codeunit 423;
                                                                RecRef@1007 : RecordRef;
                                                                xRecRef@1008 : RecordRef;
                                                              BEGIN
                                                                IF "Company No." = xRec."Company No." THEN
                                                                  EXIT;

                                                                xRecRef.GETTABLE(Rec);

                                                                TESTFIELD(Type,Type::Person);

                                                                SegLine.SETCURRENTKEY("Contact No.");
                                                                SegLine.SETRANGE("Contact No.","No.");
                                                                IF SegLine.FIND('-') THEN
                                                                  ERROR(Text012,FIELDCAPTION("Company No."));

                                                                IF Cont.GET("Company No.") THEN
                                                                  InheritCompanyToPersonData(Cont,xRec."Company No." = '')
                                                                ELSE
                                                                  CLEAR("Company Name");

                                                                IF Cont.GET("No.") THEN BEGIN
                                                                  IF xRec."Company No." <> '' THEN BEGIN
                                                                    Opp.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    Opp.SETRANGE("Contact Company No.",xRec."Company No.");
                                                                    Opp.SETRANGE("Contact No.","No.");
                                                                    Opp.MODIFYALL("Contact No.",xRec."Company No.");
                                                                    OppEntry.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    OppEntry.SETRANGE("Contact Company No.",xRec."Company No.");
                                                                    OppEntry.SETRANGE("Contact No.","No.");
                                                                    OppEntry.MODIFYALL("Contact No.",xRec."Company No.");
                                                                    Todo.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    Todo.SETRANGE("Contact Company No.",xRec."Company No.");
                                                                    Todo.SETRANGE("Contact No.","No.");
                                                                    Todo.MODIFYALL("Contact No.",xRec."Company No.");
                                                                    InteractLogEntry.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    InteractLogEntry.SETRANGE("Contact Company No.",xRec."Company No.");
                                                                    InteractLogEntry.SETRANGE("Contact No.","No.");
                                                                    InteractLogEntry.MODIFYALL("Contact No.",xRec."Company No.");
                                                                    ContBusRel.RESET;
                                                                    ContBusRel.SETCURRENTKEY("Link to Table","No.");
                                                                    ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
                                                                    ContBusRel.SETRANGE("Contact No.",xRec."Company No.");
                                                                    SalesHeader.SETCURRENTKEY("Sell-to Customer No.","External Document No.");
                                                                    SalesHeader.SETRANGE("Sell-to Contact No.","No.");
                                                                    IF ContBusRel.FIND('-') THEN
                                                                      SalesHeader.SETRANGE("Sell-to Customer No.",ContBusRel."No.")
                                                                    ELSE
                                                                      SalesHeader.SETRANGE("Sell-to Customer No.",'');
                                                                    IF SalesHeader.FIND('-') THEN
                                                                      REPEAT
                                                                        SalesHeader."Sell-to Contact No." := xRec."Company No.";
                                                                        IF SalesHeader."Sell-to Contact No." = SalesHeader."Bill-to Contact No." THEN
                                                                          SalesHeader."Bill-to Contact No." := xRec."Company No.";
                                                                        SalesHeader.MODIFY;
                                                                      UNTIL SalesHeader.NEXT = 0;
                                                                    SalesHeader.RESET;
                                                                    SalesHeader.SETCURRENTKEY("Bill-to Contact No.");
                                                                    SalesHeader.SETRANGE("Bill-to Contact No.","No.");
                                                                    SalesHeader.MODIFYALL("Bill-to Contact No.",xRec."Company No.");
                                                                  END ELSE BEGIN
                                                                    Opp.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    Opp.SETRANGE("Contact Company No.",'');
                                                                    Opp.SETRANGE("Contact No.","No.");
                                                                    Opp.MODIFYALL("Contact Company No.","Company No.");
                                                                    OppEntry.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    OppEntry.SETRANGE("Contact Company No.",'');
                                                                    OppEntry.SETRANGE("Contact No.","No.");
                                                                    OppEntry.MODIFYALL("Contact Company No.","Company No.");
                                                                    Todo.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    Todo.SETRANGE("Contact Company No.",'');
                                                                    Todo.SETRANGE("Contact No.","No.");
                                                                    Todo.MODIFYALL("Contact Company No.","Company No.");
                                                                    InteractLogEntry.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    InteractLogEntry.SETRANGE("Contact Company No.",'');
                                                                    InteractLogEntry.SETRANGE("Contact No.","No.");
                                                                    InteractLogEntry.MODIFYALL("Contact Company No.","Company No.");
                                                                  END;
                                                                  IF CurrFieldNo <> 0 THEN BEGIN
                                                                    MODIFY;
                                                                    RecRef.GETTABLE(Rec);
                                                                    ChangeLogMgt.LogModification(RecRef,xRecRef);
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[DEU=Unternehmensnr.;
                                                              ENU=Company No.] }
    { 5052;   ;Company Name        ;Text50        ;CaptionML=[DEU=Unternehmensname;
                                                              ENU=Company Name];
                                                   Editable=No }
    { 5053;   ;Lookup Contact No.  ;Code20        ;TableRelation=Contact;
                                                   OnValidate=BEGIN
                                                                IF Type = Type::Company THEN
                                                                  "Lookup Contact No." := ''
                                                                ELSE
                                                                  "Lookup Contact No." := "No.";
                                                              END;

                                                   CaptionML=[DEU=Look-up Kontaktnr.;
                                                              ENU=Lookup Contact No.];
                                                   Editable=No }
    { 5054;   ;First Name          ;Text30        ;OnValidate=BEGIN
                                                                Name := CalculatedName;
                                                                ProcessNameChange;
                                                              END;

                                                   CaptionML=[DEU=Vorname;
                                                              ENU=First Name] }
    { 5055;   ;Middle Name         ;Text30        ;OnValidate=BEGIN
                                                                Name := CalculatedName;
                                                                ProcessNameChange;
                                                              END;

                                                   CaptionML=[DEU=Vorname 2;
                                                              ENU=Middle Name] }
    { 5056;   ;Surname             ;Text30        ;OnValidate=BEGIN
                                                                Name := CalculatedName;
                                                                ProcessNameChange;
                                                              END;

                                                   CaptionML=[DEU=Nachname;
                                                              ENU=Surname] }
    { 5058;   ;Job Title           ;Text30        ;CaptionML=[DEU=Titel;
                                                              ENU=Job Title] }
    { 5059;   ;Initials            ;Text30        ;CaptionML=[DEU=Initialen;
                                                              ENU=Initials] }
    { 5060;   ;Extension No.       ;Text30        ;CaptionML=[DEU=Durchwahl;
                                                              ENU=Extension No.] }
    { 5061;   ;Mobile Phone No.    ;Text30        ;OnValidate=BEGIN
                                                                // AT01 BEGIN
                                                                TAPIFu.PhoneIndexContAtt(Rec);
                                                                // AT01 END
                                                                // AT01.20 BEGIN
                                                                TAPISetup.GET;
                                                                IF TAPISetup."Format Phone Numbers" THEN
                                                                // AT2009 CHANGED
                                                                  "Mobile Phone No." := TAPIFuSi.ConvToCanonic("Mobile Phone No.");
                                                                // AT2009 END
                                                                // AT01.20 END
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[DEU=Mobiltelefonnr.;
                                                              ENU=Mobile Phone No.] }
    { 5062;   ;Pager               ;Text30        ;CaptionML=[DEU=Pager;
                                                              ENU=Pager] }
    { 5063;   ;Organizational Level Code;Code10   ;TableRelation="Organizational Level";
                                                   CaptionML=[DEU=Positionscode;
                                                              ENU=Organizational Level Code] }
    { 5064;   ;Exclude from Segment;Boolean       ;CaptionML=[DEU=Nicht segmentieren;
                                                              ENU=Exclude from Segment] }
    { 5065;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=Datumsfilter;
                                                              ENU=Date Filter] }
    { 5066;   ;Next To-do Date     ;Date          ;FieldClass=FlowField;
                                                   CalcFormula=Min(To-do.Date WHERE (Contact Company No.=FIELD(Company No.),
                                                                                     Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                     Closed=CONST(No),
                                                                                     System To-do Type=CONST(Contact Attendee)));
                                                   CaptionML=[DEU=NÑchste Aufgabe am;
                                                              ENU=Next To-do Date];
                                                   Editable=No }
    { 5067;   ;Last Date Attempted ;Date          ;FieldClass=FlowField;
                                                   CalcFormula=Max("Interaction Log Entry".Date WHERE (Contact Company No.=FIELD(Company No.),
                                                                                                       Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                       Initiated By=CONST(Us),
                                                                                                       Postponed=CONST(No)));
                                                   CaptionML=[DEU=Letzte Kontaktaufnahme am;
                                                              ENU=Last Date Attempted];
                                                   Editable=No }
    { 5068;   ;Date of Last Interaction;Date      ;FieldClass=FlowField;
                                                   CalcFormula=Max("Interaction Log Entry".Date WHERE (Contact Company No.=FIELD(Company No.),
                                                                                                       Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                       Attempt Failed=CONST(No),
                                                                                                       Postponed=CONST(No)));
                                                   CaptionML=[DEU=Letzte AktivitÑt am;
                                                              ENU=Date of Last Interaction];
                                                   Editable=No }
    { 5069;   ;No. of Job Responsibilities;Integer;FieldClass=FlowField;
                                                   CalcFormula=Count("Contact Job Responsibility" WHERE (Contact No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Verantwortlichkeiten;
                                                              ENU=No. of Job Responsibilities];
                                                   Editable=No }
    { 5070;   ;No. of Industry Groups;Integer     ;FieldClass=FlowField;
                                                   CalcFormula=Count("Contact Industry Group" WHERE (Contact No.=FIELD(Company No.)));
                                                   CaptionML=[DEU=Anzahl Branchen;
                                                              ENU=No. of Industry Groups];
                                                   Editable=No }
    { 5071;   ;No. of Business Relations;Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Count("Contact Business Relation" WHERE (Contact No.=FIELD(Company No.)));
                                                   CaptionML=[DEU=Anzahl GeschÑftsbeziehungen;
                                                              ENU=No. of Business Relations];
                                                   Editable=No }
    { 5072;   ;No. of Mailing Groups;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Contact Mailing Group" WHERE (Contact No.=FIELD(No.)));
                                                   CaptionML=[DEU=Anzahl Verteiler;
                                                              ENU=No. of Mailing Groups];
                                                   Editable=No }
    { 5073;   ;External ID         ;Code20        ;CaptionML=[DEU=Externe ID;
                                                              ENU=External ID] }
    { 5074;   ;No. of Interactions ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Interaction Log Entry" WHERE (Contact Company No.=FIELD(Company No.),
                                                                                                    Canceled=CONST(No),
                                                                                                    Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                    Date=FIELD(Date Filter),
                                                                                                    Postponed=CONST(No)));
                                                   CaptionML=[DEU=Anzahl AktivitÑten;
                                                              ENU=No. of Interactions];
                                                   Editable=No }
    { 5076;   ;Cost (LCY)          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Interaction Log Entry"."Cost (LCY)" WHERE (Contact Company No.=FIELD(Company No.),
                                                                                                               Canceled=CONST(No),
                                                                                                               Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                               Date=FIELD(Date Filter),
                                                                                                               Postponed=CONST(No)));
                                                   CaptionML=[DEU=Einstandsbetrag (MW);
                                                              ENU=Cost (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5077;   ;Duration (Min.)     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Interaction Log Entry"."Duration (Min.)" WHERE (Contact Company No.=FIELD(Company No.),
                                                                                                                    Canceled=CONST(No),
                                                                                                                    Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                                    Date=FIELD(Date Filter),
                                                                                                                    Postponed=CONST(No)));
                                                   CaptionML=[DEU=Dauer (Min.);
                                                              ENU=Duration (Min.)];
                                                   DecimalPlaces=0:0;
                                                   Editable=No }
    { 5078;   ;No. of Opportunities;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Opportunity Entry" WHERE (Active=CONST(Yes),
                                                                                                Contact Company No.=FIELD(Company No.),
                                                                                                Estimated Close Date=FIELD(Date Filter),
                                                                                                Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                Action Taken=FIELD(Action Taken Filter)));
                                                   CaptionML=[DEU=Anzahl Verkaufschancen;
                                                              ENU=No. of Opportunities];
                                                   Editable=No }
    { 5079;   ;Estimated Value (LCY);Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Opportunity Entry"."Estimated Value (LCY)" WHERE (Active=CONST(Yes),
                                                                                                                      Contact Company No.=FIELD(Company No.),
                                                                                                                      Estimated Close Date=FIELD(Date Filter),
                                                                                                                      Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                                      Action Taken=FIELD(Action Taken Filter)));
                                                   CaptionML=[DEU=Erwarteter Wert (MW);
                                                              ENU=Estimated Value (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5080;   ;Calcd. Current Value (LCY);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Opportunity Entry"."Calcd. Current Value (LCY)" WHERE (Active=CONST(Yes),
                                                                                                                           Contact Company No.=FIELD(Company No.),
                                                                                                                           Estimated Close Date=FIELD(Date Filter),
                                                                                                                           Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                                           Action Taken=FIELD(Action Taken Filter)));
                                                   CaptionML=[DEU=Berech. aktueller Wert (MW);
                                                              ENU=Calcd. Current Value (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5082;   ;Opportunity Entry Exists;Boolean   ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Opportunity Entry" WHERE (Active=CONST(Yes),
                                                                                                Contact Company No.=FIELD(Company No.),
                                                                                                Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                Sales Cycle Code=FIELD(Sales Cycle Filter),
                                                                                                Sales Cycle Stage=FIELD(Sales Cycle Stage Filter),
                                                                                                Salesperson Code=FIELD(Salesperson Filter),
                                                                                                Campaign No.=FIELD(Campaign Filter),
                                                                                                Action Taken=FIELD(Action Taken Filter),
                                                                                                Estimated Value (LCY)=FIELD(Estimated Value Filter),
                                                                                                Calcd. Current Value (LCY)=FIELD(Calcd. Current Value Filter),
                                                                                                Completed %=FIELD(Completed % Filter),
                                                                                                Chances of Success %=FIELD(Chances of Success % Filter),
                                                                                                Probability %=FIELD(Probability % Filter),
                                                                                                Estimated Close Date=FIELD(Date Filter),
                                                                                                Close Opportunity Code=FIELD(Close Opportunity Filter)));
                                                   CaptionML=[DEU=Verkaufschancenposten vorh.;
                                                              ENU=Opportunity Entry Exists];
                                                   Editable=No }
    { 5083;   ;To-do Entry Exists  ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist(To-do WHERE (Contact Company No.=FIELD(Company No.),
                                                                                  Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                  Team Code=FIELD(Team Filter),
                                                                                  Salesperson Code=FIELD(Salesperson Filter),
                                                                                  Campaign No.=FIELD(Campaign Filter),
                                                                                  Date=FIELD(Date Filter),
                                                                                  Status=FIELD(To-do Status Filter),
                                                                                  Priority=FIELD(Priority Filter),
                                                                                  Closed=FIELD(To-do Closed Filter)));
                                                   CaptionML=[DEU=Aufgabenposten vorhanden;
                                                              ENU=To-do Entry Exists];
                                                   Editable=No }
    { 5084;   ;Salesperson Filter  ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[DEU=VerkÑuferfilter;
                                                              ENU=Salesperson Filter] }
    { 5085;   ;Campaign Filter     ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Campaign;
                                                   CaptionML=[DEU=Kampagnenfilter;
                                                              ENU=Campaign Filter] }
    { 5087;   ;Action Taken Filter ;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=Kriterienaktionsfilter;
                                                              ENU=Action Taken Filter];
                                                   OptionCaptionML=[DEU=" ,NÑchster Schritt,Vorheriger Schritt,Aktualisiert,Schritt Åbersprungen,Gewonnen,Verloren";
                                                                    ENU=" ,Next,Previous,Updated,Jumped,Won,Lost"];
                                                   OptionString=[ ,Next,Previous,Updated,Jumped,Won,Lost] }
    { 5088;   ;Sales Cycle Filter  ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation="Sales Cycle";
                                                   CaptionML=[DEU=Verkaufsprozessfilter;
                                                              ENU=Sales Cycle Filter] }
    { 5089;   ;Sales Cycle Stage Filter;Integer   ;FieldClass=FlowFilter;
                                                   TableRelation="Sales Cycle Stage".Stage WHERE (Sales Cycle Code=FIELD(Sales Cycle Filter));
                                                   CaptionML=[DEU=Verkaufsprozess-Stufenfilter;
                                                              ENU=Sales Cycle Stage Filter] }
    { 5090;   ;Probability % Filter;Decimal       ;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=Wahrscheinlichkeit % Filter;
                                                              ENU=Probability % Filter];
                                                   DecimalPlaces=1:1;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 5091;   ;Completed % Filter  ;Decimal       ;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=Abgeschlossen % Filter;
                                                              ENU=Completed % Filter];
                                                   DecimalPlaces=1:1;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 5092;   ;Estimated Value Filter;Decimal     ;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=Erwarteter Wert Filter;
                                                              ENU=Estimated Value Filter];
                                                   AutoFormatType=1 }
    { 5093;   ;Calcd. Current Value Filter;Decimal;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=Berech. aktueller Wert Filter;
                                                              ENU=Calcd. Current Value Filter];
                                                   AutoFormatType=1 }
    { 5094;   ;Chances of Success % Filter;Decimal;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=Erfolgschancen % Filter;
                                                              ENU=Chances of Success % Filter];
                                                   DecimalPlaces=0:0;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 5095;   ;To-do Status Filter ;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=Aufgabenstatusfilter;
                                                              ENU=To-do Status Filter];
                                                   OptionCaptionML=[DEU=Nicht begonnen,In Bearbeitung,Erledigt,Warten,ZurÅckgestellt;
                                                                    ENU=Not Started,In Progress,Completed,Waiting,Postponed];
                                                   OptionString=Not Started,In Progress,Completed,Waiting,Postponed }
    { 5096;   ;To-do Closed Filter ;Boolean       ;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=Abgeschlossene Aufgaben Filter;
                                                              ENU=To-do Closed Filter] }
    { 5097;   ;Priority Filter     ;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=PrioritÑtenfilter;
                                                              ENU=Priority Filter];
                                                   OptionCaptionML=[DEU=Niedrig,Normal,Hoch;
                                                                    ENU=Low,Normal,High];
                                                   OptionString=Low,Normal,High }
    { 5098;   ;Team Filter         ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Team;
                                                   CaptionML=[DEU=Teamfilter;
                                                              ENU=Team Filter] }
    { 5099;   ;Close Opportunity Filter;Code10    ;FieldClass=FlowFilter;
                                                   TableRelation="Close Opportunity Code";
                                                   CaptionML=[DEU=Verkaufschancenabschlussfilter;
                                                              ENU=Close Opportunity Filter] }
    { 5100;   ;Correspondence Type ;Option        ;CaptionML=[DEU=Korrespondenzart;
                                                              ENU=Correspondence Type];
                                                   OptionCaptionML=[DEU=" ,Brief,E-Mail,Fax";
                                                                    ENU=" ,Hard Copy,E-Mail,Fax"];
                                                   OptionString=[ ,Hard Copy,E-Mail,Fax] }
    { 5101;   ;Salutation Code     ;Code10        ;TableRelation=Salutation;
                                                   CaptionML=[DEU=Anredecode;
                                                              ENU=Salutation Code] }
    { 5102;   ;Search E-Mail       ;Code80        ;CaptionML=[DEU=E-Mail-Suchbegriff;
                                                              ENU=Search E-Mail] }
    { 5104;   ;Last Time Modified  ;Time          ;CaptionML=[DEU=Korrigiert um;
                                                              ENU=Last Time Modified] }
    { 5105;   ;E-Mail 2            ;Text80        ;ExtendedDatatype=E-Mail;
                                                   CaptionML=[DEU=E-Mail 2;
                                                              ENU=E-Mail 2] }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Search Name                              }
    {    ;Company Name,Company No.,Type,Name       }
    {    ;Company No.                              }
    {    ;Territory Code                           }
    {    ;Salesperson Code                         }
    {    ;VAT Registration No.                     }
    {    ;Search E-Mail                            }
    {    ;Name                                    ;KeyGroups=SearchCol }
    {    ;City                                    ;KeyGroups=SearchCol }
    {    ;Post Code                               ;KeyGroups=SearchCol }
    {    ;Phone No.                               ;KeyGroups=SearchCol }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Name,Type,City,Post Code,Phone No.   }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'DEU=Sie kînnen %1 %2 nicht lîschen, da es eine oder mehrere offene Aufgaben gibt.;ENU=You cannot delete the %2 record of the %1 because there are one or more to-dos open.';
      Text001@1001 : TextConst 'DEU=Sie kînnen %1 %2 nicht lîschen, da der Kontakt einem oder mehreren unprotokollierten Segmenten zugeordnet ist.;ENU=You cannot delete the %2 record of the %1 because the contact is assigned one or more unlogged segments.';
      Text002@1002 : TextConst 'DEU=Sie kînnen %1 %2 nicht lîschen, da es eine oder mehrere Verkaufschancen gibt, die in Bearbeitung sind oder noch nicht begonnen wurden.;ENU=You cannot delete the %2 record of the %1 because one or more opportunities are in not started or progress.';
      Text003@1003 : TextConst 'DEU=%1 kann nicht geÑndert werden, da mindestens ein AktivitÑtenprotokollposten mit dem Kontakt verknÅpft ist.;ENU=%1 cannot be changed because one or more interaction log entries are linked to the contact.';
      Text005@1005 : TextConst 'DEU=%1 kann nicht geÑndert werden, da mindestens eine Aufgabe mit dem Kontakt verknÅpft ist.;ENU=%1 cannot be changed because one or more to-dos are linked to the contact.';
      Text006@1006 : TextConst 'DEU=%1 kann nicht geÑndert werden, da mindestens eine Verkaufschance mit dem Kontakt verknÅpft ist.;ENU=%1 cannot be changed because one or more opportunities are linked to the contact.';
      Text007@1007 : TextConst 'DEU=%1 kann nicht geÑndert werden, da es eine oder mehrere Personen gibt, die mit dem Kontakt verknÅpft sind.;ENU=%1 cannot be changed because there are one or more related people linked to the contact.';
      Text009@1009 : TextConst 'DEU=%1 %2 wurde erstellt.;ENU=The %2 record of the %1 has been created.';
      Text010@1010 : TextConst 'DEU=%1 %2 ist nicht mit einer anderen Tabelle verknÅpft.;ENU=The %2 record of the %1 is not linked with any other table.';
      RMSetup@1012 : Record 5079;
      Cont@1013 : Record 5050;
      ContBusRel@1014 : Record 5054;
      SearchWordDetail@1042 : Record 5118;
      PostCode@1011 : Record 225;
      RecRef@1004 : RecordRef;
      xRecRef@1024 : RecordRef;
      DuplMgt@1015 : Codeunit 5060;
      NoSeriesMgt@1016 : Codeunit 396;
      ChangeLogMgt@1031 : Codeunit 423;
      UpdateCustVendBank@1017 : Codeunit 5055;
      SearchManagement@1041 : Codeunit 5067;
      CampaignMgt@1050 : Codeunit 7030;
      ContChanged@1018 : Boolean;
      SkipDefaults@1019 : Boolean;
      Text012@1020 : TextConst 'DEU=Sie kînnen %1 nicht Ñndern, da diesem Kontakt mindestens ein unprotokolliertes Segment zugeordnet ist.;ENU=You cannot change %1 because one or more unlogged segments are assigned to the contact.';
      Text019@1022 : TextConst 'DEU=%1 %2 hat bereits die %3 mit %4 %5.;ENU=The %2 record of the %1 already has the %3 with %4 %5.';
      Text020@1021 : TextConst 'DEU=Mîchten Sie aus dem Kontakt %1 %2 einen Debitor unter Verwendung einer Debitorenvorlage erstellen?;ENU=Do you want to create a contact %1 %2 as a customer using a customer template?';
      Text021@1023 : TextConst 'DEU=Sie mÅssen formelle und informelle Anredeformeln in der Sprache %1 fÅr den Kontakt %2 einrichten.;ENU=You have to set up formal and informal salutation formulas in %1  language for the %2 contact.';
      HideValidationDialog@1032 : Boolean;
      Text022@1034 : TextConst 'DEU=Die Erstellung des Debitors wurde abgebrochen.;ENU=The creation of the customer has been aborted.';
      Text029@1045 : TextConst 'DEU=Die GesamtlÑnge von Vorname, zweitem Vornamen und Nachnamen ist %1 Zeichen lÑnger als die zulÑssige MaximallÑnge fÅr das Namensfeld.;ENU=The total length of first name, middle name and surname is %1 character(s)longer than the maximum length allowed for the Name field.';
      Text032@1048 : TextConst 'DEU=Die LÑnge von %1 ist um %2 Zeichen lÑnger als die maximal zulÑssige LÑnge des %1-Felds.;ENU=The length of %1 is %2 character(s)longer than the maximum length allowed for the %1 field.';
      Text033@1008 : TextConst 'DEU=Bevor Sie Online Map verwenden kînnen, mÅssen Sie die Felder des Fensters ''Online Map-Einrichtung'' ausfÅllen.\Informationen hierzu finden Sie in der Hilfe zum Einrichten von Online Map.;ENU=Before you can use Online Map, you must fill in the Online Map Setup window.\See Setting Up Online Map in Help.';
      "*** actTAPI ***"@1113900000 : Integer;
      TAPIFu@1113900001 : Codeunit 56780;
      TAPISetup@1113900002 : Record 56782;
      TAPIFuSi@1113900003 : Codeunit 56782;

    PROCEDURE OnModify@4(xRec@1005 : Record 5050);
    VAR
      OldCont@1001 : Record 5050;
    BEGIN
      "Last Date Modified" := TODAY;
      "Last Time Modified" := TIME;
      IF Name <> xRec.Name THEN
        SearchManagement.ParseField(
          "No.","No.",Name,SearchWordDetail."Table Name"::Contact,FIELDNO(Name));

      IF  "Company Name" <> xRec."Company Name" THEN
        SearchManagement.ParseField(
          "No.","No.","Company Name",SearchWordDetail."Table Name"::Contact,FIELDNO("Company Name"));

      IF  "Search Name" <> xRec."Search Name" THEN
        SearchManagement.ParseField(
          "No.","No.","Search Name",SearchWordDetail."Table Name"::Contact,FIELDNO("Search Name"));

      IF  "Name 2" <> xRec."Name 2" THEN
        SearchManagement.ParseField(
          "No.","No.","Name 2",SearchWordDetail."Table Name"::Contact,FIELDNO("Name 2"));

      IF  Address <> xRec.Address THEN
        SearchManagement.ParseField(
          "No.","No.",Address,SearchWordDetail."Table Name"::Contact,FIELDNO(Address));

      IF  "Address 2" <> xRec."Address 2" THEN
        SearchManagement.ParseField(
          "No.","No.","Address 2",SearchWordDetail."Table Name"::Contact,FIELDNO("Address 2"));

      IF  City <> xRec.City THEN
        SearchManagement.ParseField(
          "No.","No.",City,SearchWordDetail."Table Name"::Contact,FIELDNO(City));

      IF  "Phone No." <> xRec."Phone No." THEN
        SearchManagement.ParseField(
          "No.","No.","Phone No.",SearchWordDetail."Table Name"::Contact,FIELDNO("Phone No."));

      IF  "Telex No." <> xRec."Telex No." THEN
        SearchManagement.ParseField(
          "No.","No.","Telex No.",SearchWordDetail."Table Name"::Contact,FIELDNO("Telex No."));

      IF  "Fax No." <> xRec."Fax No." THEN
        SearchManagement.ParseField(
          "No.","No.","Fax No.",SearchWordDetail."Table Name"::Contact,FIELDNO("Fax No."));

      IF  Pager <> xRec.Pager THEN
        SearchManagement.ParseField(
          "No.","No.",Pager,SearchWordDetail."Table Name"::Contact,FIELDNO(Pager));

      IF  "Telex Answer Back" <> xRec."Telex Answer Back" THEN
        SearchManagement.ParseField(
          "No.","No.","Telex Answer Back",SearchWordDetail."Table Name"::Contact,FIELDNO("Telex Answer Back"));

      IF  "VAT Registration No." <> xRec."VAT Registration No." THEN
        SearchManagement.ParseField(
          "No.","No.","VAT Registration No.",SearchWordDetail."Table Name"::Contact,FIELDNO("VAT Registration No."));

      IF  "Post Code" <> xRec."Post Code" THEN
        SearchManagement.ParseField(
          "No.","No.","Post Code",SearchWordDetail."Table Name"::Contact,FIELDNO("Post Code"));

      IF  County <> xRec.County THEN
        SearchManagement.ParseField(
          "No.","No.",County,SearchWordDetail."Table Name"::Contact,FIELDNO(County));

      IF  "E-Mail" <> xRec."E-Mail" THEN
        SearchManagement.ParseField(
          "No.","No.","E-Mail",SearchWordDetail."Table Name"::Contact,FIELDNO("E-Mail"));

      IF  "Home Page" <> xRec."Home Page" THEN
        SearchManagement.ParseField(
          "No.","No.","Home Page",SearchWordDetail."Table Name"::Contact,FIELDNO("Home Page"));

      IF  "Mobile Phone No." <> xRec."Mobile Phone No." THEN
        SearchManagement.ParseField(
          "No.","No.","Mobile Phone No.",SearchWordDetail."Table Name"::Contact,FIELDNO("Mobile Phone No."));

      IF Type = Type::Company THEN BEGIN
        IF (Name <> xRec.Name) OR
           ("Search Name" <> xRec."Search Name") OR
           ("Name 2" <> xRec."Name 2") OR
           (Address <> xRec.Address) OR
           ("Address 2" <> xRec."Address 2") OR
           (City <> xRec.City) OR
           ("Phone No." <> xRec."Phone No.") OR
           ("Telex No." <> xRec."Telex No.") OR
           ("Territory Code" <> xRec."Territory Code") OR
           ("Currency Code" <> xRec."Currency Code") OR
           ("Language Code" <> xRec."Language Code") OR
           ("Salesperson Code" <> xRec."Salesperson Code") OR
           ("Country/Region Code" <> xRec."Country/Region Code") OR
           ("Fax No." <> xRec."Fax No.") OR
           ("Telex Answer Back" <> xRec."Telex Answer Back") OR
           ("VAT Registration No." <> xRec."VAT Registration No.") OR
           ("Post Code" <> xRec."Post Code") OR
           (County <> xRec.County) OR
           ("E-Mail" <> xRec."E-Mail") OR
           ("Home Page" <> xRec."Home Page")
        THEN
          UpdateCustVendBank.RUN(Rec);

        RMSetup.GET;
        Cont.RESET;
        Cont.SETCURRENTKEY("Company No.");
        Cont.SETRANGE("Company No.","No.");
        Cont.SETRANGE(Type,Type::Person);
        IF Cont.FIND('-') THEN
          REPEAT
            ContChanged := FALSE;
            OldCont := Cont;
            IF Name <> xRec.Name THEN BEGIN
              Cont."Company Name" := Name;
              ContChanged := TRUE;
            END;
            IF RMSetup."Inherit Salesperson Code" AND
               (xRec."Salesperson Code" <> "Salesperson Code") AND
               (xRec."Salesperson Code" = Cont."Salesperson Code")
            THEN BEGIN
              Cont."Salesperson Code" := "Salesperson Code";
              ContChanged := TRUE;
            END;
            IF RMSetup."Inherit Territory Code" AND
               (xRec."Territory Code" <> "Territory Code") AND
               (xRec."Territory Code" = Cont."Territory Code")
            THEN BEGIN
              Cont."Territory Code" := "Territory Code";
              ContChanged := TRUE;
            END;
            IF RMSetup."Inherit Country/Region Code" AND
               (xRec."Country/Region Code" <> "Country/Region Code") AND
               (xRec."Country/Region Code" = Cont."Country/Region Code")
            THEN BEGIN
              Cont."Country/Region Code" := "Country/Region Code";
              ContChanged := TRUE;
            END;
            IF RMSetup."Inherit Language Code" AND
               (xRec."Language Code" <> "Language Code") AND
               (xRec."Language Code" = Cont."Language Code")
            THEN BEGIN
              Cont."Language Code" := "Language Code";
              ContChanged := TRUE;
            END;
            IF RMSetup."Inherit Address Details" THEN BEGIN
              IF xRec.IdenticalAddress(Cont) THEN BEGIN
                IF xRec.Address <> Address THEN BEGIN
                  Cont.Address := Address;
                  ContChanged := TRUE;
                END;
                IF xRec."Address 2" <> "Address 2" THEN BEGIN
                  Cont."Address 2" := "Address 2";
                  ContChanged := TRUE;
                END;
                IF xRec."Post Code" <> "Post Code" THEN BEGIN
                  Cont."Post Code" := "Post Code";
                  ContChanged := TRUE;
                END;
                IF xRec.City <> City THEN BEGIN
                  Cont.City := City;
                  ContChanged := TRUE;
                END;
              END;
            END;
            IF RMSetup."Inherit Communication Details" THEN BEGIN
              IF (xRec."Phone No." <> "Phone No.") AND (xRec."Phone No." = Cont."Phone No.") THEN BEGIN
                Cont."Phone No." := "Phone No.";
                ContChanged := TRUE;
              END;
              IF (xRec."Telex No." <> "Telex No.") AND (xRec."Telex No." = Cont."Telex No.") THEN BEGIN
                Cont."Telex No." := "Telex No.";
                ContChanged := TRUE;
              END;
              IF (xRec."Fax No." <> "Fax No.") AND (xRec."Fax No." = Cont."Fax No.") THEN BEGIN
                Cont."Fax No." := "Fax No.";
                ContChanged := TRUE;
              END;
              IF (xRec."Telex Answer Back" <> "Telex Answer Back") AND (xRec."Telex Answer Back" = Cont."Telex Answer Back") THEN BEGIN
                Cont."Telex Answer Back" := "Telex Answer Back";
                ContChanged := TRUE;
              END;
              IF (xRec."E-Mail" <> "E-Mail") AND (xRec."E-Mail" = Cont."E-Mail") THEN BEGIN
                Cont.VALIDATE("E-Mail","E-Mail");
                ContChanged := TRUE;
              END;
              IF (xRec."Home Page" <> "Home Page") AND (xRec."Home Page" = Cont."Home Page") THEN BEGIN
                Cont."Home Page" := "Home Page";
                ContChanged := TRUE;
              END;
              IF (xRec."Extension No." <> "Extension No.") AND (xRec."Extension No." = Cont."Extension No.") THEN BEGIN
                Cont."Extension No." := "Extension No.";
                ContChanged := TRUE;
              END;
              IF (xRec."Mobile Phone No." <> "Mobile Phone No.") AND (xRec."Mobile Phone No." = Cont."Mobile Phone No.") THEN BEGIN
                Cont."Mobile Phone No." := "Mobile Phone No.";
                ContChanged := TRUE;
              END;
              IF (xRec.Pager <> Pager) AND (xRec.Pager = Cont.Pager) THEN BEGIN
                Cont.Pager := Pager;
                ContChanged := TRUE;
              END;
            END;
            IF ContChanged THEN BEGIN
              Cont.OnModify(OldCont);
              Cont.MODIFY;
              xRecRef.GETTABLE(OldCont);
              RecRef.GETTABLE(Cont);
              ChangeLogMgt.LogModification(RecRef,xRecRef);
            END;
          UNTIL Cont.NEXT = 0;

        IF (Name <> xRec.Name) OR
           ("Name 2" <> xRec."Name 2") OR
           (Address <> xRec.Address) OR
           ("Address 2" <> xRec."Address 2") OR
           (City <> xRec.City) OR
           ("Post Code" <> xRec."Post Code") OR
           ("VAT Registration No." <> xRec."VAT Registration No.") OR
           ("Phone No." <> xRec."Phone No.")
        THEN
          CheckDupl;
      END;
    END;

    PROCEDURE TypeChange@1();
    VAR
      InteractLogEntry@1000 : Record 5065;
      Opp@1001 : Record 5092;
      Todo@1002 : Record 5080;
      CampaignTargetGrMgt@1003 : Codeunit 7030;
    BEGIN
      RMSetup.GET;

      InteractLogEntry.LOCKTABLE;
      Todo.LOCKTABLE;
      Opp.LOCKTABLE;
      Cont.LOCKTABLE;
      InteractLogEntry.SETCURRENTKEY("Contact Company No.","Contact No.");
      InteractLogEntry.SETRANGE("Contact Company No.","Company No.");
      InteractLogEntry.SETRANGE("Contact No.","No.");
      IF InteractLogEntry.FIND('-') THEN
        ERROR(Text003,FIELDCAPTION(Type));
      Todo.SETCURRENTKEY("Contact Company No.","Contact No.");
      Todo.SETRANGE("Contact Company No.","Company No.");
      Todo.SETRANGE("Contact No.","No.");
      IF Todo.FIND('-') THEN
        ERROR(Text005,FIELDCAPTION(Type));
      Opp.SETCURRENTKEY("Contact Company No.","Contact No.");
      Opp.SETRANGE("Contact Company No.","Company No.");
      Opp.SETRANGE("Contact No.","No.");
      IF Opp.FIND('-') THEN
        ERROR(Text006,FIELDCAPTION(Type));

      CASE Type OF
        Type::Company:
          BEGIN
            TESTFIELD("Organizational Level Code",'');
            TESTFIELD("No. of Job Responsibilities",0);
            "First Name" := '';
            "Middle Name" := '';
            Surname := '';
            "Job Title" := '';
            "Company No." := "No.";
            "Company Name" := Name;
            SearchManagement.ParseField(
              "No.","No.","Company Name",
              SearchWordDetail."Table Name"::Contact,
              FIELDNO("Company Name"));
            "Salutation Code" := RMSetup."Def. Company Salutation Code";
          END;
        Type::Person:
          BEGIN
            CampaignTargetGrMgt.DeleteContfromTargetGr(InteractLogEntry);
            Cont.RESET;
            Cont.SETCURRENTKEY("Company No.");
            Cont.SETRANGE("Company No.","No.");
            Cont.SETRANGE(Type,Type::Person);
            IF Cont.FIND('-') THEN
              ERROR(Text007,FIELDCAPTION(Type));
            TESTFIELD("No. of Business Relations",0);
            TESTFIELD("No. of Industry Groups",0);
            TESTFIELD("Currency Code",'');
            TESTFIELD("VAT Registration No.",'');
            IF "Company No." = "No." THEN BEGIN
              "Company No." := '';
              "Company Name" := '';
              SearchManagement.DeletePrevDetails(
                "No.","No.",
                SearchWordDetail."Table Name"::Contact,
                FIELDNO("Company Name"));
              "Salutation Code" := RMSetup."Default Person Salutation Code";
              NameBreakdown;
            END;
          END;
      END;
      VALIDATE("Lookup Contact No.");

      IF Cont.GET("No.") THEN BEGIN
        IF Type = Type::Company THEN
          CheckDupl
        ELSE
          DuplMgt.RemoveContIndex(Rec,FALSE);
      END;
    END;

    PROCEDURE AssistEdit@2(OldCont@1000 : Record 5050) : Boolean;
    BEGIN
      WITH Cont DO BEGIN
        Cont := Rec;
        RMSetup.GET;
        RMSetup.TESTFIELD("Contact Nos.");
        IF NoSeriesMgt.SelectSeries(RMSetup."Contact Nos.",OldCont."No. Series","No. Series") THEN BEGIN
          RMSetup.GET;
          RMSetup.TESTFIELD("Contact Nos.");
          NoSeriesMgt.SetSeries("No.");
          Rec := Cont;
          EXIT(TRUE);
        END;
      END;
    END;

    PROCEDURE CreateCustomer@3(CustomerTemplate@1006 : Code[10]);
    VAR
      Cust@1000 : Record 18;
      ContComp@1001 : Record 5050;
      CustTemplate@1003 : Record 5105;
      DefaultDim@1005 : Record 352;
      DefaultDim2@1004 : Record 352;
    BEGIN
      TESTFIELD("Company No.");
      RMSetup.GET;
      RMSetup.TESTFIELD("Bus. Rel. Code for Customers");

      ContBusRel.RESET;
      ContBusRel.SETRANGE("Contact No.","No.");
      ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
      IF ContBusRel.FIND('-') THEN
        ERROR(
          Text019,
          TABLECAPTION,"No.",ContBusRel.TABLECAPTION,ContBusRel."Link to Table",ContBusRel."No.")
      ELSE
        IF CustomerTemplate <> '' THEN
          CustTemplate.GET(CustomerTemplate);

      CLEAR(Cust);
      Cust.SetInsertFromContact(TRUE);
      Cust.INSERT(TRUE);
      Cust.SetInsertFromContact(FALSE);

      IF Type = Type::Company THEN
        ContComp := Rec
      ELSE
        ContComp.GET("Company No.");

      ContBusRel."Contact No." := ContComp."No.";
      ContBusRel."Business Relation Code" := RMSetup."Bus. Rel. Code for Customers";
      ContBusRel."Link to Table" := ContBusRel."Link to Table"::Customer;
      ContBusRel."No." := Cust."No.";
      ContBusRel.INSERT(TRUE);

      UpdateCustVendBank.UpdateCustomer(ContComp,ContBusRel);

      Cust.GET(ContBusRel."No.");
      Cust.VALIDATE(Name,"Company Name");
      Cust.MODIFY;

      IF CustTemplate.Code <> '' THEN BEGIN
        Cust."Territory Code" := "Territory Code";
        Cust."Currency Code" := ContComp."Currency Code";
        Cust."Country/Region Code" := "Country/Region Code";
        Cust."Customer Posting Group" := CustTemplate."Customer Posting Group";
        Cust."Customer Price Group" := CustTemplate."Customer Price Group";
        Cust."Invoice Disc. Code" := CustTemplate."Invoice Disc. Code";
        Cust."Customer Disc. Group" := CustTemplate."Customer Disc. Group";
        Cust."Allow Line Disc." := CustTemplate."Allow Line Disc.";
        Cust."Gen. Bus. Posting Group" := CustTemplate."Gen. Bus. Posting Group";
        Cust."VAT Bus. Posting Group" := CustTemplate."VAT Bus. Posting Group";
        Cust."Payment Terms Code" := CustTemplate."Payment Terms Code";
        Cust."Payment Method Code" := CustTemplate."Payment Method Code";
        Cust."Shipment Method Code" := CustTemplate."Shipment Method Code";
        Cust.MODIFY;

        DefaultDim.SETRANGE("Table ID",DATABASE::"Customer Template");
        DefaultDim.SETRANGE("No.",CustTemplate.Code);
        IF DefaultDim.FIND('-') THEN
          REPEAT
            CLEAR(DefaultDim2);
            DefaultDim2.INIT;
            DefaultDim2.VALIDATE("Table ID",DATABASE::Customer);
            DefaultDim2."No." := Cust."No.";
            DefaultDim2.VALIDATE("Dimension Code",DefaultDim."Dimension Code");
            DefaultDim2.VALIDATE("Dimension Value Code",DefaultDim."Dimension Value Code");
            DefaultDim2."Value Posting" := DefaultDim."Value Posting";
            DefaultDim2.INSERT(TRUE);
          UNTIL DefaultDim.NEXT = 0;
      END;

      UpdateQuotes(Cust);
      CampaignMgt.ConverttoCustomer(Rec,Cust);
      MESSAGE(Text009,Cust.TABLECAPTION,Cust."No.");
    END;

    PROCEDURE CreateVendor@7();
    VAR
      Vend@1000 : Record 23;
      ContComp@1001 : Record 5050;
    BEGIN
      TESTFIELD("Company No.");
      RMSetup.GET;
      RMSetup.TESTFIELD("Bus. Rel. Code for Vendors");

      CLEAR(Vend);
      Vend.SetInsertFromContact(TRUE);
      Vend.INSERT(TRUE);
      Vend.SetInsertFromContact(FALSE);

      IF Type = Type::Company THEN
        ContComp := Rec
      ELSE
        ContComp.GET("Company No.");

      ContBusRel."Contact No." := ContComp."No.";
      ContBusRel."Business Relation Code" := RMSetup."Bus. Rel. Code for Vendors";
      ContBusRel."Link to Table" := ContBusRel."Link to Table"::Vendor;
      ContBusRel."No." := Vend."No.";
      ContBusRel.INSERT(TRUE);

      UpdateCustVendBank.UpdateVendor(ContComp,ContBusRel);

      MESSAGE(Text009,Vend.TABLECAPTION,Vend."No.");
    END;

    PROCEDURE CreateBankAccount@8();
    VAR
      BankAcc@1000 : Record 270;
      ContComp@1001 : Record 5050;
    BEGIN
      TESTFIELD("Company No.");
      RMSetup.GET;
      RMSetup.TESTFIELD("Bus. Rel. Code for Bank Accs.");

      CLEAR(BankAcc);
      BankAcc.SetInsertFromContact(TRUE);
      BankAcc.INSERT(TRUE);
      BankAcc.SetInsertFromContact(FALSE);

      IF Type = Type::Company THEN
        ContComp := Rec
      ELSE
        ContComp.GET("Company No.");

      ContBusRel."Contact No." := ContComp."No.";
      ContBusRel."Business Relation Code" := RMSetup."Bus. Rel. Code for Bank Accs.";
      ContBusRel."Link to Table" := ContBusRel."Link to Table"::"Bank Account";
      ContBusRel."No." := BankAcc."No.";
      ContBusRel.INSERT(TRUE);

      UpdateCustVendBank.UpdateBankAccount(ContComp,ContBusRel);

      MESSAGE(Text009,BankAcc.TABLECAPTION,BankAcc."No.");
    END;

    PROCEDURE CreateCustomerLink@5();
    VAR
      Cust@1001 : Record 18;
      ContBusRel@1000 : Record 5054;
    BEGIN
      TESTFIELD("Company No.");
      RMSetup.GET;
      RMSetup.TESTFIELD("Bus. Rel. Code for Customers");
      CreateLink(
        FORM::"Customer Link",
        RMSetup."Bus. Rel. Code for Customers",
        ContBusRel."Link to Table"::Customer);

      ContBusRel.SETCURRENTKEY("Link to Table","No.");
      ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
      ContBusRel.SETRANGE("Contact No.","Company No.");
      IF ContBusRel.FIND('-') THEN
        IF Cust.GET(ContBusRel."No.") THEN
          UpdateQuotes(Cust);
    END;

    PROCEDURE CreateVendorLink@6();
    BEGIN
      TESTFIELD("Company No.");
      RMSetup.GET;
      RMSetup.TESTFIELD("Bus. Rel. Code for Vendors");
      CreateLink(
        FORM::"Vendor Link",
        RMSetup."Bus. Rel. Code for Vendors",
        ContBusRel."Link to Table"::Vendor);
    END;

    PROCEDURE CreateBankAccountLink@9();
    BEGIN
      TESTFIELD("Company No.");
      RMSetup.GET;
      RMSetup.TESTFIELD("Bus. Rel. Code for Bank Accs.");
      CreateLink(
        FORM::"Bank Account Link",
        RMSetup."Bus. Rel. Code for Bank Accs.",
        ContBusRel."Link to Table"::"Bank Account");
    END;

    PROCEDURE CreateLink@11(CreateForm@1000 : Integer;BusRelCode@1001 : Code[10];Table@1002 : 'Customer,Vendor,Bank Account');
    VAR
      TempContBusRel@1003 : TEMPORARY Record 5054;
    BEGIN
      TempContBusRel."Contact No." := "Company No.";
      TempContBusRel."Business Relation Code" := BusRelCode;
      TempContBusRel."Link to Table" := Table;
      TempContBusRel.INSERT;
      FORM.RUNMODAL(CreateForm,TempContBusRel);
      TempContBusRel.DELETEALL;
    END;

    PROCEDURE CreateInteraction@10();
    VAR
      SegmentLine@1000 : TEMPORARY Record 5077;
    BEGIN
      SegmentLine.CreateInteractionFromContact(Rec);
    END;

    PROCEDURE ShowCustVendBank@12();
    VAR
      ContBusRel@1000 : Record 5054;
      FormSelected@1001 : Boolean;
      Cust@1002 : Record 18;
      Vend@1003 : Record 23;
      BankAcc@1004 : Record 270;
    BEGIN
      FormSelected := TRUE;

      ContBusRel.RESET;
      ContBusRel.SETRANGE("Contact No.","Company No.");
      ContBusRel.SETFILTER("No.",'<>''''');

      CASE ContBusRel.COUNT OF
        0: ERROR(Text010,TABLECAPTION,"No.");
        1: ContBusRel.FIND('-');
        ELSE
          FormSelected := FORM.RUNMODAL(FORM::"Contact Business Relations",ContBusRel) = ACTION::LookupOK;
      END;

      IF FormSelected THEN BEGIN
        CASE ContBusRel."Link to Table" OF
          ContBusRel."Link to Table"::Customer: BEGIN
            Cust.GET(ContBusRel."No.");
            FORM.RUN(FORM::"Customer Card",Cust);
          END;
          ContBusRel."Link to Table"::Vendor: BEGIN
            Vend.GET(ContBusRel."No.");
            FORM.RUN(FORM::"Vendor Card",Vend);
          END;
          ContBusRel."Link to Table"::"Bank Account": BEGIN
            BankAcc.GET(ContBusRel."No.");
            FORM.RUN(FORM::"Bank Account Card",BankAcc);
          END;
        END;
      END;
    END;

    PROCEDURE NameBreakdown@13();
    VAR
      NamePart@1000 : ARRAY [30] OF Text[250];
      TempName@1001 : Text[250];
      FirstName250@1004 : Text[250];
      i@1002 : Integer;
      NoOfParts@1003 : Integer;
    BEGIN
      IF Type = Type::Company THEN
        EXIT;

      TempName := Name;
      WHILE STRPOS(TempName,' ') > 0 DO BEGIN
        IF STRPOS(TempName,' ') > 1 THEN BEGIN
          i := i + 1;
          NamePart[i] := COPYSTR(TempName,1,STRPOS(TempName,' ') - 1);
        END;
        TempName := COPYSTR(TempName,STRPOS(TempName,' ') + 1);
      END;
      i := i + 1;
      NamePart[i] := TempName;
      NoOfParts := i;

      "First Name" := '';
      "Middle Name" := '';
      Surname := '';
      FOR i := 1 TO NoOfParts DO BEGIN
        IF (i = NoOfParts) AND (NoOfParts > 1) THEN BEGIN
          IF STRLEN(NamePart[i]) > MAXSTRLEN(Surname) THEN
            ERROR(Text032,FIELDCAPTION(Surname),STRLEN(NamePart[i]) - MAXSTRLEN(Surname));
          Surname := NamePart[i]
        END ELSE
          IF (i = NoOfParts - 1) AND (NoOfParts > 2) THEN BEGIN
            IF STRLEN(NamePart[i]) > MAXSTRLEN("Middle Name") THEN
              ERROR(Text032,FIELDCAPTION("Middle Name"),STRLEN(NamePart[i]) - MAXSTRLEN("Middle Name"));
            "Middle Name" := NamePart[i]
          END ELSE BEGIN
            FirstName250 := DELCHR("First Name" + ' ' + NamePart[i],'<',' ');
            IF STRLEN(FirstName250) > MAXSTRLEN("First Name") THEN
              ERROR(Text032,FIELDCAPTION("First Name"),STRLEN(FirstName250) - MAXSTRLEN("First Name"));
            "First Name" := FirstName250;
          END;
      END;
    END;

    PROCEDURE SetSkipDefault@15(Defaults@1000 : Boolean);
    BEGIN
      SkipDefaults := NOT Defaults;
    END;

    PROCEDURE IdenticalAddress@16(VAR Cont@1000 : Record 5050) : Boolean;
    BEGIN
      EXIT(
        (Address = Cont.Address) AND
        ("Address 2" = Cont."Address 2") AND
        ("Post Code" = Cont."Post Code") AND
        (City = Cont.City))
    END;

    PROCEDURE ActiveAltAddress@17(ActiveDate@1000 : Date) : Code[10];
    VAR
      ContAltAddrDateRange@1001 : Record 5052;
    BEGIN
      ContAltAddrDateRange.SETCURRENTKEY("Contact No.","Starting Date");
      ContAltAddrDateRange.SETRANGE("Contact No.","No.");
      ContAltAddrDateRange.SETRANGE("Starting Date",0D,ActiveDate);
      ContAltAddrDateRange.SETFILTER("Ending Date",'>=%1|%2',ActiveDate,0D);
      IF ContAltAddrDateRange.FIND('+') THEN
        EXIT(ContAltAddrDateRange."Contact Alt. Address Code")
      ELSE
        EXIT('');
    END;

    PROCEDURE CalculatedName@14() NewName@1000 : Text[50];
    VAR
      NewName92@1001 : Text[92];
    BEGIN
      IF "First Name" <> '' THEN
        NewName92 := "First Name";
      IF "Middle Name" <> '' THEN
        NewName92 := NewName92 + ' ' + "Middle Name";
      IF Surname <> '' THEN
        NewName92 := NewName92 + ' ' + Surname;

      NewName92 := DELCHR(NewName92,'<',' ');

      IF STRLEN(NewName92) > MAXSTRLEN(Name) THEN
        ERROR(Text029,STRLEN(NewName92) - MAXSTRLEN(Name));

      NewName := COPYSTR(NewName92,1,STRLEN(NewName92));
    END;

    PROCEDURE UpdateSearchName@22();
    BEGIN
      IF ("Search Name" = UPPERCASE(xRec.Name)) OR ("Search Name" = '') THEN
        "Search Name" := Name;
    END;

    PROCEDURE AddText@20(Text@1000 : Text[249]) : Text[250];
    BEGIN
      IF Text <> '' THEN
        EXIT(Text + ' ');
    END;

    PROCEDURE CheckDupl@21();
    BEGIN
      IF RMSetup."Maintain Dupl. Search Strings" THEN
        DuplMgt.MakeContIndex(Rec);
      IF GUIALLOWED THEN
        IF DuplMgt.DuplicateExist(Rec) THEN BEGIN
          MODIFY;
          COMMIT;
          DuplMgt.LaunchDuplicateForm(Rec);
        END;
    END;

    PROCEDURE FindCustomerTemplate@23() FindCustTemplate@1001 : Code[10];
    VAR
      CustTemplate@1003 : Record 5105;
      ContCompany@1002 : Record 5050;
    BEGIN
      CustTemplate.RESET;
      CustTemplate.SETRANGE("Territory Code","Territory Code");
      CustTemplate.SETRANGE("Country/Region Code","Country/Region Code");
      IF ContCompany.GET("Company No.") THEN
        CustTemplate.SETRANGE("Currency Code",ContCompany."Currency Code");

      IF CustTemplate.COUNT = 1 THEN BEGIN
        CustTemplate.FIND('-');
        EXIT(CustTemplate.Code);
      END;
    END;

    PROCEDURE ChooseCustomerTemplate@27() ChooseCustTemplate@1001 : Code[10];
    VAR
      CustTemplate@1000 : Record 5105;
    BEGIN
      ContBusRel.RESET;
      ContBusRel.SETRANGE("Contact No.","No.");
      ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
      IF ContBusRel.FIND('-') THEN
        ERROR(
          Text019,
          TABLECAPTION,"No.",ContBusRel.TABLECAPTION,ContBusRel."Link to Table",ContBusRel."No.")
      ELSE
        IF CONFIRM(Text020,TRUE,"No.",Name) THEN
          IF FORM.RUNMODAL(0,CustTemplate) = ACTION::LookupOK THEN
            EXIT(CustTemplate.Code)
          ELSE
            ERROR(Text022);
    END;

    PROCEDURE UpdateQuotes@29(Customer@1000 : Record 18);
    VAR
      SalesHeader@1003 : Record 36;
      Cont@1004 : Record 5050;
      SalesLine@1001 : Record 37;
    BEGIN
      Cont.SETCURRENTKEY("Company No.");
      Cont.SETRANGE("Company No.","Company No.");

      IF Cont.FIND('-') THEN
        REPEAT
          SalesHeader.RESET;
          SalesHeader.SETCURRENTKEY("Document Type","Sell-to Contact No.");
          SalesHeader.SETRANGE("Document Type",SalesHeader."Document Type"::Quote);
          SalesHeader.SETRANGE("Sell-to Contact No.",Cont."No.");
          IF SalesHeader.FIND('-') THEN
            REPEAT
              SalesHeader."Sell-to Customer No." := Customer."No.";
              SalesHeader."Sell-to Customer Template Code" := '';
              SalesHeader.MODIFY;
              SalesLine.SETRANGE("Document Type",SalesHeader."Document Type");
              SalesLine.SETRANGE("Document No.",SalesHeader."No.");
              IF SalesLine.FIND('-') THEN
                SalesLine.MODIFYALL("Sell-to Customer No.",SalesHeader."Sell-to Customer No.");
            UNTIL SalesHeader.NEXT = 0;

          SalesHeader.RESET;
          SalesHeader.SETCURRENTKEY("Bill-to Contact No.");
          SalesHeader.SETRANGE("Document Type",SalesHeader."Document Type"::Quote);
          SalesHeader.SETRANGE("Bill-to Contact No.",Cont."No.");
          IF SalesHeader.FIND('-') THEN
            REPEAT
              SalesHeader."Bill-to Customer No." := Customer."No.";
              SalesHeader."Bill-to Customer Template Code" := '';
              SalesHeader."Salesperson Code" := Customer."Salesperson Code";
              SalesHeader.MODIFY;
              SalesLine.SETRANGE("Document Type",SalesHeader."Document Type");
              SalesLine.SETRANGE("Document No.",SalesHeader."No.");
              IF SalesLine.FIND('-') THEN
                SalesLine.MODIFYALL("Bill-to Customer No.",SalesHeader."Bill-to Customer No.");
            UNTIL SalesHeader.NEXT = 0;
        UNTIL Cont.NEXT = 0;
    END;

    PROCEDURE GetSalutation@18(SalutationType@1001 : 'Formal,Informal';LanguageCode@1000 : Code[10]) : Text[260];
    VAR
      SalutationFormula@1005 : Record 5069;
      NamePart@1004 : ARRAY [5] OF Text[50];
      SubStr@1003 : Text[30];
      i@1002 : Integer;
    BEGIN
      IF NOT SalutationFormula.GET("Salutation Code",LanguageCode,SalutationType) THEN
        ERROR(Text021,LanguageCode,"No.");
      SalutationFormula.TESTFIELD(Salutation);

      CASE SalutationFormula."Name 1" OF
        SalutationFormula."Name 1"::"Job Title":
          NamePart[1] := "Job Title";
        SalutationFormula."Name 1"::"First Name":
          NamePart[1] := "First Name";
        SalutationFormula."Name 1"::"Middle Name":
          NamePart[1] := "Middle Name";
        SalutationFormula."Name 1"::Surname:
          NamePart[1] := Surname;
        SalutationFormula."Name 1"::Initials:
          NamePart[1] := Initials;
        SalutationFormula."Name 1"::"Company Name":
          NamePart[1] := "Company Name";
      END;

      CASE SalutationFormula."Name 2" OF
        SalutationFormula."Name 2"::"Job Title":
          NamePart[2] := "Job Title";
        SalutationFormula."Name 2"::"First Name":
          NamePart[2] := "First Name";
        SalutationFormula."Name 2"::"Middle Name":
          NamePart[2] := "Middle Name";
        SalutationFormula."Name 2"::Surname:
          NamePart[2] := Surname;
        SalutationFormula."Name 2"::Initials:
          NamePart[2] := Initials;
        SalutationFormula."Name 2"::"Company Name":
          NamePart[2] := "Company Name";
      END;

      CASE SalutationFormula."Name 3" OF
        SalutationFormula."Name 3"::"Job Title":
          NamePart[3] := "Job Title";
        SalutationFormula."Name 3"::"First Name":
          NamePart[3] := "First Name";
        SalutationFormula."Name 3"::"Middle Name":
          NamePart[3] := "Middle Name";
        SalutationFormula."Name 3"::Surname:
          NamePart[3] := Surname;
        SalutationFormula."Name 3"::Initials:
          NamePart[3] := Initials;
        SalutationFormula."Name 3"::"Company Name":
          NamePart[3] := "Company Name";
      END;

      CASE SalutationFormula."Name 4" OF
        SalutationFormula."Name 4"::"Job Title":
          NamePart[4] := "Job Title";
        SalutationFormula."Name 4"::"First Name":
          NamePart[4] := "First Name";
        SalutationFormula."Name 4"::"Middle Name":
          NamePart[4] := "Middle Name";
        SalutationFormula."Name 4"::Surname:
          NamePart[4] := Surname;
        SalutationFormula."Name 4"::Initials:
          NamePart[4] := Initials;
        SalutationFormula."Name 4"::"Company Name":
          NamePart[4] := "Company Name";
      END;

      CASE SalutationFormula."Name 5" OF
        SalutationFormula."Name 5"::"Job Title":
          NamePart[5] := "Job Title";
        SalutationFormula."Name 5"::"First Name":
          NamePart[5] := "First Name";
        SalutationFormula."Name 5"::"Middle Name":
          NamePart[5] := "Middle Name";
        SalutationFormula."Name 5"::Surname:
          NamePart[5] := Surname;
        SalutationFormula."Name 5"::Initials:
          NamePart[5] := Initials;
        SalutationFormula."Name 5"::"Company Name":
          NamePart[5] := "Company Name";
      END;

      FOR i := 1 TO 5 DO
        IF NamePart[i] = '' THEN BEGIN
          SubStr := '%' + FORMAT(i) + ' ';
          IF STRPOS(SalutationFormula.Salutation,SubStr) > 0 THEN
            SalutationFormula.Salutation :=
              DELSTR(SalutationFormula.Salutation,STRPOS(SalutationFormula.Salutation,SubStr),3);
        END;

      EXIT(STRSUBSTNO(SalutationFormula.Salutation,NamePart[1],NamePart[2],NamePart[3],NamePart[4],NamePart[5]))
    END;

    PROCEDURE InheritCompanyToPersonData@24(Cont@1000 : Record 5050;KeepPersonalData@1001 : Boolean);
    BEGIN
      "Company Name" := Cont.Name;

      SearchManagement.ParseField(
        "No.","No.","Company Name",SearchWordDetail."Table Name"::Contact,FIELDNO("Company Name"));

      RMSetup.GET;
      IF RMSetup."Inherit Salesperson Code" THEN
        "Salesperson Code" := Cont."Salesperson Code";
      IF RMSetup."Inherit Territory Code" THEN
        "Territory Code" := Cont."Territory Code";
      IF RMSetup."Inherit Country/Region Code" THEN
        "Country/Region Code" := Cont."Country/Region Code";
      IF RMSetup."Inherit Language Code" THEN
        "Language Code" := Cont."Language Code";
      IF RMSetup."Inherit Address Details" AND
        ((NOT KeepPersonalData) OR
         (Cont.Address + Cont."Address 2" + Cont.County + Cont."Post Code" + Cont.City <> ''))
      THEN BEGIN
        Address := Cont.Address;
        "Address 2" := Cont."Address 2";
        "Post Code" := Cont."Post Code";
        City := Cont.City;
        County := Cont.County;
        SearchManagement.ParseField(
          "No.","No.",Address,SearchWordDetail."Table Name"::Contact,FIELDNO(Address));
        SearchManagement.ParseField(
          "No.","No.","Address 2",SearchWordDetail."Table Name"::Contact,FIELDNO("Address 2"));
        SearchManagement.ParseField(
          "No.","No.","Post Code",SearchWordDetail."Table Name"::Contact,FIELDNO("Post Code"));
        SearchManagement.ParseField(
          "No.","No.",City,SearchWordDetail."Table Name"::Contact,FIELDNO(City));
        SearchManagement.ParseField(
          "No.","No.",County,SearchWordDetail."Table Name"::Contact,FIELDNO(County));
      END;
      IF RMSetup."Inherit Communication Details" THEN BEGIN
        IF (Cont."Phone No." <> '') OR NOT KeepPersonalData THEN
          "Phone No." := Cont."Phone No.";
        IF (Cont."Telex No." <> '') OR NOT KeepPersonalData THEN
          "Telex No." := Cont."Telex No.";
        IF (Cont."Fax No." <> '') OR NOT KeepPersonalData THEN
          "Fax No." := Cont."Fax No.";
        IF (Cont."Telex Answer Back" <> '') OR NOT KeepPersonalData THEN
          "Telex Answer Back" := Cont."Telex Answer Back";
        IF (Cont."E-Mail" <> '') OR NOT KeepPersonalData THEN
          VALIDATE("E-Mail",Cont."E-Mail");
        IF (Cont."Home Page" <> '') OR NOT KeepPersonalData THEN
          "Home Page" := Cont."Home Page";
        IF (Cont."Extension No." <> '') OR NOT KeepPersonalData THEN
          "Extension No." := Cont."Extension No.";
        IF (Cont."Mobile Phone No." <> '') OR NOT KeepPersonalData THEN
          "Mobile Phone No." := Cont."Mobile Phone No.";
        IF (Cont.Pager <> '') OR NOT KeepPersonalData THEN
          Pager := Cont.Pager;
        IF (Cont."Correspondence Type" <> "Correspondence Type"::" ") OR NOT KeepPersonalData THEN
          "Correspondence Type" := Cont."Correspondence Type";
        SearchManagement.ParseField(
          "No.","No.","Phone No.",SearchWordDetail."Table Name"::Contact,FIELDNO("Phone No."));
        SearchManagement.ParseField(
          "No.","No.","Telex No.",SearchWordDetail."Table Name"::Contact,FIELDNO("Telex No."));
        SearchManagement.ParseField(
          "No.","No.","Fax No.",SearchWordDetail."Table Name"::Contact,FIELDNO("Fax No."));
        SearchManagement.ParseField(
          "No.","No.","Telex Answer Back",SearchWordDetail."Table Name"::Contact,FIELDNO("Telex Answer Back"));
        SearchManagement.ParseField(
          "No.","No.","E-Mail",SearchWordDetail."Table Name"::Contact,FIELDNO("E-Mail"));
        SearchManagement.ParseField(
          "No.","No.","Home Page",SearchWordDetail."Table Name"::Contact,FIELDNO("Home Page"));
        SearchManagement.ParseField(
          "No.","No.","Mobile Phone No.",SearchWordDetail."Table Name"::Contact,FIELDNO("Mobile Phone No."));
        SearchManagement.ParseField(
          "No.","No.",Pager,SearchWordDetail."Table Name"::Contact,FIELDNO(Pager));
      END;
    END;

    PROCEDURE SetHideValidationDialog@26(NewHideValidationDialog@1000 : Boolean) : Boolean;
    BEGIN
      HideValidationDialog := NewHideValidationDialog;
    END;

    PROCEDURE DisplayMap@36();
    VAR
      MapPoint@1001 : Record 800;
      MapMgt@1000 : Codeunit 802;
    BEGIN
      IF MapPoint.FIND('-') THEN
        MapMgt.MakeSelection(DATABASE::Contact,GETPOSITION)
      ELSE MESSAGE(Text033);
    END;

    PROCEDURE ProcessNameChange@37();
    VAR
      ContBusRel@1000 : Record 5054;
      Cust@1001 : Record 18;
      Vend@1002 : Record 23;
    BEGIN
      UpdateSearchName;

      IF Type = Type::Company THEN
        "Company Name" := Name;

      IF Type = Type::Person THEN BEGIN
        ContBusRel.RESET;
        ContBusRel.SETCURRENTKEY("Link to Table","Contact No.");
        ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
        ContBusRel.SETRANGE("Contact No.","Company No.");
        IF ContBusRel.FINDFIRST THEN
          IF Cust.GET(ContBusRel."No.") THEN
            IF Cust."Primary Contact No." = "No." THEN BEGIN
              Cust.Contact := Name;
              Cust.MODIFY;
            END;

        ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Vendor);
        IF ContBusRel.FINDFIRST THEN
          IF Vend.GET(ContBusRel."No.") THEN
            IF Vend."Primary Contact No." = "No." THEN BEGIN
              Vend.Contact := Name;
              Vend.MODIFY;
            END;
      END;
    END;

    BEGIN
    {
      AT01 actTAPI 04.06.2003 Update Phone Index: Global Var TAPIFu CU 56780
                              Call in the OnValidate-Trigger of every Phone No. (3x)
                              Delete Phone Index
      AT01.20      08.09.2003 Create/modify Phone-Index, if Name is changed
                              Option: Format Phone No.. in the OnValidate-Trigger of
                                every Phone No. (3x)
                              Global Var: TAPISetUp Rec 56782
      AT04.00      04.11.2005 Option: Format Fax No. in the OnValidate-Trigger
                              of Fax No.
      AT2009       06.11.2009 Global Var TAPIFuSI CU 56782 (ConvToCanonic)
    }
    END.
  }
}

OBJECT Form 21 Customer Card
{
  OBJECT-PROPERTIES
  {
    Date=05.04.11;
    Time=12:20:11;
    Modified=Yes;
    Version List=NAVW16.00.10,LIQEM6.00,NAVDACH5.00.01,AT2011;
  }
  PROPERTIES
  {
    Width=16170;
    Height=8030;
    CaptionML=[DEU=Debitorenkarte;
               ENU=Customer Card];
    SourceTable=Table18;
    UpdateOnActivate=Yes;
    OnOpenForm=VAR
                 MapMgt@1000 : Codeunit 802;
               BEGIN
                 ActivateFields;
                 IF NOT MapMgt.TestSetup THEN
                   CurrForm.MapPoint.VISIBLE(FALSE);
               END;

    OnFindRecord=VAR
                   RecordFound@1000 : Boolean;
                 BEGIN
                   RecordFound := FIND(Which);
                   IF NOT RecordFound AND (GETFILTER("No.") <> '') THEN BEGIN
                   MESSAGE(Text003,GETFILTER("No."));
                   SETRANGE("No.");
                   RecordFound := FIND(Which);
                   END;
                   EXIT(RecordFound);
                 END;

    OnAfterGetRecord=BEGIN
                       SETRANGE("No.");
                     END;

    OnAfterGetCurrRecord=BEGIN
                           ActivateFields;
                         END;

  }
  CONTROLS
  {
    { 1   ;TabControl   ;220  ;220  ;15730;6820 ;HorzGlue=Both;
                                                 VertGlue=Both;
                                                 PageNamesML=[DEU=Allgemein,Kommunikation,Fakturierung,Zahlung,Lieferung,Au·enhandel;
                                                              ENU=General,Communication,Invoicing,Payments,Shipping,Foreign Trade] }
    { 2   ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="No.";
                                                 OnAssistEdit=BEGIN
                                                                IF AssistEdit(xRec) THEN
                                                                  CurrForm.UPDATE;
                                                              END;
                                                               }
    { 3   ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=2;
                                                 InPage=0 }
    { 88  ;PictureBox   ;6710 ;990  ;440  ;440  ;Focusable=No;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 Border=No;
                                                 BitmapPos=Center;
                                                 BitmapList=7,6;
                                                 SourceExpr=Comment }
    { 89  ;CommandButton;6710 ;990  ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 BackTransparent=Yes;
                                                 PushAction=RunObject;
                                                 ToolTipML=[DEU=Bemerkung;
                                                            ENU=Comment];
                                                 RunObject=Form 124;
                                                 RunFormLinkType=OnUpdate;
                                                 RunFormLink=Table Name=CONST(Customer),
                                                             No.=FIELD(No.) }
    { 4   ;TextBox      ;3850 ;1650 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=Name }
    { 5   ;Label        ;440  ;1650 ;3300 ;440  ;ParentControl=4;
                                                 InPage=0 }
    { 6   ;TextBox      ;3850 ;2200 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=Address }
    { 7   ;Label        ;440  ;2200 ;3300 ;440  ;ParentControl=6;
                                                 InPage=0 }
    { 8   ;TextBox      ;3850 ;2750 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Address 2" }
    { 9   ;Label        ;440  ;2750 ;3300 ;440  ;ParentControl=8;
                                                 InPage=0 }
    { 12  ;TextBox      ;3850 ;4510 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Phone No." }
    { 13  ;Label        ;440  ;4510 ;3300 ;440  ;ParentControl=12;
                                                 InPage=0 }
    { 16  ;TextBox      ;3850 ;5720 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=Contact;
                                                 OnAfterValidate=BEGIN
                                                                   ActivateFields;
                                                                 END;
                                                                  }
    { 17  ;Label        ;440  ;5720 ;3300 ;440  ;ParentControl=16;
                                                 InPage=0 }
    { 18  ;TextBox      ;12980;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Search Name" }
    { 19  ;Label        ;9570 ;990  ;3300 ;440  ;ParentControl=18;
                                                 InPage=0 }
    { 22  ;TextBox      ;12980;2200 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Credit Limit (LCY)" }
    { 23  ;Label        ;9570 ;2200 ;3300 ;440  ;ParentControl=22;
                                                 InPage=0 }
    { 24  ;TextBox      ;12980;2860 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Salesperson Code" }
    { 25  ;Label        ;9570 ;2860 ;3300 ;440  ;ParentControl=24;
                                                 InPage=0 }
    { 28  ;TextBox      ;12980;5390 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Last Date Modified" }
    { 29  ;Label        ;9570 ;5390 ;3300 ;440  ;ParentControl=28;
                                                 InPage=0 }
    { 91  ;TextBox      ;3850 ;3850 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Country/Region Code" }
    { 92  ;Label        ;440  ;3850 ;3300 ;440  ;ParentControl=91 }
    { 10  ;TextBox      ;6710 ;3300 ;2640 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 NextControl=91;
                                                 SourceExpr=City }
    { 90  ;TextBox      ;3850 ;3300 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 NextControl=10;
                                                 SourceExpr="Post Code" }
    { 97  ;Label        ;440  ;3300 ;3300 ;440  ;ParentControl=90;
                                                 CaptionML=[DEU=PLZ-Code/Ort;
                                                            ENU=Post Code/City] }
    { 20  ;TextBox      ;12980;1650 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Balance (LCY)";
                                                 OnDrillDown=VAR
                                                               DtldCustLedgEntry@1001 : Record 379;
                                                               CustLedgEntry@1002 : Record 21;
                                                             BEGIN
                                                               DtldCustLedgEntry.SETRANGE("Customer No.","No.");
                                                               COPYFILTER("Global Dimension 1 Filter",DtldCustLedgEntry."Initial Entry Global Dim. 1");
                                                               COPYFILTER("Global Dimension 2 Filter",DtldCustLedgEntry."Initial Entry Global Dim. 2");
                                                               COPYFILTER("Currency Filter",DtldCustLedgEntry."Currency Code");
                                                               CustLedgEntry.DrillDownOnEntries(DtldCustLedgEntry);
                                                             END;
                                                              }
    { 21  ;Label        ;9570 ;1650 ;3300 ;440  ;ParentControl=20 }
    { 64  ;TextBox      ;12980;3410 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Responsibility Center" }
    { 65  ;Label        ;9570 ;3410 ;3300 ;440  ;ParentControl=64 }
    { 122 ;TextBox      ;3850 ;5170 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Primary Contact No.";
                                                 OnDeactivate=BEGIN
                                                                ActivateFields;
                                                              END;
                                                               }
    { 133 ;Label        ;440  ;5170 ;3300 ;440  ;ParentControl=122 }
    { 93  ;TextBox      ;12980;4070 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Service Zone Code" }
    { 116 ;Label        ;9570 ;4070 ;3300 ;440  ;ParentControl=93 }
    { 26  ;TextBox      ;12980;4730 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=Blocked }
    { 27  ;Label        ;9570 ;4730 ;3300 ;440  ;ParentControl=26 }
    { 150 ;CommandButton;6710 ;4510 ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 Bitmap=34;
                                                 ToolTipML=[DEU=Telefonverbindung herstellen;
                                                            ENU=Make Phone Call];
                                                 OnPush=VAR
                                                          TAPIManagement@1001 : Codeunit 5053;
                                                        BEGIN
                                                          // AT01 BEGIN
                                                          // Changed / geÑndert
                                                          // ORI BEGIN
                                                          // TAPIManagement.DialContCustVendBank(DATABASE::Customer,"No.","Phone No.",'');
                                                          // ORI END
                                                          TAPIFu.Dial(18, "No.", '', 0);
                                                          // AT01 END
                                                        END;
                                                         }
    { 164 ;CommandButton;6710 ;3850 ;440  ;440  ;Name=MapPoint;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 Bitmap=53;
                                                 ToolTipML=[DEU=Zuordnung anzeigen;
                                                            ENU=Display Map];
                                                 OnPush=BEGIN
                                                          DisplayMap;
                                                        END;
                                                         }
    { 103 ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Phone No." }
    { 106 ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=103 }
    { 104 ;TextBox      ;3850 ;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Fax No." }
    { 105 ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=104 }
    { 107 ;TextBox      ;3850 ;2200 ;4950 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="E-Mail" }
    { 108 ;Label        ;440  ;2200 ;3300 ;440  ;ParentControl=107 }
    { 109 ;TextBox      ;3850 ;2750 ;4950 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Home Page" }
    { 110 ;Label        ;440  ;2750 ;3300 ;440  ;ParentControl=109 }
    { 56  ;CommandButton;8910 ;2750 ;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 Bitmap=20;
                                                 ToolTipML=[DEU=Hyperlink;
                                                            ENU=Hyperlink];
                                                 OnPush=BEGIN
                                                          TESTFIELD("Home Page");
                                                          HYPERLINK("Home Page");
                                                        END;
                                                         }
    { 57  ;CommandButton;8910 ;2200 ;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 Bitmap=21;
                                                 ToolTipML=[DEU=Neue Nachricht;
                                                            ENU=New Mail Message];
                                                 OnPush=VAR
                                                          Mail@1001 : Codeunit 397;
                                                        BEGIN
                                                          Mail.MailContCustVendBank(DATABASE::Customer,"No.","E-Mail");
                                                        END;
                                                         }
    { 1125;CommandButton;6710 ;990  ;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 Bitmap=34;
                                                 ToolTipML=[DEU=Telefonverbindung herstellen;
                                                            ENU=Make Phone Call];
                                                 OnPush=VAR
                                                          TAPIManagement@1001 : Codeunit 5053;
                                                        BEGIN
                                                          // AT01 BEGIN
                                                          // Changed / geÑndert
                                                          // ORI BEGIN
                                                          // TAPIManagement.DialContCustVendBank(DATABASE::Customer,"No.","Phone No.",'');
                                                          // ORI END
                                                          TAPIFu.Dial(18, "No.", '', 0);
                                                          // AT01 END
                                                        END;
                                                         }
    { 154 ;TextBox      ;3850 ;3410 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="IC Partner Code";
                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 155 ;Label        ;440  ;3410 ;3300 ;440  ;ParentControl=154 }
    { 34  ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Bill-to Customer No." }
    { 35  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=34 }
    { 36  ;TextBox      ;3850 ;1540 ;1650 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Invoice Copies" }
    { 37  ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=36 }
    { 38  ;TextBox      ;12980;2200 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Customer Posting Group" }
    { 39  ;Label        ;9570 ;2200 ;3300 ;440  ;ParentControl=38 }
    { 40  ;TextBox      ;12980;2860 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Customer Price Group" }
    { 41  ;Label        ;9570 ;2860 ;3300 ;440  ;ParentControl=40 }
    { 42  ;TextBox      ;3850 ;2090 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Invoice Disc. Code" }
    { 43  ;Label        ;440  ;2090 ;3300 ;440  ;ParentControl=42 }
    { 44  ;TextBox      ;12980;3520 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Customer Disc. Group" }
    { 45  ;Label        ;9570 ;3520 ;3300 ;440  ;ParentControl=44 }
    { 46  ;CheckBox     ;12980;4070 ;440  ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 ShowCaption=No;
                                                 SourceExpr="Allow Line Disc." }
    { 47  ;Label        ;9570 ;4070 ;3300 ;440  ;ParentControl=46 }
    { 70  ;TextBox      ;12980;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Gen. Bus. Posting Group" }
    { 71  ;Label        ;9570 ;990  ;3300 ;440  ;ParentControl=70 }
    { 58  ;TextBox      ;12980;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="VAT Bus. Posting Group" }
    { 59  ;Label        ;9570 ;1540 ;3300 ;440  ;ParentControl=58 }
    { 129 ;CheckBox     ;12980;4730 ;440  ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 ShowCaption=No;
                                                 SourceExpr="Prices Including VAT" }
    { 130 ;Label        ;9570 ;4730 ;3300 ;440  ;ParentControl=129 }
    { 156 ;TextBox      ;3850 ;2750 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Copy Sell-to Addr. to Qte From" }
    { 157 ;Label        ;440  ;2750 ;3300 ;440  ;ParentControl=156 }
    { 160 ;TextBox      ;12980;5390 ;1650 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Prepayment %" }
    { 161 ;Label        ;9570 ;5390 ;3300 ;440  ;ParentControl=160 }
    { 48  ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Application Method" }
    { 49  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=48 }
    { 50  ;TextBox      ;3850 ;1650 ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Payment Terms Code" }
    { 51  ;Label        ;440  ;1650 ;3300 ;440  ;ParentControl=50 }
    { 52  ;TextBox      ;3850 ;3410 ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Fin. Charge Terms Code" }
    { 53  ;Label        ;440  ;3410 ;3300 ;440  ;ParentControl=52 }
    { 54  ;CheckBox     ;12980;990  ;440  ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 ShowCaption=No;
                                                 SourceExpr="Print Statements" }
    { 55  ;Label        ;9570 ;990  ;3300 ;440  ;ParentControl=54 }
    { 60  ;TextBox      ;12980;1540 ;1650 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Last Statement No." }
    { 61  ;Label        ;9570 ;1540 ;3300 ;440  ;ParentControl=60 }
    { 15  ;TextBox      ;3850 ;2860 ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Reminder Terms Code" }
    { 111 ;Label        ;440  ;2860 ;3300 ;440  ;ParentControl=15 }
    { 11  ;TextBox      ;3850 ;2200 ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Payment Method Code" }
    { 98  ;Label        ;440  ;2200 ;3300 ;440  ;ParentControl=11 }
    { 143 ;CheckBox     ;12980;2200 ;440  ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 ShowCaption=No;
                                                 SourceExpr="Block Payment Tolerance";
                                                 OnValidate=BEGIN
                                                              IF "Block Payment Tolerance" THEN BEGIN
                                                                IF CONFIRM(Text002,FALSE) THEN
                                                                  PaymentToleranceMgt.DelTolCustLedgEntry(Rec);
                                                              END ELSE BEGIN
                                                                IF CONFIRM(Text001,FALSE) THEN
                                                                  PaymentToleranceMgt.CalcTolCustLedgEntry(Rec);
                                                              END;
                                                            END;
                                                             }
    { 144 ;Label        ;9570 ;2200 ;3300 ;440  ;ParentControl=143 }
    { 1461000;TextBox   ;3850 ;4070 ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Liq. Payment Terms Code" }
    { 1461001;Label     ;440  ;4070 ;3300 ;440  ;ParentControl=1461000 }
    { 123 ;TextBox      ;12980;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Shipping Advice" }
    { 124 ;Label        ;9570 ;990  ;3300 ;440  ;ParentControl=123 }
    { 101 ;TextBox      ;12980;2090 ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Shipping Agent Code" }
    { 102 ;Label        ;9570 ;2090 ;3300 ;440  ;ParentControl=101 }
    { 30  ;TextBox      ;12980;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Shipment Method Code" }
    { 31  ;Label        ;9570 ;1540 ;3300 ;440  ;ParentControl=30 }
    { 95  ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Location Code" }
    { 96  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=95 }
    { 32  ;CheckBox     ;3850 ;1650 ;440  ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 ShowCaption=No;
                                                 SourceExpr="Combine Shipments" }
    { 33  ;Label        ;440  ;1650 ;3300 ;440  ;ParentControl=32 }
    { 158 ;TextBox      ;3850 ;2310 ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr=Reserve }
    { 159 ;Label        ;440  ;2310 ;3300 ;440  ;ParentControl=158 }
    { 119 ;TextBox      ;12980;3190 ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Shipping Time" }
    { 120 ;Label        ;9570 ;3190 ;3300 ;440  ;ParentControl=119 }
    { 131 ;TextBox      ;12980;2640 ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Shipping Agent Service Code" }
    { 132 ;Label        ;9790 ;2640 ;3080 ;440  ;ParentControl=131 }
    { 141 ;TextBox      ;12980;3740 ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 DrillDown=No;
                                                 SourceExpr="Base Calendar Code" }
    { 142 ;Label        ;9570 ;3740 ;3300 ;440  ;ParentControl=141 }
    { 146 ;TextBox      ;12980;4290 ;1700 ;440  ;Name=Customized Calendar;
                                                 Editable=No;
                                                 ParentControl=1;
                                                 InPage=4;
                                                 CaptionML=[DEU=Spezifischer Kalender;
                                                            ENU=Customized Calendar];
                                                 SourceExpr=CalendarMgmt.CustomizedCalendarExistText(CustomizedCalendar."Source Type"::Customer,"No.",'',"Base Calendar Code");
                                                 OnDrillDown=BEGIN
                                                               CurrForm.SAVERECORD;
                                                               TESTFIELD("Base Calendar Code");
                                                               CalendarMgmt.ShowCustomizedCalendar(CustomizedCalEntry."Source Type"::Customer,"No.",'',"Base Calendar Code");
                                                             END;
                                                              }
    { 145 ;Label        ;9790 ;4290 ;3080 ;440  ;ParentControl=146;
                                                 InPage=4 }
    { 66  ;TextBox      ;3850 ;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=5;
                                                 SourceExpr="Language Code" }
    { 62  ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=66 }
    { 67  ;TextBox      ;3850 ;990  ;1650 ;440  ;ParentControl=1;
                                                 InPage=5;
                                                 SourceExpr="Currency Code" }
    { 63  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=67 }
    { 69  ;TextBox      ;12980;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=5;
                                                 SourceExpr="VAT Registration No." }
    { 68  ;Label        ;9570 ;990  ;3300 ;440  ;ParentControl=69 }
    { 72  ;CommandButton;1650 ;7260 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Default=Yes;
                                                 PushAction=LookupOK;
                                                 InvalidActionAppearance=Hide }
    { 73  ;CommandButton;4070 ;7260 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Cancel=Yes;
                                                 PushAction=LookupCancel;
                                                 InvalidActionAppearance=Hide }
    { 74  ;MenuButton   ;6490 ;7260 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=D&ebitor;
                                                            ENU=&Customer];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=75;
                                                     PushAction=LookupTable;
                                                     ShortCutKey=F5;
                                                     CaptionML=[DEU=öbersicht;
                                                                ENU=List] }
                                                   { ID=80;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Strg+F5;
                                                     CaptionML=[DEU=&Posten;
                                                                ENU=Ledger E&ntries];
                                                     RunObject=Form 25;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Customer No.);
                                                     RunFormLink=Customer No.=FIELD(No.) }
                                                   { ID=134;
                                                     CaptionML=[DEU=Verkaufs&historie;
                                                                ENU=Sales &History] }
                                                   { ID=135;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Verwendet al&s Verkauf an Debitor;
                                                                ENU=Used as &Sell-to Customer];
                                                     OnPush=BEGIN
                                                              SalesInfoPaneMgt.LookupCustHistory("No.",FALSE);
                                                            END;
                                                             }
                                                   { ID=139;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Verwendet als Rechnung an De&bitor;
                                                                ENU=Used as &Bill-to Customer];
                                                     OnPush=BEGIN
                                                              SalesInfoPaneMgt.LookupCustHistory("No.",TRUE);
                                                            END;
                                                             }
                                                   { ID=151;
                                                     CaptionML=[DEU=Registrierte Belege;
                                                                ENU=Issued Documents] }
                                                   { ID=152;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Registrierte &Mahnungen;
                                                                ENU=Issued &Reminders];
                                                     RunObject=Form 438;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Customer No.,Posting Date);
                                                     RunFormLink=Customer No.=FIELD(No.) }
                                                   { ID=153;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Registrierte &Zinsrechnungen;
                                                                ENU=Issued &Finance Charge Memos];
                                                     RunObject=Form 450;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Customer No.,Posting Date);
                                                     RunFormLink=Customer No.=FIELD(No.) }
                                                   { ID=78;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Be&merkungen;
                                                                ENU=Co&mments];
                                                     RunObject=Form 124;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Table Name=CONST(Customer),
                                                                 No.=FIELD(No.) }
                                                   { ID=84;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Umschalt+Strg+D;
                                                     CaptionML=[DEU=Dimensionen;
                                                                ENU=Dimensions];
                                                     RunObject=Form 540;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Table ID=CONST(18),
                                                                 No.=FIELD(No.) }
                                                   { ID=99;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Bankk&onten;
                                                                ENU=Bank Accounts];
                                                     RunObject=Form 423;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Customer No.=FIELD(No.) }
                                                   { ID=81;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=&Lief. an Adressen;
                                                                ENU=Ship-&to Addresses];
                                                     RunObject=Form 300;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Customer No.=FIELD(No.) }
                                                   { ID=14;
                                                     CaptionML=[DEU=Ko&ntakt;
                                                                ENU=C&ontact];
                                                     OnPush=BEGIN
                                                              ShowContact;
                                                            END;
                                                             }
                                                   { ID=100;
                                                     MenuItemType=Separator }
                                                   { ID=76;
                                                     PushAction=RunObject;
                                                     ShortCutKey=F9;
                                                     CaptionML=[DEU=Statistik;
                                                                ENU=Statistics];
                                                     RunObject=Form 151;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.),
                                                                 Date Filter=FIELD(Date Filter),
                                                                 Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                                                 Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
                                                   { ID=112;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Statistik nach &WÑhrungen;
                                                                ENU=Statistics by C&urrencies];
                                                     RunObject=Form 481;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.),
                                                                 Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                                                 Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),
                                                                 Date Filter=FIELD(Date Filter) }
                                                   { ID=77;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Buchungsstatistik;
                                                                ENU=Entry Statistics];
                                                     RunObject=Form 302;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.),
                                                                 Date Filter=FIELD(Date Filter),
                                                                 Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                                                 Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
                                                   { ID=79;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=&Verkauf;
                                                                ENU=S&ales];
                                                     RunObject=Form 155;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.),
                                                                 Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                                                 Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
                                                   { ID=115;
                                                     MenuItemType=Separator;
                                                     CaptionML=[DEU="";
                                                                ENU=""] }
                                                   { ID=94;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Re&ferenzen;
                                                                ENU=Cross Re&ferences];
                                                     RunObject=Form 5723;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Cross-Reference Type,Cross-Reference Type No.);
                                                     RunFormLink=Cross-Reference Type=CONST(Customer),
                                                                 Cross-Reference Type No.=FIELD(No.) }
                                                   { ID=125;
                                                     MenuItemType=Separator;
                                                     CaptionML=[DEU="";
                                                                ENU=""] }
                                                   { ID=126;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=S&ervicevertrÑge;
                                                                ENU=Ser&vice Contracts];
                                                     RunObject=Form 6065;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Customer No.,Ship-to Code);
                                                     RunFormLink=Customer No.=FIELD(No.) }
                                                   { ID=127;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Service&artikel;
                                                                ENU=Service &Items];
                                                     RunObject=Form 5988;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Customer No.,Ship-to Code,Item No.,Serial No.);
                                                     RunFormLink=Customer No.=FIELD(No.) }
                                                   { ID=138;
                                                     MenuItemType=Separator }
                                                   { ID=147;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Proje&kte;
                                                                ENU=&Jobs];
                                                     RunObject=Form 88;
                                                     RunFormView=SORTING(Bill-to Customer No.);
                                                     RunFormLink=Bill-to Customer No.=FIELD(No.) }
                                                   { ID=117;
                                                     MenuItemType=Separator }
                                                   { ID=118;
                                                     CaptionML=[DEU=Online Map;
                                                                ENU=Online Map];
                                                     OnPush=BEGIN
                                                              DisplayMap;
                                                            END;
                                                             }
                                                   { ID=140;
                                                     MenuItemType=Separator }
                                                   { ID=149;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=K&reditkarten;
                                                                ENU=C&redit Cards];
                                                     RunObject=Form 827;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Customer No.=FIELD(No.) }
                                                   { ID=165;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Transaktionspro&tokolleintrÑge fÅr Kreditkarten;
                                                                ENU=Credit Cards Transaction Lo&g Entries];
                                                     RunObject=Form 829;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Customer No.=FIELD(No.) }
                                                 }
                                                  }
    { 82  ;MenuButton   ;8910 ;7260 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=&Verkauf;
                                                            ENU=S&ales];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=83;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=&Rechnungsrabatte;
                                                                ENU=Invoice &Discounts];
                                                     RunObject=Form 23;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Code=FIELD(Invoice Disc. Code) }
                                                   { ID=113;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Preise;
                                                                ENU=Prices];
                                                     RunObject=Form 7002;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Sales Type,Sales Code);
                                                     RunFormLink=Sales Type=CONST(Customer),
                                                                 Sales Code=FIELD(No.) }
                                                   { ID=136;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Zeilenrabatte;
                                                                ENU=Line Discounts];
                                                     RunObject=Form 7004;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Sales Type,Sales Code);
                                                     RunFormLink=Sales Type=CONST(Customer),
                                                                 Sales Code=FIELD(No.) }
                                                   { ID=162;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=&VorauszahlungsprozentsÑtze;
                                                                ENU=Prepa&yment Percentages];
                                                     RunObject=Form 664;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Sales Type,Sales Code);
                                                     RunFormLink=Sales Type=CONST(Customer),
                                                                 Sales Code=FIELD(No.) }
                                                   { ID=148;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=S&td.-Debitorverkaufscodes;
                                                                ENU=S&td. Cust. Sales Codes];
                                                     RunObject=Form 173;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Customer No.=FIELD(No.) }
                                                   { ID=137;
                                                     MenuItemType=Separator }
                                                   { ID=85;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Angebote;
                                                                ENU=Quotes];
                                                     RunObject=Form 41;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Document Type,Sell-to Customer No.,No.);
                                                     RunFormLink=Sell-to Customer No.=FIELD(No.) }
                                                   { ID=114;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Ra&hmenauftrÑge;
                                                                ENU=Blanket Orders];
                                                     RunObject=Form 507;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Document Type,Sell-to Customer No.);
                                                     RunFormLink=Sell-to Customer No.=FIELD(No.) }
                                                   { ID=86;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=A&uftrÑge;
                                                                ENU=Orders];
                                                     RunObject=Form 42;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Document Type,Sell-to Customer No.,No.);
                                                     RunFormLink=Sell-to Customer No.=FIELD(No.) }
                                                   { ID=121;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Rekla&mationen;
                                                                ENU=Return Orders];
                                                     RunObject=Form 6630;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Document Type,Sell-to Customer No.,No.);
                                                     RunFormLink=Sell-to Customer No.=FIELD(No.) }
                                                   { ID=128;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=ServiceauftrÑge;
                                                                ENU=Service Orders];
                                                     RunObject=Form 5900;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Document Type,Customer No.);
                                                     RunFormLink=Customer No.=FIELD(No.) }
                                                   { ID=6500;
                                                     CaptionML=[DEU=Artikel&verfolgungsposten;
                                                                ENU=Item &Tracking Entries];
                                                     RunFormLinkType=OnUpdate;
                                                     OnPush=VAR
                                                              ItemTrackingMgt@1000 : Codeunit 6500;
                                                            BEGIN
                                                              ItemTrackingMgt.CallItemTrackingEntryForm(1,"No.",'','','','','');
                                                            END;
                                                             }
                                                 }
                                                  }
    { 87  ;CommandButton;13750;7260 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 163 ;MenuButton   ;11330;7260 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=F&unktionen;
                                                            ENU=F&unctions];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=167;
                                                     Ellipsis=Yes;
                                                     CaptionML=[DEU=Vorlage anwenden;
                                                                ENU=Apply Template];
                                                     OnPush=VAR
                                                              TemplateMgt@1000 : Codeunit 8612;
                                                              RecRef@1001 : RecordRef;
                                                            BEGIN
                                                              RecRef.GETTABLE(Rec);
                                                              TemplateMgt.UpdateFromTemplateSelection(RecRef);
                                                            END;
                                                             }
                                                 }
                                                  }
  }
  CODE
  {
    VAR
      CustomizedCalEntry@1001 : Record 7603;
      Text001@1003 : TextConst 'DEU=Mîchten Sie Zahlungstoleranzen fÅr momentan offene Posten zulassen?;ENU=Do you want to allow payment tolerance for entries that are currently open?';
      CustomizedCalendar@1005 : Record 7602;
      Text002@1006 : TextConst 'DEU=Mîchten Sie Zahlungstoleranzen fÅr momentan offene Posten lîschen?;ENU=Do you want to remove payment tolerance from entries that are currently open?';
      CalendarMgmt@1002 : Codeunit 7600;
      PaymentToleranceMgt@1000 : Codeunit 426;
      SalesInfoPaneMgt@1004 : Codeunit 7171;
      Text003@1102601000 : TextConst 'DEU=Der Debitor ''%1'' ist nicht vorhanden.;ENU=The customer %1 does not exist.';
      "*** activeTAPI ***"@1113900000 : Integer;
      TAPIFu@1113900001 : Codeunit 56780;

    PROCEDURE ActivateFields@3();
    BEGIN
      CurrForm.Contact.EDITABLE("Primary Contact No." = '');
    END;

    BEGIN
    {
      AT01 actTAPI 04.06.2003  New Dial function
                               Global Var TAPIFu CU 56780
                               Call in OnPush-Trigger of every Phone-No. Bitmap (2x)
      AT2011       05.04.2011  Anpassung an R2
    }
    END.
  }
}

OBJECT Form 22 Customer List
{
  OBJECT-PROPERTIES
  {
    Date=17.03.11;
    Time=19:18:53;
    Modified=Yes;
    Version List=NAVW16.00.10,AT4.00;
  }
  PROPERTIES
  {
    Width=16500;
    Height=6710;
    Editable=No;
    CaptionML=[DEU=DebitorenÅbersicht;
               ENU=Customer List];
    TableBoxID=1;
    SourceTable=Table18;
  }
  CONTROLS
  {
    { 1   ;TableBox     ;220  ;220  ;16060;5500 ;HorzGlue=Both;
                                                 VertGlue=Both }
    { 2   ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="No." }
    { 3   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=2;
                                                 InColumnHeading=Yes }
    { 4   ;TextBox      ;0    ;0    ;4400 ;0    ;HorzGlue=Both;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Name }
    { 5   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=4;
                                                 InColumnHeading=Yes }
    { 40  ;TextBox      ;5424 ;440  ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Responsibility Center" }
    { 41  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=40;
                                                 InColumnHeading=Yes }
    { 43  ;TextBox      ;7038 ;440  ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Location Code" }
    { 64  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=43;
                                                 InColumnHeading=Yes }
    { 54  ;TextBox      ;5636 ;550  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Post Code" }
    { 55  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=54;
                                                 InColumnHeading=Yes }
    { 30  ;TextBox      ;5450 ;660  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Country/Region Code" }
    { 31  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=30;
                                                 InColumnHeading=Yes }
    { 6   ;TextBox      ;0    ;0    ;2200 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Phone No." }
    { 7   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=6;
                                                 InColumnHeading=Yes }
    { 32  ;TextBox      ;9974 ;660  ;2200 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Fax No." }
    { 33  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=32;
                                                 InColumnHeading=Yes }
    { 79  ;TextBox      ;15822;440  ;1700 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="IC Partner Code" }
    { 80  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=79;
                                                 InColumnHeading=Yes }
    { 34  ;TextBox      ;11589;770  ;4400 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Contact }
    { 35  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=34;
                                                 InColumnHeading=Yes }
    { 36  ;TextBox      ;16060;660  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Salesperson Code" }
    { 37  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=36;
                                                 InColumnHeading=Yes }
    { 38  ;TextBox      ;17701;770  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Customer Posting Group" }
    { 39  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=38;
                                                 InColumnHeading=Yes }
    { 56  ;TextBox      ;10822;770  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Gen. Bus. Posting Group" }
    { 57  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=56;
                                                 InColumnHeading=Yes }
    { 52  ;TextBox      ;13203;440  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="VAT Bus. Posting Group" }
    { 53  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=52;
                                                 InColumnHeading=Yes }
    { 46  ;TextBox      ;22754;770  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Customer Price Group" }
    { 47  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=46;
                                                 InColumnHeading=Yes }
    { 72  ;TextBox      ;29501;1320 ;1700 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Customer Disc. Group" }
    { 73  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=72;
                                                 InColumnHeading=Yes }
    { 8   ;TextBox      ;0    ;0    ;1650 ;0    ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Payment Terms Code" }
    { 9   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=8;
                                                 InColumnHeading=Yes }
    { 61  ;TextBox      ;8678 ;330  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Reminder Terms Code" }
    { 62  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=61;
                                                 InColumnHeading=Yes }
    { 48  ;TextBox      ;25982;660  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Fin. Charge Terms Code" }
    { 49  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=48;
                                                 InColumnHeading=Yes }
    { 10  ;TextBox      ;0    ;0    ;1100 ;0    ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Currency Code" }
    { 11  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=10;
                                                 InColumnHeading=Yes }
    { 50  ;TextBox      ;29157;660  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Language Code" }
    { 51  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=50;
                                                 InColumnHeading=Yes }
    { 12  ;TextBox      ;36433;770  ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Search Name" }
    { 13  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=12;
                                                 InColumnHeading=Yes }
    { 1102601000;TextBox;42609;440  ;2200 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Credit Limit (LCY)" }
    { 1102601001;Label  ;0    ;0    ;0    ;0    ;ParentControl=1102601000;
                                                 InColumnHeading=Yes }
    { 1102601002;TextBox;44937;330  ;550  ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Blocked }
    { 1102601003;Label  ;0    ;0    ;0    ;0    ;ParentControl=1102601002;
                                                 InColumnHeading=Yes }
    { 1102601004;TextBox;45445;330  ;1700 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Last Date Modified" }
    { 1102601005;Label  ;0    ;0    ;0    ;0    ;ParentControl=1102601004;
                                                 InColumnHeading=Yes }
    { 1102601006;TextBox;47011;440  ;550  ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Application Method" }
    { 1102601007;Label  ;0    ;0    ;0    ;0    ;ParentControl=1102601006;
                                                 InColumnHeading=Yes }
    { 1102601008;CheckBox;47646;330 ;1700 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr="Combine Shipments" }
    { 1102601009;Label  ;0    ;0    ;0    ;0    ;ParentControl=1102601008;
                                                 InColumnHeading=Yes }
    { 1102601010;TextBox;49276;440  ;550  ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Reserve }
    { 1102601011;Label  ;0    ;0    ;0    ;0    ;ParentControl=1102601010;
                                                 InColumnHeading=Yes }
    { 1102601012;TextBox;49805;440  ;550  ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Shipping Advice" }
    { 1102601013;Label  ;0    ;0    ;0    ;0    ;ParentControl=1102601012;
                                                 InColumnHeading=Yes }
    { 1102601014;TextBox;50355;550  ;1700 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Shipping Agent Code" }
    { 1102601015;Label  ;0    ;0    ;0    ;0    ;ParentControl=1102601014;
                                                 InColumnHeading=Yes }
    { 1102601016;TextBox;52197;440  ;1700 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Base Calendar Code" }
    { 1102601017;Label  ;0    ;0    ;0    ;0    ;ParentControl=1102601016;
                                                 InColumnHeading=Yes }
    { 14  ;CommandButton;1980 ;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Default=Yes;
                                                 PushAction=LookupOK;
                                                 InvalidActionAppearance=Hide }
    { 15  ;CommandButton;4400 ;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Cancel=Yes;
                                                 PushAction=LookupCancel;
                                                 InvalidActionAppearance=Hide }
    { 16  ;MenuButton   ;9240 ;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=D&ebitor;
                                                            ENU=&Customer];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=17;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Umschalt+F5;
                                                     CaptionML=[DEU=Karte;
                                                                ENU=Card];
                                                     RunObject=Form 21;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.),
                                                                 Date Filter=FIELD(Date Filter),
                                                                 Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                                                 Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
                                                   { ID=22;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Strg+F5;
                                                     CaptionML=[DEU=&Posten;
                                                                ENU=Ledger E&ntries];
                                                     RunObject=Form 25;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Customer No.);
                                                     RunFormLink=Customer No.=FIELD(No.) }
                                                   { ID=76;
                                                     CaptionML=[DEU=Registrierte Belege;
                                                                ENU=Issued Documents] }
                                                   { ID=77;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Registrierte &Mahnungen;
                                                                ENU=Issued &Reminders];
                                                     RunObject=Form 438;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Customer No.,Posting Date);
                                                     RunFormLink=Customer No.=FIELD(No.) }
                                                   { ID=78;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Registrierte &Zinsrechnungen;
                                                                ENU=Issued &Finance Charge Memos];
                                                     RunObject=Form 450;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Customer No.,Posting Date);
                                                     RunFormLink=Customer No.=FIELD(No.) }
                                                   { ID=20;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Be&merkungen;
                                                                ENU=Co&mments];
                                                     RunObject=Form 124;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Table Name=CONST(Customer),
                                                                 No.=FIELD(No.) }
                                                   { ID=66;
                                                     CaptionML=[DEU=Dimensionen;
                                                                ENU=Dimensions] }
                                                   { ID=84;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Umschalt+Strg+D;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Zuordnung fÅr &aktuellen Datensatz;
                                                                ENU=Dimensions-Single];
                                                     RunObject=Form 540;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Table ID=CONST(18),
                                                                 No.=FIELD(No.) }
                                                   { ID=42;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Zuordnung fÅr &markierte DatensÑtze;
                                                                ENU=Dimensions-&Multiple];
                                                     OnPush=VAR
                                                              Cust@1001 : Record 18;
                                                              DefaultDimMultiple@1002 : Form 542;
                                                            BEGIN
                                                              CurrForm.SETSELECTIONFILTER(Cust);
                                                              DefaultDimMultiple.SetMultiCust(Cust);
                                                              DefaultDimMultiple.RUNMODAL;
                                                            END;
                                                             }
                                                   { ID=58;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Bankk&onten;
                                                                ENU=Bank Accounts];
                                                     RunObject=Form 423;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Customer No.=FIELD(No.) }
                                                   { ID=23;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=L&ief. an Adressen;
                                                                ENU=Ship-&to Addresses];
                                                     RunObject=Form 300;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Customer No.=FIELD(No.) }
                                                   { ID=60;
                                                     CaptionML=[DEU=Ko&ntakt;
                                                                ENU=C&ontact];
                                                     OnPush=BEGIN
                                                              ShowContact;
                                                            END;
                                                             }
                                                   { ID=59;
                                                     MenuItemType=Separator }
                                                   { ID=18;
                                                     PushAction=RunObject;
                                                     ShortCutKey=F9;
                                                     CaptionML=[DEU=Statistik;
                                                                ENU=Statistics];
                                                     RunObject=Form 151;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.),
                                                                 Date Filter=FIELD(Date Filter),
                                                                 Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                                                 Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
                                                   { ID=63;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Statistik nach &WÑhrungen;
                                                                ENU=Statistics by C&urrencies];
                                                     RunObject=Form 481;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.),
                                                                 Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                                                 Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),
                                                                 Date Filter=FIELD(Date Filter) }
                                                   { ID=19;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Buchungsstatistik;
                                                                ENU=Entry Statistics];
                                                     RunObject=Form 302;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.),
                                                                 Date Filter=FIELD(Date Filter),
                                                                 Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                                                 Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
                                                   { ID=21;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=&Verkauf;
                                                                ENU=S&ales];
                                                     RunObject=Form 155;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.),
                                                                 Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                                                 Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
                                                   { ID=44;
                                                     MenuItemType=Separator }
                                                   { ID=45;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Re&ferenzen;
                                                                ENU=Cross Re&ferences];
                                                     RunObject=Form 5723;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Cross-Reference Type,Cross-Reference Type No.);
                                                     RunFormLink=Cross-Reference Type=CONST(Customer),
                                                                 Cross-Reference Type No.=FIELD(No.) }
                                                   { ID=67;
                                                     MenuItemType=Separator }
                                                   { ID=68;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=S&ervicevertrÑge;
                                                                ENU=Ser&vice Contracts];
                                                     RunObject=Form 6065;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Customer No.,Ship-to Code);
                                                     RunFormLink=Customer No.=FIELD(No.) }
                                                   { ID=69;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Service&artikel;
                                                                ENU=Service &Items];
                                                     RunObject=Form 5988;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Customer No.,Ship-to Code,Item No.,Serial No.);
                                                     RunFormLink=Customer No.=FIELD(No.) }
                                                   { ID=83;
                                                     MenuItemType=Separator }
                                                   { ID=85;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=K&reditkarten;
                                                                ENU=C&redit Cards];
                                                     RunObject=Form 827;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Customer No.=FIELD(No.) }
                                                   { ID=86;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Transaktionspro&tokolleintrÑge fÅr Kreditkarten;
                                                                ENU=Credit Cards Transaction Lo&g Entries];
                                                     RunObject=Form 829;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Customer No.=FIELD(No.) }
                                                 }
                                                  }
    { 24  ;MenuButton   ;11660;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=&Verkauf;
                                                            ENU=S&ales];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=25;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=&Rechnungsrabatte;
                                                                ENU=Invoice &Discounts];
                                                     RunObject=Form 23;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Code=FIELD(Invoice Disc. Code) }
                                                   { ID=26;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Preise;
                                                                ENU=Prices];
                                                     RunObject=Form 7002;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Sales Type,Sales Code);
                                                     RunFormLink=Sales Type=CONST(Customer),
                                                                 Sales Code=FIELD(No.) }
                                                   { ID=71;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Zeilenrabatte;
                                                                ENU=Line Discounts];
                                                     RunObject=Form 7004;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Sales Type,Sales Code);
                                                     RunFormLink=Sales Type=CONST(Customer),
                                                                 Sales Code=FIELD(No.) }
                                                   { ID=82;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=&VorauszahlungsprozentsÑtze;
                                                                ENU=Prepa&yment Percentages];
                                                     RunObject=Form 664;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Sales Type,Sales Code);
                                                     RunFormLink=Sales Type=CONST(Customer),
                                                                 Sales Code=FIELD(No.) }
                                                   { ID=75;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=S&td.-Debitorverkaufscodes;
                                                                ENU=S&td. Cust. Sales Codes];
                                                     RunObject=Form 173;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Customer No.=FIELD(No.) }
                                                   { ID=74;
                                                     MenuItemType=Separator }
                                                   { ID=27;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=A&ngebote;
                                                                ENU=Quotes];
                                                     RunObject=Form 41;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Sell-to Customer No.);
                                                     RunFormLink=Sell-to Customer No.=FIELD(No.) }
                                                   { ID=65;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Ra&hmenauftrÑge;
                                                                ENU=Blanket Orders];
                                                     RunObject=Form 507;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Document Type,Sell-to Customer No.);
                                                     RunFormLink=Sell-to Customer No.=FIELD(No.) }
                                                   { ID=28;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=A&uftrÑge;
                                                                ENU=Orders];
                                                     RunObject=Form 42;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Sell-to Customer No.);
                                                     RunFormLink=Sell-to Customer No.=FIELD(No.) }
                                                   { ID=70;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Rekla&mationen;
                                                                ENU=Return Orders];
                                                     RunObject=Form 6630;
                                                     RunFormLinkType=OnUpdate }
                                                   { ID=81;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=ServiceauftrÑge;
                                                                ENU=Service Orders];
                                                     RunObject=Form 5900;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Document Type,Customer No.);
                                                     RunFormLink=Customer No.=FIELD(No.) }
                                                   { ID=6500;
                                                     CaptionML=[DEU=Artikel&verfolgungsposten;
                                                                ENU=Item &Tracking Entries];
                                                     RunFormLinkType=OnUpdate;
                                                     OnPush=VAR
                                                              ItemTrackingMgt@1001 : Codeunit 6500;
                                                            BEGIN
                                                              ItemTrackingMgt.CallItemTrackingEntryForm(1,"No.",'','','','','');
                                                            END;
                                                             }
                                                 }
                                                  }
    { 29  ;CommandButton;14080;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 1113900000;CommandButton;6820;5940;2200;550;
                                                 HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=&Anrufen;
                                                            ENU=&Dial];
                                                 OnPush=BEGIN
                                                          // AT04.00 BEGIN
                                                          TAPIFu.Dial(18, "No.", '', 0);
                                                          // AT04.00 END
                                                        END;
                                                         }
  }
  CODE
  {
    VAR
      "*** activeTAPI ***"@1113900000 : Integer;
      TAPIFu@1113900001 : Codeunit 56780;

    PROCEDURE GetSelectionFilter@2() : Code[80];
    VAR
      Cust@1000 : Record 18;
      FirstCust@1001 : Code[30];
      LastCust@1002 : Code[30];
      SelectionFilter@1003 : Code[250];
      CustCount@1004 : Integer;
      More@1005 : Boolean;
    BEGIN
      CurrForm.SETSELECTIONFILTER(Cust);
      CustCount := Cust.COUNT;
      IF CustCount > 0 THEN BEGIN
        Cust.FIND('-');
        WHILE CustCount > 0 DO BEGIN
          CustCount := CustCount - 1;
          Cust.MARKEDONLY(FALSE);
          FirstCust := Cust."No.";
          LastCust := FirstCust;
          More := (CustCount > 0);
          WHILE More DO
            IF Cust.NEXT = 0 THEN
              More := FALSE
            ELSE
              IF NOT Cust.MARK THEN
                More := FALSE
              ELSE BEGIN
                LastCust := Cust."No.";
                CustCount := CustCount - 1;
                IF CustCount = 0 THEN
                  More := FALSE;
              END;
          IF SelectionFilter <> '' THEN
            SelectionFilter := SelectionFilter + '|';
          IF FirstCust = LastCust THEN
            SelectionFilter := SelectionFilter + FirstCust
          ELSE
            SelectionFilter := SelectionFilter + FirstCust + '..' + LastCust;
          IF CustCount > 0 THEN BEGIN
            Cust.MARKEDONLY(TRUE);
            Cust.NEXT;
          END;
        END;
      END;
      EXIT(SelectionFilter);
    END;

    PROCEDURE SetSelection@1(VAR Cust@1000 : Record 18);
    BEGIN
      CurrForm.SETSELECTIONFILTER(Cust);
    END;

    BEGIN
    {
      AT04.00    04.11.2005  Button for dialing out of the List
                             Global Var TAPIFu CU 56780 TAPI Functions
    }
    END.
  }
}

OBJECT Form 26 Vendor Card
{
  OBJECT-PROPERTIES
  {
    Date=06.11.09;
    Time=10:00:00;
    Modified=Yes;
    Version List=NAVW16.00.01,LIQEM6.00,NAVDACH5.00.01,AT01;
  }
  PROPERTIES
  {
    Width=16170;
    Height=8030;
    CaptionML=[DEU=Kreditorenkarte;
               ENU=Vendor Card];
    SourceTable=Table23;
    UpdateOnActivate=Yes;
    OnOpenForm=VAR
                 MapMgt@1000 : Codeunit 802;
               BEGIN
                 ActivateFields;
                 IF NOT MapMgt.TestSetup THEN
                   CurrForm.MapPoint.VISIBLE(FALSE);
               END;

    OnFindRecord=VAR
                   RecordFound@1000 : Boolean;
                 BEGIN
                   RecordFound := FIND(Which);
                   IF NOT RecordFound AND (GETFILTER("No.") <> '') THEN
                   BEGIN
                     MESSAGE(Text003,GETFILTER("No."));
                     SETRANGE("No.");
                     RecordFound := FIND(Which);
                   END;
                   EXIT(RecordFound);
                 END;

    OnAfterGetRecord=BEGIN
                       SETRANGE("No.");
                     END;

    OnAfterGetCurrRecord=BEGIN
                           ActivateFields;
                         END;

  }
  CONTROLS
  {
    { 1   ;TabControl   ;220  ;220  ;15730;6820 ;HorzGlue=Both;
                                                 VertGlue=Both;
                                                 PageNamesML=[DEU=Allgemein,Kommunikation,Fakturierung,Zahlung,Lieferung,Au·enhandel;
                                                              ENU=General,Communication,Invoicing,Payments,Receiving,Foreign Trade] }
    { 2   ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="No.";
                                                 OnAssistEdit=BEGIN
                                                                IF AssistEdit(xRec) THEN
                                                                  CurrForm.UPDATE;
                                                              END;
                                                               }
    { 3   ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=2;
                                                 InPage=0 }
    { 77  ;PictureBox   ;6710 ;990  ;440  ;440  ;Focusable=No;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 Border=No;
                                                 BitmapPos=Center;
                                                 BitmapList=7,6;
                                                 SourceExpr=Comment }
    { 78  ;CommandButton;6710 ;990  ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 BackTransparent=Yes;
                                                 PushAction=RunObject;
                                                 ToolTipML=[DEU=Bemerkung;
                                                            ENU=Comment];
                                                 RunObject=Form 124;
                                                 RunFormLinkType=OnUpdate;
                                                 RunFormLink=Table Name=CONST(Vendor),
                                                             No.=FIELD(No.) }
    { 4   ;TextBox      ;3850 ;1650 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=Name }
    { 5   ;Label        ;440  ;1650 ;3300 ;440  ;ParentControl=4;
                                                 InPage=0 }
    { 6   ;TextBox      ;3850 ;2200 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=Address }
    { 7   ;Label        ;440  ;2200 ;3300 ;440  ;ParentControl=6;
                                                 InPage=0 }
    { 8   ;TextBox      ;3850 ;2750 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Address 2" }
    { 9   ;Label        ;440  ;2750 ;3300 ;440  ;ParentControl=8;
                                                 InPage=0 }
    { 12  ;TextBox      ;3850 ;4510 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Phone No." }
    { 13  ;Label        ;440  ;4510 ;3300 ;440  ;ParentControl=12;
                                                 InPage=0 }
    { 16  ;TextBox      ;3850 ;5720 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=Contact;
                                                 OnAfterValidate=BEGIN
                                                                   ActivateFields;
                                                                 END;
                                                                  }
    { 17  ;Label        ;440  ;5720 ;3300 ;440  ;ParentControl=16;
                                                 InPage=0 }
    { 18  ;TextBox      ;12980;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Search Name" }
    { 19  ;Label        ;9570 ;990  ;3300 ;440  ;ParentControl=18;
                                                 InPage=0 }
    { 22  ;TextBox      ;12980;2310 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Purchaser Code" }
    { 23  ;Label        ;9570 ;2310 ;3300 ;440  ;ParentControl=22;
                                                 InPage=0 }
    { 26  ;TextBox      ;12980;3960 ;1650 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Last Date Modified" }
    { 27  ;Label        ;9570 ;3960 ;3300 ;440  ;ParentControl=26;
                                                 InPage=0 }
    { 81  ;TextBox      ;3850 ;3850 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Country/Region Code" }
    { 82  ;Label        ;440  ;3850 ;3300 ;440  ;ParentControl=81 }
    { 10  ;TextBox      ;6710 ;3300 ;2640 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 NextControl=81;
                                                 SourceExpr=City }
    { 79  ;TextBox      ;3850 ;3300 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 NextControl=10;
                                                 SourceExpr="Post Code" }
    { 85  ;Label        ;440  ;3300 ;3300 ;440  ;ParentControl=79;
                                                 CaptionML=[DEU=PLZ-Code/Ort;
                                                            ENU=Post Code/City] }
    { 92  ;TextBox      ;12980;1650 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Balance (LCY)";
                                                 OnDrillDown=VAR
                                                               VendLedgEntry@1001 : Record 25;
                                                               DtldVendLedgEntry@1002 : Record 380;
                                                             BEGIN
                                                               DtldVendLedgEntry.SETRANGE("Vendor No.","No.");
                                                               COPYFILTER("Global Dimension 1 Filter",DtldVendLedgEntry."Initial Entry Global Dim. 1");
                                                               COPYFILTER("Global Dimension 2 Filter",DtldVendLedgEntry."Initial Entry Global Dim. 2");
                                                               COPYFILTER("Currency Filter",DtldVendLedgEntry."Currency Code");
                                                               VendLedgEntry.DrillDownOnEntries(DtldVendLedgEntry);
                                                             END;
                                                              }
    { 93  ;Label        ;9570 ;1650 ;3300 ;440  ;ParentControl=92 }
    { 55  ;TextBox      ;12980;2860 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Responsibility Center" }
    { 80  ;Label        ;9570 ;2860 ;3300 ;440  ;ParentControl=55 }
    { 114 ;TextBox      ;3850 ;5170 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Primary Contact No.";
                                                 OnDeactivate=BEGIN
                                                                ActivateFields;
                                                              END;
                                                               }
    { 115 ;Label        ;440  ;5170 ;3300 ;440  ;ParentControl=114 }
    { 24  ;TextBox      ;12980;3410 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=Blocked }
    { 25  ;Label        ;9570 ;3410 ;3300 ;440  ;ParentControl=24 }
    { 124 ;CommandButton;6710 ;4510 ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 Bitmap=34;
                                                 ToolTipML=[DEU=Telefonverbindung herstellen;
                                                            ENU=Make Phone Call];
                                                 OnPush=VAR
                                                          TAPIManagement@1001 : Codeunit 5053;
                                                        BEGIN
                                                          // AT01 BEGIN
                                                          // Changed / geÑndert
                                                          // ORI BEGIN
                                                          // TAPIManagement.DialContCustVendBank(DATABASE::Vendor,"No.","Phone No.",'');
                                                          // ORI END
                                                          TAPIFu.Dial(23,"No.",'',0);
                                                          // AT01 END
                                                        END;
                                                         }
    { 132 ;CommandButton;6710 ;3850 ;440  ;440  ;Name=MapPoint;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 Bitmap=53;
                                                 ToolTipML=[DEU=Zuordnung anzeigen;
                                                            ENU=Display Map];
                                                 OnPush=BEGIN
                                                          DisplayMap;
                                                        END;
                                                         }
    { 44  ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Phone No." }
    { 46  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=44 }
    { 45  ;TextBox      ;3850 ;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Fax No." }
    { 47  ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=45 }
    { 48  ;TextBox      ;3850 ;2200 ;4950 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="E-Mail" }
    { 49  ;Label        ;440  ;2200 ;3300 ;440  ;ParentControl=48 }
    { 86  ;TextBox      ;3850 ;2750 ;4950 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Home Page" }
    { 88  ;Label        ;440  ;2750 ;3300 ;440  ;ParentControl=86 }
    { 15  ;CommandButton;8910 ;2750 ;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 Bitmap=20;
                                                 ToolTipML=[DEU=Hyperlink;
                                                            ENU=Hyperlink];
                                                 OnPush=BEGIN
                                                          TESTFIELD("Home Page");
                                                          HYPERLINK("Home Page");
                                                        END;
                                                         }
    { 89  ;CommandButton;8910 ;2200 ;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 Bitmap=21;
                                                 ToolTipML=[DEU=Neue Nachricht;
                                                            ENU=New Mail Message];
                                                 OnPush=VAR
                                                          Mail@1001 : Codeunit 397;
                                                        BEGIN
                                                          Mail.MailContCustVendBank(DATABASE::Vendor,"No.","E-Mail");
                                                        END;
                                                         }
    { 98  ;CommandButton;6710 ;990  ;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 Bitmap=34;
                                                 ToolTipML=[DEU=Telefonverbindung herstellen;
                                                            ENU=Make Phone Call];
                                                 OnPush=VAR
                                                          TAPIManagement@1001 : Codeunit 5053;
                                                        BEGIN
                                                          // AT01 BEGIN
                                                          // Changed / geÑndert
                                                          // ORI BEGIN
                                                          // TAPIManagement.DialContCustVendBank(DATABASE::Vendor,"No.","Phone No.",'');
                                                          // ORI END
                                                          TAPIFu.Dial(23,"No.",'',0);
                                                          // AT01 END
                                                        END;
                                                         }
    { 125 ;TextBox      ;3850 ;3410 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="IC Partner Code";
                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 126 ;Label        ;440  ;3410 ;3300 ;440  ;ParentControl=125 }
    { 30  ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Pay-to Vendor No." }
    { 31  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=30 }
    { 32  ;TextBox      ;12980;2200 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Vendor Posting Group" }
    { 33  ;Label        ;9570 ;2200 ;3300 ;440  ;ParentControl=32 }
    { 34  ;TextBox      ;12980;2860 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Invoice Disc. Code" }
    { 35  ;Label        ;9570 ;2860 ;3300 ;440  ;ParentControl=34 }
    { 60  ;TextBox      ;12980;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Gen. Bus. Posting Group" }
    { 61  ;Label        ;9570 ;990  ;3300 ;440  ;ParentControl=60 }
    { 90  ;TextBox      ;12980;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="VAT Bus. Posting Group" }
    { 91  ;Label        ;9570 ;1540 ;3300 ;440  ;ParentControl=90 }
    { 94  ;CheckBox     ;12980;3520 ;440  ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 ShowCaption=No;
                                                 SourceExpr="Prices Including VAT" }
    { 95  ;Label        ;9570 ;3520 ;3300 ;440  ;ParentControl=94 }
    { 127 ;TextBox      ;12980;4180 ;1650 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Prepayment %" }
    { 128 ;Label        ;9570 ;4180 ;3300 ;440  ;ParentControl=127 }
    { 1140000;TextBox   ;12980;4840 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Registration No." }
    { 1140001;Label     ;9570 ;4840 ;3300 ;440  ;ParentControl=1140000 }
    { 36  ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Application Method" }
    { 37  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=36 }
    { 38  ;TextBox      ;3850 ;1650 ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Payment Terms Code" }
    { 39  ;Label        ;440  ;1650 ;3300 ;440  ;ParentControl=38 }
    { 42  ;TextBox      ;3850 ;2860 ;1650 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr=Priority }
    { 43  ;Label        ;440  ;2860 ;3300 ;440  ;ParentControl=42 }
    { 50  ;TextBox      ;12980;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Our Account No." }
    { 51  ;Label        ;9570 ;990  ;3300 ;440  ;ParentControl=50 }
    { 40  ;TextBox      ;3850 ;2200 ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Payment Method Code" }
    { 41  ;Label        ;440  ;2200 ;3300 ;440  ;ParentControl=40 }
    { 119 ;CheckBox     ;12980;1650 ;440  ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 ShowCaption=No;
                                                 SourceExpr="Block Payment Tolerance";
                                                 OnValidate=BEGIN
                                                              IF "Block Payment Tolerance" THEN BEGIN
                                                                IF CONFIRM(Text002,FALSE) THEN
                                                                  PaymentToleranceMgt.DelTolVendLedgEntry(Rec);
                                                              END ELSE BEGIN
                                                                IF CONFIRM(Text001,FALSE) THEN
                                                                  PaymentToleranceMgt.CalcTolVendLedgEntry(Rec);
                                                              END;
                                                            END;
                                                             }
    { 120 ;Label        ;9570 ;1650 ;3300 ;440  ;ParentControl=119 }
    { 1461000;TextBox   ;3850 ;3520 ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Liq. Payment Terms Code" }
    { 1461001;Label     ;440  ;3520 ;3300 ;440  ;ParentControl=1461000 }
    { 96  ;TextBox      ;3850 ;2200 ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Lead Time Calculation" }
    { 97  ;Label        ;440  ;2200 ;3300 ;440  ;ParentControl=96 }
    { 28  ;TextBox      ;3850 ;1650 ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Shipment Method Code" }
    { 29  ;Label        ;440  ;1650 ;3300 ;440  ;ParentControl=28 }
    { 100 ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Location Code" }
    { 101 ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=100 }
    { 112 ;TextBox      ;3850 ;2750 ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 DrillDown=No;
                                                 SourceExpr="Base Calendar Code" }
    { 113 ;Label        ;440  ;2750 ;3300 ;440  ;ParentControl=112 }
    { 121 ;TextBox      ;3850 ;3300 ;1700 ;440  ;Name=Customized Calendar;
                                                 Editable=No;
                                                 ParentControl=1;
                                                 InPage=4;
                                                 CaptionML=[DEU=Spezifischer Kalender;
                                                            ENU=Customized Calendar];
                                                 SourceExpr=CalendarMgmt.CustomizedCalendarExistText(CustomizedCalendar."Source Type"::Vendor,"No.",'',"Base Calendar Code");
                                                 OnDrillDown=BEGIN
                                                               CurrForm.SAVERECORD;
                                                               TESTFIELD("Base Calendar Code");
                                                               CalendarMgmt.ShowCustomizedCalendar(CustomizedCalEntry."Source Type"::Vendor,"No.",'',"Base Calendar Code");
                                                             END;
                                                              }
    { 122 ;Label        ;660  ;3300 ;3080 ;440  ;ParentControl=121;
                                                 InPage=4 }
    { 1140005;TextBox   ;12980;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Delivery Reminder Terms" }
    { 1140006;Label     ;9570 ;990  ;3300 ;440  ;ParentControl=1140005 }
    { 56  ;TextBox      ;3850 ;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=5;
                                                 SourceExpr="Language Code" }
    { 57  ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=56 }
    { 52  ;TextBox      ;3850 ;990  ;1650 ;440  ;ParentControl=1;
                                                 InPage=5;
                                                 SourceExpr="Currency Code" }
    { 53  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=52 }
    { 58  ;TextBox      ;12980;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=5;
                                                 SourceExpr="VAT Registration No." }
    { 59  ;Label        ;9570 ;990  ;3300 ;440  ;ParentControl=58 }
    { 62  ;CommandButton;1650 ;7260 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Default=Yes;
                                                 PushAction=LookupOK;
                                                 InvalidActionAppearance=Hide }
    { 63  ;CommandButton;4070 ;7260 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Cancel=Yes;
                                                 PushAction=LookupCancel;
                                                 InvalidActionAppearance=Hide }
    { 64  ;MenuButton   ;6490 ;7260 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=&Kreditor;
                                                            ENU=Ven&dor];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=65;
                                                     PushAction=LookupTable;
                                                     ShortCutKey=F5;
                                                     CaptionML=[DEU=öbersicht;
                                                                ENU=List];
                                                     RunFormLinkType=OnUpdate }
                                                   { ID=70;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Strg+F5;
                                                     CaptionML=[DEU=&Posten;
                                                                ENU=Ledger E&ntries];
                                                     RunObject=Form 29;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Vendor No.);
                                                     RunFormLink=Vendor No.=FIELD(No.) }
                                                   { ID=103;
                                                     CaptionML=[DEU=Einkaufs&historie;
                                                                ENU=Purchase &History] }
                                                   { ID=104;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Verwendet als &Einkauf von Kreditor;
                                                                ENU=Used as &Buy-from Vendor];
                                                     OnPush=BEGIN
                                                              PurchInfoPaneMgt.LookupVendHistory("No.",FALSE);
                                                            END;
                                                             }
                                                   { ID=105;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Verwendet als &Zahlung an Kreditor;
                                                                ENU=Used as &Pay-to Vendor];
                                                     OnPush=BEGIN
                                                              PurchInfoPaneMgt.LookupVendHistory("No.",TRUE);
                                                            END;
                                                             }
                                                   { ID=68;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Be&merkungen;
                                                                ENU=Co&mments];
                                                     RunObject=Form 124;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Table Name=CONST(Vendor),
                                                                 No.=FIELD(No.) }
                                                   { ID=184;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Umschalt+Strg+D;
                                                     CaptionML=[DEU=Dimensionen;
                                                                ENU=Dimensions];
                                                     RunObject=Form 540;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Table ID=CONST(23),
                                                                 No.=FIELD(No.) }
                                                   { ID=87;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Bankk&onten;
                                                                ENU=Bank Accounts];
                                                     RunObject=Form 425;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Vendor No.=FIELD(No.) }
                                                   { ID=54;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Bestell&adressen;
                                                                ENU=Order &Addresses];
                                                     RunObject=Form 368;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Vendor No.=FIELD(No.) }
                                                   { ID=14;
                                                     CaptionML=[DEU=Ko&ntakt;
                                                                ENU=C&ontact];
                                                     OnPush=BEGIN
                                                              ShowContact;
                                                            END;
                                                             }
                                                   { ID=11;
                                                     MenuItemType=Separator }
                                                   { ID=66;
                                                     PushAction=RunObject;
                                                     ShortCutKey=F9;
                                                     CaptionML=[DEU=Statistik;
                                                                ENU=Statistics];
                                                     RunObject=Form 152;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.),
                                                                 Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                                                 Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
                                                   { ID=20;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Statistik nach &WÑhrungen;
                                                                ENU=Statistics by C&urrencies];
                                                     RunObject=Form 482;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.),
                                                                 Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                                                 Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),
                                                                 Date Filter=FIELD(Date Filter) }
                                                   { ID=67;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Buchungsstatistik;
                                                                ENU=Entry Statistics];
                                                     RunObject=Form 303;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.),
                                                                 Date Filter=FIELD(Date Filter),
                                                                 Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                                                 Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
                                                   { ID=69;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Einkauf;
                                                                ENU=Purchases];
                                                     RunObject=Form 156;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.),
                                                                 Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                                                 Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
                                                   { ID=83;
                                                     MenuItemType=Separator;
                                                     CaptionML=[DEU="";
                                                                ENU=""] }
                                                   { ID=84;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Re&ferenzen;
                                                                ENU=Cross References];
                                                     RunObject=Form 5723;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Cross-Reference Type,Cross-Reference Type No.);
                                                     RunFormLink=Cross-Reference Type=CONST(Vendor),
                                                                 Cross-Reference Type No.=FIELD(No.) }
                                                   { ID=108;
                                                     MenuItemType=Separator }
                                                   { ID=102;
                                                     CaptionML=[DEU=Online Map;
                                                                ENU=Online Map];
                                                     OnPush=BEGIN
                                                              DisplayMap;
                                                            END;
                                                             }
                                                 }
                                                  }
    { 71  ;MenuButton   ;8910 ;7260 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=&Einkauf;
                                                            ENU=&Purchases];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=118;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Arti&kel;
                                                                ENU=Items];
                                                     RunObject=Form 297;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Vendor No.,Item No.);
                                                     RunFormLink=Vendor No.=FIELD(No.) }
                                                   { ID=73;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=&Rechnungsrabatte;
                                                                ENU=Invoice &Discounts];
                                                     RunObject=Form 28;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Code=FIELD(Invoice Disc. Code) }
                                                   { ID=72;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Preise;
                                                                ENU=Prices];
                                                     RunObject=Form 7012;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Vendor No.);
                                                     RunFormLink=Vendor No.=FIELD(No.) }
                                                   { ID=116;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Zeilenrabatte;
                                                                ENU=Line Discounts];
                                                     RunObject=Form 7014;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Vendor No.);
                                                     RunFormLink=Vendor No.=FIELD(No.) }
                                                   { ID=129;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=&VorauszahlungsprozentsÑtze;
                                                                ENU=Prepa&yment Percentages];
                                                     RunObject=Form 665;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Vendor No.);
                                                     RunFormLink=Vendor No.=FIELD(No.) }
                                                   { ID=123;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=S&td.-Kreditoreinkaufscodes;
                                                                ENU=S&td. Vend. Purchase Codes];
                                                     RunObject=Form 178;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Vendor No.=FIELD(No.) }
                                                   { ID=117;
                                                     MenuItemType=Separator }
                                                   { ID=74;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Anfragen;
                                                                ENU=Quotes];
                                                     RunObject=Form 49;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Document Type,Buy-from Vendor No.);
                                                     RunFormLink=Buy-from Vendor No.=FIELD(No.) }
                                                   { ID=21;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Ra&hmenbestellungen;
                                                                ENU=Blanket Orders];
                                                     RunObject=Form 509;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Document Type,Buy-from Vendor No.);
                                                     RunFormLink=Buy-from Vendor No.=FIELD(No.) }
                                                   { ID=75;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Bestellungen;
                                                                ENU=Orders];
                                                     RunObject=Form 50;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Document Type,Buy-from Vendor No.,No.);
                                                     RunFormLink=Buy-from Vendor No.=FIELD(No.) }
                                                   { ID=99;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Rekla&mationen;
                                                                ENU=Return Orders];
                                                     RunObject=Form 6640;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Document Type,Buy-from Vendor No.,No.);
                                                     RunFormLink=Buy-from Vendor No.=FIELD(No.) }
                                                   { ID=6500;
                                                     CaptionML=[DEU=Artikel&verfolgungsposten;
                                                                ENU=Item &Tracking Entries];
                                                     RunFormLinkType=OnUpdate;
                                                     OnPush=VAR
                                                              ItemTrackingMgt@1000 : Codeunit 6500;
                                                            BEGIN
                                                              ItemTrackingMgt.CallItemTrackingEntryForm(2,"No.",'','','','','');
                                                            END;
                                                             }
                                                 }
                                                  }
    { 76  ;CommandButton;13750;7260 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 130 ;MenuButton   ;11330;7260 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=F&unktionen;
                                                            ENU=F&unctions];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=131;
                                                     Ellipsis=Yes;
                                                     CaptionML=[DEU=Vorlage anwenden;
                                                                ENU=Apply Template];
                                                     OnPush=VAR
                                                              TemplateMgt@1000 : Codeunit 8612;
                                                              RecRef@1001 : RecordRef;
                                                            BEGIN
                                                              RecRef.GETTABLE(Rec);
                                                              TemplateMgt.UpdateFromTemplateSelection(RecRef);
                                                            END;
                                                             }
                                                 }
                                                  }
  }
  CODE
  {
    VAR
      CalendarMgmt@1000 : Codeunit 7600;
      PaymentToleranceMgt@1002 : Codeunit 426;
      CustomizedCalEntry@1001 : Record 7603;
      CustomizedCalendar@1003 : Record 7602;
      Text001@1005 : TextConst 'DEU=Mîchten Sie Zahlungstoleranzen fÅr momentan offene Posten zulassen?;ENU=Do you want to allow payment tolerance for entries that are currently open?';
      Text002@1004 : TextConst 'DEU=Mîchten Sie Zahlungstoleranzen fÅr momentan offene Posten lîschen?;ENU=Do you want to remove payment tolerance from entries that are currently open?';
      PurchInfoPaneMgt@1006 : Codeunit 7181;
      Text003@1007 : TextConst 'DEU=Der Kreditor ''%1'' ist nicht vorhanden.;ENU=The vendor %1 does not exist.';
      "**** avtiveTAPI ****"@1000000001 : Integer;
      TAPIFu@1000000000 : Codeunit 56780;

    PROCEDURE ActivateFields@3();
    BEGIN
      CurrForm.Contact.EDITABLE("Primary Contact No." = '');
    END;

    BEGIN
    {
      AT01 actTAPI 04.06.2003  New Dial function
                               Global Var TAPIFu CU 56780
                               Call in the OnPush-Trigger of every Phone-No. Bitmap (2x)
    }
    END.
  }
}

OBJECT Form 27 Vendor List
{
  OBJECT-PROPERTIES
  {
    Date=06.11.09;
    Time=10:00:00;
    Modified=Yes;
    Version List=NAVW16.00.01,AT4.00;
  }
  PROPERTIES
  {
    Width=16500;
    Height=6710;
    Editable=No;
    CaptionML=[DEU=KreditorenÅbersicht;
               ENU=Vendor List];
    TableBoxID=1;
    SourceTable=Table23;
  }
  CONTROLS
  {
    { 1   ;TableBox     ;220  ;220  ;16060;5500 ;HorzGlue=Both;
                                                 VertGlue=Both }
    { 2   ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="No." }
    { 3   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=2;
                                                 InColumnHeading=Yes }
    { 4   ;TextBox      ;0    ;0    ;4400 ;0    ;HorzGlue=Both;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Name }
    { 5   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=4;
                                                 InColumnHeading=Yes }
    { 41  ;TextBox      ;4948 ;440  ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Responsibility Center" }
    { 42  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=41;
                                                 InColumnHeading=Yes }
    { 59  ;TextBox      ;7065 ;330  ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Location Code" }
    { 60  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=59;
                                                 InColumnHeading=Yes }
    { 29  ;TextBox      ;5424 ;660  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Post Code" }
    { 30  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=29;
                                                 InColumnHeading=Yes }
    { 31  ;TextBox      ;7303 ;660  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Country/Region Code" }
    { 32  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=31;
                                                 InColumnHeading=Yes }
    { 6   ;TextBox      ;0    ;0    ;2200 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Phone No." }
    { 7   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=6;
                                                 InColumnHeading=Yes }
    { 33  ;TextBox      ;10848;660  ;2200 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Fax No." }
    { 34  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=33;
                                                 InColumnHeading=Yes }
    { 68  ;TextBox      ;16272;440  ;1700 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="IC Partner Code" }
    { 69  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=68;
                                                 InColumnHeading=Yes }
    { 35  ;TextBox      ;15452;660  ;4400 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Contact }
    { 36  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=35;
                                                 InColumnHeading=Yes }
    { 37  ;TextBox      ;19553;770  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Purchaser Code" }
    { 38  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=37;
                                                 InColumnHeading=Yes }
    { 39  ;TextBox      ;9790 ;660  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Vendor Posting Group" }
    { 40  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=39;
                                                 InColumnHeading=Yes }
    { 51  ;TextBox      ;10822;660  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Gen. Bus. Posting Group" }
    { 52  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=51;
                                                 InColumnHeading=Yes }
    { 49  ;TextBox      ;13362;440  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="VAT Bus. Posting Group" }
    { 50  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=49;
                                                 InColumnHeading=Yes }
    { 8   ;TextBox      ;0    ;0    ;1650 ;0    ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Payment Terms Code" }
    { 9   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=8;
                                                 InColumnHeading=Yes }
    { 45  ;TextBox      ;28099;660  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Fin. Charge Terms Code" }
    { 46  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=45;
                                                 InColumnHeading=Yes }
    { 10  ;TextBox      ;30132;0    ;1100 ;0    ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Currency Code" }
    { 11  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=10;
                                                 InColumnHeading=Yes }
    { 47  ;TextBox      ;30983;660  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Language Code" }
    { 48  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=47;
                                                 InColumnHeading=Yes }
    { 12  ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Search Name" }
    { 13  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=12;
                                                 InColumnHeading=Yes }
    { 1102601000;TextBox;37677;330  ;550  ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Blocked }
    { 1102601001;Label  ;0    ;0    ;0    ;0    ;ParentControl=1102601000;
                                                 InColumnHeading=Yes }
    { 1102601002;TextBox;38142;440  ;1700 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Last Date Modified" }
    { 1102601003;Label  ;0    ;0    ;0    ;0    ;ParentControl=1102601002;
                                                 InColumnHeading=Yes }
    { 1102601004;TextBox;39899;550  ;550  ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Application Method" }
    { 1102601005;Label  ;0    ;0    ;0    ;0    ;ParentControl=1102601004;
                                                 InColumnHeading=Yes }
    { 1102601006;TextBox;40450;440  ;1700 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Location Code" }
    { 1102601007;Label  ;0    ;0    ;0    ;0    ;ParentControl=1102601006;
                                                 InColumnHeading=Yes }
    { 1102601008;TextBox;42228;440  ;1700 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Shipment Method Code" }
    { 1102601009;Label  ;0    ;0    ;0    ;0    ;ParentControl=1102601008;
                                                 InColumnHeading=Yes }
    { 1102601010;TextBox;43815;330  ;1700 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Lead Time Calculation" }
    { 1102601011;Label  ;0    ;0    ;0    ;0    ;ParentControl=1102601010;
                                                 InColumnHeading=Yes }
    { 1102601012;TextBox;45615;440  ;1700 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Base Calendar Code" }
    { 1102601013;Label  ;0    ;0    ;0    ;0    ;ParentControl=1102601012;
                                                 InColumnHeading=Yes }
    { 14  ;CommandButton;1980 ;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Default=Yes;
                                                 PushAction=LookupOK;
                                                 InvalidActionAppearance=Hide }
    { 15  ;CommandButton;4400 ;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Cancel=Yes;
                                                 PushAction=LookupCancel;
                                                 InvalidActionAppearance=Hide }
    { 16  ;MenuButton   ;9240 ;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=&Kreditor;
                                                            ENU=Ven&dor];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=17;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Umschalt+F5;
                                                     CaptionML=[DEU=Karte;
                                                                ENU=Card];
                                                     RunObject=Form 26;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.),
                                                                 Date Filter=FIELD(Date Filter),
                                                                 Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                                                 Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
                                                   { ID=22;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Strg+F5;
                                                     CaptionML=[DEU=&Posten;
                                                                ENU=Ledger E&ntries];
                                                     RunObject=Form 29;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Vendor No.);
                                                     RunFormLink=Vendor No.=FIELD(No.) }
                                                   { ID=20;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Be&merkungen;
                                                                ENU=Co&mments];
                                                     RunObject=Form 124;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Table Name=CONST(Vendor),
                                                                 No.=FIELD(No.) }
                                                   { ID=44;
                                                     CaptionML=[DEU=Dimensionen;
                                                                ENU=Dimensions] }
                                                   { ID=84;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Umschalt+Strg+D;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Zuordnung fÅr &aktuellen Datensatz;
                                                                ENU=Dimensions-Single];
                                                     RunObject=Form 540;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Table ID=CONST(23),
                                                                 No.=FIELD(No.) }
                                                   { ID=43;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Zuordnung fÅr &markierte DatensÑtze;
                                                                ENU=Dimensions-&Multiple];
                                                     OnPush=VAR
                                                              Vend@1001 : Record 23;
                                                              DefaultDimMultiple@1002 : Form 542;
                                                            BEGIN
                                                              CurrForm.SETSELECTIONFILTER(Vend);
                                                              DefaultDimMultiple.SetMultiVendor(Vend);
                                                              DefaultDimMultiple.RUNMODAL;
                                                            END;
                                                             }
                                                   { ID=54;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Bankk&onten;
                                                                ENU=Bank Accounts];
                                                     RunObject=Form 425;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Vendor No.=FIELD(No.) }
                                                   { ID=53;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Bestell&adressen;
                                                                ENU=Order &Addresses];
                                                     RunObject=Form 368;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Vendor No.=FIELD(No.) }
                                                   { ID=56;
                                                     CaptionML=[DEU=Ko&ntakt;
                                                                ENU=C&ontact];
                                                     OnPush=BEGIN
                                                              ShowContact;
                                                            END;
                                                             }
                                                   { ID=55;
                                                     MenuItemType=Separator }
                                                   { ID=18;
                                                     PushAction=RunObject;
                                                     ShortCutKey=F9;
                                                     CaptionML=[DEU=Statistik;
                                                                ENU=Statistics];
                                                     RunObject=Form 152;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.),
                                                                 Date Filter=FIELD(Date Filter),
                                                                 Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                                                 Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
                                                   { ID=57;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Statistik nach &WÑhrungen;
                                                                ENU=Statistics by C&urrencies];
                                                     RunObject=Form 482;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.),
                                                                 Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                                                 Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),
                                                                 Date Filter=FIELD(Date Filter) }
                                                   { ID=19;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Buchungsstatistik;
                                                                ENU=Entry Statistics];
                                                     RunObject=Form 303;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.),
                                                                 Date Filter=FIELD(Date Filter),
                                                                 Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                                                 Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
                                                   { ID=21;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Einkauf;
                                                                ENU=Purchases];
                                                     RunObject=Form 156;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.),
                                                                 Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                                                 Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
                                                   { ID=61;
                                                     MenuItemType=Separator }
                                                   { ID=62;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Re&ferenzen;
                                                                ENU=Cross Re&ferences];
                                                     RunObject=Form 5723;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Cross-Reference Type,Cross-Reference Type No.);
                                                     RunFormLink=Cross-Reference Type=CONST(Vendor),
                                                                 Cross-Reference Type No.=FIELD(No.) }
                                                 }
                                                  }
    { 23  ;MenuButton   ;11660;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=&Einkauf;
                                                            ENU=&Purchases];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=66;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Arti&kel;
                                                                ENU=Items];
                                                     RunObject=Form 297;
                                                     RunFormView=SORTING(Vendor No.);
                                                     RunFormLink=Vendor No.=FIELD(No.) }
                                                   { ID=25;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=&Rechnungsrabatte;
                                                                ENU=Invoice &Discounts];
                                                     RunObject=Form 28;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Code=FIELD(Invoice Disc. Code) }
                                                   { ID=24;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Preise;
                                                                ENU=Prices];
                                                     RunObject=Form 7012;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Vendor No.);
                                                     RunFormLink=Vendor No.=FIELD(No.) }
                                                   { ID=64;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Zeilenrabatte;
                                                                ENU=Line Discounts];
                                                     RunObject=Form 7014;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Vendor No.);
                                                     RunFormLink=Vendor No.=FIELD(No.) }
                                                   { ID=70;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=&VorauszahlungsprozentsÑtze;
                                                                ENU=Prepa&yment Percentages];
                                                     RunObject=Form 665;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Vendor No.);
                                                     RunFormLink=Vendor No.=FIELD(No.) }
                                                   { ID=67;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=S&td.-Kreditoreinkaufscodes;
                                                                ENU=S&td. Vend. Purchase Codes];
                                                     RunObject=Form 178;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Vendor No.=FIELD(No.) }
                                                   { ID=65;
                                                     MenuItemType=Separator }
                                                   { ID=26;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Anfragen;
                                                                ENU=Quotes];
                                                     RunObject=Form 49;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Document Type,Buy-from Vendor No.);
                                                     RunFormLink=Buy-from Vendor No.=FIELD(No.) }
                                                   { ID=58;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Ra&hmenbestellungen;
                                                                ENU=Blanket Orders];
                                                     RunObject=Form 509;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Document Type,Buy-from Vendor No.);
                                                     RunFormLink=Buy-from Vendor No.=FIELD(No.) }
                                                   { ID=27;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Bestellungen;
                                                                ENU=Orders];
                                                     RunObject=Form 50;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Document Type,Buy-from Vendor No.,No.);
                                                     RunFormLink=Buy-from Vendor No.=FIELD(No.) }
                                                   { ID=63;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Rekla&mationen;
                                                                ENU=Return Orders];
                                                     RunObject=Form 6640;
                                                     RunFormLinkType=OnUpdate }
                                                   { ID=6500;
                                                     CaptionML=[DEU=Artikel&verfolgungsposten;
                                                                ENU=Item &Tracking Entries];
                                                     RunFormLinkType=OnUpdate;
                                                     OnPush=VAR
                                                              ItemTrackingMgt@1001 : Codeunit 6500;
                                                            BEGIN
                                                              ItemTrackingMgt.CallItemTrackingEntryForm(2,"No.",'','','','','');
                                                            END;
                                                             }
                                                 }
                                                  }
    { 28  ;CommandButton;14080;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 1000000000;CommandButton;6820;5940;2200;550;
                                                 HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=&Anrufen;
                                                            ENU=&Dial];
                                                 OnPush=BEGIN
                                                          // AT04.00 BEGIN
                                                          TAPIFu.Dial(23,"No.",'',0);
                                                          // AT04.00 END
                                                        END;
                                                         }
  }
  CODE
  {
    VAR
      "*** activeTAPI ***"@1000000001 : Integer;
      TAPIFu@1000000000 : Codeunit 56780;

    PROCEDURE GetSelectionFilter@2() : Code[80];
    VAR
      Vend@1000 : Record 23;
      FirstVend@1001 : Code[30];
      LastVend@1002 : Code[30];
      SelectionFilter@1003 : Code[250];
      VendCount@1004 : Integer;
      More@1005 : Boolean;
    BEGIN
      CurrForm.SETSELECTIONFILTER(Vend);
      VendCount := Vend.COUNT;
      IF VendCount > 0 THEN BEGIN
        Vend.FIND('-');
        WHILE VendCount > 0 DO BEGIN
          VendCount := VendCount - 1;
          Vend.MARKEDONLY(FALSE);
          FirstVend := Vend."No.";
          LastVend := FirstVend;
          More := (VendCount > 0);
          WHILE More DO
            IF Vend.NEXT = 0 THEN
              More := FALSE
            ELSE
              IF NOT Vend.MARK THEN
                More := FALSE
              ELSE BEGIN
                LastVend := Vend."No.";
                VendCount := VendCount - 1;
                IF VendCount = 0 THEN
                  More := FALSE;
              END;
          IF SelectionFilter <> '' THEN
            SelectionFilter := SelectionFilter + '|';
          IF FirstVend = LastVend THEN
            SelectionFilter := SelectionFilter + FirstVend
          ELSE
            SelectionFilter := SelectionFilter + FirstVend + '..' + LastVend;
          IF VendCount > 0 THEN BEGIN
            Vend.MARKEDONLY(TRUE);
            Vend.NEXT;
          END;
        END;
      END;
      EXIT(SelectionFilter);
    END;

    PROCEDURE SetSelection@1(VAR Vend@1000 : Record 23);
    BEGIN
      CurrForm.SETSELECTIONFILTER(Vend);
    END;

    BEGIN
    {
      AT04.00    04.11.2005 Button for dialing out of the List
    }
    END.
  }
}

OBJECT Form 119 User Setup
{
  OBJECT-PROPERTIES
  {
    Date=06.11.09;
    Time=10:00:00;
    Modified=Yes;
    Version List=NAVW14.00,AT2009;
  }
  PROPERTIES
  {
    Width=13090;
    Height=6710;
    CaptionML=[DEU=Benutzer Einrichtung;
               ENU=User Setup];
    TableBoxID=1;
    SourceTable=Table91;
  }
  CONTROLS
  {
    { 1   ;TableBox     ;220  ;220  ;12650;5500 ;HorzGlue=Both;
                                                 VertGlue=Both }
    { 2   ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="User ID" }
    { 3   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=2;
                                                 InColumnHeading=Yes }
    { 4   ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Allow Posting From" }
    { 5   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=4;
                                                 InColumnHeading=Yes }
    { 6   ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Allow Posting To" }
    { 7   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=6;
                                                 InColumnHeading=Yes }
    { 8   ;CheckBox     ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Register Time" }
    { 9   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=8;
                                                 InColumnHeading=Yes }
    { 15  ;TextBox      ;7752 ;330  ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Sales Resp. Ctr. Filter" }
    { 16  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=15;
                                                 InColumnHeading=Yes }
    { 17  ;TextBox      ;8705 ;440  ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Purchase Resp. Ctr. Filter" }
    { 18  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=17;
                                                 InColumnHeading=Yes }
    { 21  ;TextBox      ;11986;770  ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Service Resp. Ctr. Filter" }
    { 22  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=21;
                                                 InColumnHeading=Yes }
    { 1000000000;CheckBox;9287;330  ;1700 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr="Use active TAPI" }
    { 1000000001;Label  ;0    ;0    ;0    ;0    ;ParentControl=1000000000;
                                                 InColumnHeading=Yes }
    { 1000000002;CheckBox;11218;440 ;1700 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr="See TAPI Logfile completely" }
    { 1000000003;Label  ;0    ;0    ;0    ;0    ;ParentControl=1000000002;
                                                 InColumnHeading=Yes }
    { 12  ;CommandButton;5830 ;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Default=Yes;
                                                 PushAction=LookupOK;
                                                 InvalidActionAppearance=Hide }
    { 13  ;CommandButton;8250 ;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Cancel=Yes;
                                                 PushAction=LookupCancel;
                                                 InvalidActionAppearance=Hide }
    { 14  ;CommandButton;10670;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
  }
  CODE
  {

    BEGIN
    {
      AT01 actTAPI 04.06.2003 New field: Use active TAPI
      AT2009       06.11.2009 New Field: See TAPI Logfile completely
    }
    END.
  }
}

OBJECT Form 5050 Contact Card
{
  OBJECT-PROPERTIES
  {
    Date=17.03.11;
    Time=19:21:55;
    Modified=Yes;
    Version List=NAVW16.00.10,AT01;
  }
  PROPERTIES
  {
    Width=16720;
    Height=10780;
    CaptionML=[DEU=Kontaktkarte;
               ENU=Contact Card];
    SourceTable=Table5050;
    OnOpenForm=VAR
                 MapMgt@1000 : Codeunit 802;
               BEGIN
                 IF NOT MapMgt.TestSetup THEN
                   CurrForm.MapPoint.VISIBLE(FALSE);
               END;

    OnFindRecord=VAR
                   RecordFound@1000 : Boolean;
                 BEGIN
                   RecordFound := FIND(Which);
                   CurrForm.EDITABLE := RecordFound OR (GETFILTER("No.") = '');
                   EXIT(RecordFound);
                 END;

    OnAfterGetRecord=BEGIN
                       SETRANGE("No.");
                     END;

    OnAfterGetCurrRecord=BEGIN
                           EnableFields;

                           IF Type = Type::Person THEN
                             IntegrationFindCustomerNo;
                         END;

  }
  CONTROLS
  {
    { 1   ;TabControl   ;220  ;220  ;16280;6050 ;HorzGlue=Both;
                                                 VertGlue=Top;
                                                 PageNamesML=[DEU=Allgemein,Kommunikation,Segmentierung,Au·enhandel;
                                                              ENU=General,Communication,Segmentation,Foreign Trade] }
    { 2   ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="No.";
                                                 OnAssistEdit=BEGIN
                                                                IF AssistEdit(xRec) THEN
                                                                  CurrForm.UPDATE;
                                                              END;
                                                               }
    { 3   ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=2 }
    { 4   ;TextBox      ;3850 ;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=Type;
                                                 OnAfterValidate=BEGIN
                                                                   EnableFields;
                                                                 END;
                                                                  }
    { 5   ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=4 }
    { 6   ;TextBox      ;3850 ;2200 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 NextControl=10;
                                                 SourceExpr="Company No." }
    { 7   ;Label        ;440  ;2200 ;3300 ;440  ;ParentControl=6 }
    { 8   ;TextBox      ;3850 ;2750 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 AssistEdit=Yes;
                                                 PermanentAssist=Yes;
                                                 SourceExpr="Company Name";
                                                 OnAssistEdit=BEGIN
                                                                Cont.SETRANGE("No.","Company No.");
                                                                CLEAR(CompanyDetails);
                                                                CompanyDetails.SETTABLEVIEW(Cont);
                                                                CompanyDetails.SETRECORD(Cont);
                                                                IF Type = Type::Person THEN
                                                                  CompanyDetails.EDITABLE := FALSE;
                                                                CompanyDetails.RUNMODAL;
                                                              END;
                                                               }
    { 9   ;Label        ;440  ;2750 ;3300 ;440  ;ParentControl=8 }
    { 10  ;TextBox      ;3850 ;3410 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 AssistEdit=Yes;
                                                 PermanentAssist=Yes;
                                                 SourceExpr=Name;
                                                 OnAssistEdit=BEGIN
                                                                MODIFY;
                                                                COMMIT;
                                                                Cont.SETRANGE("No.","No.");
                                                                IF Type = Type::Person THEN BEGIN
                                                                  CLEAR(NameDetails);
                                                                  NameDetails.SETTABLEVIEW(Cont);
                                                                  NameDetails.SETRECORD(Cont);
                                                                  NameDetails.RUNMODAL;
                                                                END ELSE BEGIN
                                                                  CLEAR(CompanyDetails);
                                                                  CompanyDetails.SETTABLEVIEW(Cont);
                                                                  CompanyDetails.SETRECORD(Cont);
                                                                  CompanyDetails.RUNMODAL;
                                                                END;
                                                                GET("No.");
                                                                CurrForm.UPDATE;
                                                              END;
                                                               }
    { 11  ;Label        ;440  ;3410 ;3300 ;440  ;ParentControl=10 }
    { 12  ;TextBox      ;3850 ;3960 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=Address }
    { 13  ;Label        ;440  ;3960 ;3300 ;440  ;ParentControl=12 }
    { 14  ;TextBox      ;3850 ;4510 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Address 2" }
    { 15  ;Label        ;440  ;4510 ;3300 ;440  ;ParentControl=14 }
    { 16  ;TextBox      ;3850 ;5060 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 NextControl=34;
                                                 SourceExpr="Post Code" }
    { 17  ;Label        ;440  ;5060 ;3300 ;440  ;ParentControl=16;
                                                 CaptionML=[DEU=PLZ-Code/Ort;
                                                            ENU=Post Code/City] }
    { 18  ;TextBox      ;3850 ;5610 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 NextControl=20;
                                                 SourceExpr="Country/Region Code" }
    { 19  ;Label        ;440  ;5610 ;3300 ;440  ;ParentControl=18 }
    { 20  ;TextBox      ;12980;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Search Name" }
    { 21  ;Label        ;9570 ;990  ;3300 ;440  ;ParentControl=20 }
    { 24  ;TextBox      ;12980;2200 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Salesperson Code" }
    { 25  ;Label        ;9570 ;2200 ;3300 ;440  ;ParentControl=24 }
    { 26  ;TextBox      ;12980;3410 ;1650 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Last Date Modified" }
    { 27  ;Label        ;9570 ;3410 ;3300 ;440  ;ParentControl=26 }
    { 28  ;TextBox      ;12980;3960 ;1650 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Date of Last Interaction";
                                                 OnDrillDown=VAR
                                                               InteractionLogEntry@1000 : Record 5065;
                                                             BEGIN
                                                               InteractionLogEntry.SETCURRENTKEY("Contact Company No.",Date,"Contact No.",Canceled,"Initiated By","Attempt Failed");
                                                               InteractionLogEntry.SETRANGE("Contact Company No.","Company No.");
                                                               InteractionLogEntry.SETFILTER("Contact No.","Lookup Contact No.");
                                                               InteractionLogEntry.SETRANGE("Attempt Failed",FALSE);
                                                               IF InteractionLogEntry.FIND('+') THEN
                                                                 FORM.RUN(0,InteractionLogEntry);
                                                             END;
                                                              }
    { 29  ;Label        ;9570 ;3960 ;3300 ;440  ;ParentControl=28 }
    { 30  ;TextBox      ;12980;4510 ;1650 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Last Date Attempted";
                                                 OnDrillDown=VAR
                                                               InteractionLogEntry@1000 : Record 5065;
                                                             BEGIN
                                                               InteractionLogEntry.SETCURRENTKEY("Contact Company No.",Date,"Contact No.",Canceled,"Initiated By","Attempt Failed");
                                                               InteractionLogEntry.SETRANGE("Contact Company No.","Company No.");
                                                               InteractionLogEntry.SETFILTER("Contact No.","Lookup Contact No.");
                                                               InteractionLogEntry.SETRANGE("Initiated By",InteractionLogEntry."Initiated By"::Us);
                                                               IF InteractionLogEntry.FIND('+') THEN
                                                                 FORM.RUN(0,InteractionLogEntry);
                                                             END;
                                                              }
    { 31  ;Label        ;9570 ;4510 ;3300 ;440  ;ParentControl=30 }
    { 32  ;TextBox      ;12980;5060 ;1650 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Next To-do Date" }
    { 33  ;Label        ;9570 ;5060 ;3300 ;440  ;ParentControl=32 }
    { 34  ;TextBox      ;6710 ;5060 ;2640 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 NextControl=18;
                                                 SourceExpr=City }
    { 22  ;TextBox      ;12980;1650 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Phone No." }
    { 23  ;Label        ;9570 ;1650 ;3300 ;440  ;ParentControl=22 }
    { 73  ;PictureBox   ;6710 ;990  ;440  ;440  ;Focusable=No;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 Border=No;
                                                 BitmapPos=Center;
                                                 BitmapList=7,6;
                                                 SourceExpr=Comment }
    { 74  ;CommandButton;6710 ;990  ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 BackTransparent=Yes;
                                                 PushAction=RunObject;
                                                 ToolTipML=[DEU=Bemerkung;
                                                            ENU=Comment];
                                                 RunObject=Form 5072;
                                                 RunFormLinkType=OnUpdate;
                                                 RunFormLink=Table Name=CONST(Contact),
                                                             No.=FIELD(No.),
                                                             Sub No.=CONST(0) }
    { 117 ;TextBox      ;12980;2750 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Salutation Code" }
    { 118 ;Label        ;9570 ;2750 ;3300 ;440  ;ParentControl=117 }
    { 148 ;CommandButton;15840;1650 ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 Bitmap=34;
                                                 ToolTipML=[DEU=Telefonverbindung herstellen;
                                                            ENU=Make Phone Call];
                                                 OnPush=VAR
                                                          TAPIManagement@1001 : Codeunit 5053;
                                                        BEGIN
                                                          // AT01 BEGIN
                                                          // Changed / geÑndert
                                                          // ORI BEGIN
                                                          // TAPIManagement.DialContCustVendBank(DATABASE::Contact,"No.","Phone No.",'');
                                                          // ORI END
                                                          TAPIFu.Dial(5050,"No.",'',0);
                                                          // AT01 END
                                                        END;
                                                         }
    { 154 ;CommandButton;6710 ;5610 ;440  ;440  ;Name=MapPoint;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 Bitmap=53;
                                                 ToolTipML=[DEU=Zuordnung anzeigen;
                                                            ENU=Display Map];
                                                 OnPush=BEGIN
                                                          DisplayMap;
                                                        END;
                                                         }
    { 36  ;TextBox      ;3850 ;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Mobile Phone No." }
    { 37  ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=36 }
    { 38  ;TextBox      ;3850 ;2090 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Fax No." }
    { 39  ;Label        ;440  ;2090 ;3300 ;440  ;ParentControl=38 }
    { 40  ;TextBox      ;3850 ;2640 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Telex No." }
    { 41  ;Label        ;440  ;2640 ;3300 ;440  ;ParentControl=40 }
    { 42  ;TextBox      ;3850 ;3190 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr=Pager }
    { 43  ;Label        ;440  ;3190 ;3300 ;440  ;ParentControl=42 }
    { 44  ;TextBox      ;3850 ;3740 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Telex Answer Back" }
    { 45  ;Label        ;440  ;3740 ;3300 ;440  ;ParentControl=44 }
    { 46  ;TextBox      ;3850 ;4290 ;4950 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="E-Mail" }
    { 47  ;Label        ;440  ;4290 ;3300 ;440  ;ParentControl=46 }
    { 48  ;TextBox      ;3850 ;4840 ;4950 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Home Page" }
    { 49  ;Label        ;440  ;4840 ;3300 ;440  ;ParentControl=48 }
    { 35  ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Phone No." }
    { 71  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=35 }
    { 113 ;CommandButton;8910 ;4840 ;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 Bitmap=20;
                                                 ToolTipML=[DEU=Hyperlink;
                                                            ENU=Hyperlink];
                                                 OnPush=BEGIN
                                                          TESTFIELD("Home Page");
                                                          HYPERLINK("Home Page");
                                                        END;
                                                         }
    { 114 ;CommandButton;8910 ;4290 ;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 Bitmap=21;
                                                 ToolTipML=[DEU=Neue Nachricht;
                                                            ENU=New Mail Message];
                                                 OnPush=VAR
                                                          Mail@1001 : Codeunit 397;
                                                        BEGIN
                                                          Mail.MailContCustVendBank(DATABASE::Contact,"No.","E-Mail");
                                                        END;
                                                         }
    { 115 ;CommandButton;6710 ;990  ;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 Bitmap=34;
                                                 ToolTipML=[DEU=Telefonverbindung herstellen;
                                                            ENU=Make Phone Call];
                                                 OnPush=VAR
                                                          TAPIManagement@1001 : Codeunit 5053;
                                                        BEGIN
                                                          // AT01 BEGIN
                                                          // Changed / geÑndert
                                                          // ORI BEGIN
                                                          // TAPIManagement.DialContCustVendBank(DATABASE::Contact,"No.","Phone No.",'');
                                                          // ORI END
                                                          TAPIFu.Dial(5050,"No.",'',0);
                                                          // AT01 END
                                                        END;
                                                         }
    { 104 ;CommandButton;6710 ;1540 ;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 Bitmap=34;
                                                 ToolTipML=[DEU=Telefonverbindung herstellen;
                                                            ENU=Make Phone Call];
                                                 OnPush=VAR
                                                          TAPIManagement@1001 : Codeunit 5053;
                                                        BEGIN
                                                          // AT01 BEGIN
                                                          // Changed / geÑndert
                                                          // ORI BEGIN
                                                          // TAPIManagement.DialContCustVendBank(DATABASE::Contact,"No.","Mobile Phone No.",'');
                                                          // ORI END
                                                          TAPIFu.Dial(5050,"No.",'',2);
                                                          // AT01 END
                                                        END;
                                                         }
    { 126 ;TextBox      ;12980;2090 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Correspondence Type" }
    { 127 ;Label        ;9570 ;2090 ;3300 ;440  ;ParentControl=126 }
    { 128 ;TextBox      ;12980;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Salutation Code" }
    { 129 ;Label        ;9570 ;1540 ;3300 ;440  ;ParentControl=128 }
    { 130 ;TextBox      ;12980;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Language Code" }
    { 131 ;Label        ;9570 ;990  ;3300 ;440  ;ParentControl=130 }
    { 101 ;TextBox      ;12980;3740 ;2750 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="First Name" }
    { 120 ;Label        ;9570 ;3740 ;3300 ;440  ;Visible=No;
                                                 ParentControl=101 }
    { 121 ;TextBox      ;12980;4290 ;2750 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Middle Name" }
    { 122 ;Label        ;9570 ;4290 ;3300 ;440  ;Visible=No;
                                                 ParentControl=121 }
    { 123 ;TextBox      ;12980;4840 ;2750 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr=Surname }
    { 124 ;Label        ;9570 ;4840 ;3300 ;440  ;Visible=No;
                                                 ParentControl=123 }
    { 125 ;TextBox      ;12980;3190 ;2750 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr=IntegrationCustomerNo;
                                                 OnValidate=VAR
                                                              Customer@1000 : Record 18;
                                                              ContactBusinessRelation@1001 : Record 5054;
                                                            BEGIN
                                                              IF NOT (IntegrationCustomerNo = '') THEN BEGIN
                                                                Customer.GET(IntegrationCustomerNo);
                                                                ContactBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                ContactBusinessRelation.SETRANGE("Link to Table",ContactBusinessRelation."Link to Table"::Customer);
                                                                ContactBusinessRelation.SETRANGE("No.",Customer."No.");
                                                                IF ContactBusinessRelation.FINDFIRST THEN
                                                                  VALIDATE("Company No.",ContactBusinessRelation."Contact No.");
                                                              END ELSE
                                                                VALIDATE("Company No.",'');
                                                            END;
                                                             }
    { 132 ;Label        ;9570 ;3190 ;3300 ;440  ;Visible=No;
                                                 ParentControl=125 }
    { 50  ;TextBox      ;3850 ;990  ;1650 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="No. of Mailing Groups";
                                                 OnDrillDown=VAR
                                                               ContMailingGrp@1001 : Record 5056;
                                                             BEGIN
                                                               CurrForm.SAVERECORD;
                                                               COMMIT;
                                                               ContMailingGrp.SETRANGE("Contact No.","No.");
                                                               FORM.RUNMODAL(FORM::"Contact Mailing Groups",ContMailingGrp);
                                                               CurrForm.UPDATE(FALSE);
                                                             END;
                                                              }
    { 51  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=50 }
    { 52  ;TextBox      ;3850 ;1650 ;1650 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="No. of Business Relations";
                                                 OnDrillDown=VAR
                                                               ContBusRel@1001 : Record 5054;
                                                             BEGIN
                                                               CurrForm.SAVERECORD;
                                                               COMMIT;
                                                               ContBusRel.SETRANGE("Contact No.","Company No.");
                                                               FORM.RUNMODAL(FORM::"Contact Business Relations",ContBusRel);
                                                               CurrForm.UPDATE(FALSE);
                                                             END;
                                                              }
    { 53  ;Label        ;440  ;1650 ;3300 ;440  ;ParentControl=52 }
    { 54  ;TextBox      ;3850 ;2200 ;1650 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="No. of Industry Groups";
                                                 OnDrillDown=VAR
                                                               ContIndustGrp@1001 : Record 5058;
                                                             BEGIN
                                                               CurrForm.SAVERECORD;
                                                               COMMIT;
                                                               ContIndustGrp.SETRANGE("Contact No.","Company No.");
                                                               FORM.RUNMODAL(FORM::"Contact Industry Groups",ContIndustGrp);
                                                               CurrForm.UPDATE(FALSE);
                                                             END;
                                                              }
    { 55  ;Label        ;440  ;2200 ;3300 ;440  ;ParentControl=54 }
    { 56  ;TextBox      ;3850 ;2860 ;1650 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="No. of Job Responsibilities";
                                                 OnDrillDown=VAR
                                                               ContJobResp@1001 : Record 5067;
                                                             BEGIN
                                                               CurrForm.SAVERECORD;
                                                               COMMIT;
                                                               ContJobResp.SETRANGE("Contact No.","No.");
                                                               FORM.RUNMODAL(FORM::"Contact Job Responsibilities",ContJobResp);
                                                               CurrForm.UPDATE(FALSE);
                                                             END;
                                                              }
    { 57  ;Label        ;440  ;2860 ;3300 ;440  ;ParentControl=56 }
    { 58  ;TextBox      ;3850 ;3410 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Organizational Level Code" }
    { 59  ;Label        ;440  ;3410 ;3300 ;440  ;ParentControl=58 }
    { 60  ;CheckBox     ;3850 ;4070 ;440  ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 ShowCaption=No;
                                                 SourceExpr="Exclude from Segment" }
    { 61  ;Label        ;440  ;4070 ;3300 ;440  ;ParentControl=60 }
    { 64  ;TextBox      ;3850 ;990  ;1650 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Currency Code" }
    { 65  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=64 }
    { 66  ;TextBox      ;12980;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="VAT Registration No." }
    { 67  ;Label        ;9570 ;990  ;3300 ;440  ;ParentControl=66 }
    { 68  ;TextBox      ;3850 ;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Territory Code" }
    { 69  ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=68 }
    { 70  ;CommandButton;14300;10010;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 72  ;SubForm      ;220  ;6490 ;16280;3300 ;HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Border=No;
                                                 SubFormID=Form5051;
                                                 SubFormLink=Contact No.=FIELD(No.) }
    { 75  ;MenuButton   ;9460 ;10010;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=F&unktion;
                                                            ENU=F&unctions];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=102;
                                                     CaptionML=[DEU=&Internetfavorit aufrufen;
                                                                ENU=Launch &Web Source];
                                                     OnPush=VAR
                                                              ContactWebSource@1001 : Record 5060;
                                                            BEGIN
                                                              ContactWebSource.SETRANGE("Contact No.","Company No.");
                                                              IF FORM.RUNMODAL(FORM::"Web Source Launch",ContactWebSource) = ACTION::LookupOK THEN
                                                                ContactWebSource.Launch;
                                                            END;
                                                             }
                                                   { ID=103;
                                                     CaptionML=[DEU=&Deckblatt drucken;
                                                                ENU=Print Cover &Sheet];
                                                     OnPush=VAR
                                                              Cont@1001 : Record 5050;
                                                            BEGIN
                                                              Cont := Rec;
                                                              Cont.SETRECFILTER;
                                                              REPORT.RUN(REPORT::"Contact - Cover Sheet",TRUE,FALSE,Cont);
                                                            END;
                                                             }
                                                   { ID=105;
                                                     CaptionML=[DEU=Erstellen als;
                                                                ENU=Create as] }
                                                   { ID=106;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Debitor;
                                                                ENU=Customer];
                                                     OnPush=BEGIN
                                                              CreateCustomer(ChooseCustomerTemplate);
                                                            END;
                                                             }
                                                   { ID=107;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Kreditor;
                                                                ENU=Vendor];
                                                     OnPush=BEGIN
                                                              CreateVendor;
                                                            END;
                                                             }
                                                   { ID=108;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Bankkonto;
                                                                ENU=Bank];
                                                     OnPush=BEGIN
                                                              CreateBankAccount;
                                                            END;
                                                             }
                                                   { ID=109;
                                                     CaptionML=[DEU=VerknÅpfen mit;
                                                                ENU=Link with existing] }
                                                   { ID=110;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Debitor;
                                                                ENU=Customer];
                                                     OnPush=BEGIN
                                                              CreateCustomerLink;
                                                            END;
                                                             }
                                                   { ID=111;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Kreditor;
                                                                ENU=Vendor];
                                                     OnPush=BEGIN
                                                              CreateVendorLink;
                                                            END;
                                                             }
                                                   { ID=112;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Bankkonto;
                                                                ENU=Bank];
                                                     OnPush=BEGIN
                                                              CreateBankAccountLink;
                                                            END;
                                                             }
                                                   { ID=146;
                                                     CaptionML=[DEU=&Kontaktsuche;
                                                                ENU=Co&ntact Search];
                                                     OnPush=VAR
                                                              SearchResult@1001 : Record 5113;
                                                              ContactSearchForm@1000 : Form 5177;
                                                            BEGIN
                                                              ContactSearchForm.LOOKUPMODE(TRUE);
                                                              IF ContactSearchForm.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                ContactSearchForm.GETRECORD(SearchResult);
                                                                IF GET(SearchResult."Contact No.") THEN;
                                                              END;
                                                            END;
                                                             }
                                                   { ID=152;
                                                     MenuItemType=Separator }
                                                   { ID=153;
                                                     Ellipsis=Yes;
                                                     CaptionML=[DEU=Vorlage anwenden;
                                                                ENU=Apply Template];
                                                     OnPush=VAR
                                                              TemplateMgt@1000 : Codeunit 8612;
                                                              RecRef@1001 : RecordRef;
                                                            BEGIN
                                                              RecRef.GETTABLE(Rec);
                                                              TemplateMgt.UpdateFromTemplateSelection(RecRef);
                                                            END;
                                                             }
                                                 }
                                                  }
    { 76  ;MenuButton   ;7040 ;10010;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=Ko&ntakt;
                                                            ENU=C&ontact];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=78;
                                                     PushAction=LookupTable;
                                                     ShortCutKey=F5;
                                                     CaptionML=[DEU=öbersicht;
                                                                ENU=List] }
                                                   { ID=79;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Zugehîrige Ko&ntakte;
                                                                ENU=Relate&d Contacts];
                                                     RunObject=Form 5052;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Company No.=FIELD(Company No.) }
                                                   { ID=82;
                                                     CaptionML=[DEU=Un&ternehmen;
                                                                ENU=Comp&any] }
                                                   { ID=85;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=GeschÑftsbeziehungen;
                                                                ENU=Business Relations];
                                                     RunObject=Form 5061;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Contact No.=FIELD(Company No.) }
                                                   { ID=83;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Branchen;
                                                                ENU=Industry Groups];
                                                     RunObject=Form 5067;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Contact No.=FIELD(Company No.) }
                                                   { ID=84;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Internetfavoriten;
                                                                ENU=Web Sources];
                                                     RunObject=Form 5070;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Contact No.=FIELD(Company No.) }
                                                   { ID=80;
                                                     CaptionML=[DEU=&Person;
                                                                ENU=P&erson] }
                                                   { ID=81;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Verantwortlichkeiten;
                                                                ENU=Job Responsibilities];
                                                     OnPush=VAR
                                                              ContJobResp@1001 : Record 5067;
                                                            BEGIN
                                                              TESTFIELD(Type,Type::Person);
                                                              ContJobResp.SETRANGE("Contact No.","No.");
                                                              FORM.RUNMODAL(FORM::"Contact Job Responsibilities",ContJobResp);
                                                            END;
                                                             }
                                                   { ID=86;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=&Verteiler;
                                                                ENU=Mailing &Groups];
                                                     RunObject=Form 5064;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Contact No.=FIELD(No.) }
                                                   { ID=87;
                                                     CaptionML=[DEU=Pr&ofile;
                                                                ENU=Pro&files];
                                                     OnPush=VAR
                                                              ProfileManagement@1001 : Codeunit 5059;
                                                            BEGIN
                                                              ProfileManagement.ShowContactQuestionnaireCard(Rec,'',0);
                                                            END;
                                                             }
                                                   { ID=88;
                                                     PushAction=RunObject;
                                                     ShortCutKey=F9;
                                                     CaptionML=[DEU=Statistik;
                                                                ENU=Statistics];
                                                     RunObject=Form 5053;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.) }
                                                   { ID=89;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Bi&ld;
                                                                ENU=&Picture];
                                                     RunObject=Form 5104;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.) }
                                                   { ID=90;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Be&merkungen;
                                                                ENU=Co&mments];
                                                     RunObject=Form 5072;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Table Name=CONST(Contact),
                                                                 No.=FIELD(No.),
                                                                 Sub No.=CONST(0) }
                                                   { ID=91;
                                                     CaptionML=[DEU=Al&ternative Adressen;
                                                                ENU=Alternati&ve Address] }
                                                   { ID=92;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Karte;
                                                                ENU=Card];
                                                     RunObject=Form 5056;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Contact No.=FIELD(No.) }
                                                   { ID=93;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=GÅltigkeiten;
                                                                ENU=Date Ranges];
                                                     RunObject=Form 5059;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Contact No.=FIELD(No.) }
                                                   { ID=94;
                                                     MenuItemType=Separator;
                                                     CaptionML=[DEU="";
                                                                ENU=""] }
                                                   { ID=95;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Strg+F5;
                                                     CaptionML=[DEU=Aktivit&Ñtenprotokollposten;
                                                                ENU=Interaction Log E&ntries];
                                                     RunObject=Form 5076;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Contact Company No.,Date,Contact No.,Canceled,Initiated By,Attempt Failed);
                                                     RunFormLink=Contact Company No.=FIELD(Company No.),
                                                                 Contact No.=FILTER(<>''),
                                                                 Contact No.=FIELD(FILTER(Lookup Contact No.)) }
                                                   { ID=149;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=ZurÅckgestellte &AktivitÑten;
                                                                ENU=Postponed &Interactions];
                                                     RunObject=Form 5082;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Contact Company No.,Date,Contact No.,Canceled,Initiated By,Attempt Failed);
                                                     RunFormLink=Contact Company No.=FIELD(Company No.),
                                                                 Contact No.=FILTER(<>''),
                                                                 Contact No.=FIELD(FILTER(Lookup Contact No.)) }
                                                   { ID=96;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Aufga&ben;
                                                                ENU=T&o-dos];
                                                     RunObject=Form 5096;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Contact Company No.,Date,Contact No.,Closed);
                                                     RunFormLink=Contact Company No.=FIELD(Company No.),
                                                                 Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                 System To-do Type=FILTER(Contact Attendee) }
                                                   { ID=151;
                                                     CaptionML=[DEU=Verkaufs&chancen;
                                                                ENU=Oppo&rtunities] }
                                                   { ID=97;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=öbersicht;
                                                                ENU=List];
                                                     RunObject=Form 5123;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Contact Company No.,Contact No.);
                                                     RunFormLink=Contact Company No.=FIELD(Company No.),
                                                                 Contact No.=FILTER(<>''),
                                                                 Contact No.=FIELD(FILTER(Lookup Contact No.)) }
                                                   { ID=150;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Balkendiagramm;
                                                                ENU=Bar Chart];
                                                     OnPush=VAR
                                                              OpportunityBarChart@1000 : Form 5084;
                                                            BEGIN
                                                              OpportunityBarChart.SetContactFilter("No.","Company No.");
                                                              OpportunityBarChart.RUN;
                                                            END;
                                                             }
                                                   { ID=100;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=S&egmente;
                                                                ENU=Segmen&ts];
                                                     RunObject=Form 5150;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Contact No.,Segment No.);
                                                     RunFormLink=Contact Company No.=FIELD(Company No.),
                                                                 Contact No.=FILTER(<>''),
                                                                 Contact No.=FIELD(FILTER(Lookup Contact No.)) }
                                                   { ID=98;
                                                     MenuItemType=Separator;
                                                     CaptionML=[DEU="";
                                                                ENU=""] }
                                                   { ID=116;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=&Angebote;
                                                                ENU=Sales &Quotes];
                                                     RunObject=Form 41;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Document Type,Sell-to Contact No.);
                                                     RunFormLink=Sell-to Contact No.=FIELD(No.) }
                                                   { ID=119;
                                                     MenuItemType=Separator }
                                                   { ID=99;
                                                     CaptionML=[DEU=&Debitor/Kreditor/Bankkonto;
                                                                ENU=C&ustomer/Vendor/Bank Acc.];
                                                     OnPush=BEGIN
                                                              ShowCustVendBank;
                                                            END;
                                                             }
                                                   { ID=62;
                                                     MenuItemType=Separator }
                                                   { ID=63;
                                                     CaptionML=[DEU=Online Map;
                                                                ENU=Online Map];
                                                     OnPush=BEGIN
                                                              DisplayMap;
                                                            END;
                                                             }
                                                 }
                                                  }
    { 77  ;CommandButton;11880;10010;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=AktivitÑt &erst.;
                                                            ENU=Create &Interact];
                                                 OnPush=BEGIN
                                                          CreateInteraction;
                                                        END;
                                                         }
  }
  CODE
  {
    VAR
      Cont@1000 : Record 5050;
      CompanyDetails@1001 : Form 5054;
      NameDetails@1002 : Form 5055;
      IntegrationCustomerNo@1003 : Code[20];
      "*** actTAPI ***"@1113900000 : Integer;
      TAPIFu@1113900001 : Codeunit 56780;

    PROCEDURE EnableFields@1();
    BEGIN
      CurrForm."Currency Code".ENABLED(Type = Type::Company);
      CurrForm."VAT Registration No.".ENABLED(Type = Type::Company);
      CurrForm."Company No.".ENABLED(Type = Type::Person);
      CurrForm."Company Name".ENABLED(Type = Type::Person);
      CurrForm."Organizational Level Code".ENABLED(Type = Type::Person);
      CurrForm."No. of Job Responsibilities".ENABLED(Type = Type::Person);
    END;

    PROCEDURE IntegrationFindCustomerNo@2();
    VAR
      ContactBusinessRelation@1000 : Record 5054;
    BEGIN
      ContactBusinessRelation.SETCURRENTKEY("Link to Table","Contact No.");
      ContactBusinessRelation.SETRANGE("Link to Table",ContactBusinessRelation."Link to Table"::Customer);
      ContactBusinessRelation.SETRANGE("Contact No.","Company No.");
      IF ContactBusinessRelation.FINDFIRST THEN BEGIN
        IntegrationCustomerNo := ContactBusinessRelation."No.";
      END ELSE BEGIN
        IntegrationCustomerNo := '';
      END;
    END;

    BEGIN
    {
      AT01 actTAPI 04.06.2003 New Dial function
                              Global Var TAPIFu CU 56780
                              Call in the OnPush-Trigger of every Phone No. Bitmap (3x)
    }
    END.
  }
}

OBJECT Form 5052 Contact List
{
  OBJECT-PROPERTIES
  {
    Date=06.11.09;
    Time=10:00:00;
    Modified=Yes;
    Version List=NAVW15.00,AT04;
  }
  PROPERTIES
  {
    Width=16940;
    Height=6710;
    Editable=No;
    CaptionML=[DEU=KontaktÅbersicht;
               ENU=Contact List];
    TableBoxID=1;
    SourceTable=Table5050;
    SourceTableView=SORTING(Company Name,Company No.,Type,Name);
    DataCaptionFields=Company No.;
  }
  CONTROLS
  {
    { 1   ;TableBox     ;220  ;220  ;16500;5500 ;HorzGlue=Both;
                                                 VertGlue=Both }
    { 2   ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="No.";
                                                 OnFormat=BEGIN
                                                            IF Type = Type::Company THEN
                                                              CurrForm."No.".UPDATEFONTBOLD := TRUE;
                                                          END;
                                                           }
    { 3   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=2;
                                                 InColumnHeading=Yes }
    { 4   ;TextBox      ;0    ;0    ;4400 ;0    ;HorzGlue=Both;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Name;
                                                 OnFormat=BEGIN
                                                            IF Type = Type::Company THEN
                                                              CurrForm.Name.UPDATEFONTBOLD := TRUE
                                                            ELSE BEGIN
                                                              Cont.SETCURRENTKEY("Company Name","Company No.",Type,Name);
                                                              IF ("Company No." <> '') AND (NOT HASFILTER) AND (NOT MARKEDONLY) AND (CURRENTKEY = Cont.CURRENTKEY)
                                                              THEN
                                                                CurrForm.Name.UPDATEINDENT := 220;
                                                            END;
                                                          END;
                                                           }
    { 5   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=4;
                                                 InColumnHeading=Yes }
    { 66  ;TextBox      ;1746 ;2750 ;4400 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Company Name" }
    { 67  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=66;
                                                 InColumnHeading=Yes }
    { 6   ;TextBox      ;0    ;0    ;1650 ;0    ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Post Code" }
    { 7   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=6;
                                                 InColumnHeading=Yes }
    { 8   ;TextBox      ;0    ;0    ;1650 ;0    ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Country/Region Code" }
    { 9   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=8;
                                                 InColumnHeading=Yes }
    { 10  ;TextBox      ;0    ;0    ;2200 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Phone No." }
    { 11  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=10;
                                                 InColumnHeading=Yes }
    { 24  ;TextBox      ;0    ;0    ;2200 ;0    ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Mobile Phone No." }
    { 25  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=24;
                                                 InColumnHeading=Yes }
    { 12  ;TextBox      ;0    ;0    ;2200 ;0    ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Fax No." }
    { 13  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=12;
                                                 InColumnHeading=Yes }
    { 14  ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Salesperson Code" }
    { 15  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=14;
                                                 InColumnHeading=Yes }
    { 16  ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Territory Code" }
    { 17  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=16;
                                                 InColumnHeading=Yes }
    { 18  ;TextBox      ;0    ;0    ;1100 ;0    ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Currency Code" }
    { 19  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=18;
                                                 InColumnHeading=Yes }
    { 20  ;TextBox      ;0    ;0    ;1650 ;0    ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Language Code" }
    { 21  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=20;
                                                 InColumnHeading=Yes }
    { 22  ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Search Name" }
    { 23  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=22;
                                                 InColumnHeading=Yes }
    { 26  ;CommandButton;0    ;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Default=Yes;
                                                 PushAction=LookupOK;
                                                 InvalidActionAppearance=Hide }
    { 27  ;CommandButton;2420 ;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Cancel=Yes;
                                                 PushAction=LookupCancel;
                                                 InvalidActionAppearance=Hide }
    { 28  ;CommandButton;14520;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 31  ;CommandButton;12100;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=AktivitÑt &erst.;
                                                            ENU=Create &Interact];
                                                 OnPush=BEGIN
                                                          CreateInteraction;
                                                        END;
                                                         }
    { 30  ;MenuButton   ;9680 ;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=F&unktion;
                                                            ENU=F&unctions];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=54;
                                                     CaptionML=[DEU=&Telefonverbindung herstellen;
                                                                ENU=Make &Phone Call];
                                                     OnPush=VAR
                                                              TAPIManagement@1001 : Codeunit 5053;
                                                            BEGIN
                                                              TAPIManagement.DialContCustVendBank(DATABASE::Contact,"No.","Phone No.",'');
                                                            END;
                                                             }
                                                   { ID=56;
                                                     CaptionML=[DEU=&Internetfavorit aufrufen;
                                                                ENU=Launch &Web Source];
                                                     OnPush=VAR
                                                              ContactWebSource@1001 : Record 5060;
                                                            BEGIN
                                                              ContactWebSource.SETRANGE("Contact No.","Company No.");
                                                              IF FORM.RUNMODAL(FORM::"Web Source Launch",ContactWebSource) = ACTION::LookupOK THEN
                                                                ContactWebSource.Launch;
                                                            END;
                                                             }
                                                   { ID=57;
                                                     CaptionML=[DEU=&Deckblatt drucken;
                                                                ENU=Print Cover &Sheet];
                                                     OnPush=VAR
                                                              Cont@1001 : Record 5050;
                                                            BEGIN
                                                              Cont := Rec;
                                                              Cont.SETRECFILTER;
                                                              REPORT.RUN(REPORT::"Contact - Cover Sheet",TRUE,FALSE,Cont);
                                                            END;
                                                             }
                                                   { ID=58;
                                                     CaptionML=[DEU=Erstellen als;
                                                                ENU=Create as] }
                                                   { ID=59;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Debitor;
                                                                ENU=Customer];
                                                     OnPush=BEGIN
                                                              CreateCustomer(ChooseCustomerTemplate);
                                                            END;
                                                             }
                                                   { ID=60;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Kreditor;
                                                                ENU=Vendor];
                                                     OnPush=BEGIN
                                                              CreateVendor;
                                                            END;
                                                             }
                                                   { ID=61;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Bankkonto;
                                                                ENU=Bank];
                                                     OnPush=BEGIN
                                                              CreateBankAccount;
                                                            END;
                                                             }
                                                   { ID=62;
                                                     CaptionML=[DEU=VerknÅpfen mit;
                                                                ENU=Link with existing] }
                                                   { ID=63;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Debitor;
                                                                ENU=Customer];
                                                     OnPush=BEGIN
                                                              CreateCustomerLink;
                                                            END;
                                                             }
                                                   { ID=64;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Kreditor;
                                                                ENU=Vendor];
                                                     OnPush=BEGIN
                                                              CreateVendorLink;
                                                            END;
                                                             }
                                                   { ID=65;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Bankkonto;
                                                                ENU=Bank];
                                                     OnPush=BEGIN
                                                              CreateBankAccountLink;
                                                            END;
                                                             }
                                                   { ID=74;
                                                     CaptionML=[DEU=&Kontaktsuche;
                                                                ENU=Co&ntact Search];
                                                     OnPush=VAR
                                                              SearchResult@1001 : Record 5113;
                                                              ContactSearchForm@1000 : Form 5177;
                                                            BEGIN
                                                              ContactSearchForm.LOOKUPMODE(TRUE);
                                                              IF ContactSearchForm.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                ContactSearchForm.GETRECORD(SearchResult);
                                                                IF GET(SearchResult."Contact No.") THEN;
                                                              END;
                                                            END;
                                                             }
                                                 }
                                                  }
    { 29  ;MenuButton   ;7260 ;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=Ko&ntakt;
                                                            ENU=C&ontact];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=32;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Umschalt+F5;
                                                     CaptionML=[DEU=Karte;
                                                                ENU=Card];
                                                     RunObject=Form 5050;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.) }
                                                   { ID=33;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Zugehîrige Ko&ntakte;
                                                                ENU=Relate&d Contacts];
                                                     RunObject=Form 5052;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Company No.=FIELD(Company No.) }
                                                   { ID=34;
                                                     CaptionML=[DEU=Un&ternehmen;
                                                                ENU=Comp&any] }
                                                   { ID=35;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=GeschÑftsbeziehungen;
                                                                ENU=Business Relations];
                                                     RunObject=Form 5061;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Contact No.=FIELD(Company No.) }
                                                   { ID=36;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Branchen;
                                                                ENU=Industry Groups];
                                                     RunObject=Form 5067;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Contact No.=FIELD(Company No.) }
                                                   { ID=37;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Internetfavoriten;
                                                                ENU=Web Sources];
                                                     RunObject=Form 5070;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Contact No.=FIELD(Company No.) }
                                                   { ID=38;
                                                     CaptionML=[DEU=&Person;
                                                                ENU=P&erson] }
                                                   { ID=39;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Verantwortlichkeiten;
                                                                ENU=Job Responsibilities];
                                                     OnPush=VAR
                                                              ContJobResp@1001 : Record 5067;
                                                            BEGIN
                                                              TESTFIELD(Type,Type::Person);
                                                              ContJobResp.SETRANGE("Contact No.","No.");
                                                              FORM.RUNMODAL(FORM::"Contact Job Responsibilities",ContJobResp);
                                                            END;
                                                             }
                                                   { ID=40;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=&Verteiler;
                                                                ENU=Mailing &Groups];
                                                     RunObject=Form 5064;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Contact No.=FIELD(No.) }
                                                   { ID=41;
                                                     CaptionML=[DEU=Pr&ofile;
                                                                ENU=Pro&files];
                                                     OnPush=VAR
                                                              ProfileManagement@1001 : Codeunit 5059;
                                                            BEGIN
                                                              ProfileManagement.ShowContactQuestionnaireCard(Rec,'',0);
                                                            END;
                                                             }
                                                   { ID=42;
                                                     PushAction=RunObject;
                                                     ShortCutKey=F9;
                                                     CaptionML=[DEU=Statistik;
                                                                ENU=Statistics];
                                                     RunObject=Form 5053;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.) }
                                                   { ID=43;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Bi&ld;
                                                                ENU=&Picture];
                                                     RunObject=Form 5104;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.) }
                                                   { ID=44;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Be&merkungen;
                                                                ENU=Co&mments];
                                                     RunObject=Form 5072;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Table Name=CONST(Contact),
                                                                 No.=FIELD(No.),
                                                                 Sub No.=CONST(0) }
                                                   { ID=45;
                                                     CaptionML=[DEU=Al&ternative Adressen;
                                                                ENU=Alternati&ve Address] }
                                                   { ID=46;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Karte;
                                                                ENU=Card];
                                                     RunObject=Form 5056;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Contact No.=FIELD(No.) }
                                                   { ID=47;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=GÅltigkeiten;
                                                                ENU=Date Ranges];
                                                     RunObject=Form 5059;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Contact No.=FIELD(No.) }
                                                   { ID=48;
                                                     MenuItemType=Separator;
                                                     CaptionML=[DEU="";
                                                                ENU=""] }
                                                   { ID=49;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Strg+F5;
                                                     CaptionML=[DEU=Aktivit&Ñtenprotokollposten;
                                                                ENU=Interaction Log E&ntries];
                                                     RunObject=Form 5076;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Contact Company No.,Contact No.);
                                                     RunFormLink=Contact Company No.=FIELD(Company No.),
                                                                 Contact No.=FILTER(<>''),
                                                                 Contact No.=FIELD(FILTER(Lookup Contact No.)) }
                                                   { ID=76;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=ZurÅckgestellte &AktivitÑten;
                                                                ENU=Postponed &Interactions];
                                                     RunObject=Form 5082;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Contact Company No.,Contact No.);
                                                     RunFormLink=Contact Company No.=FIELD(Company No.),
                                                                 Contact No.=FILTER(<>''),
                                                                 Contact No.=FIELD(FILTER(Lookup Contact No.)) }
                                                   { ID=50;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Aufga&ben;
                                                                ENU=T&o-dos];
                                                     RunObject=Form 5096;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Contact Company No.,Contact No.);
                                                     RunFormLink=Contact Company No.=FIELD(Company No.),
                                                                 Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                 System To-do Type=FILTER(Contact Attendee) }
                                                   { ID=78;
                                                     CaptionML=[DEU=Verkaufs&chancen;
                                                                ENU=Oppo&rtunities] }
                                                   { ID=51;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=öbersicht;
                                                                ENU=List];
                                                     RunObject=Form 5123;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Contact Company No.,Contact No.);
                                                     RunFormLink=Contact Company No.=FIELD(Company No.),
                                                                 Contact No.=FILTER(<>''),
                                                                 Contact No.=FIELD(FILTER(Lookup Contact No.)) }
                                                   { ID=77;
                                                     MenuLevel=1;
                                                     CaptionML=[DEU=Balkendiagramm;
                                                                ENU=Bar Chart];
                                                     OnPush=VAR
                                                              OpportunityBarChart@1000 : Form 5084;
                                                            BEGIN
                                                              OpportunityBarChart.SetContactFilter("No.","Company No.");
                                                              OpportunityBarChart.RUN;
                                                            END;
                                                             }
                                                   { ID=55;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=S&egmente;
                                                                ENU=Segmen&ts];
                                                     RunObject=Form 5150;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Contact No.,Segment No.);
                                                     RunFormLink=Contact Company No.=FIELD(Company No.),
                                                                 Contact No.=FILTER(<>''),
                                                                 Contact No.=FIELD(FILTER(Lookup Contact No.)) }
                                                   { ID=52;
                                                     MenuItemType=Separator;
                                                     CaptionML=[DEU="";
                                                                ENU=""] }
                                                   { ID=68;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=&Angebote;
                                                                ENU=Sales &Quotes];
                                                     RunObject=Form 41;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Document Type,Sell-to Contact No.);
                                                     RunFormLink=Sell-to Contact No.=FIELD(No.) }
                                                   { ID=69;
                                                     MenuItemType=Separator }
                                                   { ID=53;
                                                     CaptionML=[DEU=&Debitor/Kreditor/Bankkonto;
                                                                ENU=C&ustomer/Vendor/Bank Acc.];
                                                     OnPush=BEGIN
                                                              ShowCustVendBank;
                                                            END;
                                                             }
                                                 }
                                                  }
    { 1000000000;CommandButton;4840;5940;2200;550;
                                                 HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=&Anrufen;
                                                            ENU=&Dial];
                                                 OnPush=BEGIN
                                                          // AT04.00 BEGIN
                                                          TAPIFu.Dial(5050,"No.",'',0);
                                                          // AT04.00 END
                                                        END;
                                                         }
  }
  CODE
  {
    VAR
      Cont@1000 : Record 5050;
      "*** activeTAPI ***"@1000000001 : Integer;
      TAPIFu@1000000000 : Codeunit 56780;

    BEGIN
    {
      AT04.00     04.11.2005 Button for dialing out of the List
    }
    END.
  }
}

OBJECT Codeunit 1 ApplicationManagement
{
  OBJECT-PROPERTIES
  {
    Date=11.10.11;
    Time=12:29:55;
    Modified=Yes;
    Version List=NAVW16.00.10,LIQEM5.00,NAVDACH4.00.01,NAVDE5.00,AO,AT2011.3;
  }
  PROPERTIES
  {
    Permissions=TableData 17=r,
                TableData 51=rimd;
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'DEU=CRONUS;ENU=CRONUS';
      Text001@1003 : TextConst 'DEU=Dies ist der Demomandant ''%1''\\;ENU=This is the demonstration company %1\\';
      Text002@1002 : TextConst 'DEU=Sie kînnen Programmfunktionen an den Daten des Demomandanten ausprobieren, bevor Sie sie mit Ihren echten Daten verwenden.\Das Programm hat das Arbeitsdatum auf %2 festgelegt.\\;ENU=You can try out program features on the data in the demonstration company before using the features with your real data.\The program has set the work date to %2.\\';
      Text003@1001 : TextConst 'DEU=Zum Schlie·en des Demomandanten und zum Einrichten eines neuen Mandanten klicken Sie auf ''Datei'', ''Mandant'', ''Neu''. \Zum ôffnen eines vorhandenen Mandanten klicken Sie auf ''Datei'', ''Mandant'', ''ôffnen''.;ENU=To close the demonstration company and set up a new company, click File, Company, New. \To open an existing company, click File, Company, Open.';
      Text005@1004 : TextConst 'DEU=HEUTIGES DATUM;ENU=TODAY';
      Text006@1005 : TextConst 'DEU=ARBEITSDATUM;ENU=WORKDATE';
      Text007@1006 : TextConst 'DEU=ZEIT;ENU=TIME';
      Text008@1007 : TextConst 'DEU=PERIODE;ENU=PERIOD';
      Text009@1008 : TextConst 'DEU=JAHR;ENU=YEAR';
      Text010@1009 : TextConst 'DEU=ABCDEFGHIJKLMNOPQRSTUVWXYZéôö;ENU=ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      Text011@1010 : TextConst 'DEU=Wenn Perioden und Jahre angegeben werden, kînnen Zahlen von 1 - 999, wie P-1, P1, J2 oder J+3, verwendet werden.;ENU=When specifying periods and years you can use numbers from 1 - 999, such as P-1, P1, Y2 or Y+3.';
      Text012@1011 : TextConst 'DEU=<Precision,%1><Standard format,0>;ENU=<Precision,%1><Standard format,0>';
      Text016@1013 : TextConst 'DEU=Ohne MwSt.;ENU=Excl. VAT';
      Text017@1014 : TextConst 'DEU=inkl. MwSt.;ENU=Incl. VAT';
      Currency@1025 : Record 4;
      GLSetup@1018 : Record 98;
      AccountingPeriod@1019 : Record 50;
      StdTxt@1020 : Record 7;
      Dim@1026 : Record 348;
      EmployeePortalApplSrv@1017 : Codeunit 6810;
      LogInWorkDate@1021 : Date;
      LogInDate@1022 : Date;
      LogInTime@1023 : Time;
      Sign@1028 : Text[1];
      PartOfText@1029 : Text[132];
      Date@1030 : Date;
      Date1@1031 : Date;
      Date2@1032 : Date;
      Text1@1033 : Text[30];
      Text2@1034 : Text[30];
      Numeral@1035 : Integer;
      i@1036 : Integer;
      OK@1037 : Boolean;
      Text019@1016 : TextConst 'DEU=Der Endbenutzer-Lizenzvertrag (EULA) wurde nicht akzeptiert.;ENU=End User License Agreement has not been accepted.';
      Text020@1015 : TextConst 'DEU=Das Aktivierungsdatum ist %1.;ENU=The Go Live date is %1.';
      Text021@1012 : TextConst 'DEU=Klicken Sie auf ''Microsoft Dynamics NAV'', ''Mandant auswÑhlen'', um den Demomandanten zu schlie·en und einen neuen Mandanten zu îffnen.;ENU=To close the demonstration company and open another company, click Microsoft Dynamics NAV, Select Company.';
      GLSetupRead@1024 : Boolean;

    PROCEDURE CompanyOpen@30();
    BEGIN
      IF GUIALLOWED THEN
        LogInStart;
    END;

    PROCEDURE GetSystemIndicator@51(VAR Text@1000 : Text[250];VAR Style@1001 : 'Standard,Accent1,Accent2,Accent3,Accent4,Accent5,Accent6,Accent7,Accent8,Accent9');
    VAR
      CompanyInformation@1002 : Record 79;
    BEGIN
      IF CompanyInformation.GET THEN
        CompanyInformation.GetSystemIndicator(Text,Style)
    END;

    PROCEDURE CompanyClose@31();
    VAR
      MobDocDispatcher@1000 : Codeunit 8700;
      BizTalkApplnSrvStartup@1001 : Codeunit 99008528;
    BEGIN
      EmployeePortalApplSrv.StopQueue;
      MobDocDispatcher.Stop;
      BizTalkApplnSrvStartup.StopTcpListen;
      IF GUIALLOWED THEN
        LogInEnd;
    END;

    PROCEDURE FindPrinter@11(ReportID@1000 : Integer) : Text[250];
    VAR
      PrinterSelection@1001 : Record 78;
    BEGIN
      CLEAR(PrinterSelection);

      IF NOT PrinterSelection.GET(USERID,ReportID) THEN
        IF NOT PrinterSelection.GET('',ReportID) THEN
          IF NOT PrinterSelection.GET(USERID,0) THEN
            IF PrinterSelection.GET('',0) THEN;

      EXIT(PrinterSelection."Printer Name");
    END;

    LOCAL PROCEDURE LogInStart@10001();
    VAR
      GLSetup@1000 : Record 98;
      GLEntry@1001 : Record 17;
      RMSetup@1002 : Record 5079;
      Profile@1006 : Record 2000000072;
      LicenseAgreement@1008 : Record 140;
      CompanyInitialize@1003 : Codeunit 2;
      ConfPersMgt@1004 : Codeunit 9170;
      Language@1005 : Record 2000000045;
      "**** activeTAPI ****"@1113900000 : Integer;
      AppTrace@1113900002 : Automation "{600E23A8-24BF-43EE-BA93-691E0DFFAD1A} 2.0:{1B61767C-91A3-4632-9E92-A8C29C7DA936}:'activeTAPI_NET_Services'.AppTrace";
      TAPIFu@1113900001 : Codeunit 56780;
      UserSetUp@1113900003 : Record 91;
    BEGIN
      IF (STRPOS(COMPANYNAME,Text000) < 1) AND LicenseAgreement.GET THEN
        IF (TODAY >= LicenseAgreement."Effective Date") AND NOT LicenseAgreement.Accepted THEN BEGIN
          FORM.RUNMODAL(FORM::"License Agreement Accept");
          LicenseAgreement.GET;
          IF NOT LicenseAgreement.Accepted THEN
            MESSAGE(Text019);
        END ELSE
          IF TODAY < LicenseAgreement."Effective Date" THEN
            MESSAGE(Text020,LicenseAgreement."Effective Date");

      Language.SETRANGE("STX File Exist",TRUE);
      Language.SETRANGE("Globally Enabled",TRUE);
      Language."Language ID" := GLOBALLANGUAGE;
      IF NOT Language.FIND THEN BEGIN
        Language."Language ID" := WINDOWSLANGUAGE;
        IF NOT Language.FIND THEN
          Language."Language ID" := ApplicationLanguage;
      END;
      GLOBALLANGUAGE := Language."Language ID";

      IF NOT GLSetup.GET THEN BEGIN
        CompanyInitialize.RUN;
        COMMIT;
        CLEAR(CompanyInitialize);
      END;

      IF Profile.ISEMPTY THEN BEGIN
        ConfPersMgt.RUN;
        COMMIT;
        CLEAR(ConfPersMgt);
      END;

      LogInDate := TODAY;
      LogInTime := TIME;
      LogInWorkDate := 0D;
      IF STRPOS(COMPANYNAME,Text000) = 1 THEN
        IF GLEntry.READPERMISSION THEN BEGIN
          GLEntry.SETCURRENTKEY("G/L Account No.","Posting Date");
          OK := TRUE;
          REPEAT
            GLEntry.SETFILTER("G/L Account No.",'>%1',GLEntry."G/L Account No.");
            GLEntry.SETFILTER("Posting Date",'>%1',GLEntry."Posting Date");
            IF GLEntry.FINDFIRST THEN BEGIN
              GLEntry.SETRANGE("G/L Account No.",GLEntry."G/L Account No.");
              GLEntry.SETRANGE("Posting Date");
              GLEntry.FINDLAST;
            END ELSE
              OK := FALSE
          UNTIL NOT OK;
          IF NOT (GLEntry."Posting Date" IN [0D,WORKDATE]) THEN BEGIN
            IF NOT ISSERVICETIER THEN
              MESSAGE(
                Text001 +
                Text002 +
                Text003,
                COMPANYNAME,NORMALDATE(GLEntry."Posting Date"))
            ELSE
              MESSAGE(
                Text001 +
                Text002 +
                Text021,
                COMPANYNAME,NORMALDATE(GLEntry."Posting Date"));
            LogInWorkDate := WORKDATE;
            WORKDATE := NORMALDATE(GLEntry."Posting Date");
          END;
        END;

      RMSetup.GET;
      IF (RMSetup."E-Mail Logging User ID" <> '') AND (RMSetup."E-Mail Logging User ID" = UPPERCASE(USERID)) THEN
        CODEUNIT.RUN(CODEUNIT::"E-Mail Dispatcher");

      // AT2011 CHANGED
      IF ISCLEAR(AppTrace) THEN
        CREATE(AppTrace,TRUE,TRUE);
      AppTrace.InfoMessage('Start AppTrace in CU1');

      // AT01 BEGIN
      IF UserSetUp.GET(USERID) THEN BEGIN
        IF UserSetUp."Use active TAPI" THEN BEGIN
      // AT2011 START
          IF ISSERVICETIER THEN BEGIN
            // Page 56785 Page with Timer is started as Parameter of RTC-Start
            AppTrace.InfoMessage('ISSERVICETIER: Start Servicetier in CU1');
          END ELSE BEGIN
      // AT2011 END
            // Codeunit 56781
            CODEUNIT.RUN(CODEUNIT::"TAPI Main");
            AppTrace.InfoMessage('Start Codeunit TAPI Main in CU1');
          END;
        END;
      END;

      // AT2009 BEGIN
      CODEUNIT.RUN(CODEUNIT::"TAPI Functions SI");
      // AT2009 END
      // AT01 END
    END;

    LOCAL PROCEDURE LogInEnd@10002();
    VAR
      UserSetup@1000 : Record 91;
      UserTimeRegister@1001 : Record 51;
      LogOutDate@1002 : Date;
      LogOutTime@1003 : Time;
      Minutes@1004 : Integer;
      UserSetupFound@1005 : Boolean;
      RegisterTime@1006 : Boolean;
      "**** activeTAPI ****"@1113900000 : Integer;
      TAPIFu@1113900001 : Codeunit 56780;
    BEGIN
      IF LogInWorkDate <> 0D THEN
        IF LogInWorkDate = LogInDate THEN
          WORKDATE := TODAY
        ELSE
          WORKDATE := LogInWorkDate;

      IF USERID <> '' THEN BEGIN
        IF UserSetup.GET(USERID) THEN BEGIN
          UserSetupFound := TRUE;
          RegisterTime := UserSetup."Register Time";
        END;
        IF NOT UserSetupFound THEN
          IF GetGLSetup THEN
            RegisterTime := GLSetup."Register Time";
        IF RegisterTime THEN BEGIN
          LogOutDate := TODAY;
          LogOutTime := TIME;
          IF (LogOutDate > LogInDate) OR (LogOutDate = LogInDate) AND (LogOutTime > LogInTime) THEN
            Minutes := ROUND((1440 * (LogOutDate - LogInDate)) + ((LogOutTime - LogInTime) / 60000),1);
          IF Minutes = 0 THEN
            Minutes := 1;
          UserTimeRegister.INIT;
          UserTimeRegister."User ID" := USERID;
          UserTimeRegister.Date := LogInDate;
          IF UserTimeRegister.FIND THEN BEGIN
            UserTimeRegister.Minutes := UserTimeRegister.Minutes + Minutes;
            UserTimeRegister.MODIFY;
          END ELSE BEGIN
            UserTimeRegister.Minutes := Minutes;
            UserTimeRegister.INSERT;
          END;
        END;
      END;

      // AT01.20 BEGIN
      IF UserSetup.GET(USERID) THEN
        IF UserSetup."Use active TAPI" THEN
          TAPIFu.EndOfTAPI;
      // AT01.20 END
    END;

    PROCEDURE ApplicationVersion@2() : Text[80];
    BEGIN
      EXIT('DE Dynamics NAV 6.0 R2');
    END;

    PROCEDURE ApplicationBuild@3() : Text[80];
    BEGIN
      EXIT('32012');
    END;

    PROCEDURE BaseApplicationBuild@1000000() : Text[80];
    BEGIN
       EXIT('32012');
    END;

    PROCEDURE ApplicationLanguage@4() : Integer;
    BEGIN
      EXIT(1033);
    END;

    PROCEDURE DefaultRoleCenter@50() : Integer;
    VAR
      ConfPersMgt@1000 : Codeunit 9170;
    BEGIN
      EXIT(ConfPersMgt.DefaultRoleCenterID);
    END;

    PROCEDURE CodeCoverage@6();
    BEGIN
      FORM.RUN(FORM::"Code Coverage");
    END;

    PROCEDURE MakeDateTimeText@114(VAR DateTimeText@1000 : Text[250]) : Integer;
    VAR
      Date@1001 : Date;
      Time@1002 : Time;
    BEGIN
      IF GetSeparateDateTime(DateTimeText,Date,Time) THEN BEGIN
        IF Date = 0D THEN
          EXIT;
        IF Time = 0T THEN
          Time := 000000T;
        DateTimeText := FORMAT(CREATEDATETIME(Date,Time),0,1);
      END;
    END;

    PROCEDURE GetSeparateDateTime@10011(DateTimeText@1000 : Text[250];VAR Date@1005 : Date;VAR Time@1006 : Time) : Boolean;
    VAR
      DateText@1001 : Text[250];
      TimeText@1002 : Text[250];
      Position@1008 : Integer;
      Length@1007 : Integer;
    BEGIN
      Date := 0D;
      Time := 0T;
      Position := 1;
      Length := STRLEN(DateTimeText);
      ReadCharacter(' ',DateTimeText,Position,Length);
      ReadUntilCharacter(' ',DateTimeText,Position,Length);
      DateText := DELCHR(COPYSTR(DateTimeText,1,Position - 1),'<>');
      TimeText := DELCHR(COPYSTR(DateTimeText,Position),'<>');
      IF DateText = '' THEN
        EXIT(TRUE);

      IF MakeDateText(DateText) = 0 THEN;
      IF NOT EVALUATE(Date,DateText) THEN
        EXIT(FALSE);

      IF TimeText = '' THEN
        EXIT(TRUE);

      IF MakeTimeText(TimeText) = 0 THEN;
      IF EVALUATE(Time,TimeText) THEN
        EXIT(TRUE);
    END;

    PROCEDURE MakeDateText@105(VAR DateText@1000 : Text[250]) : Integer;
    VAR
      Position@1004 : Integer;
      Length@1003 : Integer;
    BEGIN
      Position := 1;
      Length := STRLEN(DateText);
      ReadCharacter(' ',DateText,Position,Length);
      IF NOT FindText(PartOfText,DateText,Position,Length) THEN
        EXIT(0);
      CASE PartOfText OF
        COPYSTR(Text005,1,STRLEN(PartOfText)):
          Date := TODAY;
        COPYSTR(Text006,1,STRLEN(PartOfText)):
          Date := WORKDATE;
        ELSE
          EXIT(0);
      END;
      Position := Position + STRLEN(PartOfText);
      ReadCharacter(' ',DateText,Position,Length);
      IF Position > Length THEN BEGIN
        DateText := FORMAT(Date);
        EXIT(0);
      END;
      EXIT(Position);
    END;

    PROCEDURE MakeTimeText@106(VAR TimeText@1000 : Text[250]) : Integer;
    VAR
      Position@1004 : Integer;
      Length@1003 : Integer;
    BEGIN
      Position := 1;
      Length := STRLEN(TimeText);
      ReadCharacter(' ',TimeText,Position,Length);
      IF NOT FindText(PartOfText,TimeText,Position,Length) THEN
        EXIT(0);
      IF PartOfText <> COPYSTR(Text007,1,STRLEN(PartOfText)) THEN
        EXIT(0);
      Position := Position + STRLEN(PartOfText);
      ReadCharacter(' ',TimeText,Position,Length);
      IF Position <= Length THEN
        EXIT(Position);
      TimeText := FORMAT(000000T + ROUND(TIME - 000000T,1000));
      EXIT(0);
    END;

    PROCEDURE MakeText@107(VAR Text@1000 : Text[250]) : Integer;
    VAR
      Position@1004 : Integer;
      Length@1003 : Integer;
    BEGIN
      Position := 1;
      Length := STRLEN(Text);
      ReadCharacter(' ',Text,Position,Length);
      IF NOT ReadSymbol('?',Text,Position,Length) THEN
        EXIT(0);
      PartOfText := COPYSTR(Text,Position);
      IF PartOfText = '' THEN BEGIN
        IF FORM.RUNMODAL(0,StdTxt) = ACTION::LookupOK THEN
          Text := StdTxt.Description;
        EXIT(0);
      END;
      StdTxt.Code := COPYSTR(Text,Position,MAXSTRLEN(StdTxt.Code));
      IF NOT StdTxt.FIND('=>') OR
         (UPPERCASE(PartOfText) <> COPYSTR(StdTxt.Code,1,STRLEN(PartOfText)))
      THEN
        EXIT(Position);
      Text := StdTxt.Description;
      EXIT(0);
    END;

    PROCEDURE MakeDateTimeFilter@214(VAR DateTimeFilterText@1000 : Text[250]) : Integer;
    VAR
      Head@1006 : Text[250];
      Tail@1008 : Text[250];
      Position@1012 : Integer;
      Length@1011 : Integer;
    BEGIN
      Position := 1;
      Length := STRLEN(DateTimeFilterText);
      WHILE Length <> 0 DO BEGIN
        ReadCharacter(' |()',DateTimeFilterText,Position,Length);
        IF Position > 1 THEN BEGIN
          Head := Head + COPYSTR(DateTimeFilterText,1,Position - 1);
          DateTimeFilterText := COPYSTR(DateTimeFilterText,Position);
          Position := 1;
          Length := STRLEN(DateTimeFilterText);
        END;
        IF Length <> 0 THEN BEGIN
          ReadUntilCharacter('|()',DateTimeFilterText,Position,Length);
          IF Position > 1 THEN BEGIN
            Tail := COPYSTR(DateTimeFilterText,Position);
            DateTimeFilterText := COPYSTR(DateTimeFilterText,1,Position - 1);
            MakeDateTimeFilter2(DateTimeFilterText);
            Head := Head + DateTimeFilterText;
            DateTimeFilterText := Tail;
            Position := 1;
            Length := STRLEN(DateTimeFilterText);
          END;
        END;
      END;
      DateTimeFilterText := Head;
    END;

    LOCAL PROCEDURE MakeDateTimeFilter2@10014(VAR DateTimeFilterText@1000 : Text[250]);
    VAR
      DateTime1@1002 : DateTime;
      DateTime2@1005 : DateTime;
      Date1@1007 : Date;
      Date2@1003 : Date;
      Time1@1004 : Time;
      Time2@1001 : Time;
      StringPosition@1011 : Integer;
    BEGIN
      StringPosition := STRPOS(DateTimeFilterText,'..');
      IF StringPosition = 0 THEN BEGIN
        IF NOT GetSeparateDateTime(DateTimeFilterText,Date1,Time1) THEN
          EXIT;
        IF Date1 = 0D THEN
          EXIT;
        IF Time1 = 0T THEN BEGIN
          IF GLSetup.RECORDLEVELLOCKING THEN
            DateTimeFilterText := FORMAT(CREATEDATETIME(Date1,000000T)) + '..' + FORMAT(CREATEDATETIME(Date1,235959.995T),0,1)
          ELSE
            DateTimeFilterText := FORMAT(CREATEDATETIME(Date1,000000T)) + '..' + FORMAT(CREATEDATETIME(Date1,235959.999T),0,1);
          EXIT;
        END;
        DateTimeFilterText := FORMAT(CREATEDATETIME(Date1,Time1),0,1);
        EXIT;
      END;

      IF NOT GetSeparateDateTime(COPYSTR(DateTimeFilterText,1,StringPosition - 1),Date1,Time1) THEN
        EXIT;
      IF NOT GetSeparateDateTime(COPYSTR(DateTimeFilterText,StringPosition + 2),Date2,Time2) THEN
        EXIT;

      IF (Date1 = 0D) AND (Date2 = 0D) THEN
        EXIT;

      IF (Date1 <> 0D) THEN BEGIN
        IF Time1 = 0T THEN
          Time1 := 000000T;
        DateTime1 := CREATEDATETIME(Date1,Time1);
      END;
      IF (Date2 <> 0D) THEN BEGIN
        IF Time2 = 0T THEN
          Time2 := 235959T;
        DateTime2 := CREATEDATETIME(Date2,Time2);
      END;
      DateTimeFilterText := FORMAT(DateTime1,0,1) + '..' + FORMAT(DateTime2,0,1);
    END;

    PROCEDURE MakeDateFilter@205(VAR DateFilterText@1000 : Text[250]) : Integer;
    VAR
      StringPosition@1001 : Integer;
    BEGIN
      StringPosition := STRPOS(DateFilterText,'..');
      IF StringPosition = 0 THEN BEGIN
        i := MakeDateFilter2(OK,Date1,Date2,DateFilterText);
        IF i <> 0 THEN
          EXIT(i);
        IF OK THEN
          IF Date1 = Date2 THEN
            DateFilterText := FORMAT(Date1)
          ELSE
            DateFilterText := STRSUBSTNO('%1..%2',Date1,Date2);
        EXIT(0);
      END;

      Text1 := COPYSTR(DateFilterText,1,StringPosition - 1);
      i := MakeDateFilter2(OK,Date1,Date2,Text1);
      IF i <> 0 THEN
        EXIT(i);
      IF OK THEN
        Text1 := FORMAT(Date1);

      ReadCharacter('.',DateFilterText,StringPosition,STRLEN(DateFilterText));

      Text2 := COPYSTR(DateFilterText,StringPosition);
      i := MakeDateFilter2(OK,Date1,Date2,Text2);
      IF i <> 0 THEN
        EXIT(StringPosition + i - 1);
      IF OK THEN
        Text2 := FORMAT(Date2);

      DateFilterText := Text1 + '..' + Text2;
      EXIT(0);
    END;

    LOCAL PROCEDURE MakeDateFilter2@10003(VAR OK@1000 : Boolean;VAR Date1@1001 : Date;VAR Date2@1002 : Date;VAR DateFilterText@1003 : Text[250]) : Integer;
    VAR
      Position@1007 : Integer;
      Length@1006 : Integer;
    BEGIN
      Position := 1;
      Length := STRLEN(DateFilterText);
      ReadCharacter(' ',DateFilterText,Position,Length);
      IF FindText(PartOfText,DateFilterText,Position,Length) THEN
        CASE PartOfText OF
          COPYSTR(Text008,1,STRLEN(PartOfText)):
            BEGIN
              OK := TRUE;
              Position := Position + STRLEN(PartOfText);
              EXIT(FindPeriod(Date1,Date2,FALSE,DateFilterText,Position,Length));
            END;
          COPYSTR(Text009,1,STRLEN(PartOfText)):
            BEGIN
              OK := TRUE;
              Position := Position + STRLEN(PartOfText);
              EXIT(FindPeriod(Date1,Date2,TRUE,DateFilterText,Position,Length));
            END;
          COPYSTR(Text005,1,STRLEN(PartOfText)):
            BEGIN
              OK := TRUE;
              Position := Position + STRLEN(PartOfText);
              ReadCharacter(' ',DateFilterText,Position,Length);
              IF Position <= Length THEN
                EXIT(Position);
              Date1 := TODAY;
              Date2 := Date1;
              EXIT(0);
            END;
          COPYSTR(Text006,1,STRLEN(PartOfText)):
            BEGIN
              OK := TRUE;
              Position := Position + STRLEN(PartOfText);
              ReadCharacter(' ',DateFilterText,Position,Length);
              IF Position <= Length THEN
                EXIT(Position);
              Date1 := WORKDATE;
              Date2 := Date1;
              EXIT(0);
            END;
        END;
      OK := FALSE;
      EXIT(0);
    END;

    LOCAL PROCEDURE FindPeriod@10004(VAR Date1@1000 : Date;VAR Date2@1001 : Date;FindYear@1002 : Boolean;VAR DateFilterText@1003 : Text[250];VAR Position@1004 : Integer;Length@1005 : Integer) : Integer;
    BEGIN
      ReadCharacter(' ',DateFilterText,Position,Length);
      IF FindYear THEN
        AccountingPeriod.SETRANGE("New Fiscal Year",TRUE)
      ELSE
        AccountingPeriod.SETRANGE("New Fiscal Year");
      Sign := '';
      IF ReadSymbol('+',DateFilterText,Position,Length) THEN
        Sign := '+'
      ELSE
        IF ReadSymbol('-',DateFilterText,Position,Length) THEN
          Sign := '-';
      IF Sign = '' THEN
        IF ReadNumeral(Numeral,DateFilterText,Position,Length) THEN BEGIN
          IF FindYear THEN
            AccountingPeriod.FINDFIRST
          ELSE BEGIN
            AccountingPeriod.SETRANGE("New Fiscal Year",TRUE);
            AccountingPeriod."Starting Date" := WORKDATE;
            AccountingPeriod.FIND('=<');
            AccountingPeriod.SETRANGE("New Fiscal Year");
          END;
          AccountingPeriod.NEXT(Numeral - 1);
        END ELSE BEGIN
          AccountingPeriod."Starting Date" := WORKDATE;
          AccountingPeriod.FIND('=<');
        END
      ELSE BEGIN
        IF NOT ReadNumeral(Numeral,DateFilterText,Position,Length) THEN
          EXIT(Position);
        IF Sign = '-' THEN
          Numeral := -Numeral;
        AccountingPeriod."Starting Date" := WORKDATE;
        AccountingPeriod.FIND('=<');
        AccountingPeriod.NEXT(Numeral);
      END;
      Date1 := AccountingPeriod."Starting Date";
      IF AccountingPeriod.NEXT = 0 THEN
        Date2 := 31129999D
      ELSE
        Date2 := AccountingPeriod."Starting Date" - 1;
      ReadCharacter(' ',DateFilterText,Position,Length);
      IF Position <= Length THEN
        EXIT(Position);
      EXIT(0);
    END;

    LOCAL PROCEDURE FindText@10005(VAR PartOfText@1000 : Text[250];VAR Text@1001 : Text[250];Position@1002 : Integer;Length@1003 : Integer) : Boolean;
    VAR
      Position2@1005 : Integer;
    BEGIN
      Position2 := Position;
      ReadCharacter(Text010,Text,Position,Length);
      IF Position = Position2 THEN
        EXIT(FALSE);
      PartOfText := UPPERCASE(COPYSTR(Text,Position2,Position - Position2));
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE ReadSymbol@10006(Token@1000 : Text[30];VAR Text@1001 : Text[250];VAR Position@1002 : Integer;Length@1003 : Integer) : Boolean;
    BEGIN
      IF Token <> COPYSTR(Text,Position,STRLEN(Token)) THEN
        EXIT(FALSE);
      Position := Position + STRLEN(Token);
      ReadCharacter(' ',Text,Position,Length);
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE ReadNumeral@10007(VAR Numeral@1000 : Integer;VAR Text@1001 : Text[250];VAR Position@1002 : Integer;Length@1003 : Integer) : Boolean;
    VAR
      Position2@1005 : Integer;
    BEGIN
      Position2 := Position;
      ReadCharacter('0123456789',Text,Position,Length);
      IF Position2 = Position THEN
        EXIT(FALSE);
      Numeral := 0;
      FOR i := Position2 TO Position - 1 DO
        IF Numeral < 1000 THEN
          Numeral := Numeral * 10 + STRPOS('0123456789',COPYSTR(Text,i,1)) - 1;
      IF (Numeral < 1) OR (Numeral > 999) THEN
        ERROR(Text011);
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE ReadCharacter@10008(Character@1000 : Text[50];VAR Text@1001 : Text[250];VAR Position@1002 : Integer;Length@1003 : Integer);
    BEGIN
      WHILE (Position <= Length) AND (STRPOS(Character,UPPERCASE(COPYSTR(Text,Position,1))) <> 0) DO
        Position := Position + 1;
    END;

    LOCAL PROCEDURE ReadUntilCharacter@10010(Character@1000 : Text[50];VAR Text@1001 : Text[250];VAR Position@1002 : Integer;Length@1003 : Integer);
    BEGIN
      WHILE (Position <= Length) AND (STRPOS(Character,UPPERCASE(COPYSTR(Text,Position,1))) = 0) DO
        Position := Position + 1;
    END;

    PROCEDURE AutoFormatTranslate@12(AutoFormatType@1000 : Integer;AutoFormatExpr@1001 : Text[80]) : Text[80];
    BEGIN
      IF AutoFormatType = 0 THEN
        EXIT('');

      IF NOT GetGLSetup THEN
        EXIT('');

      CASE AutoFormatType OF
        1: // Amount
          IF AutoFormatExpr = '' THEN
            EXIT(STRSUBSTNO(Text012,GLSetup."Amount Decimal Places"))
          ELSE BEGIN
            IF GetCurrency(COPYSTR(AutoFormatExpr,1,10)) AND
               (Currency."Amount Decimal Places" <> '')
            THEN
              EXIT(STRSUBSTNO(Text012,Currency."Amount Decimal Places"))
            ELSE
              EXIT(STRSUBSTNO(Text012,GLSetup."Amount Decimal Places"));
          END;

        2: // Unit Amount
          IF AutoFormatExpr = '' THEN
            EXIT(STRSUBSTNO(Text012,GLSetup."Unit-Amount Decimal Places"))
          ELSE BEGIN
            IF GetCurrency(COPYSTR(AutoFormatExpr,1,10)) AND
               (Currency."Unit-Amount Decimal Places" <> '')
            THEN
              EXIT(STRSUBSTNO(Text012,Currency."Unit-Amount Decimal Places"))
            ELSE
              EXIT(STRSUBSTNO(Text012,GLSetup."Unit-Amount Decimal Places"));
          END;
        10: EXIT('<Custom,' + AutoFormatExpr + '>');
      END;
    END;

    PROCEDURE ReadRounding@14() Rounding@1000 : Decimal;
    BEGIN
      GetGLSetup;
      EXIT(GLSetup."Amount Rounding Precision");
    END;

    PROCEDURE CaptionClassTranslate@15(Language@1000 : Integer;CaptionExpr@1001 : Text[1024]) : Text[1024];
    VAR
      CaptionArea@1002 : Text[80];
      CaptionRef@1003 : Text[1024];
      CommaPosition@1004 : Integer;
    BEGIN
      CommaPosition := STRPOS(CaptionExpr,',');
      IF (CommaPosition > 0) AND (CommaPosition < 80) THEN BEGIN
        CaptionArea := COPYSTR(CaptionExpr,1,CommaPosition - 1);
        CaptionRef := COPYSTR(CaptionExpr,CommaPosition + 1);
        CASE CaptionArea OF
          '1' : EXIT(DimCaptionClassTranslate(Language,COPYSTR(CaptionRef,1,80)));
          '2' : EXIT(VATCaptionClassTranslate(Language,COPYSTR(CaptionRef,1,80)));
          '3' : EXIT(CaptionRef);
        END;
      END;
      EXIT(CaptionExpr);
    END;

    LOCAL PROCEDURE DimCaptionClassTranslate@10009(Language@1000 : Integer;CaptionExpr@1001 : Text[80]) : Text[80];
    VAR
      DimCaptionType@1003 : Text[80];
      DimCaptionRef@1004 : Text[80];
      DimOptionalParam1@1005 : Text[80];
      DimOptionalParam2@1006 : Text[80];
      CommaPosition@1007 : Integer;
    BEGIN
      IF NOT GetGLSetup THEN
        EXIT('');

      CommaPosition := STRPOS(CaptionExpr,',');
      IF (CommaPosition > 0) THEN BEGIN
        DimCaptionType := COPYSTR(CaptionExpr,1,CommaPosition - 1);
        DimCaptionRef := COPYSTR(CaptionExpr,CommaPosition + 1);
        CommaPosition := STRPOS(DimCaptionRef,',');
        IF (CommaPosition > 0) THEN BEGIN
          DimOptionalParam1 := COPYSTR(DimCaptionRef,CommaPosition + 1);
          DimCaptionRef := COPYSTR(DimCaptionRef,1,CommaPosition - 1);
          CommaPosition := STRPOS(DimOptionalParam1,',');
          IF (CommaPosition > 0) THEN BEGIN
            DimOptionalParam2 := COPYSTR(DimOptionalParam1,CommaPosition + 1);
            DimOptionalParam1 := COPYSTR(DimOptionalParam1,1,CommaPosition - 1);
          END ELSE BEGIN
            DimOptionalParam2 := '';
          END;
        END ELSE BEGIN
          DimOptionalParam1 := '';
          DimOptionalParam2 := '';
        END;
        CASE DimCaptionType OF
          '1':  // Code Caption - Global Dimension using No. as Reference
            BEGIN
              CASE DimCaptionRef OF
                '1':
                  BEGIN
                    IF Dim.GET(GLSetup."Global Dimension 1 Code") THEN
                      EXIT(DimOptionalParam1 + Dim.GetMLCodeCaption(Language) + DimOptionalParam2)
                    ELSE
                      EXIT(
                        DimOptionalParam1 +
                        GLSetup.FIELDCAPTION("Global Dimension 1 Code") +
                        DimOptionalParam2);
                  END;
                '2':
                  BEGIN
                    IF Dim.GET(GLSetup."Global Dimension 2 Code") THEN
                      EXIT(DimOptionalParam1 + Dim.GetMLCodeCaption(Language) + DimOptionalParam2)
                    ELSE
                      EXIT(
                        DimOptionalParam1 +
                        GLSetup.FIELDCAPTION("Global Dimension 2 Code") +
                        DimOptionalParam2);
                  END;
              END;
            END;
          '2':  // Code Caption - Shortcut Dimension using No. as Reference
            BEGIN
              CASE DimCaptionRef OF
                '1':
                  BEGIN
                    IF Dim.GET(GLSetup."Shortcut Dimension 1 Code") THEN
                      EXIT(DimOptionalParam1 + Dim.GetMLCodeCaption(Language) + DimOptionalParam2)
                    ELSE
                      EXIT(
                        DimOptionalParam1 +
                        GLSetup.FIELDCAPTION("Shortcut Dimension 1 Code") +
                        DimOptionalParam2);
                  END;
                '2':
                  BEGIN
                    IF Dim.GET(GLSetup."Shortcut Dimension 2 Code") THEN
                      EXIT(DimOptionalParam1 + Dim.GetMLCodeCaption(Language) + DimOptionalParam2)
                    ELSE
                      EXIT(
                        DimOptionalParam1 +
                        GLSetup.FIELDCAPTION("Shortcut Dimension 2 Code") +
                        DimOptionalParam2);
                  END;
                '3':
                  BEGIN
                    IF Dim.GET(GLSetup."Shortcut Dimension 3 Code") THEN
                      EXIT(DimOptionalParam1 + Dim.GetMLCodeCaption(Language) + DimOptionalParam2)
                    ELSE
                      EXIT(
                        DimOptionalParam1 +
                        GLSetup.FIELDCAPTION("Shortcut Dimension 3 Code") +
                        DimOptionalParam2);
                  END;
                '4':
                  BEGIN
                    IF Dim.GET(GLSetup."Shortcut Dimension 4 Code") THEN
                      EXIT(DimOptionalParam1 + Dim.GetMLCodeCaption(Language) + DimOptionalParam2)
                    ELSE
                      EXIT(
                        DimOptionalParam1 +
                        GLSetup.FIELDCAPTION("Shortcut Dimension 4 Code") +
                        DimOptionalParam2);
                  END;
                '5':
                  BEGIN
                    IF Dim.GET(GLSetup."Shortcut Dimension 5 Code") THEN
                      EXIT(DimOptionalParam1 + Dim.GetMLCodeCaption(Language) + DimOptionalParam2)
                    ELSE
                      EXIT(
                        DimOptionalParam1 +
                        GLSetup.FIELDCAPTION("Shortcut Dimension 5 Code") +
                        DimOptionalParam2);
                  END;
                '6':
                  BEGIN
                    IF Dim.GET(GLSetup."Shortcut Dimension 6 Code") THEN
                      EXIT(DimOptionalParam1 + Dim.GetMLCodeCaption(Language) + DimOptionalParam2)
                    ELSE
                      EXIT(
                        DimOptionalParam1 +
                        GLSetup.FIELDCAPTION("Shortcut Dimension 6 Code") +
                        DimOptionalParam2);
                  END;
                '7':
                  BEGIN
                    IF Dim.GET(GLSetup."Shortcut Dimension 7 Code") THEN
                      EXIT(DimOptionalParam1 + Dim.GetMLCodeCaption(Language) + DimOptionalParam2)
                    ELSE
                      EXIT(
                        DimOptionalParam1 +
                        GLSetup.FIELDCAPTION("Shortcut Dimension 7 Code") +
                        DimOptionalParam2);
                  END;
                '8':
                  BEGIN
                    IF Dim.GET(GLSetup."Shortcut Dimension 8 Code") THEN
                      EXIT(DimOptionalParam1 + Dim.GetMLCodeCaption(Language) + DimOptionalParam2)
                    ELSE
                      EXIT(
                        DimOptionalParam1 +
                        GLSetup.FIELDCAPTION("Shortcut Dimension 8 Code") +
                        DimOptionalParam2);
                  END;
              END;
            END;
          '3':  // Filter Caption - Global Dimension using No. as Reference
            BEGIN
              CASE DimCaptionRef OF
                '1':
                  BEGIN
                    IF Dim.GET(GLSetup."Global Dimension 1 Code") THEN
                      EXIT(DimOptionalParam1 + Dim.GetMLFilterCaption(Language) + DimOptionalParam2)
                    ELSE
                      EXIT(
                        DimOptionalParam1 +
                        GLSetup.FIELDCAPTION("Global Dimension 1 Filter") +
                        DimOptionalParam2);
                  END;
                '2':
                  BEGIN
                    IF Dim.GET(GLSetup."Global Dimension 2 Code") THEN
                      EXIT(DimOptionalParam1 + Dim.GetMLFilterCaption(Language) + DimOptionalParam2)
                    ELSE
                      EXIT(
                        DimOptionalParam1 +
                        GLSetup.FIELDCAPTION("Global Dimension 2 Filter") +
                        DimOptionalParam2);
                  END;
              END;
            END;
          '4':  // Filter Caption - Shortcut Dimension using No. as Reference
            BEGIN
              CASE DimCaptionRef OF
                '1':
                  BEGIN
                    IF Dim.GET(GLSetup."Shortcut Dimension 1 Code") THEN
                      EXIT(DimOptionalParam1 + Dim.GetMLFilterCaption(Language) + DimOptionalParam2)
                    ELSE
                      EXIT(
                        DimOptionalParam1 +
                        GLSetup.FIELDCAPTION("Shortcut Dimension 1 Code") +
                        DimOptionalParam2);
                  END;
                '2':
                  BEGIN
                    IF Dim.GET(GLSetup."Shortcut Dimension 2 Code") THEN
                      EXIT(DimOptionalParam1 + Dim.GetMLFilterCaption(Language) + DimOptionalParam2)
                    ELSE
                      EXIT(
                        DimOptionalParam1 +
                        GLSetup.FIELDCAPTION("Shortcut Dimension 2 Code") +
                        DimOptionalParam2);
                  END;
                '3':
                  BEGIN
                    IF Dim.GET(GLSetup."Shortcut Dimension 3 Code") THEN
                      EXIT(DimOptionalParam1 + Dim.GetMLFilterCaption(Language) + DimOptionalParam2)
                    ELSE
                      EXIT(
                        DimOptionalParam1 +
                        GLSetup.FIELDCAPTION("Shortcut Dimension 3 Code") +
                        DimOptionalParam2);
                  END;
                '4':
                  BEGIN
                    IF Dim.GET(GLSetup."Shortcut Dimension 4 Code") THEN
                      EXIT(DimOptionalParam1 + Dim.GetMLFilterCaption(Language) + DimOptionalParam2)
                    ELSE
                      EXIT(
                        DimOptionalParam1 +
                        GLSetup.FIELDCAPTION("Shortcut Dimension 4 Code") +
                        DimOptionalParam2);
                  END;
                '5':
                  BEGIN
                    IF Dim.GET(GLSetup."Shortcut Dimension 5 Code") THEN
                      EXIT(DimOptionalParam1 + Dim.GetMLFilterCaption(Language) + DimOptionalParam2)
                    ELSE
                      EXIT(
                        DimOptionalParam1 +
                        GLSetup.FIELDCAPTION("Shortcut Dimension 5 Code") +
                        DimOptionalParam2);
                  END;
                '6':
                  BEGIN
                    IF Dim.GET(GLSetup."Shortcut Dimension 6 Code") THEN
                      EXIT(DimOptionalParam1 + Dim.GetMLFilterCaption(Language) + DimOptionalParam2)
                    ELSE
                      EXIT(
                        DimOptionalParam1 +
                        GLSetup.FIELDCAPTION("Shortcut Dimension 6 Code") +
                        DimOptionalParam2);
                  END;
                '7':
                  BEGIN
                    IF Dim.GET(GLSetup."Shortcut Dimension 7 Code") THEN
                      EXIT(DimOptionalParam1 + Dim.GetMLFilterCaption(Language) + DimOptionalParam2)
                    ELSE
                      EXIT(
                        DimOptionalParam1 +
                        GLSetup.FIELDCAPTION("Shortcut Dimension 7 Code") +
                        DimOptionalParam2);
                  END;
                '8':
                  BEGIN
                    IF Dim.GET(GLSetup."Shortcut Dimension 8 Code") THEN
                      EXIT(DimOptionalParam1 + Dim.GetMLFilterCaption(Language) + DimOptionalParam2)
                    ELSE
                      EXIT(
                        DimOptionalParam1 +
                        GLSetup.FIELDCAPTION("Shortcut Dimension 8 Code") +
                        DimOptionalParam2);
                  END;
              END;
            END;
          '5':  // Code Caption - using Dimension Code as Reference
            BEGIN
              IF Dim.GET(DimCaptionRef) THEN
                EXIT(DimOptionalParam1 + Dim.GetMLCodeCaption(Language) + DimOptionalParam2)
              ELSE
                EXIT(DimOptionalParam1);
            END;
          '6':  // Filter Caption - using Dimension Code as Reference
            BEGIN
              IF Dim.GET(DimCaptionRef) THEN
                EXIT(DimOptionalParam1 + Dim.GetMLFilterCaption(Language) + DimOptionalParam2)
              ELSE
                EXIT(DimOptionalParam1);
            END;
        END;
      END;
      EXIT('');
    END;

    LOCAL PROCEDURE VATCaptionClassTranslate@100010(Language@1000 : Integer;CaptionExpr@1001 : Text[80]) : Text[80];
    VAR
      VATCaptionType@1002 : Text[80];
      VATCaptionRef@1003 : Text[80];
      CommaPosition@1004 : Integer;
    BEGIN
      CommaPosition := STRPOS(CaptionExpr,',');
      IF (CommaPosition > 0) THEN BEGIN
        VATCaptionType := COPYSTR(CaptionExpr,1,CommaPosition - 1);
        VATCaptionRef := COPYSTR(CaptionExpr,CommaPosition + 1);
        CASE VATCaptionType OF
          '0':
            EXIT(COPYSTR(STRSUBSTNO('%1 %2',VATCaptionRef,Text016),1,80));
          '1':
            EXIT(COPYSTR(STRSUBSTNO('%1 %2',VATCaptionRef,Text017),1,80));
        END;
      END;
      EXIT('');
    END;

    PROCEDURE SetGlobalLanguage@5();
    VAR
      TempLanguage@1001 : TEMPORARY Record 2000000045;
    BEGIN
      GetApplicationLanguages(TempLanguage);

      WITH TempLanguage DO BEGIN
        SETCURRENTKEY(Name);
        IF GET(GLOBALLANGUAGE) THEN;
        FORM.RUN(FORM::"Application Languages",TempLanguage);
      END;
    END;

    LOCAL PROCEDURE GetApplicationLanguages@1033(VAR TempLanguage@1034 : TEMPORARY Record 2000000045);
    VAR
      Language@1035 : Record 2000000045;
    BEGIN
      WITH Language DO BEGIN
        SETRANGE("STX File Exist",TRUE);
        SETRANGE("Globally Enabled",TRUE);
        IF FINDSET THEN
          REPEAT
            TempLanguage := Language;
            TempLanguage.INSERT;
          UNTIL NEXT = 0;
        IF GET(ApplicationLanguage) THEN BEGIN
          TempLanguage := Language;
          IF TempLanguage.INSERT THEN;
        END;
      END;
    END;

    PROCEDURE ValidateApplicationlLanguage@1102601001(LanguageID@1037 : Integer);
    VAR
      TempLanguage@1038 : TEMPORARY Record 2000000045;
    BEGIN
      GetApplicationLanguages(TempLanguage);

      WITH TempLanguage DO BEGIN
        SETRANGE("Language ID",LanguageID);
        FINDFIRST;
      END;
    END;

    PROCEDURE LookupApplicationlLanguage@1102601005(VAR LanguageID@1040 : Integer);
    VAR
      TempLanguage@1039 : TEMPORARY Record 2000000045;
    BEGIN
      GetApplicationLanguages(TempLanguage);

      WITH TempLanguage DO BEGIN
        IF GET(LanguageID) THEN;
        IF FORM.RUNMODAL(FORM::"Windows Languages",TempLanguage) = ACTION::LookupOK THEN
          LanguageID := TempLanguage."Language ID";
      END;
    END;

    PROCEDURE NASHandler@99(NASID@1000 : Text[260]);
    VAR
      BizTalkNASStartup@1009 : Codeunit 99008528;
      ADCSNASStartup@1011 : Codeunit 7700;
      MobDocDispatcher@1002 : Codeunit 8700;
      JobQueueSetup@1001 : Record 470;
      Parameter@1008 : Text[260];
      ParamStr@1007 : Text[260];
      SepPosition@1006 : Integer;
      PortNumber@1010 : Integer;
      CGNASStartedinLoop@1012 : Boolean;
      ADCSID@1013 : Text[260];
      EmployeePortalTrustNAS@1015 : Codeunit 6870;
      EPNASSetup@1016 : Record 6870;
    BEGIN
      ParamStr := UPPERCASE(NASID);
      REPEAT
        SepPosition := STRPOS(ParamStr,',');
        IF SepPosition > 0 THEN
          Parameter := COPYSTR(ParamStr,1,SepPosition - 1)
        ELSE
          Parameter := COPYSTR(ParamStr,1);
          IF (COPYSTR(Parameter,1,2) = 'CG') THEN BEGIN
            IF STRPOS(Parameter,' PORT=') > 0 THEN
              IF EVALUATE(PortNumber,COPYSTR(Parameter,STRPOS(Parameter,'=') + 1)) THEN BEGIN
                IF (PortNumber >= 1) AND (PortNumber <= 65535) THEN
                BEGIN
                   BizTalkNASStartup.RUN;
                   IF BizTalkNASStartup.StartTcpListen(PortNumber) THEN
                     CGNASStartedinLoop := TRUE
                   ELSE
                     CGNASStartedinLoop := FALSE
                 END ELSE
                   CGNASStartedinLoop := FALSE;
                END;
                IF (STRLEN(Parameter) = 2) THEN BEGIN
                  BizTalkNASStartup.RUN;
                  IF BizTalkNASStartup.StartTcpListen(0) THEN
                    CGNASStartedinLoop := TRUE
                  ELSE
                    CGNASStartedinLoop := FALSE;
                END;
          END;
        IF (COPYSTR(Parameter,1,4) = 'ADCS') THEN BEGIN
          IF STRPOS(Parameter,' ADCSID=') > 0 THEN
            IF EVALUATE(ADCSID,COPYSTR(Parameter,STRPOS(Parameter,'=') + 1)) THEN
              ADCSNASStartup.SetNASID(ADCSID)
            ELSE
              ADCSNASStartup.SetNASID('NAS1');
          ADCSNASStartup.RUN;
          CGNASStartedinLoop := TRUE;
        END;
        IF (COPYSTR(Parameter,1,4) = 'NEP-') THEN BEGIN
          EPNASSetup.GET(Parameter);
          IF EPNASSetup."Front End Processing" THEN BEGIN
            EmployeePortalApplSrv.SetNASID(Parameter);
            EmployeePortalApplSrv.RUN;
            CGNASStartedinLoop := TRUE;
          END;
          IF EPNASSetup."Handle Key Exchange" THEN BEGIN
            EmployeePortalTrustNAS.SetNASID(Parameter);
            EmployeePortalTrustNAS.RUN;
            CGNASStartedinLoop := TRUE;
          END;
        END;
        IF COPYSTR(Parameter,1,3) = 'MOB' THEN BEGIN
          MobDocDispatcher.Start(Parameter);
          CGNASStartedinLoop := TRUE;
        END;
        IF CGNASStartedinLoop = FALSE THEN
          CASE Parameter OF
            'OSYNCH','JOBQUEUE':
              BEGIN
                IF NOT JobQueueSetup.GET THEN BEGIN
                  JobQueueSetup.INIT;
                  JobQueueSetup.INSERT;
                END;
                IF NOT JobQueueSetup."Job Queue Active" THEN BEGIN
                  JobQueueSetup.VALIDATE("Job Queue Active",TRUE);
                  JobQueueSetup.MODIFY;
                END;
                CODEUNIT.RUN(CODEUNIT::"Job Queue Dispacher");
              END;
          END;
        ParamStr := COPYSTR(ParamStr,SepPosition + 1);
        CGNASStartedinLoop := FALSE;
      UNTIL SepPosition = 0;
    END;

    PROCEDURE GetGlobalTableTriggerMask@20(TableID@1000 : Integer) : Integer;
    VAR
      ChangeLogMgt@1001 : Codeunit 423;
    BEGIN
      EXIT(ChangeLogMgt.GetTableTriggerMask(TableID));
    END;

    PROCEDURE OnGlobalInsert@21(RecRef@1000 : RecordRef);
    VAR
      ChangLogMgt@1001 : Codeunit 423;
    BEGIN
      ChangLogMgt.LogInsertion(RecRef);
    END;

    PROCEDURE OnGlobalModify@22(RecRef@1000 : RecordRef;xRecRef@1002 : RecordRef);
    VAR
      ChangLogMgt@1001 : Codeunit 423;
    BEGIN
      ChangLogMgt.LogModification(RecRef,xRecRef);
    END;

    PROCEDURE OnGlobalDelete@23(RecRef@1000 : RecordRef);
    VAR
      ChangLogMgt@1001 : Codeunit 423;
    BEGIN
      ChangLogMgt.LogDeletion(RecRef);
    END;

    PROCEDURE OnGlobalRename@24(RecRef@1000 : RecordRef;xRecRef@1002 : RecordRef);
    VAR
      ChangLogMgt@1001 : Codeunit 423;
    BEGIN
      ChangLogMgt.LogRename(RecRef,xRecRef);
    END;

    PROCEDURE GetDatabaseTableTriggerSetup@25(TableId@1000 : Integer;VAR Insert@1001 : Boolean;VAR Modify@1002 : Boolean;VAR Delete@1003 : Boolean;VAR Rename@1004 : Boolean);
    VAR
      IntegrationManagement@1005 : Codeunit 5150;
    BEGIN
      IntegrationManagement.GetDatabaseTableTriggerSetup(TableId,Insert,Modify,Delete,Rename);
    END;

    PROCEDURE OnDatabaseInsert@26(RecRef@1000 : RecordRef);
    VAR
      IntegrationManagement@1001 : Codeunit 5150;
    BEGIN
      IntegrationManagement.OnDatabaseInsert(RecRef);
    END;

    PROCEDURE OnDatabaseModify@27(RecRef@1000 : RecordRef);
    VAR
      IntegrationManagement@1001 : Codeunit 5150;
    BEGIN
      IntegrationManagement.OnDatabaseModify(RecRef);
    END;

    PROCEDURE OnDatabaseDelete@28(RecRef@1000 : RecordRef);
    VAR
      IntegrationManagement@1001 : Codeunit 5150;
    BEGIN
      IntegrationManagement.OnDatabaseDelete(RecRef);
    END;

    PROCEDURE OnDatabaseRename@29(RecRef@1000 : RecordRef;xRecRef@1001 : RecordRef);
    VAR
      IntegrationManagement@1002 : Codeunit 5150;
    BEGIN
      IntegrationManagement.OnDatabaseRename(RecRef,xRecRef);
    END;

    PROCEDURE LaunchApp@116(DataXML@1000 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{88D96A05-F192-11D4-A65F-0040963251E5}:'Microsoft XML, v6.0'.DOMDocument60";StylesheetID@1001 : GUID;ApplicationXML@1002 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{88D96A05-F192-11D4-A65F-0040963251E5}:'Microsoft XML, v6.0'.DOMDocument60") : Boolean;
    VAR
      AppLaunchMgt@1010 : Codeunit 403;
    BEGIN
      EXIT(AppLaunchMgt.LaunchApp(DataXML,StylesheetID,ApplicationXML));
    END;

    PROCEDURE SelectStyleSheet@117(ObjectType@1000 : Integer;ObjectID@1001 : Integer;VAR StyleSheetID@1002 : GUID) : Boolean;
    VAR
      AppLaunchMgt@1003 : Codeunit 403;
    BEGIN
      EXIT(AppLaunchMgt.SelectStyleSheet(ObjectType,ObjectID,StyleSheetID));
    END;

    PROCEDURE ManageStyleSheets@118(ObjectType@1000 : Integer;ObjectID@1001 : Integer);
    VAR
      StyleSheets@1002 : Form 690;
    BEGIN
      StyleSheets.SetObject(ObjectType,ObjectID);
      StyleSheets.RUN;
    END;

    LOCAL PROCEDURE GetGLSetup@10015() : Boolean;
    BEGIN
      IF NOT GLSetupRead THEN
        GLSetupRead := GLSetup.GET;
      EXIT(GLSetupRead);
    END;

    LOCAL PROCEDURE GetCurrency@1(CurrencyCode@1000 : Code[10]) : Boolean;
    BEGIN
      IF CurrencyCode = Currency.Code THEN
        EXIT(TRUE);
      IF CurrencyCode = '' THEN BEGIN
        CLEAR(Currency);
        Currency.InitRoundingPrecision;
        EXIT(TRUE);
      END;
      EXIT(Currency.GET(CurrencyCode));
    END;

    BEGIN
    {
      [Procedure]CaptionClassTranslate (<LANGUAGE>;<CAPTIONEXPR>)
        LANGUAGE
          <DataType>   := [Integer]
          <DataValue>  := // Automatically mentioned by the system
        CAPTIONEXPR
          <DataType>   := [String]
          <Length>     <= 80
          <DataValue>  := <CAPTIONAREA>,<CAPTIONREF>
        CAPTIONAREA
          <DataType>   := [SubString]
          <Length>     <= 10
          <DataValue>  := 1..9999999999
                          // 1 for Dimension Area
                          // 2 for VAT
        CAPTIONREF
          <DataType>   := [SubString]
          <Length>     <= 10
          <DataValue>  := IF (<CAPTIONAREA> = 1) <DIMCAPTIONTYPE>,<DIMCAPTIONREF>
          <DataValue>  := IF (<CAPTIONAREA> = 2) <VATCAPTIONTYPE>
        DIMCAPTIONTYPE
          <DataType>   := [SubString]
          <Length>     <= 10
          <DataValue>  := 1..6
                          // 1 to retrieve Code Caption of Global Dimension
                          // 2 to retrieve Code Caption of Shortcut Dimension
                          // 3 to retrieve Filter Caption of Global Dimension
                          // 4 to retrieve Filter Caption of Shortcut Dimension
                          // 5 to retrieve Code Caption of any kind of Dimensions
                          // 6 to retrieve Filter Caption of any kind of Dimensions
        DIMCAPTIONREF
          <DataType>   := [SubString]
          <Length>     <= 10
          <DataValue>  := IF (<DIMCAPTIONTYPE> = 1) 1..2,<DIMOPTIONALPARAM1>,<DIMOPTIONALPARAM2>
                          IF (<DIMCAPTIONTYPE> = 2) 1..8,<DIMOPTIONALPARAM1>,<DIMOPTIONALPARAM2>
                          IF (<DIMCAPTIONTYPE> = 3) 1..2,<DIMOPTIONALPARAM1>,<DIMOPTIONALPARAM2>
                          IF (<DIMCAPTIONTYPE> = 4) 1..8,<DIMOPTIONALPARAM1>,<DIMOPTIONALPARAM2>
                          IF (<DIMCAPTIONTYPE> = 5) [Table]Dimension.[Field]Code,<DIMOPTIONALPARAM1>,<DIMOPTIONALPARAM2>
                          IF (<DIMCAPTIONTYPE> = 6) [Table]Dimension.[Field]Code,<DIMOPTIONALPARAM1>,<DIMOPTIONALPARAM2>
        DIMOPTIONALPARAM1
          <DataType>   := [SubString]
          <Length>     <= 30
          <DataValue>  := [String]

                                              // a string added before the dimension name
        DIMOPTIONALPARAM2
          <DataType>   := [SubString]
          <Length>     <= 30
          <DataValue>  := [String]
                          // a string added after the dimension name
        VATCAPTIONTYPE
          <DataType>   := [SubString]
          <Length>     =  1
          <DataValue>  := '0' -> <field caption + 'Excl. VAT'>
                          '1' -> <field caption + 'Incl. VAT'>

      <changelog>
        <add id="de0001"
             dev="mnommens"
             date="2004-08-01"
             area="VERSION"
             releaseversion="DACH4.00"
             request="DACH-START-40">
             Codeunit 1 for Version String
        </add>
        <change id="de0002"
                dev="mnommens"
                date="2005-04-29"
                area="VERSION"
                baseversion="DACH4.00"
                releaseversion="DACH4.00A"
                request="DACH-START-400A">
                Codeunit 1 for Version String
        </change>
        <add id="de0003" dev="jhoek" date="2006-09-04" area="UID" feature="NAVCORS3366"
        releaseversion="DE5.00">Added GetUIDOffset function</add>
        <add id="CF0001" dev="TMARTI" feature="PSCORS339" date="2006-04-25" area="LIQUIDITY"
          releaseversion="LIQEM5.00">
          Liquidity</add>
      </changelog>

      AT01 actTAPI 04.06.2003  Start Codeunit TAPI Main
                                 IF "User Setup"."Use active TAPI" = TRUE
                               in Trigger LoginStart, Local Var UserSetUp Rec 91
      AT01.20      08.09.2003  New function EndOfTAPI added
                               Local Var: TAPIFu CU 56780
      AT2009       06.11.2009  Start SI-Codeunit 56782 TAPI Functions SI in Trigger LoginStart
      AT2011       05.04.2011  Start AppTrace, Changes for RTC
                               StartOfTAPI (Part of TAPI Functions)
      AT2011.3     11.10.2011  Fix for Start and End Dialer (" added)
                               Reassignment for EndOfTAPI
    }
    END.
  }
}

OBJECT Codeunit 5055 CustVendBank-Update
{
  OBJECT-PROPERTIES
  {
    Date=05.01.11;
    Time=16:00:00;
    Modified=Yes;
    Version List=NAVW16.00.01,AT01;
  }
  PROPERTIES
  {
    TableNo=5050;
    OnRun=VAR
            ContBusRel@1000 : Record 5054;
          BEGIN
            ContBusRel.SETRANGE("Contact No.", "No.");
            ContBusRel.SETFILTER("Link to Table", '<>''''');

            IF ContBusRel.FIND('-') THEN
              REPEAT
                CASE ContBusRel."Link to Table" OF
                  ContBusRel."Link to Table"::Customer: UpdateCustomer(Rec,ContBusRel);
                  ContBusRel."Link to Table"::Vendor: UpdateVendor(Rec,ContBusRel);
                  ContBusRel."Link to Table"::"Bank Account": UpdateBankAccount(Rec,ContBusRel);
                END;
              UNTIL ContBusRel.NEXT = 0;
          END;

  }
  CODE
  {
    VAR
      Cust@1001 : Record 18;
      Vend@1002 : Record 23;
      BankAcc@1003 : Record 270;
      ChangeLogMgt@1008 : Codeunit 423;
      RecRef@1007 : RecordRef;
      xRecRef@1000 : RecordRef;
      NoSerie@1004 : Code[10];
      PurchaserCode@1005 : Code[10];
      OurContactCode@1006 : Code[10];

    PROCEDURE UpdateCustomer@1(VAR Cont@1000 : Record 5050;VAR ContBusRel@1001 : Record 5054);
    BEGIN
      WITH Cust DO BEGIN
        GET(ContBusRel."No.");
        xRecRef.GETTABLE(Cust);
        NoSerie := "No. Series";
        TRANSFERFIELDS(Cont);
        "No." := ContBusRel."No.";
        "No. Series" := NoSerie;
      // AT01 BEGIN
        VALIDATE("Phone No.");
      // AT01 END
        MODIFY;
        RecRef.GETTABLE(Cust);
        ChangeLogMgt.LogModification(RecRef,xRecRef);
      END;
    END;

    PROCEDURE UpdateVendor@2(VAR Cont@1000 : Record 5050;VAR ContBusRel@1001 : Record 5054);
    BEGIN
      WITH Vend DO BEGIN
        GET(ContBusRel."No.");
        xRecRef.GETTABLE(Vend);
        NoSerie := "No. Series";
        PurchaserCode :=  Vend."Purchaser Code";
        TRANSFERFIELDS(Cont);
        "No." := ContBusRel."No.";
        "No. Series" := NoSerie;
        Vend."Purchaser Code" := PurchaserCode;
      // AT01 BEGIN
        VALIDATE("Phone No.");
      // AT01 END
        MODIFY;
        RecRef.GETTABLE(Vend);
        ChangeLogMgt.LogModification(RecRef,xRecRef);
      END;
    END;

    PROCEDURE UpdateBankAccount@3(VAR Cont@1000 : Record 5050;VAR ContBusRel@1001 : Record 5054);
    BEGIN
      WITH BankAcc DO BEGIN
        GET(ContBusRel."No.");
        xRecRef.GETTABLE(BankAcc);
        NoSerie := "No. Series";
        OurContactCode := "Our Contact Code";
        TRANSFERFIELDS(Cont);
        "No." := ContBusRel."No.";
        "No. Series" := NoSerie;
        "Our Contact Code" := OurContactCode;
        MODIFY;
        RecRef.GETTABLE(BankAcc);
        ChangeLogMgt.LogModification(RecRef,xRecRef);
      END;
    END;

    BEGIN
    {
      AT01 actTAPI 04.06.2003  Update Phone Index: Additional VALIDATE on Phone No. in
                               UpdateCustomer and UpdateVendor
    }
    END.
  }
}

OBJECT Codeunit 5056 CustCont-Update
{
  OBJECT-PROPERTIES
  {
    Date=17.03.11;
    Time=19:36:59;
    Modified=Yes;
    Version List=NAVW16.00.10,AT01;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      RMSetup@1000 : Record 5079;
      ContBusRel@1001 : Record 5054;
      Cont@1002 : Record 5050;
      OldCont@1003 : Record 5050;
      NoSeriesMgt@1004 : Codeunit 396;
      ContNo@1005 : Code[20];
      NoSeries@1006 : Code[10];

    PROCEDURE OnInsert@3(VAR Cust@1000 : Record 18);
    BEGIN
      RMSetup.GET;
      IF RMSetup."Bus. Rel. Code for Customers" = '' THEN
        EXIT;

      InsertNewContact(Cust,TRUE);
    END;

    PROCEDURE OnModify@1(VAR Cust@1000 : Record 18);
    VAR
      ChangeLogMgt@1001 : Codeunit 423;
      RecRef@1003 : RecordRef;
      xRecRef@1002 : RecordRef;
    BEGIN
      WITH ContBusRel DO BEGIN
        SETCURRENTKEY("Link to Table","No.");
        SETRANGE("Link to Table","Link to Table"::Customer);
        SETRANGE("No.",Cust."No.");
        IF NOT FIND('-') THEN
          EXIT;
        Cont.GET("Contact No.");
        OldCont := Cont;
      END;

      ContNo := Cont."No.";
      NoSeries := Cont."No. Series";
      Cont.VALIDATE("E-Mail",Cust."E-Mail");
      Cont.TRANSFERFIELDS(Cust);
      Cont."No." := ContNo ;
      Cont."No. Series" := NoSeries;
      Cont.VALIDATE(Name);
      // AT01 BEGIN
      Cont.VALIDATE("Phone No.");
      // AT01 END
      Cont.OnModify(OldCont);
      Cont.MODIFY(TRUE);

      xRecRef.GETTABLE(OldCont);
      RecRef.GETTABLE(Cont);
      ChangeLogMgt.LogModification(RecRef,xRecRef);
    END;

    PROCEDURE OnDelete@2(VAR Cust@1000 : Record 18);
    BEGIN
      WITH ContBusRel DO BEGIN
        SETCURRENTKEY("Link to Table","No.");
        SETRANGE("Link to Table","Link to Table"::Customer);
        SETRANGE("No.", Cust."No.");
        DELETEALL(TRUE);
      END;
    END;

    PROCEDURE InsertNewContact@5(VAR Cust@1000 : Record 18;LocalCall@1001 : Boolean);
    BEGIN
      IF NOT LocalCall THEN BEGIN
        RMSetup.GET;
        RMSetup.TESTFIELD("Bus. Rel. Code for Customers");
      END;

      WITH Cont DO BEGIN
        INIT;
        TRANSFERFIELDS(Cust);
        Cont.VALIDATE(Name);
        Cont.VALIDATE("E-Mail");
        "No." := '';
        "No. Series" := '';
        RMSetup.TESTFIELD("Contact Nos.");
        NoSeriesMgt.InitSeries(RMSetup."Contact Nos.",'',0D,"No.","No. Series");
        Type := Type::Company;
        TypeChange;
        SetSkipDefault(FALSE);

      // AT01 BEGIN
        VALIDATE("Phone No.");
      // AT01 END

        INSERT(TRUE);
      END;

      WITH ContBusRel DO BEGIN
        INIT;
        "Contact No." := Cont."No.";
        "Business Relation Code" := RMSetup."Bus. Rel. Code for Customers";
        "Link to Table" := "Link to Table"::Customer;
        "No." := Cust."No.";
        INSERT(TRUE);
      END;
    END;

    PROCEDURE InsertNewContactPerson@4(VAR Cust@1001 : Record 18;LocalCall@1003 : Boolean);
    VAR
      ContComp@1000 : Record 5050;
      ContBusRel@1002 : Record 5054;
    BEGIN
      IF NOT LocalCall THEN BEGIN
        RMSetup.GET;
        RMSetup.TESTFIELD("Bus. Rel. Code for Customers");
      END;

      ContBusRel.SETCURRENTKEY("Link to Table","No.");
      ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
      ContBusRel.SETRANGE("No.",Cust."No.");
      IF ContBusRel.FIND('-') THEN
        IF ContComp.GET(ContBusRel."Contact No.") THEN
          WITH Cont DO BEGIN
            INIT;
            "No." := '';
            VALIDATE(Type,Type::Person);
            INSERT(TRUE);
            "Company No." := ContComp."No.";
            VALIDATE(Name,Cust.Contact);
            InheritCompanyToPersonData(ContComp,FALSE);

      // AT01 BEGIN
            VALIDATE("Phone No.");
      // AT01 END

            MODIFY(TRUE);
            Cust."Primary Contact No." := "No.";
          END
    END;

    BEGIN
    {
      AT01 actTAPI 04.06.2003  Update Phone Index: Additional VALIDATE on Phone No. in
                               OnModify, InsertNewContact and InsertNewContactPerson
    }
    END.
  }
}

OBJECT Codeunit 5057 VendCont-Update
{
  OBJECT-PROPERTIES
  {
    Date=05.01.11;
    Time=16:00:00;
    Modified=Yes;
    Version List=NAVW16.00.01,AT01.20;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      RMSetup@1000 : Record 5079;
      ContBusRel@1001 : Record 5054;
      Cont@1002 : Record 5050;
      OldCont@1003 : Record 5050;
      NoSeriesMgt@1004 : Codeunit 396;
      ContNo@1005 : Code[20];
      NoSeries@1006 : Code[10];
      SalespersonCode@1007 : Code[10];

    PROCEDURE OnInsert@3(VAR Vend@1000 : Record 23);
    BEGIN
      RMSetup.GET;
      IF RMSetup."Bus. Rel. Code for Vendors" = '' THEN
        EXIT;

      InsertNewContact(Vend,TRUE);
    END;

    PROCEDURE OnModify@1(VAR Vend@1000 : Record 23);
    VAR
      ChangeLogMgt@1001 : Codeunit 423;
      RecRef@1003 : RecordRef;
      xRecRef@1002 : RecordRef;
    BEGIN
      WITH ContBusRel DO BEGIN
        SETCURRENTKEY("Link to Table","No.");
        SETRANGE("Link to Table","Link to Table"::Vendor);
        SETRANGE("No.",Vend."No.");
        IF NOT FIND('-') THEN
          EXIT;
        Cont.GET("Contact No.");
        OldCont := Cont;
      END;

      ContNo := Cont."No.";
      NoSeries := Cont."No. Series";
      SalespersonCode := Cont."Salesperson Code";
      Cont.VALIDATE("E-Mail",Vend."E-Mail");
      Cont.TRANSFERFIELDS(Vend);
      Cont."No." := ContNo ;
      Cont."No. Series" := NoSeries;
      Cont."Salesperson Code" := SalespersonCode;
      Cont.VALIDATE(Name);
      // AT01.20 BEGIN
      Cont.VALIDATE("Phone No.");
      // AT01.20 END
      Cont.OnModify(OldCont);
      Cont.MODIFY(TRUE);

      xRecRef.GETTABLE(OldCont);
      RecRef.GETTABLE(Cont);
      ChangeLogMgt.LogModification(RecRef,xRecRef);
    END;

    PROCEDURE OnDelete@2(VAR Vend@1000 : Record 23);
    BEGIN
      WITH ContBusRel DO BEGIN
        SETCURRENTKEY("Link to Table","No.");
        SETRANGE("Link to Table","Link to Table"::Vendor);
        SETRANGE("No.", Vend."No.");
        DELETEALL(TRUE);
      END;
    END;

    PROCEDURE InsertNewContact@4(VAR Vend@1000 : Record 23;LocalCall@1001 : Boolean);
    BEGIN
      IF NOT LocalCall THEN BEGIN
        RMSetup.GET;
        RMSetup.TESTFIELD("Bus. Rel. Code for Vendors");
      END;

      WITH Cont DO BEGIN
        INIT;
        TRANSFERFIELDS(Vend);
        Cont.VALIDATE(Name);
        Cont.VALIDATE("E-Mail");
        "No." := '';
        "No. Series" := '';
        RMSetup.TESTFIELD("Contact Nos.");
        NoSeriesMgt.InitSeries(RMSetup."Contact Nos.",'',0D,"No.","No. Series");
        Type := Type::Company;
        TypeChange;
        SetSkipDefault(FALSE);
      // AT01.20 BEGIN
        VALIDATE("Phone No.");
      // AT01.20 END
        INSERT(TRUE);
      END;

      WITH ContBusRel DO BEGIN
        INIT;
        "Contact No." := Cont."No.";
        "Business Relation Code" := RMSetup."Bus. Rel. Code for Vendors";
        "Link to Table" := "Link to Table"::Vendor;
        "No." := Vend."No.";
        INSERT(TRUE);
      END;
    END;

    PROCEDURE InsertNewContactPerson@5(VAR Vend@1001 : Record 23;LocalCall@1003 : Boolean);
    VAR
      ContComp@1000 : Record 5050;
      ContBusRel@1002 : Record 5054;
    BEGIN
      IF NOT LocalCall THEN BEGIN
        RMSetup.GET;
        RMSetup.TESTFIELD("Bus. Rel. Code for Vendors");
      END;

      ContBusRel.SETCURRENTKEY("Link to Table","No.");
      ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Vendor);
      ContBusRel.SETRANGE("No.",Vend."No.");
      IF ContBusRel.FIND('-') THEN
        IF ContComp.GET(ContBusRel."Contact No.") THEN
          WITH Cont DO BEGIN
            INIT;
            "No." := '';
            INSERT(TRUE);
            "Company No." := ContComp."No.";
            Type := Type::Person;
            VALIDATE(Name,Vend.Contact);
            InheritCompanyToPersonData(ContComp,FALSE);
      // AT01.20 BEGIN
            VALIDATE("Phone No.");
      // AT01.20 END
            MODIFY(TRUE);
            Vend."Primary Contact No." := "No.";
          END
    END;

    BEGIN
    {
      AT01.20 actTAPI 25.09.2003  Update Phone Index: Additional VALIDATE on Phone No. in
                                  OnModify, InsertNewContact and InsertNewContactPerson
    }
    END.
  }
}

OBJECT Page 21 Customer Card
{
  OBJECT-PROPERTIES
  {
    Date=05.04.11;
    Time=12:27:59;
    Modified=Yes;
    Version List=NAVW16.00.10,LIQEM6.00,NAVDACH5.00.01,AT2011;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Debitorenkarte;
               ENU=Customer Card];
    SourceTable=Table18;
    PageType=Card;
    RefreshOnActivate=Yes;
    OnInit=BEGIN
             ContactEditable := TRUE;
             MapPointVisible := TRUE;
           END;

    OnOpenPage=VAR
                 MapMgt@1000 : Codeunit 802;
               BEGIN
                 ActivateFields;
                 IF NOT MapMgt.TestSetup THEN
                   MapPointVisible := FALSE;
               END;

    OnFindRecord=VAR
                   RecordFound@1000 : Boolean;
                 BEGIN
                   RecordFound := FIND(Which);
                   IF NOT RecordFound AND (GETFILTER("No.") <> '') THEN BEGIN
                   MESSAGE(Text003,GETFILTER("No."));
                   SETRANGE("No.");
                   RecordFound := FIND(Which);
                   END;
                   EXIT(RecordFound);
                 END;

    OnAfterGetRecord=BEGIN
                       ActivateFields;

                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 74      ;1   ;ActionGroup;
                      CaptionML=[DEU=D&ebitor;
                                 ENU=&Customer] }
      { 80      ;2   ;Action    ;
                      ShortCutKey=Strg+F7;
                      CaptionML=[DEU=&Posten;
                                 ENU=Ledger E&ntries];
                      RunObject=Page 25;
                      RunFormView=SORTING(Customer No.);
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=CustomerLedger;
                      PromotedCategory=Process }
      { 151     ;2   ;ActionGroup;
                      CaptionML=[DEU=Registrierte Belege;
                                 ENU=Issued Documents] }
      { 152     ;3   ;Action    ;
                      CaptionML=[DEU=Registrierte &Mahnungen;
                                 ENU=Issued &Reminders];
                      RunObject=Page 440;
                      RunFormView=SORTING(Customer No.,Posting Date);
                      RunFormLink=Customer No.=FIELD(No.) }
      { 153     ;3   ;Action    ;
                      CaptionML=[DEU=Registrierte &Zinsrechnungen;
                                 ENU=Issued &Finance Charge Memos];
                      RunObject=Page 452;
                      RunFormView=SORTING(Customer No.,Posting Date);
                      RunFormLink=Customer No.=FIELD(No.) }
      { 78      ;2   ;Action    ;
                      CaptionML=[DEU=Be&merkungen;
                                 ENU=Co&mments];
                      RunObject=Page 124;
                      RunFormLink=Table Name=CONST(Customer),
                                  No.=FIELD(No.);
                      Image=ViewComments }
      { 84      ;2   ;Action    ;
                      ShortCutKey=Umschalt+Strg+D;
                      CaptionML=[DEU=Dimensionen;
                                 ENU=Dimensions];
                      RunObject=Page 540;
                      RunFormLink=Table ID=CONST(18),
                                  No.=FIELD(No.);
                      Image=Dimensions }
      { 99      ;2   ;Action    ;
                      CaptionML=[DEU=Bankkonten;
                                 ENU=Bank Accounts];
                      RunObject=Page 424;
                      RunFormLink=Customer No.=FIELD(No.) }
      { 81      ;2   ;Action    ;
                      CaptionML=[DEU=&Lief. an Adressen;
                                 ENU=Ship-&to Addresses];
                      RunObject=Page 301;
                      RunFormLink=Customer No.=FIELD(No.) }
      { 14      ;2   ;Action    ;
                      CaptionML=[DEU=Ko&ntakt;
                                 ENU=C&ontact];
                      OnAction=BEGIN
                                 ShowContact;
                               END;
                                }
      { 100     ;2   ;Separator  }
      { 76      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[DEU=Statistik;
                                 ENU=Statistics];
                      RunObject=Page 151;
                      RunFormLink=No.=FIELD(No.),
                                  Date Filter=FIELD(Date Filter),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 112     ;2   ;Action    ;
                      CaptionML=[DEU=Statistik nach &WÑhrungen;
                                 ENU=Statistics by C&urrencies];
                      RunObject=Page 481;
                      RunFormLink=No.=FIELD(No.),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),
                                  Date Filter=FIELD(Date Filter) }
      { 77      ;2   ;Action    ;
                      CaptionML=[DEU=Buchungsstatistik;
                                 ENU=Entry Statistics];
                      RunObject=Page 302;
                      RunFormLink=No.=FIELD(No.),
                                  Date Filter=FIELD(Date Filter),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
      { 79      ;2   ;Action    ;
                      CaptionML=[DEU=&Verkauf;
                                 ENU=S&ales];
                      RunObject=Page 155;
                      RunFormLink=No.=FIELD(No.),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
      { 115     ;2   ;Separator ;
                      CaptionML=[DEU="";
                                 ENU=""] }
      { 94      ;2   ;Action    ;
                      CaptionML=[DEU=Re&ferenzen;
                                 ENU=Cross Re&ferences];
                      RunObject=Page 5723;
                      RunFormView=SORTING(Cross-Reference Type,Cross-Reference Type No.);
                      RunFormLink=Cross-Reference Type=CONST(Customer),
                                  Cross-Reference Type No.=FIELD(No.) }
      { 125     ;2   ;Separator ;
                      CaptionML=[DEU="";
                                 ENU=""] }
      { 126     ;2   ;Action    ;
                      CaptionML=[DEU=S&ervicevertrÑge;
                                 ENU=Ser&vice Contracts];
                      RunObject=Page 6065;
                      RunFormView=SORTING(Customer No.,Ship-to Code);
                      RunFormLink=Customer No.=FIELD(No.);
                      Image=ServiceAgreement }
      { 127     ;2   ;Action    ;
                      CaptionML=[DEU=Service&artikel;
                                 ENU=Service &Items];
                      RunObject=Page 5988;
                      RunFormView=SORTING(Customer No.,Ship-to Code,Item No.,Serial No.);
                      RunFormLink=Customer No.=FIELD(No.) }
      { 138     ;2   ;Separator  }
      { 147     ;2   ;Action    ;
                      CaptionML=[DEU=Proje&kte;
                                 ENU=&Jobs];
                      RunObject=Page 89;
                      RunFormView=SORTING(Bill-to Customer No.);
                      RunFormLink=Bill-to Customer No.=FIELD(No.) }
      { 117     ;2   ;Separator  }
      { 118     ;2   ;Action    ;
                      CaptionML=[DEU=Online Map;
                                 ENU=Online Map];
                      OnAction=BEGIN
                                 DisplayMap;
                               END;
                                }
      { 140     ;2   ;Separator  }
      { 149     ;2   ;Action    ;
                      CaptionML=[DEU=K&reditkarten;
                                 ENU=C&redit Cards];
                      RunObject=Page 828;
                      RunFormLink=Customer No.=FIELD(No.) }
      { 165     ;2   ;Action    ;
                      CaptionML=[DEU=Transaktionspro&tokolleintrÑge fÅr Kreditkarten;
                                 ENU=Credit Cards Transaction Lo&g Entries];
                      RunObject=Page 829;
                      RunFormLink=Customer No.=FIELD(No.) }
      { 82      ;1   ;ActionGroup;
                      CaptionML=[DEU=&Verkauf;
                                 ENU=S&ales] }
      { 83      ;2   ;Action    ;
                      CaptionML=[DEU=&Rechnungsrabatte;
                                 ENU=Invoice &Discounts];
                      RunObject=Page 23;
                      RunFormLink=Code=FIELD(Invoice Disc. Code) }
      { 113     ;2   ;Action    ;
                      CaptionML=[DEU=Preise;
                                 ENU=Prices];
                      RunObject=Page 7002;
                      RunFormView=SORTING(Sales Type,Sales Code);
                      RunFormLink=Sales Type=CONST(Customer),
                                  Sales Code=FIELD(No.);
                      Image=ResourcePrice }
      { 136     ;2   ;Action    ;
                      CaptionML=[DEU=Zeilenrabatte;
                                 ENU=Line Discounts];
                      RunObject=Page 7004;
                      RunFormView=SORTING(Sales Type,Sales Code);
                      RunFormLink=Sales Type=CONST(Customer),
                                  Sales Code=FIELD(No.) }
      { 162     ;2   ;Action    ;
                      CaptionML=[DEU=&VorauszahlungsprozentsÑtze;
                                 ENU=Prepa&yment Percentages];
                      RunObject=Page 664;
                      RunFormView=SORTING(Sales Type,Sales Code);
                      RunFormLink=Sales Type=CONST(Customer),
                                  Sales Code=FIELD(No.) }
      { 148     ;2   ;Action    ;
                      CaptionML=[DEU=S&td.-Debitorverkaufscodes;
                                 ENU=S&td. Cust. Sales Codes];
                      RunObject=Page 173;
                      RunFormLink=Customer No.=FIELD(No.) }
      { 137     ;2   ;Separator  }
      { 85      ;2   ;Action    ;
                      CaptionML=[DEU=Angebote;
                                 ENU=Quotes];
                      RunObject=Page 9300;
                      RunFormView=SORTING(Document Type,Sell-to Customer No.,No.);
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Image=Quote }
      { 114     ;2   ;Action    ;
                      CaptionML=[DEU=RahmenauftrÑge;
                                 ENU=Blanket Orders];
                      RunObject=Page 9303;
                      RunFormView=SORTING(Document Type,Sell-to Customer No.);
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Image=BlanketOrder }
      { 86      ;2   ;Action    ;
                      CaptionML=[DEU=AuftrÑge;
                                 ENU=Orders];
                      RunObject=Page 9305;
                      RunFormView=SORTING(Document Type,Sell-to Customer No.,No.);
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Image=Document }
      { 121     ;2   ;Action    ;
                      CaptionML=[DEU=Reklamationen;
                                 ENU=Return Orders];
                      RunObject=Page 9304;
                      RunFormView=SORTING(Document Type,Sell-to Customer No.,No.);
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Image=ReturnOrder }
      { 128     ;2   ;Action    ;
                      CaptionML=[DEU=ServiceauftrÑge;
                                 ENU=Service Orders];
                      RunObject=Page 9318;
                      RunFormView=SORTING(Document Type,Customer No.);
                      RunFormLink=Customer No.=FIELD(No.);
                      Image=Document }
      { 6500    ;2   ;Action    ;
                      CaptionML=[DEU=Artikel&verfolgungsposten;
                                 ENU=Item &Tracking Entries];
                      Image=ItemTrackingLedger;
                      OnAction=VAR
                                 ItemTrackingMgt@1000 : Codeunit 6500;
                               BEGIN
                                 ItemTrackingMgt.CallItemTrackingEntryForm(1,"No.",'','','','','');
                               END;
                                }
      { 1900000005;0 ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 1902575205;1 ;Action    ;
                      CaptionML=[DEU=Rahmenauftrag;
                                 ENU=Blanket Sales Order];
                      RunObject=Page 507;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=BlanketOrder;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1900246505;1 ;Action    ;
                      CaptionML=[DEU=Verkaufsangebot;
                                 ENU=Sales Quote];
                      RunObject=Page 41;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=Quote;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1906384905;1 ;Action    ;
                      CaptionML=[DEU=Verkaufsrechnung;
                                 ENU=Sales Invoice];
                      RunObject=Page 43;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Invoice;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1904747105;1 ;Action    ;
                      CaptionML=[DEU=Verkaufsauftrag;
                                 ENU=Sales Order];
                      RunObject=Page 42;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1902583505;1 ;Action    ;
                      CaptionML=[DEU=Verkaufsgutschrift;
                                 ENU=Sales Credit Memo];
                      RunObject=Page 44;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=CreditMemo;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1905163705;1 ;Action    ;
                      CaptionML=[DEU=Verkaufsreklamation;
                                 ENU=Sales Return Order];
                      RunObject=Page 6630;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=ReturnOrder;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1905185205;1 ;Action    ;
                      CaptionML=[DEU=Serviceangebot;
                                 ENU=Service Quote];
                      RunObject=Page 5964;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=Quote;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1902079405;1 ;Action    ;
                      CaptionML=[DEU=Servicerechnung;
                                 ENU=Service Invoice];
                      RunObject=Page 5933;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=Invoice;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1907102005;1 ;Action    ;
                      CaptionML=[DEU=Serviceauftrag;
                                 ENU=Service Order];
                      RunObject=Page 5900;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=Document;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1901662105;1 ;Action    ;
                      CaptionML=[DEU=Servicegutschrift;
                                 ENU=Service Credit Memo];
                      RunObject=Page 5935;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=CreditMemo;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1903839805;1 ;Action    ;
                      CaptionML=[DEU=Mahnung;
                                 ENU=Reminder];
                      RunObject=Page 434;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Reminder;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1901102005;1 ;Action    ;
                      CaptionML=[DEU=Zinsrechnung;
                                 ENU=Financial Charge Memo];
                      RunObject=Page 446;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=FinChargeMemo;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 163     ;1   ;ActionGroup;
                      CaptionML=[DEU=F&unktionen;
                                 ENU=F&unctions] }
      { 167     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Vorlage anwenden;
                                 ENU=Apply Template];
                      Promoted=Yes;
                      Image=ApplyTemplate;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 TemplateMgt@1000 : Codeunit 8612;
                                 RecRef@1001 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 TemplateMgt.UpdateFromTemplateSelection(RecRef);
                               END;
                                }
      { 1900839804;1 ;Action    ;
                      CaptionML=[DEU=Zahlungseingangs Buch.-Blatt;
                                 ENU=Cash Receipt Journal];
                      RunObject=Page 255;
                      Promoted=Yes;
                      Image=CashReceiptJournal;
                      PromotedCategory=Process }
      { 1905171704;1 ;Action    ;
                      CaptionML=[DEU=Verkaufs Buch.-Blatt;
                                 ENU=Sales Journal];
                      RunObject=Page 253;
                      Promoted=Yes;
                      Image=Journals;
                      PromotedCategory=Process }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1906813206;1 ;Action    ;
                      CaptionML=[DEU=Debitor - FÑllige Posten;
                                 ENU=Customer Detailed Aging];
                      RunObject=Report 106;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1907586706;1 ;Action    ;
                      CaptionML=[DEU=Debitor - Etiketten;
                                 ENU=Customer - Labels];
                      RunObject=Report 110;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1902299006;1 ;Action    ;
                      CaptionML=[DEU=Debitorenposten per;
                                 ENU=Customer - Balance to Date];
                      RunObject=Report 121;
                      Promoted=Yes;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[DEU=Allgemein;
                           ENU=General] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr=Name;
                Importance=Promoted }

    { 6   ;2   ;Field     ;
                SourceExpr=Address }

    { 8   ;2   ;Field     ;
                SourceExpr="Address 2" }

    { 90  ;2   ;Field     ;
                SourceExpr="Post Code";
                Importance=Promoted }

    { 10  ;2   ;Field     ;
                SourceExpr=City }

    { 91  ;2   ;Field     ;
                SourceExpr="Country/Region Code" }

    { 12  ;2   ;Field     ;
                SourceExpr="Phone No.";
                OnAssistEdit=BEGIN
                               // AT2009.01 START
                               TAPIFu.Dial(18, "No.", '', 0);
                               // AT2009.01 END
                             END;
                              }

    { 122 ;2   ;Field     ;
                SourceExpr="Primary Contact No." }

    { 16  ;2   ;Field     ;
                SourceExpr=Contact;
                Importance=Promoted;
                Editable=ContactEditable;
                OnValidate=BEGIN
                             ContactOnAfterValidate;
                           END;
                            }

    { 18  ;2   ;Field     ;
                SourceExpr="Search Name" }

    { 20  ;2   ;Field     ;
                SourceExpr="Balance (LCY)";
                OnDrillDown=VAR
                              DtldCustLedgEntry@1001 : Record 379;
                              CustLedgEntry@1002 : Record 21;
                            BEGIN
                              DtldCustLedgEntry.SETRANGE("Customer No.","No.");
                              COPYFILTER("Global Dimension 1 Filter",DtldCustLedgEntry."Initial Entry Global Dim. 1");
                              COPYFILTER("Global Dimension 2 Filter",DtldCustLedgEntry."Initial Entry Global Dim. 2");
                              COPYFILTER("Currency Filter",DtldCustLedgEntry."Currency Code");
                              CustLedgEntry.DrillDownOnEntries(DtldCustLedgEntry);
                            END;
                             }

    { 22  ;2   ;Field     ;
                SourceExpr="Credit Limit (LCY)" }

    { 24  ;2   ;Field     ;
                SourceExpr="Salesperson Code" }

    { 64  ;2   ;Field     ;
                SourceExpr="Responsibility Center" }

    { 93  ;2   ;Field     ;
                SourceExpr="Service Zone Code" }

    { 26  ;2   ;Field     ;
                SourceExpr=Blocked }

    { 28  ;2   ;Field     ;
                SourceExpr="Last Date Modified" }

    { 1902768601;1;Group  ;
                CaptionML=[DEU=Kommunikation;
                           ENU=Communication] }

    { 103 ;2   ;Field     ;
                SourceExpr="Phone No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               // AT2009.01 START
                               TAPIFu.Dial(18, "No.", '', 0);
                               // AT2009.01 END
                             END;
                              }

    { 104 ;2   ;Field     ;
                SourceExpr="Fax No." }

    { 107 ;2   ;Field     ;
                SourceExpr="E-Mail";
                Importance=Promoted }

    { 109 ;2   ;Field     ;
                SourceExpr="Home Page" }

    { 154 ;2   ;Field     ;
                SourceExpr="IC Partner Code";
                OnValidate=BEGIN
                             ICPartnerCodeOnAfterValidate;
                           END;
                            }

    { 1905885101;1;Group  ;
                CaptionML=[DEU=Fakturierung;
                           ENU=Invoicing] }

    { 34  ;2   ;Field     ;
                SourceExpr="Bill-to Customer No." }

    { 36  ;2   ;Field     ;
                SourceExpr="Invoice Copies" }

    { 42  ;2   ;Field     ;
                SourceExpr="Invoice Disc. Code" }

    { 156 ;2   ;Field     ;
                SourceExpr="Copy Sell-to Addr. to Qte From" }

    { 70  ;2   ;Field     ;
                SourceExpr="Gen. Bus. Posting Group";
                Importance=Promoted }

    { 58  ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group" }

    { 38  ;2   ;Field     ;
                SourceExpr="Customer Posting Group";
                Importance=Promoted }

    { 40  ;2   ;Field     ;
                SourceExpr="Customer Price Group";
                Importance=Promoted }

    { 44  ;2   ;Field     ;
                SourceExpr="Customer Disc. Group";
                Importance=Promoted }

    { 46  ;2   ;Field     ;
                SourceExpr="Allow Line Disc." }

    { 129 ;2   ;Field     ;
                SourceExpr="Prices Including VAT" }

    { 160 ;2   ;Field     ;
                SourceExpr="Prepayment %" }

    { 1901677601;1;Group  ;
                CaptionML=[DEU=Zahlungen;
                           ENU=Payments] }

    { 48  ;2   ;Field     ;
                SourceExpr="Application Method" }

    { 50  ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Importance=Promoted }

    { 11  ;2   ;Field     ;
                SourceExpr="Payment Method Code";
                Importance=Promoted }

    { 15  ;2   ;Field     ;
                SourceExpr="Reminder Terms Code";
                Importance=Promoted }

    { 52  ;2   ;Field     ;
                SourceExpr="Fin. Charge Terms Code";
                Importance=Promoted }

    { 1461000;2;Field     ;
                SourceExpr="Liq. Payment Terms Code" }

    { 54  ;2   ;Field     ;
                SourceExpr="Print Statements" }

    { 60  ;2   ;Field     ;
                SourceExpr="Last Statement No." }

    { 143 ;2   ;Field     ;
                SourceExpr="Block Payment Tolerance";
                OnValidate=BEGIN
                             IF "Block Payment Tolerance" THEN BEGIN
                               IF CONFIRM(Text002,FALSE) THEN
                                 PaymentToleranceMgt.DelTolCustLedgEntry(Rec);
                             END ELSE BEGIN
                               IF CONFIRM(Text001,FALSE) THEN
                                 PaymentToleranceMgt.CalcTolCustLedgEntry(Rec);
                             END;
                           END;
                            }

    { 1906801201;1;Group  ;
                CaptionML=[DEU=Lieferung;
                           ENU=Shipping] }

    { 95  ;2   ;Field     ;
                SourceExpr="Location Code";
                Importance=Promoted }

    { 32  ;2   ;Field     ;
                SourceExpr="Combine Shipments" }

    { 158 ;2   ;Field     ;
                SourceExpr=Reserve }

    { 123 ;2   ;Field     ;
                SourceExpr="Shipping Advice";
                Importance=Promoted }

    { 30  ;2   ;Field     ;
                SourceExpr="Shipment Method Code";
                Importance=Promoted }

    { 101 ;2   ;Field     ;
                SourceExpr="Shipping Agent Code";
                Importance=Promoted }

    { 131 ;2   ;Field     ;
                SourceExpr="Shipping Agent Service Code" }

    { 119 ;2   ;Field     ;
                SourceExpr="Shipping Time" }

    { 141 ;2   ;Field     ;
                DrillDown=No;
                SourceExpr="Base Calendar Code" }

    { 146 ;2   ;Field     ;
                Name=Customized Calendar;
                CaptionML=[DEU=Spezifischer Kalender;
                           ENU=Customized Calendar];
                SourceExpr=CalendarMgmt.CustomizedCalendarExistText(CustomizedCalendar."Source Type"::Customer,"No.",'',"Base Calendar Code");
                Editable=FALSE;
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              TESTFIELD("Base Calendar Code");
                              CalendarMgmt.ShowCustomizedCalendar(CustomizedCalEntry."Source Type"::Customer,"No.",'',"Base Calendar Code");
                            END;
                             }

    { 1907468901;1;Group  ;
                CaptionML=[DEU=Au·enhandel;
                           ENU=Foreign Trade] }

    { 67  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Importance=Promoted }

    { 66  ;2   ;Field     ;
                SourceExpr="Language Code" }

    { 69  ;2   ;Field     ;
                SourceExpr="VAT Registration No." }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1903720907;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9080;
                Visible=TRUE;
                PartType=Page }

    { 1907234507;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9081;
                Visible=FALSE;
                PartType=Page }

    { 1902018507;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9082;
                Visible=TRUE;
                PartType=Page }

    { 1905532107;1;Part   ;
                SubFormLink=Table ID=CONST(18),
                            No.=FIELD(No.);
                PagePartID=Page9083;
                Visible=FALSE;
                PartType=Page }

    { 1907829707;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9085;
                Visible=FALSE;
                PartType=Page }

    { 1902613707;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9086;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      CustomizedCalEntry@1001 : Record 7603;
      Text001@1003 : TextConst 'DEU=Mîchten Sie Zahlungstoleranzen fÅr momentan offene Posten zulassen?;ENU=Do you want to allow payment tolerance for entries that are currently open?';
      CustomizedCalendar@1005 : Record 7602;
      Text002@1006 : TextConst 'DEU=Mîchten Sie Zahlungstoleranzen fÅr momentan offene Posten lîschen?;ENU=Do you want to remove payment tolerance from entries that are currently open?';
      CalendarMgmt@1002 : Codeunit 7600;
      PaymentToleranceMgt@1000 : Codeunit 426;
      SalesInfoPaneMgt@1004 : Codeunit 7171;
      Text003@1102601000 : TextConst 'DEU=Der Debitor ''%1'' ist nicht vorhanden.;ENU=The customer %1 does not exist.';
      MapPointVisible@19022708 : Boolean INDATASET;
      ContactEditable@19051436 : Boolean INDATASET;
      "***** activeTAPI *****"@1113900000 : Integer;
      TAPIFu@1113900001 : Codeunit 56780;

    PROCEDURE ActivateFields@3();
    BEGIN
      ContactEditable := "Primary Contact No." = '';
    END;

    LOCAL PROCEDURE ContactOnAfterValidate@19013243();
    BEGIN
      ActivateFields;
    END;

    LOCAL PROCEDURE ICPartnerCodeOnAfterValidate@19032922();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      ActivateFields;
    END;

    BEGIN
    {
      AT2011  actTAPI 05.04.2011  New Dial function
                                  Global Var TAPIFu CU 56780
                                  Trick: Call in OnAssistEdit-Trigger of every Phone-No. Bitmap (2x)
    }
    END.
  }
}

OBJECT Page 22 Customer List
{
  OBJECT-PROPERTIES
  {
    Date=05.04.11;
    Time=12:28:10;
    Modified=Yes;
    Version List=NAVW16.00.10,AT2011;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[DEU=DebitorenÅbersicht;
               ENU=Customer List];
    SourceTable=Table18;
    PageType=List;
    CardFormID=Page21;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 16      ;1   ;ActionGroup;
                      CaptionML=[DEU=D&ebitor;
                                 ENU=&Customer] }
      { 22      ;2   ;Action    ;
                      ShortCutKey=Strg+F7;
                      CaptionML=[DEU=&Posten;
                                 ENU=Ledger E&ntries];
                      RunObject=Page 25;
                      RunFormView=SORTING(Customer No.);
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=Yes;
                      Image=CustomerLedger;
                      PromotedCategory=Process }
      { 76      ;2   ;ActionGroup;
                      CaptionML=[DEU=Registrierte Belege;
                                 ENU=Issued Documents] }
      { 77      ;3   ;Action    ;
                      CaptionML=[DEU=Registrierte &Mahnungen;
                                 ENU=Issued &Reminders];
                      RunObject=Page 440;
                      RunFormView=SORTING(Customer No.,Posting Date);
                      RunFormLink=Customer No.=FIELD(No.) }
      { 78      ;3   ;Action    ;
                      CaptionML=[DEU=Registrierte &Zinsrechnungen;
                                 ENU=Issued &Finance Charge Memos];
                      RunObject=Page 452;
                      RunFormView=SORTING(Customer No.,Posting Date);
                      RunFormLink=Customer No.=FIELD(No.) }
      { 20      ;2   ;Action    ;
                      CaptionML=[DEU=Be&merkungen;
                                 ENU=Co&mments];
                      RunObject=Page 124;
                      RunFormLink=Table Name=CONST(Customer),
                                  No.=FIELD(No.);
                      Image=ViewComments }
      { 66      ;2   ;ActionGroup;
                      CaptionML=[DEU=Dimensionen;
                                 ENU=Dimensions] }
      { 84      ;3   ;Action    ;
                      ShortCutKey=Umschalt+Strg+D;
                      CaptionML=[DEU=Zuordnung fÅr aktuellen Datensatz;
                                 ENU=Dimensions-Single];
                      RunObject=Page 540;
                      RunFormLink=Table ID=CONST(18),
                                  No.=FIELD(No.) }
      { 42      ;3   ;Action    ;
                      CaptionML=[DEU=Zuordnung fÅr &markierte DatensÑtze;
                                 ENU=Dimensions-&Multiple];
                      OnAction=VAR
                                 Cust@1001 : Record 18;
                                 DefaultDimMultiple@1002 : Form 542;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Cust);
                                 DefaultDimMultiple.SetMultiCust(Cust);
                                 DefaultDimMultiple.RUNMODAL;
                               END;
                                }
      { 58      ;2   ;Action    ;
                      CaptionML=[DEU=Bankkonten;
                                 ENU=Bank Accounts];
                      RunObject=Page 424;
                      RunFormLink=Customer No.=FIELD(No.) }
      { 23      ;2   ;Action    ;
                      CaptionML=[DEU=L&ief. an Adressen;
                                 ENU=Ship-&to Addresses];
                      RunObject=Page 301;
                      RunFormLink=Customer No.=FIELD(No.) }
      { 60      ;2   ;Action    ;
                      CaptionML=[DEU=Ko&ntakt;
                                 ENU=C&ontact];
                      OnAction=BEGIN
                                 ShowContact;
                               END;
                                }
      { 59      ;2   ;Separator  }
      { 18      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[DEU=Statistik;
                                 ENU=Statistics];
                      RunObject=Page 151;
                      RunFormLink=No.=FIELD(No.),
                                  Date Filter=FIELD(Date Filter),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 63      ;2   ;Action    ;
                      CaptionML=[DEU=Statistik nach &WÑhrungen;
                                 ENU=Statistics by C&urrencies];
                      RunObject=Page 481;
                      RunFormLink=No.=FIELD(No.),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),
                                  Date Filter=FIELD(Date Filter) }
      { 19      ;2   ;Action    ;
                      CaptionML=[DEU=Buchungsstatistik;
                                 ENU=Entry Statistics];
                      RunObject=Page 302;
                      RunFormLink=No.=FIELD(No.),
                                  Date Filter=FIELD(Date Filter),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
      { 21      ;2   ;Action    ;
                      CaptionML=[DEU=&Verkauf;
                                 ENU=S&ales];
                      RunObject=Page 155;
                      RunFormLink=No.=FIELD(No.),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
      { 44      ;2   ;Separator  }
      { 45      ;2   ;Action    ;
                      CaptionML=[DEU=Re&ferenzen;
                                 ENU=Cross Re&ferences];
                      RunObject=Page 5723;
                      RunFormView=SORTING(Cross-Reference Type,Cross-Reference Type No.);
                      RunFormLink=Cross-Reference Type=CONST(Customer),
                                  Cross-Reference Type No.=FIELD(No.) }
      { 67      ;2   ;Separator  }
      { 68      ;2   ;Action    ;
                      CaptionML=[DEU=S&ervicevertrÑge;
                                 ENU=Ser&vice Contracts];
                      RunObject=Page 6065;
                      RunFormView=SORTING(Customer No.,Ship-to Code);
                      RunFormLink=Customer No.=FIELD(No.);
                      Image=ServiceAgreement }
      { 69      ;2   ;Action    ;
                      CaptionML=[DEU=Service&artikel;
                                 ENU=Service &Items];
                      RunObject=Page 5988;
                      RunFormView=SORTING(Customer No.,Ship-to Code,Item No.,Serial No.);
                      RunFormLink=Customer No.=FIELD(No.) }
      { 83      ;2   ;Separator  }
      { 85      ;2   ;Action    ;
                      CaptionML=[DEU=K&reditkarten;
                                 ENU=C&redit Cards];
                      RunObject=Page 828;
                      RunFormLink=Customer No.=FIELD(No.) }
      { 86      ;2   ;Action    ;
                      CaptionML=[DEU=Transaktionspro&tokolleintrÑge fÅr Kreditkarten;
                                 ENU=Credit Cards Transaction Lo&g Entries];
                      RunObject=Page 829;
                      RunFormLink=Customer No.=FIELD(No.) }
      { 24      ;1   ;ActionGroup;
                      CaptionML=[DEU=&Verkauf;
                                 ENU=S&ales] }
      { 25      ;2   ;Action    ;
                      CaptionML=[DEU=&Rechnungsrabatte;
                                 ENU=Invoice &Discounts];
                      RunObject=Page 23;
                      RunFormLink=Code=FIELD(Invoice Disc. Code) }
      { 26      ;2   ;Action    ;
                      CaptionML=[DEU=Preise;
                                 ENU=Prices];
                      RunObject=Page 7002;
                      RunFormView=SORTING(Sales Type,Sales Code);
                      RunFormLink=Sales Type=CONST(Customer),
                                  Sales Code=FIELD(No.);
                      Image=ResourcePrice }
      { 71      ;2   ;Action    ;
                      CaptionML=[DEU=Zeilenrabatte;
                                 ENU=Line Discounts];
                      RunObject=Page 7004;
                      RunFormView=SORTING(Sales Type,Sales Code);
                      RunFormLink=Sales Type=CONST(Customer),
                                  Sales Code=FIELD(No.) }
      { 82      ;2   ;Action    ;
                      CaptionML=[DEU=&VorauszahlungsprozentsÑtze;
                                 ENU=Prepa&yment Percentages];
                      RunObject=Page 664;
                      RunFormView=SORTING(Sales Type,Sales Code);
                      RunFormLink=Sales Type=CONST(Customer),
                                  Sales Code=FIELD(No.) }
      { 75      ;2   ;Action    ;
                      CaptionML=[DEU=S&td.-Debitorverkaufscodes;
                                 ENU=S&td. Cust. Sales Codes];
                      RunObject=Page 173;
                      RunFormLink=Customer No.=FIELD(No.) }
      { 74      ;2   ;Separator  }
      { 27      ;2   ;Action    ;
                      CaptionML=[DEU=Angebote;
                                 ENU=Quotes];
                      RunObject=Page 9300;
                      RunFormView=SORTING(Sell-to Customer No.);
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Image=Quote }
      { 65      ;2   ;Action    ;
                      CaptionML=[DEU=RahmenauftrÑge;
                                 ENU=Blanket Orders];
                      RunObject=Page 9303;
                      RunFormView=SORTING(Document Type,Sell-to Customer No.);
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Image=BlanketOrder }
      { 28      ;2   ;Action    ;
                      CaptionML=[DEU=AuftrÑge;
                                 ENU=Orders];
                      RunObject=Page 9305;
                      RunFormView=SORTING(Sell-to Customer No.);
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Image=Document }
      { 70      ;2   ;Action    ;
                      CaptionML=[DEU=Reklamationen;
                                 ENU=Return Orders];
                      RunObject=Page 9304;
                      Image=ReturnOrder }
      { 81      ;2   ;Action    ;
                      CaptionML=[DEU=ServiceauftrÑge;
                                 ENU=Service Orders];
                      RunObject=Page 9318;
                      RunFormView=SORTING(Document Type,Customer No.);
                      RunFormLink=Customer No.=FIELD(No.);
                      Image=Document }
      { 6500    ;2   ;Action    ;
                      CaptionML=[DEU=Artikel&verfolgungsposten;
                                 ENU=Item &Tracking Entries];
                      Image=ItemTrackingLedger;
                      OnAction=VAR
                                 ItemTrackingMgt@1001 : Codeunit 6500;
                               BEGIN
                                 ItemTrackingMgt.CallItemTrackingEntryForm(1,"No.",'','','','','');
                               END;
                                }
      { 1900000005;0 ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 1902575205;1 ;Action    ;
                      CaptionML=[DEU=Rahmenauftrag;
                                 ENU=Blanket Sales Order];
                      RunObject=Page 507;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=BlanketOrder;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1900246505;1 ;Action    ;
                      CaptionML=[DEU=Verkaufsangebot;
                                 ENU=Sales Quote];
                      RunObject=Page 41;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Quote;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1906384905;1 ;Action    ;
                      CaptionML=[DEU=Verkaufsrechnung;
                                 ENU=Sales Invoice];
                      RunObject=Page 43;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Invoice;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1904747105;1 ;Action    ;
                      CaptionML=[DEU=Verkaufsauftrag;
                                 ENU=Sales Order];
                      RunObject=Page 42;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1902583505;1 ;Action    ;
                      CaptionML=[DEU=Verkaufsgutschrift;
                                 ENU=Sales Credit Memo];
                      RunObject=Page 44;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=CreditMemo;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1905163705;1 ;Action    ;
                      CaptionML=[DEU=Verkaufsreklamation;
                                 ENU=Sales Return Order];
                      RunObject=Page 6630;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=ReturnOrder;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1905185205;1 ;Action    ;
                      CaptionML=[DEU=Serviceangebot;
                                 ENU=Service Quote];
                      RunObject=Page 5964;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=Quote;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1902079405;1 ;Action    ;
                      CaptionML=[DEU=Servicerechnung;
                                 ENU=Service Invoice];
                      RunObject=Page 5933;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=Invoice;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1907102005;1 ;Action    ;
                      CaptionML=[DEU=Serviceauftrag;
                                 ENU=Service Order];
                      RunObject=Page 5900;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=Document;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1901662105;1 ;Action    ;
                      CaptionML=[DEU=Servicegutschrift;
                                 ENU=Service Credit Memo];
                      RunObject=Page 5935;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=CreditMemo;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1903839805;1 ;Action    ;
                      CaptionML=[DEU=Mahnung;
                                 ENU=Reminder];
                      RunObject=Page 434;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Reminder;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1901102005;1 ;Action    ;
                      CaptionML=[DEU=Zinsrechnung;
                                 ENU=Financial Charge Memo];
                      RunObject=Page 446;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=FinChargeMemo;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1113900000;1 ;Action    ;
                      Name=<Action1113900000>;
                      CaptionML=[DEU=Anrufen;
                                 ENU=Dial];
                      OnAction=BEGIN
                                 // AT2011 START
                                 TAPIFu.Dial(18, "No.", '', 0);
                                 // AT2011 END
                               END;
                                }
      { 1900839804;1 ;Action    ;
                      CaptionML=[DEU=Zahlungseingangs Buch.-Blatt;
                                 ENU=Cash Receipt Journal];
                      RunObject=Page 255;
                      Promoted=Yes;
                      Image=CashReceiptJournal;
                      PromotedCategory=Process }
      { 1905171704;1 ;Action    ;
                      CaptionML=[DEU=Verkaufs Buch.-Blatt;
                                 ENU=Sales Journal];
                      RunObject=Page 253;
                      Promoted=Yes;
                      Image=Journals;
                      PromotedCategory=Process }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1905562606;1 ;Action    ;
                      CaptionML=[DEU=DebitorenÅbersicht;
                                 ENU=Customer List];
                      RunObject=Report 101;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1901007206;1 ;Action    ;
                      CaptionML=[DEU=Debitorenjournal;
                                 ENU=Customer Register];
                      RunObject=Report 103;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1906871306;1 ;Action    ;
                      CaptionML=[DEU=Debitor - Kontoblatt;
                                 ENU=Customer - Detail Trial Bal.];
                      RunObject=Report 104;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1907944606;1 ;Action    ;
                      CaptionML=[DEU=Debitor - Saldo nach Perioden;
                                 ENU=Customer - Summary Aging];
                      RunObject=Report 105;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1906813206;1 ;Action    ;
                      CaptionML=[DEU=Debitor - FÑllige Posten;
                                 ENU=Customer Detailed Aging];
                      RunObject=Report 106;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1905727106;1 ;Action    ;
                      CaptionML=[DEU=Debitor - AuftragsÅbersicht;
                                 ENU=Customer - Order Summary];
                      RunObject=Report 107;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1900172506;1 ;Action    ;
                      CaptionML=[DEU=Debitor - AuftrÑge;
                                 ENU=Customer - Order Detail];
                      RunObject=Report 108;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1907152806;1 ;Action    ;
                      CaptionML=[DEU=Debitor - Top 10 Liste;
                                 ENU=Customer - Top 10 List];
                      RunObject=Report 111;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1904190506;1 ;Action    ;
                      CaptionML=[DEU=Verkaufsstatistik;
                                 ENU=Sales Statistics];
                      RunObject=Report 112;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1900760706;1 ;Action    ;
                      CaptionML=[DEU=Debitor/Artikel Statistik;
                                 ENU=Customer/Item Sales];
                      RunObject=Report 113;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1906768606;1 ;Action    ;
                      CaptionML=[DEU=Kontoauszug;
                                 ENU=Statement];
                      RunObject=Report 116;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1903839806;1 ;Action    ;
                      CaptionML=[DEU=Mahnung;
                                 ENU=Reminder];
                      RunObject=Report 117;
                      Promoted=No;
                      Image=Reminder;
                      PromotedCategory=Report }
      { 1906073506;1 ;Action    ;
                      CaptionML=[DEU=Debitor - VerkaufsÅbersicht;
                                 ENU=Customer - Sales List];
                      RunObject=Report 119;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1900711606;1 ;Action    ;
                      CaptionML=[DEU=Debitor - SaldenrÅckblick;
                                 ENU=Aged Accounts Receivable];
                      RunObject=Report 120;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1902299006;1 ;Action    ;
                      CaptionML=[DEU=Debitorenposten per;
                                 ENU=Customer - Balance to Date];
                      RunObject=Report 121;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1906359306;1 ;Action    ;
                      CaptionML=[DEU=Debitor - Saldenliste;
                                 ENU=Customer - Trial Balance];
                      RunObject=Report 129;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1904039606;1 ;Action    ;
                      CaptionML=[DEU=Debitor - Zahlungseingang;
                                 ENU=Customer - Payment Receipt];
                      RunObject=Report 211;
                      Promoted=Yes;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                SourceExpr=Name }

    { 40  ;2   ;Field     ;
                SourceExpr="Responsibility Center" }

    { 43  ;2   ;Field     ;
                SourceExpr="Location Code" }

    { 54  ;2   ;Field     ;
                SourceExpr="Post Code";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Country/Region Code";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Phone No." }

    { 32  ;2   ;Field     ;
                SourceExpr="Fax No.";
                Visible=FALSE }

    { 79  ;2   ;Field     ;
                SourceExpr="IC Partner Code";
                Visible=FALSE }

    { 34  ;2   ;Field     ;
                SourceExpr=Contact }

    { 36  ;2   ;Field     ;
                SourceExpr="Salesperson Code";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr="Customer Posting Group";
                Visible=FALSE }

    { 56  ;2   ;Field     ;
                SourceExpr="Gen. Bus. Posting Group";
                Visible=FALSE }

    { 52  ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                SourceExpr="Customer Price Group";
                Visible=FALSE }

    { 72  ;2   ;Field     ;
                SourceExpr="Customer Disc. Group";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Visible=FALSE }

    { 61  ;2   ;Field     ;
                SourceExpr="Reminder Terms Code";
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                SourceExpr="Fin. Charge Terms Code";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Visible=FALSE }

    { 50  ;2   ;Field     ;
                SourceExpr="Language Code";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr="Search Name" }

    { 1102601000;2;Field  ;
                SourceExpr="Credit Limit (LCY)";
                Visible=FALSE }

    { 1102601002;2;Field  ;
                SourceExpr=Blocked;
                Visible=FALSE }

    { 1102601004;2;Field  ;
                SourceExpr="Last Date Modified";
                Visible=FALSE }

    { 1102601006;2;Field  ;
                SourceExpr="Application Method";
                Visible=FALSE }

    { 1102601008;2;Field  ;
                SourceExpr="Combine Shipments";
                Visible=FALSE }

    { 1102601010;2;Field  ;
                SourceExpr=Reserve;
                Visible=FALSE }

    { 1102601012;2;Field  ;
                SourceExpr="Shipping Advice";
                Visible=FALSE }

    { 1102601014;2;Field  ;
                SourceExpr="Shipping Agent Code";
                Visible=FALSE }

    { 1102601016;2;Field  ;
                SourceExpr="Base Calendar Code";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1903720907;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9080;
                Visible=TRUE;
                PartType=Page }

    { 1907234507;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9081;
                Visible=FALSE;
                PartType=Page }

    { 1902018507;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9082;
                Visible=TRUE;
                PartType=Page }

    { 1900316107;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9084;
                Visible=FALSE;
                PartType=Page }

    { 1907829707;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9085;
                Visible=FALSE;
                PartType=Page }

    { 1902613707;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9086;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      "*** activeTAPI ***"@1113900000 : Integer;
      TAPIFu@1113900001 : Codeunit 56780;

    PROCEDURE GetSelectionFilter@2() : Code[80];
    VAR
      Cust@1000 : Record 18;
      FirstCust@1001 : Code[30];
      LastCust@1002 : Code[30];
      SelectionFilter@1003 : Code[250];
      CustCount@1004 : Integer;
      More@1005 : Boolean;
    BEGIN
      CurrPage.SETSELECTIONFILTER(Cust);
      CustCount := Cust.COUNT;
      IF CustCount > 0 THEN BEGIN
        Cust.FIND('-');
        WHILE CustCount > 0 DO BEGIN
          CustCount := CustCount - 1;
          Cust.MARKEDONLY(FALSE);
          FirstCust := Cust."No.";
          LastCust := FirstCust;
          More := (CustCount > 0);
          WHILE More DO
            IF Cust.NEXT = 0 THEN
              More := FALSE
            ELSE
              IF NOT Cust.MARK THEN
                More := FALSE
              ELSE BEGIN
                LastCust := Cust."No.";
                CustCount := CustCount - 1;
                IF CustCount = 0 THEN
                  More := FALSE;
              END;
          IF SelectionFilter <> '' THEN
            SelectionFilter := SelectionFilter + '|';
          IF FirstCust = LastCust THEN
            SelectionFilter := SelectionFilter + FirstCust
          ELSE
            SelectionFilter := SelectionFilter + FirstCust + '..' + LastCust;
          IF CustCount > 0 THEN BEGIN
            Cust.MARKEDONLY(TRUE);
            Cust.NEXT;
          END;
        END;
      END;
      EXIT(SelectionFilter);
    END;

    PROCEDURE SetSelection@1(VAR Cust@1000 : Record 18);
    BEGIN
      CurrPage.SETSELECTIONFILTER(Cust);
    END;

    BEGIN
    {
      AT2011   05.04.2011   Global Var TAPIFu CU 56780
                            New Action (1. of ActionItems): DEU=Anrufen; ENU=Dial (from actual line)
    }
    END.
  }
}

OBJECT Page 26 Vendor Card
{
  OBJECT-PROPERTIES
  {
    Date=05.04.11;
    Time=12:28:28;
    Modified=Yes;
    Version List=NAVW16.00.01,LIQEM6.00,NAVDACH5.00.01,AT2011;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Kreditorenkarte;
               ENU=Vendor Card];
    SourceTable=Table23;
    PageType=Card;
    RefreshOnActivate=Yes;
    OnInit=BEGIN
             ContactEditable := TRUE;
             MapPointVisible := TRUE;
           END;

    OnOpenPage=VAR
                 MapMgt@1000 : Codeunit 802;
               BEGIN
                 ActivateFields;
                 IF NOT MapMgt.TestSetup THEN
                   MapPointVisible := FALSE;
               END;

    OnFindRecord=VAR
                   RecordFound@1000 : Boolean;
                 BEGIN
                   RecordFound := FIND(Which);
                   IF NOT RecordFound AND (GETFILTER("No.") <> '') THEN
                   BEGIN
                     MESSAGE(Text003,GETFILTER("No."));
                     SETRANGE("No.");
                     RecordFound := FIND(Which);
                   END;
                   EXIT(RecordFound);
                 END;

    OnAfterGetRecord=BEGIN
                       ActivateFields;

                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 64      ;1   ;ActionGroup;
                      CaptionML=[DEU=&Kreditor;
                                 ENU=Ven&dor] }
      { 70      ;2   ;Action    ;
                      ShortCutKey=Strg+F5;
                      CaptionML=[DEU=&Posten;
                                 ENU=Ledger E&ntries];
                      RunObject=Page 29;
                      RunFormView=SORTING(Vendor No.);
                      RunFormLink=Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=VendorLedger;
                      PromotedCategory=Process }
      { 68      ;2   ;Action    ;
                      CaptionML=[DEU=Be&merkungen;
                                 ENU=Co&mments];
                      RunObject=Page 124;
                      RunFormLink=Table Name=CONST(Vendor),
                                  No.=FIELD(No.);
                      Image=ViewComments }
      { 184     ;2   ;Action    ;
                      ShortCutKey=Umschalt+Strg+D;
                      CaptionML=[DEU=Dimensionen;
                                 ENU=Dimensions];
                      RunObject=Page 540;
                      RunFormLink=Table ID=CONST(23),
                                  No.=FIELD(No.);
                      Image=Dimensions }
      { 87      ;2   ;Action    ;
                      CaptionML=[DEU=Bankk&onten;
                                 ENU=Bank Accounts];
                      RunObject=Page 425;
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 54      ;2   ;Action    ;
                      CaptionML=[DEU=Bestell&adressen;
                                 ENU=Order &Addresses];
                      RunObject=Page 368;
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 14      ;2   ;Action    ;
                      CaptionML=[DEU=Ko&ntakt;
                                 ENU=C&ontact];
                      OnAction=BEGIN
                                 ShowContact;
                               END;
                                }
      { 11      ;2   ;Separator  }
      { 66      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[DEU=Statistik;
                                 ENU=Statistics];
                      RunObject=Page 152;
                      RunFormLink=No.=FIELD(No.),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 20      ;2   ;Action    ;
                      CaptionML=[DEU=Statistik nach &WÑhrungen;
                                 ENU=Statistics by C&urrencies];
                      RunObject=Page 482;
                      RunFormLink=No.=FIELD(No.),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),
                                  Date Filter=FIELD(Date Filter) }
      { 67      ;2   ;Action    ;
                      CaptionML=[DEU=Buchungsstatistik;
                                 ENU=Entry Statistics];
                      RunObject=Page 303;
                      RunFormLink=No.=FIELD(No.),
                                  Date Filter=FIELD(Date Filter),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
      { 69      ;2   ;Action    ;
                      CaptionML=[DEU=Einkauf;
                                 ENU=Purchases];
                      RunObject=Page 156;
                      RunFormLink=No.=FIELD(No.),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
      { 83      ;2   ;Separator ;
                      CaptionML=[DEU="";
                                 ENU=""] }
      { 84      ;2   ;Action    ;
                      CaptionML=[DEU=Re&ferenzen;
                                 ENU=Cross References];
                      RunObject=Page 5723;
                      RunFormView=SORTING(Cross-Reference Type,Cross-Reference Type No.);
                      RunFormLink=Cross-Reference Type=CONST(Vendor),
                                  Cross-Reference Type No.=FIELD(No.) }
      { 108     ;2   ;Separator  }
      { 102     ;2   ;Action    ;
                      CaptionML=[DEU=Online Map;
                                 ENU=Online Map];
                      OnAction=BEGIN
                                 DisplayMap;
                               END;
                                }
      { 71      ;1   ;ActionGroup;
                      CaptionML=[DEU=&Einkauf;
                                 ENU=&Purchases] }
      { 118     ;2   ;Action    ;
                      CaptionML=[DEU=Arti&kel;
                                 ENU=Items];
                      RunObject=Page 297;
                      RunFormView=SORTING(Vendor No.,Item No.);
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 73      ;2   ;Action    ;
                      CaptionML=[DEU=&Rechnungsrabatte;
                                 ENU=Invoice &Discounts];
                      RunObject=Page 28;
                      RunFormLink=Code=FIELD(Invoice Disc. Code) }
      { 72      ;2   ;Action    ;
                      CaptionML=[DEU=Preise;
                                 ENU=Prices];
                      RunObject=Page 7012;
                      RunFormView=SORTING(Vendor No.);
                      RunFormLink=Vendor No.=FIELD(No.);
                      Image=ResourcePrice }
      { 116     ;2   ;Action    ;
                      CaptionML=[DEU=Zeilenrabatte;
                                 ENU=Line Discounts];
                      RunObject=Page 7014;
                      RunFormView=SORTING(Vendor No.);
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 129     ;2   ;Action    ;
                      CaptionML=[DEU=&VorauszahlungsprozentsÑtze;
                                 ENU=Prepa&yment Percentages];
                      RunObject=Page 665;
                      RunFormView=SORTING(Vendor No.);
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 123     ;2   ;Action    ;
                      CaptionML=[DEU=S&td.-Kreditoreinkaufscodes;
                                 ENU=S&td. Vend. Purchase Codes];
                      RunObject=Page 178;
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 117     ;2   ;Separator  }
      { 74      ;2   ;Action    ;
                      CaptionML=[DEU=Anfragen;
                                 ENU=Quotes];
                      RunObject=Page 49;
                      RunFormView=SORTING(Document Type,Buy-from Vendor No.);
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Image=Quote }
      { 21      ;2   ;Action    ;
                      CaptionML=[DEU=Ra&hmenbestellungen;
                                 ENU=Blanket Orders];
                      RunObject=Page 509;
                      RunFormView=SORTING(Document Type,Buy-from Vendor No.);
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Image=BlanketOrder }
      { 75      ;2   ;Action    ;
                      CaptionML=[DEU=Bestellungen;
                                 ENU=Orders];
                      RunObject=Page 50;
                      RunFormView=SORTING(Document Type,Buy-from Vendor No.,No.);
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Image=Document }
      { 99      ;2   ;Action    ;
                      CaptionML=[DEU=Rekla&mationen;
                                 ENU=Return Orders];
                      RunObject=Page 6640;
                      RunFormView=SORTING(Document Type,Buy-from Vendor No.,No.);
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Image=ReturnOrder }
      { 6500    ;2   ;Action    ;
                      CaptionML=[DEU=Artikel&verfolgungsposten;
                                 ENU=Item &Tracking Entries];
                      Image=ItemTrackingLedger;
                      OnAction=VAR
                                 ItemTrackingMgt@1000 : Codeunit 6500;
                               BEGIN
                                 ItemTrackingMgt.CallItemTrackingEntryForm(2,"No.",'','','','','');
                               END;
                                }
      { 1900000005;0 ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 1903213705;1 ;Action    ;
                      CaptionML=ENU=Blanket Purchase Order;
                      RunObject=Page 509;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=BlanketOrder;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1901469405;1 ;Action    ;
                      CaptionML=ENU=Purchase Quote;
                      RunObject=Page 49;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=Quote;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1907709505;1 ;Action    ;
                      CaptionML=ENU=Purchase Invoice;
                      RunObject=Page 51;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Invoice;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1907375405;1 ;Action    ;
                      CaptionML=ENU=Purchase Order;
                      RunObject=Page 50;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1905024805;1 ;Action    ;
                      CaptionML=ENU=Purchase Credit Memo;
                      RunObject=Page 52;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=CreditMemo;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1904749705;1 ;Action    ;
                      CaptionML=ENU=Purchase Return Order;
                      RunObject=Page 6640;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=ReturnOrder;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 130     ;1   ;ActionGroup;
                      CaptionML=[DEU=F&unktionen;
                                 ENU=F&unctions] }
      { 131     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Vorlage anwenden;
                                 ENU=Apply Template];
                      Promoted=Yes;
                      Image=ApplyTemplate;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 TemplateMgt@1000 : Codeunit 8612;
                                 RecRef@1001 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 TemplateMgt.UpdateFromTemplateSelection(RecRef);
                               END;
                                }
      { 1902327104;1 ;Action    ;
                      CaptionML=ENU=Payment Journal;
                      RunObject=Page 256;
                      Promoted=Yes;
                      Image=PaymentJournal;
                      PromotedCategory=Process }
      { 1906371704;1 ;Action    ;
                      CaptionML=ENU=Purchase Journal;
                      RunObject=Page 254;
                      Promoted=Yes;
                      Image=Journals;
                      PromotedCategory=Process }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1905916106;1 ;Action    ;
                      CaptionML=ENU=Vendor - Labels;
                      RunObject=Report 310;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1904504206;1 ;Action    ;
                      CaptionML=ENU=Vendor - Balance to Date;
                      RunObject=Report 321;
                      Promoted=No;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[DEU=Allgemein;
                           ENU=General] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr=Name;
                Importance=Promoted }

    { 6   ;2   ;Field     ;
                SourceExpr=Address }

    { 8   ;2   ;Field     ;
                SourceExpr="Address 2" }

    { 79  ;2   ;Field     ;
                SourceExpr="Post Code";
                Importance=Promoted }

    { 81  ;2   ;Field     ;
                SourceExpr="Country/Region Code" }

    { 12  ;2   ;Field     ;
                SourceExpr="Phone No.";
                OnAssistEdit=BEGIN
                               // AT2009.01 START
                               TAPIFu.Dial(23,"No.",'',0);
                               // AT2009.01 END
                             END;
                              }

    { 114 ;2   ;Field     ;
                SourceExpr="Primary Contact No." }

    { 16  ;2   ;Field     ;
                SourceExpr=Contact;
                Importance=Promoted;
                Editable=ContactEditable;
                OnValidate=BEGIN
                             ContactOnAfterValidate;
                           END;
                            }

    { 10  ;2   ;Field     ;
                SourceExpr=City }

    { 18  ;2   ;Field     ;
                SourceExpr="Search Name" }

    { 92  ;2   ;Field     ;
                SourceExpr="Balance (LCY)";
                OnDrillDown=VAR
                              VendLedgEntry@1001 : Record 25;
                              DtldVendLedgEntry@1002 : Record 380;
                            BEGIN
                              DtldVendLedgEntry.SETRANGE("Vendor No.","No.");
                              COPYFILTER("Global Dimension 1 Filter",DtldVendLedgEntry."Initial Entry Global Dim. 1");
                              COPYFILTER("Global Dimension 2 Filter",DtldVendLedgEntry."Initial Entry Global Dim. 2");
                              COPYFILTER("Currency Filter",DtldVendLedgEntry."Currency Code");
                              VendLedgEntry.DrillDownOnEntries(DtldVendLedgEntry);
                            END;
                             }

    { 22  ;2   ;Field     ;
                SourceExpr="Purchaser Code" }

    { 55  ;2   ;Field     ;
                SourceExpr="Responsibility Center" }

    { 24  ;2   ;Field     ;
                SourceExpr=Blocked }

    { 26  ;2   ;Field     ;
                SourceExpr="Last Date Modified" }

    { 1902768601;1;Group  ;
                CaptionML=[DEU=Kommunikation;
                           ENU=Communication] }

    { 44  ;2   ;Field     ;
                SourceExpr="Phone No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               // AT2009.01 START
                               TAPIFu.Dial(23,"No.",'',0);
                               // AT2009.01 END
                             END;
                              }

    { 45  ;2   ;Field     ;
                SourceExpr="Fax No." }

    { 48  ;2   ;Field     ;
                SourceExpr="E-Mail";
                Importance=Promoted }

    { 86  ;2   ;Field     ;
                SourceExpr="Home Page" }

    { 125 ;2   ;Field     ;
                SourceExpr="IC Partner Code";
                OnValidate=BEGIN
                             ICPartnerCodeOnAfterValidate;
                           END;
                            }

    { 1905885101;1;Group  ;
                CaptionML=[DEU=Fakturierung;
                           ENU=Invoicing] }

    { 30  ;2   ;Field     ;
                SourceExpr="Pay-to Vendor No." }

    { 60  ;2   ;Field     ;
                SourceExpr="Gen. Bus. Posting Group";
                Importance=Promoted }

    { 90  ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group" }

    { 32  ;2   ;Field     ;
                SourceExpr="Vendor Posting Group";
                Importance=Promoted }

    { 34  ;2   ;Field     ;
                SourceExpr="Invoice Disc. Code" }

    { 94  ;2   ;Field     ;
                SourceExpr="Prices Including VAT" }

    { 127 ;2   ;Field     ;
                SourceExpr="Prepayment %" }

    { 1140000;2;Field     ;
                SourceExpr="Registration No." }

    { 1901677601;1;Group  ;
                CaptionML=[DEU=Zahlung;
                           ENU=Payments] }

    { 36  ;2   ;Field     ;
                SourceExpr="Application Method" }

    { 38  ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Importance=Promoted }

    { 40  ;2   ;Field     ;
                SourceExpr="Payment Method Code";
                Importance=Promoted }

    { 42  ;2   ;Field     ;
                SourceExpr=Priority }

    { 1461000;2;Field     ;
                SourceExpr="Liq. Payment Terms Code" }

    { 50  ;2   ;Field     ;
                SourceExpr="Our Account No." }

    { 119 ;2   ;Field     ;
                SourceExpr="Block Payment Tolerance";
                OnValidate=BEGIN
                             IF "Block Payment Tolerance" THEN BEGIN
                               IF CONFIRM(Text002,FALSE) THEN
                                 PaymentToleranceMgt.DelTolVendLedgEntry(Rec);
                             END ELSE BEGIN
                               IF CONFIRM(Text001,FALSE) THEN
                                 PaymentToleranceMgt.CalcTolVendLedgEntry(Rec);
                             END;
                           END;
                            }

    { 1901075901;1;Group  ;
                CaptionML=[DEU=Lieferung;
                           ENU=Receiving] }

    { 100 ;2   ;Field     ;
                SourceExpr="Location Code";
                Importance=Promoted }

    { 28  ;2   ;Field     ;
                SourceExpr="Shipment Method Code";
                Importance=Promoted }

    { 96  ;2   ;Field     ;
                SourceExpr="Lead Time Calculation";
                Importance=Promoted }

    { 112 ;2   ;Field     ;
                DrillDown=No;
                SourceExpr="Base Calendar Code" }

    { 121 ;2   ;Field     ;
                Name=Customized Calendar;
                CaptionML=[DEU=Spezifischer Kalender;
                           ENU=Customized Calendar];
                SourceExpr=CalendarMgmt.CustomizedCalendarExistText(CustomizedCalendar."Source Type"::Vendor,"No.",'',"Base Calendar Code");
                Editable=FALSE;
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              TESTFIELD("Base Calendar Code");
                              CalendarMgmt.ShowCustomizedCalendar(CustomizedCalEntry."Source Type"::Vendor,"No.",'',"Base Calendar Code");
                            END;
                             }

    { 1140005;2;Field     ;
                SourceExpr="Delivery Reminder Terms" }

    { 1907468901;1;Group  ;
                CaptionML=[DEU=Au·enhandel;
                           ENU=Foreign Trade] }

    { 52  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Importance=Promoted }

    { 56  ;2   ;Field     ;
                SourceExpr="Language Code" }

    { 58  ;2   ;Field     ;
                SourceExpr="VAT Registration No." }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1904651607;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9094;
                Visible=TRUE;
                PartType=Page }

    { 1903435607;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9095;
                Visible=TRUE;
                PartType=Page }

    { 1906949207;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9096;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      CalendarMgmt@1000 : Codeunit 7600;
      PaymentToleranceMgt@1002 : Codeunit 426;
      CustomizedCalEntry@1001 : Record 7603;
      CustomizedCalendar@1003 : Record 7602;
      Text001@1005 : TextConst 'DEU=Mîchten Sie Zahlungstoleranzen fÅr momentan offene Posten zulassen?;ENU=Do you want to allow payment tolerance for entries that are currently open?';
      Text002@1004 : TextConst 'DEU=Mîchten Sie Zahlungstoleranzen fÅr momentan offene Posten lîschen?;ENU=Do you want to remove payment tolerance from entries that are currently open?';
      PurchInfoPaneMgt@1006 : Codeunit 7181;
      Text003@1007 : TextConst 'DEU=Der Kreditor ''%1'' ist nicht vorhanden.;ENU=The vendor %1 does not exist.';
      "**** avtiveTAPI ****"@1000000001 : Integer;
      TAPIFu@1000000000 : Codeunit 56780;
      MapPointVisible@19022708 : Boolean INDATASET;
      ContactEditable@19051436 : Boolean INDATASET;

    PROCEDURE ActivateFields@3();
    BEGIN
      ContactEditable := "Primary Contact No." = '';
    END;

    LOCAL PROCEDURE ContactOnAfterValidate@19013243();
    BEGIN
      ActivateFields;
    END;

    LOCAL PROCEDURE ICPartnerCodeOnAfterValidate@19032922();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      ActivateFields;
    END;

    BEGIN
    {
      AT2011   05.04.2011  New Dial function
                           Global Var TAPIFu CU 56780
                           Trick: Call in the OnAssistEdit-Trigger of every Phone-No. Bitmap (2x)
    }
    END.
  }
}

OBJECT Page 27 Vendor List
{
  OBJECT-PROPERTIES
  {
    Date=05.04.11;
    Time=12:28:37;
    Modified=Yes;
    Version List=NAVW16.00.01,AT2011;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[DEU=KreditorenÅbersicht;
               ENU=Vendor List];
    SourceTable=Table23;
    PageType=List;
    CardFormID=Page26;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 16      ;1   ;ActionGroup;
                      CaptionML=[DEU=&Kreditor;
                                 ENU=Ven&dor] }
      { 17      ;2   ;Action    ;
                      ShortCutKey=Umschalt+F5;
                      CaptionML=[DEU=Karte;
                                 ENU=Card];
                      RunObject=Page 27;
                      RunFormLink=No.=FIELD(No.),
                                  Date Filter=FIELD(Date Filter),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                      Image=EditLines }
      { 22      ;2   ;Action    ;
                      ShortCutKey=Strg+F5;
                      CaptionML=[DEU=&Posten;
                                 ENU=Ledger E&ntries];
                      RunObject=Page 29;
                      RunFormView=SORTING(Vendor No.);
                      RunFormLink=Vendor No.=FIELD(No.);
                      Promoted=Yes;
                      Image=VendorLedger;
                      PromotedCategory=Process }
      { 20      ;2   ;Action    ;
                      CaptionML=[DEU=Be&merkungen;
                                 ENU=Co&mments];
                      RunObject=Page 124;
                      RunFormLink=Table Name=CONST(Vendor),
                                  No.=FIELD(No.);
                      Image=ViewComments }
      { 44      ;2   ;ActionGroup;
                      CaptionML=[DEU=Dimensionen;
                                 ENU=Dimensions] }
      { 84      ;3   ;Action    ;
                      ShortCutKey=Umschalt+Strg+D;
                      CaptionML=[DEU=Zuordnung fÅr &aktuellen Datensatz;
                                 ENU=Dimensions-Single];
                      RunObject=Page 540;
                      RunFormLink=Table ID=CONST(23),
                                  No.=FIELD(No.) }
      { 43      ;3   ;Action    ;
                      CaptionML=[DEU=Zuordnung fÅr &markierte DatensÑtze;
                                 ENU=Dimensions-&Multiple];
                      OnAction=VAR
                                 Vend@1001 : Record 23;
                                 DefaultDimMultiple@1002 : Form 542;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Vend);
                                 DefaultDimMultiple.SetMultiVendor(Vend);
                                 DefaultDimMultiple.RUNMODAL;
                               END;
                                }
      { 54      ;2   ;Action    ;
                      CaptionML=[DEU=Bankk&onten;
                                 ENU=Bank Accounts];
                      RunObject=Page 425;
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 53      ;2   ;Action    ;
                      CaptionML=[DEU=Bestell&adressen;
                                 ENU=Order &Addresses];
                      RunObject=Page 368;
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 56      ;2   ;Action    ;
                      CaptionML=[DEU=Ko&ntakt;
                                 ENU=C&ontact];
                      OnAction=BEGIN
                                 ShowContact;
                               END;
                                }
      { 55      ;2   ;Separator  }
      { 18      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[DEU=Statistik;
                                 ENU=Statistics];
                      RunObject=Page 152;
                      RunFormLink=No.=FIELD(No.),
                                  Date Filter=FIELD(Date Filter),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 57      ;2   ;Action    ;
                      CaptionML=[DEU=Statistik nach &WÑhrungen;
                                 ENU=Statistics by C&urrencies];
                      RunObject=Page 482;
                      RunFormLink=No.=FIELD(No.),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),
                                  Date Filter=FIELD(Date Filter) }
      { 19      ;2   ;Action    ;
                      CaptionML=[DEU=Buchungsstatistik;
                                 ENU=Entry Statistics];
                      RunObject=Page 303;
                      RunFormLink=No.=FIELD(No.),
                                  Date Filter=FIELD(Date Filter),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
      { 21      ;2   ;Action    ;
                      CaptionML=[DEU=Einkauf;
                                 ENU=Purchases];
                      RunObject=Page 156;
                      RunFormLink=No.=FIELD(No.),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
      { 61      ;2   ;Separator  }
      { 62      ;2   ;Action    ;
                      CaptionML=[DEU=Re&ferenzen;
                                 ENU=Cross Re&ferences];
                      RunObject=Page 5723;
                      RunFormView=SORTING(Cross-Reference Type,Cross-Reference Type No.);
                      RunFormLink=Cross-Reference Type=CONST(Vendor),
                                  Cross-Reference Type No.=FIELD(No.) }
      { 23      ;1   ;ActionGroup;
                      CaptionML=[DEU=&Einkauf;
                                 ENU=&Purchases] }
      { 66      ;2   ;Action    ;
                      CaptionML=[DEU=Arti&kel;
                                 ENU=Items];
                      RunObject=Page 297;
                      RunFormView=SORTING(Vendor No.);
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 25      ;2   ;Action    ;
                      CaptionML=[DEU=&Rechnungsrabatte;
                                 ENU=Invoice &Discounts];
                      RunObject=Page 28;
                      RunFormLink=Code=FIELD(Invoice Disc. Code) }
      { 24      ;2   ;Action    ;
                      CaptionML=[DEU=Preise;
                                 ENU=Prices];
                      RunObject=Page 7012;
                      RunFormView=SORTING(Vendor No.);
                      RunFormLink=Vendor No.=FIELD(No.);
                      Image=ResourcePrice }
      { 64      ;2   ;Action    ;
                      CaptionML=[DEU=Zeilenrabatte;
                                 ENU=Line Discounts];
                      RunObject=Page 7014;
                      RunFormView=SORTING(Vendor No.);
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 70      ;2   ;Action    ;
                      CaptionML=[DEU=&VorauszahlungsprozentsÑtze;
                                 ENU=Prepa&yment Percentages];
                      RunObject=Page 665;
                      RunFormView=SORTING(Vendor No.);
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 67      ;2   ;Action    ;
                      CaptionML=[DEU=S&td.-Kreditoreinkaufscodes;
                                 ENU=S&td. Vend. Purchase Codes];
                      RunObject=Page 178;
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 65      ;2   ;Separator  }
      { 26      ;2   ;Action    ;
                      CaptionML=[DEU=Anfragen;
                                 ENU=Quotes];
                      RunObject=Page 49;
                      RunFormView=SORTING(Document Type,Buy-from Vendor No.);
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Image=Quote }
      { 58      ;2   ;Action    ;
                      CaptionML=[DEU=Ra&hmenbestellungen;
                                 ENU=Blanket Orders];
                      RunObject=Page 509;
                      RunFormView=SORTING(Document Type,Buy-from Vendor No.);
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Image=BlanketOrder }
      { 27      ;2   ;Action    ;
                      CaptionML=[DEU=Bestellungen;
                                 ENU=Orders];
                      RunObject=Page 50;
                      RunFormView=SORTING(Document Type,Buy-from Vendor No.,No.);
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Image=Document }
      { 63      ;2   ;Action    ;
                      CaptionML=[DEU=Rekla&mationen;
                                 ENU=Return Orders];
                      RunObject=Page 6640;
                      Image=ReturnOrder }
      { 6500    ;2   ;Action    ;
                      CaptionML=[DEU=Artikel&verfolgungsposten;
                                 ENU=Item &Tracking Entries];
                      Image=ItemTrackingLedger;
                      OnAction=VAR
                                 ItemTrackingMgt@1001 : Codeunit 6500;
                               BEGIN
                                 ItemTrackingMgt.CallItemTrackingEntryForm(2,"No.",'','','','','');
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000000;1 ;Action    ;
                      CaptionML=[DEU=&Anrufen;
                                 ENU=&Dial];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 // AT04.00 BEGIN
                                 TAPIFu.Dial(23,"No.",'',0);
                                 // AT04.00 END
                               END;
                                }
      { 1902327104;1 ;Action    ;
                      CaptionML=ENU=Payment Journal;
                      RunObject=Page 256;
                      Promoted=Yes;
                      Image=PaymentJournal;
                      PromotedCategory=Process }
      { 1906371704;1 ;Action    ;
                      CaptionML=ENU=Purchase Journal;
                      RunObject=Page 254;
                      Promoted=No;
                      Image=Journals;
                      PromotedCategory=Process }
      { 1900000005;0 ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 1903213705;1 ;Action    ;
                      CaptionML=ENU=Blanket Purchase Order;
                      RunObject=Page 509;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=BlanketOrder;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1901469405;1 ;Action    ;
                      CaptionML=ENU=Purchase Quote;
                      RunObject=Page 49;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=Quote;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1907709505;1 ;Action    ;
                      CaptionML=ENU=Purchase Invoice;
                      RunObject=Page 51;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Invoice;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1907375405;1 ;Action    ;
                      CaptionML=ENU=Purchase Order;
                      RunObject=Page 50;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1905024805;1 ;Action    ;
                      CaptionML=ENU=Purchase Credit Memo;
                      RunObject=Page 52;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=CreditMemo;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1904749705;1 ;Action    ;
                      CaptionML=ENU=Purchase Return Order;
                      RunObject=Page 6640;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=ReturnOrder;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1900518506;1 ;Action    ;
                      CaptionML=ENU=Vendor - List;
                      RunObject=Report 301;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1906328906;1 ;Action    ;
                      CaptionML=ENU=Vendor Register;
                      RunObject=Report 303;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1900639206;1 ;Action    ;
                      CaptionML=ENU=Vendor - Detail Trial Balance;
                      RunObject=Report 304;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1905685906;1 ;Action    ;
                      CaptionML=ENU=Vendor - Summary Aging;
                      RunObject=Report 305;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1906294906;1 ;Action    ;
                      CaptionML=ENU=Vendor - Order Summary;
                      RunObject=Report 307;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1904076306;1 ;Action    ;
                      CaptionML=ENU=Vendor - Order Detail;
                      RunObject=Report 308;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1907303206;1 ;Action    ;
                      CaptionML=ENU=Vendor - Purchase List;
                      RunObject=Report 309;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1905916106;1 ;Action    ;
                      CaptionML=ENU=Vendor - Labels;
                      RunObject=Report 310;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1900497106;1 ;Action    ;
                      CaptionML=ENU=Vendor - Top 10 List;
                      RunObject=Report 311;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1905448306;1 ;Action    ;
                      CaptionML=ENU=Purchase Statistics;
                      RunObject=Report 312;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1904498706;1 ;Action    ;
                      CaptionML=ENU=Vendor/Item Purchases;
                      RunObject=Report 313;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1905766406;1 ;Action    ;
                      CaptionML=ENU=Payments on Hold;
                      RunObject=Report 319;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1906643406;1 ;Action    ;
                      CaptionML=ENU=Vendor Item Catalog;
                      RunObject=Report 320;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1904504206;1 ;Action    ;
                      CaptionML=ENU=Vendor - Balance to Date;
                      RunObject=Report 321;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1905388206;1 ;Action    ;
                      CaptionML=ENU=Aged Accounts Payable;
                      RunObject=Report 322;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1906387606;1 ;Action    ;
                      CaptionML=ENU=Vendor - Trial Balance;
                      RunObject=Report 329;
                      Promoted=No;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                SourceExpr=Name }

    { 41  ;2   ;Field     ;
                SourceExpr="Responsibility Center" }

    { 59  ;2   ;Field     ;
                SourceExpr="Location Code" }

    { 29  ;2   ;Field     ;
                SourceExpr="Post Code";
                Visible=FALSE }

    { 31  ;2   ;Field     ;
                SourceExpr="Country/Region Code";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Phone No." }

    { 33  ;2   ;Field     ;
                SourceExpr="Fax No.";
                Visible=FALSE }

    { 68  ;2   ;Field     ;
                SourceExpr="IC Partner Code";
                Visible=FALSE }

    { 35  ;2   ;Field     ;
                SourceExpr=Contact }

    { 37  ;2   ;Field     ;
                SourceExpr="Purchaser Code";
                Visible=FALSE }

    { 39  ;2   ;Field     ;
                SourceExpr="Vendor Posting Group";
                Visible=FALSE }

    { 51  ;2   ;Field     ;
                SourceExpr="Gen. Bus. Posting Group";
                Visible=FALSE }

    { 49  ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Visible=FALSE }

    { 45  ;2   ;Field     ;
                SourceExpr="Fin. Charge Terms Code";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Visible=FALSE }

    { 47  ;2   ;Field     ;
                SourceExpr="Language Code";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr="Search Name" }

    { 1102601000;2;Field  ;
                SourceExpr=Blocked;
                Visible=FALSE }

    { 1102601002;2;Field  ;
                SourceExpr="Last Date Modified";
                Visible=FALSE }

    { 1102601004;2;Field  ;
                SourceExpr="Application Method";
                Visible=FALSE }

    { 1102601006;2;Field  ;
                SourceExpr="Location Code";
                Visible=FALSE }

    { 1102601008;2;Field  ;
                SourceExpr="Shipment Method Code";
                Visible=FALSE }

    { 1102601010;2;Field  ;
                SourceExpr="Lead Time Calculation";
                Visible=FALSE }

    { 1102601012;2;Field  ;
                SourceExpr="Base Calendar Code";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1901138007;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9093;
                Visible=FALSE;
                PartType=Page }

    { 1904651607;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9094;
                Visible=TRUE;
                PartType=Page }

    { 1903435607;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9095;
                Visible=TRUE;
                PartType=Page }

    { 1906949207;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9096;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      "*** activeTAPI ***"@1000000001 : Integer;
      TAPIFu@1000000000 : Codeunit 56780;

    PROCEDURE GetSelectionFilter@2() : Code[80];
    VAR
      Vend@1000 : Record 23;
      FirstVend@1001 : Code[30];
      LastVend@1002 : Code[30];
      SelectionFilter@1003 : Code[250];
      VendCount@1004 : Integer;
      More@1005 : Boolean;
    BEGIN
      CurrPage.SETSELECTIONFILTER(Vend);
      VendCount := Vend.COUNT;
      IF VendCount > 0 THEN BEGIN
        Vend.FIND('-');
        WHILE VendCount > 0 DO BEGIN
          VendCount := VendCount - 1;
          Vend.MARKEDONLY(FALSE);
          FirstVend := Vend."No.";
          LastVend := FirstVend;
          More := (VendCount > 0);
          WHILE More DO
            IF Vend.NEXT = 0 THEN
              More := FALSE
            ELSE
              IF NOT Vend.MARK THEN
                More := FALSE
              ELSE BEGIN
                LastVend := Vend."No.";
                VendCount := VendCount - 1;
                IF VendCount = 0 THEN
                  More := FALSE;
              END;
          IF SelectionFilter <> '' THEN
            SelectionFilter := SelectionFilter + '|';
          IF FirstVend = LastVend THEN
            SelectionFilter := SelectionFilter + FirstVend
          ELSE
            SelectionFilter := SelectionFilter + FirstVend + '..' + LastVend;
          IF VendCount > 0 THEN BEGIN
            Vend.MARKEDONLY(TRUE);
            Vend.NEXT;
          END;
        END;
      END;
      EXIT(SelectionFilter);
    END;

    PROCEDURE SetSelection@1(VAR Vend@1000 : Record 23);
    BEGIN
      CurrPage.SETSELECTIONFILTER(Vend);
    END;

    BEGIN
    {
      AT2011   05.04.2011   Global Var TAPIFu CU 56780
                            New Action (1. of ActionItems): DEU=Anrufen; ENU=Dial (from actual line)
    }
    END.
  }
}

OBJECT Page 119 User Setup
{
  OBJECT-PROPERTIES
  {
    Date=05.04.11;
    Time=17:40:39;
    Modified=Yes;
    Version List=NAVW14.00,AT2011;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Benutzer Einrichtung;
               ENU=User Setup];
    SourceTable=Table91;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="User ID" }

    { 4   ;2   ;Field     ;
                SourceExpr="Allow Posting From" }

    { 6   ;2   ;Field     ;
                SourceExpr="Allow Posting To" }

    { 8   ;2   ;Field     ;
                SourceExpr="Register Time" }

    { 15  ;2   ;Field     ;
                SourceExpr="Sales Resp. Ctr. Filter" }

    { 17  ;2   ;Field     ;
                SourceExpr="Purchase Resp. Ctr. Filter" }

    { 21  ;2   ;Field     ;
                SourceExpr="Service Resp. Ctr. Filter" }

    { 1000000000;2;Field  ;
                SourceExpr="Use active TAPI" }

    { 1000000002;2;Field  ;
                SourceExpr="See TAPI Logfile completely" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    BEGIN
    {
      AT01 actTAPI 04.06.2003 New field: Use active TAPI
      AT2009       06.11.2009 New Field: See TAPI Logfile completely
      AT2011       05.04.2011 Page created
    }
    END.
  }
}

OBJECT Page 5050 Contact Card
{
  OBJECT-PROPERTIES
  {
    Date=05.04.11;
    Time=12:28:52;
    Modified=Yes;
    Version List=NAVW16.00.10,AT2011;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Kontaktkarte;
               ENU=Contact Card];
    SourceTable=Table5050;
    PageType=ListPlus;
    OnInit=BEGIN
             NoofJobResponsibilitiesEnable := TRUE;
             OrganizationalLevelCodeEnable := TRUE;
             "Company NameEnable" := TRUE;
             "Company No.Enable" := TRUE;
             "VAT Registration No.Enable" := TRUE;
             "Currency CodeEnable" := TRUE;
             MapPointVisible := TRUE;
           END;

    OnOpenPage=VAR
                 MapMgt@1000 : Codeunit 802;
               BEGIN
                 IF NOT MapMgt.TestSetup THEN
                   MapPointVisible := FALSE;
               END;

    OnFindRecord=VAR
                   RecordFound@1000 : Boolean;
                 BEGIN
                   RecordFound := FIND(Which);
                   CurrPage.EDITABLE := RecordFound OR (GETFILTER("No.") = '');
                   EXIT(RecordFound);
                 END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 76      ;1   ;ActionGroup;
                      CaptionML=[DEU=Ko&ntakt;
                                 ENU=C&ontact] }
      { 79      ;2   ;Action    ;
                      CaptionML=[DEU=Zugehîrige Ko&ntakte;
                                 ENU=Relate&d Contacts];
                      RunObject=Page 5052;
                      RunFormLink=Company No.=FIELD(Company No.) }
      { 82      ;2   ;ActionGroup;
                      CaptionML=[DEU=Un&ternehmen;
                                 ENU=Comp&any] }
      { 85      ;3   ;Action    ;
                      CaptionML=[DEU=GeschÑftsbeziehungen;
                                 ENU=Business Relations];
                      RunObject=Page 5061;
                      RunFormLink=Contact No.=FIELD(Company No.) }
      { 83      ;3   ;Action    ;
                      CaptionML=[DEU=Branchen;
                                 ENU=Industry Groups];
                      RunObject=Page 5067;
                      RunFormLink=Contact No.=FIELD(Company No.) }
      { 84      ;3   ;Action    ;
                      CaptionML=[DEU=Internetfavoriten;
                                 ENU=Web Sources];
                      RunObject=Page 5070;
                      RunFormLink=Contact No.=FIELD(Company No.) }
      { 80      ;2   ;ActionGroup;
                      CaptionML=[DEU=&Person;
                                 ENU=P&erson] }
      { 81      ;3   ;Action    ;
                      CaptionML=[DEU=Verantwortlichkeiten;
                                 ENU=Job Responsibilities];
                      OnAction=VAR
                                 ContJobResp@1001 : Record 5067;
                               BEGIN
                                 TESTFIELD(Type,Type::Person);
                                 ContJobResp.SETRANGE("Contact No.","No.");
                                 FORM.RUNMODAL(FORM::"Contact Job Responsibilities",ContJobResp);
                               END;
                                }
      { 86      ;2   ;Action    ;
                      CaptionML=[DEU=&Verteiler;
                                 ENU=Mailing &Groups];
                      RunObject=Page 5064;
                      RunFormLink=Contact No.=FIELD(No.) }
      { 87      ;2   ;Action    ;
                      CaptionML=[DEU=Pr&ofile;
                                 ENU=Pro&files];
                      OnAction=VAR
                                 ProfileManagement@1001 : Codeunit 5059;
                               BEGIN
                                 ProfileManagement.ShowContactQuestionnaireCard(Rec,'',0);
                               END;
                                }
      { 88      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[DEU=Statistik;
                                 ENU=Statistics];
                      RunObject=Page 5053;
                      RunFormLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 89      ;2   ;Action    ;
                      CaptionML=[DEU=Bi&ld;
                                 ENU=&Picture];
                      RunObject=Page 5104;
                      RunFormLink=No.=FIELD(No.) }
      { 90      ;2   ;Action    ;
                      CaptionML=[DEU=Be&merkungen;
                                 ENU=Co&mments];
                      RunObject=Page 5072;
                      RunFormLink=Table Name=CONST(Contact),
                                  No.=FIELD(No.),
                                  Sub No.=CONST(0);
                      Image=ViewComments }
      { 91      ;2   ;ActionGroup;
                      CaptionML=[DEU=Al&ternative Adressen;
                                 ENU=Alternati&ve Address] }
      { 92      ;3   ;Action    ;
                      CaptionML=[DEU=Karte;
                                 ENU=Card];
                      RunObject=Page 5057;
                      RunFormLink=Contact No.=FIELD(No.);
                      Image=EditLines }
      { 93      ;3   ;Action    ;
                      CaptionML=[DEU=GÅltigkeiten;
                                 ENU=Date Ranges];
                      RunObject=Page 5059;
                      RunFormLink=Contact No.=FIELD(No.) }
      { 94      ;2   ;Separator ;
                      CaptionML=[DEU="";
                                 ENU=""] }
      { 95      ;2   ;Action    ;
                      ShortCutKey=Strg+F7;
                      CaptionML=[DEU=Aktivit&Ñtenprotokollposten;
                                 ENU=Interaction Log E&ntries];
                      RunObject=Page 5076;
                      RunFormView=SORTING(Contact Company No.,Date,Contact No.,Canceled,Initiated By,Attempt Failed);
                      RunFormLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.)) }
      { 149     ;2   ;Action    ;
                      CaptionML=[DEU=ZurÅckgestellte &AktivitÑten;
                                 ENU=Postponed &Interactions];
                      RunObject=Page 5082;
                      RunFormView=SORTING(Contact Company No.,Date,Contact No.,Canceled,Initiated By,Attempt Failed);
                      RunFormLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.)) }
      { 96      ;2   ;Action    ;
                      CaptionML=[DEU=Aufga&ben;
                                 ENU=T&o-dos];
                      RunObject=Page 5096;
                      RunFormView=SORTING(Contact Company No.,Date,Contact No.,Closed);
                      RunFormLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                  System To-do Type=FILTER(Contact Attendee) }
      { 151     ;2   ;ActionGroup;
                      CaptionML=[DEU=Verkaufs&chancen;
                                 ENU=Oppo&rtunities] }
      { 97      ;3   ;Action    ;
                      CaptionML=[DEU=öbersicht;
                                 ENU=List];
                      RunObject=Page 5123;
                      RunFormView=SORTING(Contact Company No.,Contact No.);
                      RunFormLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.)) }
      { 100     ;2   ;Action    ;
                      CaptionML=[DEU=S&egmente;
                                 ENU=Segmen&ts];
                      RunObject=Page 5150;
                      RunFormView=SORTING(Contact No.,Segment No.);
                      RunFormLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.));
                      Image=Segment }
      { 98      ;2   ;Separator ;
                      CaptionML=[DEU="";
                                 ENU=""] }
      { 116     ;2   ;Action    ;
                      CaptionML=[DEU=&Angebote;
                                 ENU=Sales &Quotes];
                      RunObject=Page 9300;
                      RunFormView=SORTING(Document Type,Sell-to Contact No.);
                      RunFormLink=Sell-to Contact No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Quote;
                      PromotedCategory=Process }
      { 119     ;2   ;Separator  }
      { 99      ;2   ;Action    ;
                      CaptionML=[DEU=&Debitor/Kreditor/Bankkonto;
                                 ENU=C&ustomer/Vendor/Bank Acc.];
                      OnAction=BEGIN
                                 ShowCustVendBank;
                               END;
                                }
      { 62      ;2   ;Separator  }
      { 63      ;2   ;Action    ;
                      CaptionML=[DEU=Online Map;
                                 ENU=Online Map];
                      OnAction=BEGIN
                                 DisplayMap;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 75      ;1   ;ActionGroup;
                      CaptionML=[DEU=F&unktion;
                                 ENU=F&unctions] }
      { 102     ;2   ;Action    ;
                      CaptionML=[DEU=&Internetfavorit aufrufen;
                                 ENU=Launch &Web Source];
                      OnAction=VAR
                                 ContactWebSource@1001 : Record 5060;
                               BEGIN
                                 ContactWebSource.SETRANGE("Contact No.","Company No.");
                                 IF FORM.RUNMODAL(FORM::"Web Source Launch",ContactWebSource) = ACTION::LookupOK THEN
                                   ContactWebSource.Launch;
                               END;
                                }
      { 103     ;2   ;Action    ;
                      CaptionML=[DEU=&Deckblatt drucken;
                                 ENU=Print Cover &Sheet];
                      OnAction=VAR
                                 Cont@1001 : Record 5050;
                               BEGIN
                                 Cont := Rec;
                                 Cont.SETRECFILTER;
                                 REPORT.RUN(REPORT::"Contact - Cover Sheet",TRUE,FALSE,Cont);
                               END;
                                }
      { 105     ;2   ;ActionGroup;
                      CaptionML=[DEU=Erstellen als;
                                 ENU=Create as] }
      { 106     ;3   ;Action    ;
                      CaptionML=[DEU=Debitor;
                                 ENU=Customer];
                      OnAction=BEGIN
                                 CreateCustomer(ChooseCustomerTemplate);
                               END;
                                }
      { 107     ;3   ;Action    ;
                      CaptionML=[DEU=Kreditor;
                                 ENU=Vendor];
                      OnAction=BEGIN
                                 CreateVendor;
                               END;
                                }
      { 108     ;3   ;Action    ;
                      CaptionML=[DEU=Bankkonto;
                                 ENU=Bank];
                      OnAction=BEGIN
                                 CreateBankAccount;
                               END;
                                }
      { 109     ;2   ;ActionGroup;
                      CaptionML=[DEU=VerknÅpfen mit;
                                 ENU=Link with existing] }
      { 110     ;3   ;Action    ;
                      CaptionML=[DEU=Debitor;
                                 ENU=Customer];
                      OnAction=BEGIN
                                 CreateCustomerLink;
                               END;
                                }
      { 111     ;3   ;Action    ;
                      CaptionML=[DEU=Kreditor;
                                 ENU=Vendor];
                      OnAction=BEGIN
                                 CreateVendorLink;
                               END;
                                }
      { 112     ;3   ;Action    ;
                      CaptionML=[DEU=Bankkonto;
                                 ENU=Bank];
                      OnAction=BEGIN
                                 CreateBankAccountLink;
                               END;
                                }
      { 146     ;2   ;Action    ;
                      CaptionML=[DEU=&Kontaktsuche;
                                 ENU=Co&ntact Search];
                      OnAction=VAR
                                 SearchResult@1001 : Record 5113;
                                 ContactSearchForm@1000 : Form 5177;
                               BEGIN
                                 ContactSearchForm.LOOKUPMODE(TRUE);
                                 IF ContactSearchForm.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                   ContactSearchForm.GETRECORD(SearchResult);
                                   IF GET(SearchResult."Contact No.") THEN;
                                 END;
                               END;
                                }
      { 152     ;2   ;Separator  }
      { 153     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[DEU=Vorlage anwenden;
                                 ENU=Apply Template];
                      Promoted=Yes;
                      Image=ApplyTemplate;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 TemplateMgt@1000 : Codeunit 8612;
                                 RecRef@1001 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 TemplateMgt.UpdateFromTemplateSelection(RecRef);
                               END;
                                }
      { 77      ;1   ;Action    ;
                      CaptionML=[DEU=AktivitÑt &erst.;
                                 ENU=Create &Interact];
                      Promoted=Yes;
                      Image=CreateInteraction;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateInteraction;
                               END;
                                }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1907415106;1 ;Action    ;
                      CaptionML=[DEU=Kontakt Deckblatt;
                                 ENU=Contact Cover Sheet];
                      RunObject=Report 5055;
                      Promoted=Yes;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[DEU=Allgemein;
                           ENU=General] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr=Type;
                OnValidate=BEGIN
                             TypeOnAfterValidate;
                           END;
                            }

    { 6   ;2   ;Field     ;
                SourceExpr="Company No.";
                Enabled="Company No.Enable" }

    { 8   ;2   ;Field     ;
                AssistEdit=Yes;
                SourceExpr="Company Name";
                Enabled="Company NameEnable";
                OnAssistEdit=BEGIN
                               Cont.SETRANGE("No.","Company No.");
                               CLEAR(CompanyDetails);
                               CompanyDetails.SETTABLEVIEW(Cont);
                               CompanyDetails.SETRECORD(Cont);
                               IF Type = Type::Person THEN
                                 CompanyDetails.EDITABLE := FALSE;
                               CompanyDetails.RUNMODAL;
                             END;
                              }

    { 10  ;2   ;Field     ;
                AssistEdit=Yes;
                SourceExpr=Name;
                OnAssistEdit=BEGIN
                               MODIFY;
                               COMMIT;
                               Cont.SETRANGE("No.","No.");
                               IF Type = Type::Person THEN BEGIN
                                 CLEAR(NameDetails);
                                 NameDetails.SETTABLEVIEW(Cont);
                                 NameDetails.SETRECORD(Cont);
                                 NameDetails.RUNMODAL;
                               END ELSE BEGIN
                                 CLEAR(CompanyDetails);
                                 CompanyDetails.SETTABLEVIEW(Cont);
                                 CompanyDetails.SETRECORD(Cont);
                                 CompanyDetails.RUNMODAL;
                               END;
                               GET("No.");
                               CurrPage.UPDATE;
                             END;
                              }

    { 12  ;2   ;Field     ;
                SourceExpr=Address }

    { 14  ;2   ;Field     ;
                SourceExpr="Address 2" }

    { 16  ;2   ;Field     ;
                SourceExpr="Post Code" }

    { 18  ;2   ;Field     ;
                SourceExpr="Country/Region Code" }

    { 34  ;2   ;Field     ;
                SourceExpr=City }

    { 20  ;2   ;Field     ;
                SourceExpr="Search Name" }

    { 22  ;2   ;Field     ;
                SourceExpr="Phone No.";
                OnAssistEdit=BEGIN
                               // AT2009.01 START
                               TAPIFu.Dial(5050,"No.",'',0);
                               // AT2009.01 END
                             END;
                              }

    { 24  ;2   ;Field     ;
                SourceExpr="Salesperson Code" }

    { 117 ;2   ;Field     ;
                SourceExpr="Salutation Code" }

    { 26  ;2   ;Field     ;
                SourceExpr="Last Date Modified" }

    { 28  ;2   ;Field     ;
                SourceExpr="Date of Last Interaction";
                OnDrillDown=VAR
                              InteractionLogEntry@1000 : Record 5065;
                            BEGIN
                              InteractionLogEntry.SETCURRENTKEY("Contact Company No.",Date,"Contact No.",Canceled,"Initiated By","Attempt Failed");
                              InteractionLogEntry.SETRANGE("Contact Company No.","Company No.");
                              InteractionLogEntry.SETFILTER("Contact No.","Lookup Contact No.");
                              InteractionLogEntry.SETRANGE("Attempt Failed",FALSE);
                              IF InteractionLogEntry.FIND('+') THEN
                                FORM.RUN(0,InteractionLogEntry);
                            END;
                             }

    { 30  ;2   ;Field     ;
                SourceExpr="Last Date Attempted";
                OnDrillDown=VAR
                              InteractionLogEntry@1000 : Record 5065;
                            BEGIN
                              InteractionLogEntry.SETCURRENTKEY("Contact Company No.",Date,"Contact No.",Canceled,"Initiated By","Attempt Failed");
                              InteractionLogEntry.SETRANGE("Contact Company No.","Company No.");
                              InteractionLogEntry.SETFILTER("Contact No.","Lookup Contact No.");
                              InteractionLogEntry.SETRANGE("Initiated By",InteractionLogEntry."Initiated By"::Us);
                              IF InteractionLogEntry.FIND('+') THEN
                                FORM.RUN(0,InteractionLogEntry);
                            END;
                             }

    { 32  ;2   ;Field     ;
                SourceExpr="Next To-do Date" }

    { 72  ;1   ;Part      ;
                SubFormLink=Contact No.=FIELD(No.);
                PagePartID=Page5051 }

    { 1902768601;1;Group  ;
                CaptionML=[DEU=Kommunikation;
                           ENU=Communication] }

    { 35  ;2   ;Field     ;
                SourceExpr="Phone No.";
                OnAssistEdit=BEGIN
                               // AT2009.01 START
                               TAPIFu.Dial(5050,"No.",'',0);
                               // AT2009.01 END
                             END;
                              }

    { 36  ;2   ;Field     ;
                SourceExpr="Mobile Phone No.";
                OnAssistEdit=BEGIN
                               // AT2009.01 START
                               TAPIFu.Dial(5050,"No.",'',2);
                               // AT2009.01 END;
                             END;
                              }

    { 38  ;2   ;Field     ;
                SourceExpr="Fax No." }

    { 40  ;2   ;Field     ;
                SourceExpr="Telex No." }

    { 42  ;2   ;Field     ;
                SourceExpr=Pager }

    { 44  ;2   ;Field     ;
                SourceExpr="Telex Answer Back" }

    { 46  ;2   ;Field     ;
                SourceExpr="E-Mail" }

    { 48  ;2   ;Field     ;
                SourceExpr="Home Page" }

    { 130 ;2   ;Field     ;
                SourceExpr="Language Code" }

    { 128 ;2   ;Field     ;
                SourceExpr="Salutation Code" }

    { 126 ;2   ;Field     ;
                SourceExpr="Correspondence Type" }

    { 125 ;2   ;Field     ;
                SourceExpr=IntegrationCustomerNo;
                Visible=FALSE;
                OnValidate=VAR
                             Customer@1000 : Record 18;
                             ContactBusinessRelation@1001 : Record 5054;
                           BEGIN
                             IF NOT (IntegrationCustomerNo = '') THEN BEGIN
                               Customer.GET(IntegrationCustomerNo);
                               ContactBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                               ContactBusinessRelation.SETRANGE("Link to Table",ContactBusinessRelation."Link to Table"::Customer);
                               ContactBusinessRelation.SETRANGE("No.",Customer."No.");
                               IF ContactBusinessRelation.FINDFIRST THEN
                                 VALIDATE("Company No.",ContactBusinessRelation."Contact No.");
                             END ELSE
                               VALIDATE("Company No.",'');
                           END;
                            }

    { 101 ;2   ;Field     ;
                SourceExpr="First Name";
                Visible=FALSE }

    { 121 ;2   ;Field     ;
                SourceExpr="Middle Name";
                Visible=FALSE }

    { 123 ;2   ;Field     ;
                SourceExpr=Surname;
                Visible=FALSE }

    { 1904829601;1;Group  ;
                CaptionML=[DEU=Segmentierung;
                           ENU=Segmentation] }

    { 50  ;2   ;Field     ;
                SourceExpr="No. of Mailing Groups";
                OnDrillDown=VAR
                              ContMailingGrp@1001 : Record 5056;
                            BEGIN
                              CurrPage.SAVERECORD;
                              COMMIT;
                              ContMailingGrp.SETRANGE("Contact No.","No.");
                              FORM.RUNMODAL(FORM::"Contact Mailing Groups",ContMailingGrp);
                              CurrPage.UPDATE(FALSE);
                            END;
                             }

    { 52  ;2   ;Field     ;
                SourceExpr="No. of Business Relations";
                OnDrillDown=VAR
                              ContBusRel@1001 : Record 5054;
                            BEGIN
                              CurrPage.SAVERECORD;
                              COMMIT;
                              ContBusRel.SETRANGE("Contact No.","Company No.");
                              FORM.RUNMODAL(FORM::"Contact Business Relations",ContBusRel);
                              CurrPage.UPDATE(FALSE);
                            END;
                             }

    { 54  ;2   ;Field     ;
                SourceExpr="No. of Industry Groups";
                OnDrillDown=VAR
                              ContIndustGrp@1001 : Record 5058;
                            BEGIN
                              CurrPage.SAVERECORD;
                              COMMIT;
                              ContIndustGrp.SETRANGE("Contact No.","Company No.");
                              FORM.RUNMODAL(FORM::"Contact Industry Groups",ContIndustGrp);
                              CurrPage.UPDATE(FALSE);
                            END;
                             }

    { 56  ;2   ;Field     ;
                SourceExpr="No. of Job Responsibilities";
                Enabled=NoofJobResponsibilitiesEnable;
                OnDrillDown=VAR
                              ContJobResp@1001 : Record 5067;
                            BEGIN
                              CurrPage.SAVERECORD;
                              COMMIT;
                              ContJobResp.SETRANGE("Contact No.","No.");
                              FORM.RUNMODAL(FORM::"Contact Job Responsibilities",ContJobResp);
                              CurrPage.UPDATE(FALSE);
                            END;
                             }

    { 58  ;2   ;Field     ;
                SourceExpr="Organizational Level Code";
                Enabled=OrganizationalLevelCodeEnable }

    { 60  ;2   ;Field     ;
                SourceExpr="Exclude from Segment" }

    { 1907468901;1;Group  ;
                CaptionML=[DEU=Au·enhandel;
                           ENU=Foreign Trade] }

    { 64  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Enabled="Currency CodeEnable" }

    { 68  ;2   ;Field     ;
                SourceExpr="Territory Code" }

    { 66  ;2   ;Field     ;
                SourceExpr="VAT Registration No.";
                Enabled="VAT Registration No.Enable" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Cont@1000 : Record 5050;
      CompanyDetails@1001 : Form 5054;
      NameDetails@1002 : Form 5055;
      IntegrationCustomerNo@1003 : Code[20];
      MapPointVisible@19022708 : Boolean INDATASET;
      "Currency CodeEnable"@19025310 : Boolean INDATASET;
      "VAT Registration No.Enable"@19054634 : Boolean INDATASET;
      "Company No.Enable"@19064179 : Boolean INDATASET;
      "Company NameEnable"@19044404 : Boolean INDATASET;
      OrganizationalLevelCodeEnable@19070485 : Boolean INDATASET;
      NoofJobResponsibilitiesEnable@19004457 : Boolean INDATASET;
      "*** activeTAPI ***"@1113900000 : Integer;
      TAPIFu@1113900001 : Codeunit 56780;

    PROCEDURE EnableFields@1();
    BEGIN
      "Currency CodeEnable" := Type = Type::Company;
      "VAT Registration No.Enable" := Type = Type::Company;
      "Company No.Enable" := Type = Type::Person;
      "Company NameEnable" := Type = Type::Person;
      OrganizationalLevelCodeEnable := Type = Type::Person;
      NoofJobResponsibilitiesEnable := Type = Type::Person;
    END;

    PROCEDURE IntegrationFindCustomerNo@2();
    VAR
      ContactBusinessRelation@1000 : Record 5054;
    BEGIN
      ContactBusinessRelation.SETCURRENTKEY("Link to Table","Contact No.");
      ContactBusinessRelation.SETRANGE("Link to Table",ContactBusinessRelation."Link to Table"::Customer);
      ContactBusinessRelation.SETRANGE("Contact No.","Company No.");
      IF ContactBusinessRelation.FINDFIRST THEN BEGIN
        IntegrationCustomerNo := ContactBusinessRelation."No.";
      END ELSE BEGIN
        IntegrationCustomerNo := '';
      END;
    END;

    LOCAL PROCEDURE TypeOnAfterValidate@19069045();
    BEGIN
      EnableFields;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      EnableFields;

      IF Type = Type::Person THEN
        IntegrationFindCustomerNo;
    END;

    BEGIN
    {
      AT2011   05.04.2011   New Dial function
                            Global Var TAPIFu CU 56780
                            Trick: Call in the OnAssistEdit-Trigger of every Phone No. Bitmap (3x)
    }
    END.
  }
}

OBJECT Page 5052 Contact List
{
  OBJECT-PROPERTIES
  {
    Date=05.04.11;
    Time=12:29:01;
    Modified=Yes;
    Version List=NAVW15.00,AT2011;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[DEU=KontaktÅbersicht;
               ENU=Contact List];
    SourceTable=Table5050;
    SourceTableView=SORTING(Company Name,Company No.,Type,Name);
    DataCaptionFields=Company No.;
    PageType=List;
    CardFormID=Page5050;
    OnAfterGetRecord=BEGIN
                       NameIndent := 0;
                       NoOnFormat;
                       NameOnFormat;
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 29      ;1   ;ActionGroup;
                      CaptionML=[DEU=Ko&ntakt;
                                 ENU=C&ontact] }
      { 32      ;2   ;Action    ;
                      ShortCutKey=Umschalt+F5;
                      CaptionML=[DEU=Karte;
                                 ENU=Card];
                      RunObject=Page 5052;
                      RunFormLink=No.=FIELD(No.);
                      Image=EditLines }
      { 33      ;2   ;Action    ;
                      CaptionML=[DEU=Zugehîrige Ko&ntakte;
                                 ENU=Relate&d Contacts];
                      RunObject=Page 5052;
                      RunFormLink=Company No.=FIELD(Company No.) }
      { 34      ;2   ;ActionGroup;
                      CaptionML=[DEU=Un&ternehmen;
                                 ENU=Comp&any] }
      { 35      ;3   ;Action    ;
                      CaptionML=[DEU=GeschÑftsbeziehungen;
                                 ENU=Business Relations];
                      RunObject=Page 5061;
                      RunFormLink=Contact No.=FIELD(Company No.) }
      { 36      ;3   ;Action    ;
                      CaptionML=[DEU=Branchen;
                                 ENU=Industry Groups];
                      RunObject=Page 5067;
                      RunFormLink=Contact No.=FIELD(Company No.) }
      { 37      ;3   ;Action    ;
                      CaptionML=[DEU=Internetfavoriten;
                                 ENU=Web Sources];
                      RunObject=Page 5070;
                      RunFormLink=Contact No.=FIELD(Company No.) }
      { 38      ;2   ;ActionGroup;
                      CaptionML=[DEU=&Person;
                                 ENU=P&erson] }
      { 39      ;3   ;Action    ;
                      CaptionML=[DEU=Verantwortlichkeiten;
                                 ENU=Job Responsibilities];
                      OnAction=VAR
                                 ContJobResp@1001 : Record 5067;
                               BEGIN
                                 TESTFIELD(Type,Type::Person);
                                 ContJobResp.SETRANGE("Contact No.","No.");
                                 FORM.RUNMODAL(FORM::"Contact Job Responsibilities",ContJobResp);
                               END;
                                }
      { 40      ;2   ;Action    ;
                      CaptionML=[DEU=&Verteiler;
                                 ENU=Mailing &Groups];
                      RunObject=Page 5064;
                      RunFormLink=Contact No.=FIELD(No.) }
      { 41      ;2   ;Action    ;
                      CaptionML=[DEU=Pr&ofile;
                                 ENU=Pro&files];
                      OnAction=VAR
                                 ProfileManagement@1001 : Codeunit 5059;
                               BEGIN
                                 ProfileManagement.ShowContactQuestionnaireCard(Rec,'',0);
                               END;
                                }
      { 42      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[DEU=Statistik;
                                 ENU=Statistics];
                      RunObject=Page 5053;
                      RunFormLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 43      ;2   ;Action    ;
                      CaptionML=[DEU=Bi&ld;
                                 ENU=&Picture];
                      RunObject=Page 5104;
                      RunFormLink=No.=FIELD(No.) }
      { 44      ;2   ;Action    ;
                      CaptionML=[DEU=Be&merkungen;
                                 ENU=Co&mments];
                      RunObject=Page 5072;
                      RunFormLink=Table Name=CONST(Contact),
                                  No.=FIELD(No.),
                                  Sub No.=CONST(0);
                      Image=ViewComments }
      { 45      ;2   ;ActionGroup;
                      CaptionML=[DEU=Al&ternative Adressen;
                                 ENU=Alternati&ve Address] }
      { 46      ;3   ;Action    ;
                      CaptionML=[DEU=Karte;
                                 ENU=Card];
                      RunObject=Page 5056;
                      RunFormLink=Contact No.=FIELD(No.);
                      Image=EditLines }
      { 47      ;3   ;Action    ;
                      CaptionML=[DEU=GÅltigkeiten;
                                 ENU=Date Ranges];
                      RunObject=Page 5059;
                      RunFormLink=Contact No.=FIELD(No.) }
      { 48      ;2   ;Separator ;
                      CaptionML=[DEU="";
                                 ENU=""] }
      { 49      ;2   ;Action    ;
                      ShortCutKey=Strg+F5;
                      CaptionML=[DEU=Aktivit&Ñtenprotokollposten;
                                 ENU=Interaction Log E&ntries];
                      RunObject=Page 5076;
                      RunFormView=SORTING(Contact Company No.,Contact No.);
                      RunFormLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.)) }
      { 76      ;2   ;Action    ;
                      CaptionML=[DEU=ZurÅckgestellte &AktivitÑten;
                                 ENU=Postponed &Interactions];
                      RunObject=Page 5082;
                      RunFormView=SORTING(Contact Company No.,Contact No.);
                      RunFormLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.)) }
      { 50      ;2   ;Action    ;
                      CaptionML=[DEU=Aufga&ben;
                                 ENU=T&o-dos];
                      RunObject=Page 5096;
                      RunFormView=SORTING(Contact Company No.,Contact No.);
                      RunFormLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                  System To-do Type=FILTER(Contact Attendee) }
      { 78      ;2   ;ActionGroup;
                      CaptionML=[DEU=Verkaufs&chancen;
                                 ENU=Oppo&rtunities] }
      { 51      ;3   ;Action    ;
                      CaptionML=[DEU=öbersicht;
                                 ENU=List];
                      RunObject=Page 5123;
                      RunFormView=SORTING(Contact Company No.,Contact No.);
                      RunFormLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.)) }
      { 55      ;2   ;Action    ;
                      CaptionML=[DEU=S&egmente;
                                 ENU=Segmen&ts];
                      RunObject=Page 5150;
                      RunFormView=SORTING(Contact No.,Segment No.);
                      RunFormLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.));
                      Image=Segment }
      { 52      ;2   ;Separator ;
                      CaptionML=[DEU="";
                                 ENU=""] }
      { 68      ;2   ;Action    ;
                      CaptionML=[DEU=&Angebote;
                                 ENU=Sales &Quotes];
                      RunObject=Page 41;
                      RunFormView=SORTING(Document Type,Sell-to Contact No.);
                      RunFormLink=Sell-to Contact No.=FIELD(No.);
                      Image=Quote }
      { 69      ;2   ;Separator  }
      { 53      ;2   ;Action    ;
                      CaptionML=[DEU=&Debitor/Kreditor/Bankkonto;
                                 ENU=C&ustomer/Vendor/Bank Acc.];
                      OnAction=BEGIN
                                 ShowCustVendBank;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000000;1 ;Action    ;
                      CaptionML=[DEU=&Anrufen;
                                 ENU=&Dial];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 // AT04.00 BEGIN
                                 TAPIFu.Dial(5050,"No.",'',0);
                                 // AT04.00 END
                               END;
                                }
      { 30      ;1   ;ActionGroup;
                      CaptionML=[DEU=F&unktion;
                                 ENU=F&unctions] }
      { 54      ;2   ;Action    ;
                      CaptionML=[DEU=&Telefonverbindung herstellen;
                                 ENU=Make &Phone Call];
                      OnAction=VAR
                                 TAPIManagement@1001 : Codeunit 5053;
                               BEGIN
                                 TAPIManagement.DialContCustVendBank(DATABASE::Contact,"No.","Phone No.",'');
                               END;
                                }
      { 56      ;2   ;Action    ;
                      CaptionML=[DEU=&Internetfavorit aufrufen;
                                 ENU=Launch &Web Source];
                      OnAction=VAR
                                 ContactWebSource@1001 : Record 5060;
                               BEGIN
                                 ContactWebSource.SETRANGE("Contact No.","Company No.");
                                 IF FORM.RUNMODAL(FORM::"Web Source Launch",ContactWebSource) = ACTION::LookupOK THEN
                                   ContactWebSource.Launch;
                               END;
                                }
      { 57      ;2   ;Action    ;
                      CaptionML=[DEU=&Deckblatt drucken;
                                 ENU=Print Cover &Sheet];
                      OnAction=VAR
                                 Cont@1001 : Record 5050;
                               BEGIN
                                 Cont := Rec;
                                 Cont.SETRECFILTER;
                                 REPORT.RUN(REPORT::"Contact - Cover Sheet",TRUE,FALSE,Cont);
                               END;
                                }
      { 58      ;2   ;ActionGroup;
                      CaptionML=[DEU=Erstellen als;
                                 ENU=Create as] }
      { 59      ;3   ;Action    ;
                      CaptionML=[DEU=Debitor;
                                 ENU=Customer];
                      OnAction=BEGIN
                                 CreateCustomer(ChooseCustomerTemplate);
                               END;
                                }
      { 60      ;3   ;Action    ;
                      CaptionML=[DEU=Kreditor;
                                 ENU=Vendor];
                      OnAction=BEGIN
                                 CreateVendor;
                               END;
                                }
      { 61      ;3   ;Action    ;
                      CaptionML=[DEU=Bankkonto;
                                 ENU=Bank];
                      OnAction=BEGIN
                                 CreateBankAccount;
                               END;
                                }
      { 62      ;2   ;ActionGroup;
                      CaptionML=[DEU=VerknÅpfen mit;
                                 ENU=Link with existing] }
      { 63      ;3   ;Action    ;
                      CaptionML=[DEU=Debitor;
                                 ENU=Customer];
                      OnAction=BEGIN
                                 CreateCustomerLink;
                               END;
                                }
      { 64      ;3   ;Action    ;
                      CaptionML=[DEU=Kreditor;
                                 ENU=Vendor];
                      OnAction=BEGIN
                                 CreateVendorLink;
                               END;
                                }
      { 65      ;3   ;Action    ;
                      CaptionML=[DEU=Bankkonto;
                                 ENU=Bank];
                      OnAction=BEGIN
                                 CreateBankAccountLink;
                               END;
                                }
      { 74      ;2   ;Action    ;
                      CaptionML=[DEU=&Kontaktsuche;
                                 ENU=Co&ntact Search];
                      OnAction=VAR
                                 SearchResult@1001 : Record 5113;
                                 ContactSearchForm@1000 : Form 5177;
                               BEGIN
                                 ContactSearchForm.LOOKUPMODE(TRUE);
                                 IF ContactSearchForm.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                   ContactSearchForm.GETRECORD(SearchResult);
                                   IF GET(SearchResult."Contact No.") THEN;
                                 END;
                               END;
                                }
      { 31      ;1   ;Action    ;
                      CaptionML=[DEU=AktivitÑt &erst.;
                                 ENU=Create &Interact];
                      Promoted=Yes;
                      Image=CreateInteraction;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateInteraction;
                               END;
                                }
      { 1900000005;0 ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 1900900305;1 ;Action    ;
                      CaptionML=ENU=New Sales Quote;
                      RunObject=Page 41;
                      RunFormLink=Sell-to Contact No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Quote;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1907415106;1 ;Action    ;
                      CaptionML=ENU=Contact Cover Sheet;
                      RunObject=Report 5055;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1907778706;1 ;Action    ;
                      CaptionML=ENU=Contact Company Summary;
                      RunObject=Report 5051;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1904205506;1 ;Action    ;
                      CaptionML=ENU=Contact Labels;
                      RunObject=Report 5056;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1905922906;1 ;Action    ;
                      CaptionML=ENU=Questionnaire Handout;
                      RunObject=Report 5066;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1900800206;1 ;Action    ;
                      CaptionML=ENU=Sales Cycle Analysis;
                      RunObject=Report 5062;
                      Promoted=Yes;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                IndentationColumnName=NameIndent;
                IndentationControls=Name;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                SourceExpr=Name }

    { 66  ;2   ;Field     ;
                SourceExpr="Company Name";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Post Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Country/Region Code";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Phone No." }

    { 24  ;2   ;Field     ;
                SourceExpr="Mobile Phone No.";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr="Fax No.";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Salesperson Code" }

    { 16  ;2   ;Field     ;
                SourceExpr="Territory Code" }

    { 18  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Language Code";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Search Name" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Cont@1000 : Record 5050;
      "No.Emphasize"@19074284 : Boolean INDATASET;
      NameEmphasize@19018670 : Boolean INDATASET;
      NameIndent@19079073 : Integer INDATASET;
      "*** activeTAPI ***"@1113900001 : Integer;
      TAPIFu@1113900000 : Codeunit 56780;

    LOCAL PROCEDURE NoOnFormat@19031395();
    BEGIN
      IF Type = Type::Company THEN
        "No.Emphasize" := TRUE;
    END;

    LOCAL PROCEDURE NameOnFormat@19039177();
    BEGIN
      IF Type = Type::Company THEN
        NameEmphasize := TRUE
      ELSE BEGIN
        Cont.SETCURRENTKEY("Company Name","Company No.",Type,Name);
        IF ("Company No." <> '') AND (NOT HASFILTER) AND (NOT MARKEDONLY) AND (CURRENTKEY = Cont.CURRENTKEY)
        THEN
          NameIndent := 1;
      END;
    END;

    BEGIN
    {
      AT2011   05.04.2011   Global Var TAPIFu CU 56780
                            New Action (1. of ActionItems): DEU=Anrufen; ENU=Dial (from actual line)
    }
    END.
  }
}

